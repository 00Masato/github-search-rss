{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1034?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Alternate take on <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2332727777\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52016\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52016/hovercard\" href=\"https://github.com/rails/rails/pull/52016\">#52016</a></p>\n<p dir=\"auto\">Instead of a proxy object representing the always-instantaneous transaction state, here I'm going the other way, and giving the user an object that will always reference the <em>current</em> state of the then-current transaction at the time of creation.</p>\n<p dir=\"auto\">That means it will behave reasonably even if they do something thoroughly unreasonable, like add a callback after the transaction has already committed / rolled back.</p>\n<p dir=\"auto\">Definitely needs some tidying to be mergeable: at minimum I've lost the callback docs by moving them into a nodoc class -- and I haven't added tests that show the ways this differs from current HEAD behaviour.</p>",
            "url": "https://github.com/rails/rails/pull/52017",
            "title": "Allow users to add transaction callbacks after commit etc",
            "date_modified": "2024-06-04T08:00:57.000Z",
            "date_published": "2024-06-04T07:58:28.000Z",
            "author": {
                "name": "matthewd",
                "url": "https://github.com/matthewd"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/19192189?u=dd60737844a9db7f1475bab21fc3e5258a405e15&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Ref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2327834253\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51968\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51968/hovercard?comment_id=2146695970&amp;comment_type=issue_comment\" href=\"https://github.com/rails/rails/pull/51968#issuecomment-2146695970\">#51968 (comment)</a></p>\n<p dir=\"auto\">There is some concerns about the API being misused. By returning a proxy object we make this impossible.</p>",
            "url": "https://github.com/rails/rails/pull/52016",
            "title": "Make `.current_transaction` return a proxy rather than the real transaction",
            "date_modified": "2024-06-04T07:09:44.000Z",
            "date_published": "2024-06-04T07:09:39.000Z",
            "author": {
                "name": "casperisfine",
                "url": "https://github.com/casperisfine"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39980734?u=d74e4445138b4753c03c1b9f5f086d3f9eafec13&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created to <span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51991.\">fix</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2329123688\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51991\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51991/hovercard\" href=\"https://github.com/rails/rails/issues/51991\">#51991</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes</p>\n<p dir=\"auto\"></p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/eddf8465f66ca4fc92ec9ca615cfa87db0910e25/activerecord/lib/active_record/relation/calculations.rb#L316-L318\">rails/activerecord/lib/active_record/relation/calculations.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 316 to 318\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/eddf8465f66ca4fc92ec9ca615cfa87db0910e25\">eddf846</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L316\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"316\"></td>\n          <td id=\"LC316\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">then</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">result</span>| </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L317\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"317\"></td>\n          <td id=\"LC317\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-en\">type_cast_pluck_values</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">result</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">columns</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L318\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"318\"></td>\n          <td id=\"LC318\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\">Pluck method internally calls this method which is responsible for the incorrect result.</p>\n<p dir=\"auto\"></p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/eddf8465f66ca4fc92ec9ca615cfa87db0910e25/activerecord/lib/active_record/relation/calculations.rb#L592\">rails/activerecord/lib/active_record/relation/calculations.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n         Line 592\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/eddf8465f66ca4fc92ec9ca615cfa87db0910e25\">eddf846</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L592\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"592\"></td>\n          <td id=\"LC592\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">column_types</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">]</span> || <span class=\"pl-v\">Type</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">default_value</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\"><strong>What's the problem with this code?</strong></p>\n<p dir=\"auto\">Let me take an example:</p>\n<p dir=\"auto\">When we execute this code the test fails:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"assert_equal [['2024/05/31/11_12.a2b3c4d5.txt', DateTime.parse('2024-05-31 11:12:00')]], FilePart.pluck('min(part_name)', 'min(part_start_at)')\"><pre class=\"notranslate\"><span class=\"pl-en\">assert_equal</span> <span class=\"pl-kos\">[</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">'2024/05/31/11_12.a2b3c4d5.txt'</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">DateTime</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">parse</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'2024-05-31 11:12:00'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">FilePart</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'min(part_name)'</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'min(part_start_at)'</span><span class=\"pl-kos\">)</span></pre></div>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"  1) Failure:\nBugTest#test_pluck_with_multiple_min [51991.rb:61]:\n--- expected\n+++ actual\n@@ -1 +1 @@\n-[[&quot;2024/05/31/11_12.a2b3c4d5.txt&quot;, Fri, 31 May 2024 11:12:00 +0000]]\n+[[2024-05-31 00:00:00 UTC, 2024-05-31 11:12:00 UTC]]\"><pre class=\"notranslate\">  <span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span> <span class=\"pl-pds\">Failure</span>:\n<span class=\"pl-v\">BugTest</span><span class=\"pl-c\">#test_pluck_with_multiple_min [51991.rb:61]:</span>\n--- <span class=\"pl-en\">expected</span>\n+++ <span class=\"pl-en\">actual</span>\n@@ -<span class=\"pl-c1\">1</span> +<span class=\"pl-c1\">1</span> @@\n-<span class=\"pl-kos\">[</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"2024/05/31/11_12.a2b3c4d5.txt\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">Fri</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">31</span> <span class=\"pl-en\">May</span> <span class=\"pl-c1\">2024</span> <span class=\"pl-c1\">11</span><span class=\"pl-pds\">:12</span><span class=\"pl-pds\">:00</span> +<span class=\"pl-c1\">0000</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">]</span>\n+<span class=\"pl-kos\">[</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">2024</span>-<span class=\"pl-c1\">05</span>-<span class=\"pl-c1\">31</span> <span class=\"pl-c1\">00</span><span class=\"pl-pds\">:00</span><span class=\"pl-pds\">:00</span> <span class=\"pl-c1\">UTC</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">2024</span>-<span class=\"pl-c1\">05</span>-<span class=\"pl-c1\">31</span> <span class=\"pl-c1\">11</span><span class=\"pl-pds\">:12</span><span class=\"pl-pds\">:00</span> <span class=\"pl-c1\">UTC</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">]</span></pre></div>\n<p dir=\"auto\"><strong>Why is this test failing?</strong></p>\n<p dir=\"auto\">If we examine the output, the <code class=\"notranslate\">part_name</code> field is also being cast as a timestamp.</p>\n<p dir=\"auto\">Why is <code class=\"notranslate\">part_name</code> getting cast as a timestamp?</p>\n<p dir=\"auto\">To understand this, we need to look at this piece of code<br>\n</p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/eddf8465f66ca4fc92ec9ca615cfa87db0910e25/activerecord/lib/active_record/connection_adapters/postgresql/database_statements.rb#L63-L74\">rails/activerecord/lib/active_record/connection_adapters/postgresql/database_statements.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 63 to 74\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/eddf8465f66ca4fc92ec9ca615cfa87db0910e25\">eddf846</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L63\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"63\"></td>\n          <td id=\"LC63\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">internal_exec_query</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">sql</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"SQL\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">binds</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">prepare</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">async</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">allow_retry</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">materialize_transactions</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\"># :nodoc:</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L64\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"64\"></td>\n          <td id=\"LC64\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-en\">execute_and_clear</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">sql</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">name</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">binds</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">prepare</span>: <span class=\"pl-s1\">prepare</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">async</span>: <span class=\"pl-s1\">async</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">allow_retry</span>: <span class=\"pl-s1\">allow_retry</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">materialize_transactions</span>: <span class=\"pl-s1\">materialize_transactions</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">result</span>| </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L65\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"65\"></td>\n          <td id=\"LC65\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-s1\">types</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L66\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"66\"></td>\n          <td id=\"LC66\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-s1\">fields</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-s1\">fields</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L67\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"67\"></td>\n          <td id=\"LC67\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-s1\">fields</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">each_with_index</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">fname</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">i</span>| </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L68\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"68\"></td>\n          <td id=\"LC68\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">       <span class=\"pl-s1\">ftype</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-s1\">ftype</span> <span class=\"pl-s1\">i</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L69\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"69\"></td>\n          <td id=\"LC69\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">       <span class=\"pl-s1\">fmod</span>  <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-s1\">fmod</span> <span class=\"pl-s1\">i</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L70\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"70\"></td>\n          <td id=\"LC70\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">       <span class=\"pl-s1\">types</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">fname</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">types</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">i</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">get_oid_type</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ftype</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">fmod</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">fname</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L71\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"71\"></td>\n          <td id=\"LC71\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L72\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"72\"></td>\n          <td id=\"LC72\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">build_result</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">columns</span>: <span class=\"pl-s1\">fields</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">rows</span>: <span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">values</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">column_types</span>: <span class=\"pl-s1\">types</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L73\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"73\"></td>\n          <td id=\"LC73\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L74\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"74\"></td>\n          <td id=\"LC74\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\">Here, we are creating the <code class=\"notranslate\">types</code> hash for each field required in the pluck result. Each field will have a corresponding type. Correct?</p>\n<p dir=\"auto\">However, the issue lies in the fact that in our case, both columns have the <code class=\"notranslate\">min</code> function applied, so our <code class=\"notranslate\">fields = result.fields</code> will have the value:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"fields == [&quot;min&quot;, &quot;min&quot;]\"><pre class=\"notranslate\"><span class=\"pl-en\">fields</span> == <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"min\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"min\"</span><span class=\"pl-kos\">]</span></pre></div>\n<p dir=\"auto\">Hence, when creating the key with <code class=\"notranslate\">min</code>, it will be overridden by <code class=\"notranslate\">part_start_at</code>.</p>\n<p dir=\"auto\">In the following code, we are filtering out the type based on the <code class=\"notranslate\">name</code>, which will give the same type (timestamp) for columns with the same name.<br>\n</p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/eddf8465f66ca4fc92ec9ca615cfa87db0910e25/activerecord/lib/active_record/relation/calculations.rb#L592\">rails/activerecord/lib/active_record/relation/calculations.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n         Line 592\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/eddf8465f66ca4fc92ec9ca615cfa87db0910e25\">eddf846</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L592\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"592\"></td>\n          <td id=\"LC592\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">column_types</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">name</span><span class=\"pl-kos\">]</span> || <span class=\"pl-v\">Type</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">default_value</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\"><strong>Solution:</strong></p>\n<p dir=\"auto\">With <a href=\"https://github.com/rails/rails/commit/100c86c00eefc69661e9abdfcb6e0a4a2b46676e\">this commit</a>,</p>\n<p dir=\"auto\"></p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/eddf8465f66ca4fc92ec9ca615cfa87db0910e25/activerecord/lib/active_record/connection_adapters/postgresql/database_statements.rb#L70-L70\">rails/activerecord/lib/active_record/connection_adapters/postgresql/database_statements.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n         Line 70\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/eddf8465f66ca4fc92ec9ca615cfa87db0910e25\">eddf846</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L70\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"70\"></td>\n          <td id=\"LC70\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s1\">types</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">fname</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">types</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">i</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">get_oid_type</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">ftype</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">fmod</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">fname</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<br>\nsince we are also storing the type based on the column or field index, it's better to utilize that for a more accurate result.<p></p>\n<p dir=\"auto\">Hence we change the line to</p>\n<p dir=\"auto\"><strong>Before:</strong></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"  result.column_types[name] || Type.default_value\"><pre class=\"notranslate\">  <span class=\"pl-en\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">column_types</span><span class=\"pl-kos\">[</span><span class=\"pl-en\">name</span><span class=\"pl-kos\">]</span> || <span class=\"pl-v\">Type</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">default_value</span></pre></div>\n<p dir=\"auto\"><strong>After:</strong></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"  result.column_types[i] || Type.default_value\"><pre class=\"notranslate\">  <span class=\"pl-en\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">column_types</span><span class=\"pl-kos\">[</span><span class=\"pl-en\">i</span><span class=\"pl-kos\">]</span> || <span class=\"pl-v\">Type</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">default_value</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #51991 ]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52015",
            "title": "[FIX] Pluck columns should correctly casts types when using postgresql",
            "date_modified": "2024-06-04T07:12:20.000Z",
            "date_published": "2024-06-04T06:09:36.000Z",
            "author": {
                "name": "maniSHarma7575",
                "url": "https://github.com/maniSHarma7575"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14007?u=7d74620cf38d2057b13e9cbb7ee8c6ae35c1d019&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #48463.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1755595459\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48463\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48463/hovercard\" href=\"https://github.com/rails/rails/issues/48463\">#48463</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51424.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2208080356\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51424\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51424/hovercard\" href=\"https://github.com/rails/rails/issues/51424\">#51424</a></p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Sessions are lazily loaded by default, which makes sense for non-cookie storages. One downside of lazy loading is the session ID isn't available until after the first page load (assuming there's some interaction with <code class=\"notranslate\">session</code> that loads it).</p>\n<p dir=\"auto\">The <a href=\"https://github.com/rails/rails/blob/fb84e13468c0e266144aa7375431fc6a243f4e8f/railties/lib/rails/generators/rails/app/templates/config/initializers/content_security_policy.rb.tt#L20\">default CSP that's generated</a> suggests to use the session ID as the nonce generator. This works great when the session is actually available/loaded!</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This pull allows the session to not be lazily loaded, which should be just fine for the cookie store:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"config.session_store :cookie_store, lazy: false\"><pre class=\"notranslate\"><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">session_store</span> <span class=\"pl-pds\">:cookie_store</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">lazy</span>: <span class=\"pl-c1\">false</span></pre></div>\n<p dir=\"auto\">NOTE: this pull is not complete (needs doc and generator changes) -- I'm looking for some feedback if it's even something that the core team is open to.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52014",
            "title": "Allow sessions to not be lazily loaded",
            "date_modified": "2024-06-04T05:00:09.000Z",
            "date_published": "2024-06-04T04:55:45.000Z",
            "author": {
                "name": "justinko",
                "url": "https://github.com/justinko"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5162312?u=e1b3c0f7c6dc600253bf15c99f618b9b2d39c500&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Retry of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2254046185\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51614\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51614/hovercard\" href=\"https://github.com/rails/rails/pull/51614\">#51614</a></p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51906.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2315480773\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51906\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51906/hovercard\" href=\"https://github.com/rails/rails/issues/51906\">#51906</a></p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because apps with lots of routes take a long time to boot. A developer could boot an app for reasons that don't involve routes at all (like running unit tests, migrations, rake tasks, etc.) so I think this should be deferred in dev and test.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes engine and app route sets to a <code class=\"notranslate\">Rails::Engine::RouteSet</code>, which knows about the current Rails application. The default middleware stack has also changed to include a <code class=\"notranslate\">Rails::Rack::LoadRoutes</code> middleware that loads routes if needed. This PR loads routes under the following circumstances:</p>\n<p dir=\"auto\">In dev/test:</p>\n<ul dir=\"auto\">\n<li>The first request via middleware</li>\n<li>When application or engine <code class=\"notranslate\">url_helpers.some_path</code> is called via <code class=\"notranslate\">method_missing?</code></li>\n<li>When application or engine <code class=\"notranslate\">url_helpers.respond_to?(:some_path)</code> is called via <code class=\"notranslate\">respond_to_missing?</code></li>\n</ul>\n<p dir=\"auto\">In production:</p>\n<ul dir=\"auto\">\n<li>In the finisher eagerly, which is the previous behaviour</li>\n</ul>\n<p dir=\"auto\">If, for some reason, a developer wishes to revert to the previous behaviour, they could add an initializer with <code class=\"notranslate\">Rails.application.reload_routes!</code>. However, if we wanted to be more safe, we could also hide this behaviour behind a configuration variable.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">This is loosely inspired by <a href=\"https://github.com/amatsuda/routes_lazy_routes\">https://github.com/amatsuda/routes_lazy_routes</a></p>\n<p dir=\"auto\">I'm a bit concerned this is too much of a hack, but I think the speed benefit might be worth it. In an app with 2000 routes:</p>\n<p dir=\"auto\">Before:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"% time bin/rails runner &quot;&quot;\nbin/rails runner &quot;&quot;  0.66s user 0.33s system 95% cpu 1.036 total\"><pre class=\"notranslate\"><code class=\"notranslate\">% time bin/rails runner \"\"\nbin/rails runner \"\"  0.66s user 0.33s system 95% cpu 1.036 total\n</code></pre></div>\n<p dir=\"auto\">After:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"% time bin/rails runner &quot;&quot;\nbin/rails runner &quot;&quot;  0.47s user 0.32s system 98% cpu 0.791 total\"><pre class=\"notranslate\"><code class=\"notranslate\">% time bin/rails runner \"\"\nbin/rails runner \"\"  0.47s user 0.32s system 98% cpu 0.791 total\n</code></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52012",
            "title": "Defer route drawing to the first request, or when url_helpers called.",
            "date_modified": "2024-06-04T06:00:56.000Z",
            "date_published": "2024-06-03T21:02:02.000Z",
            "author": {
                "name": "gmcgibbon",
                "url": "https://github.com/gmcgibbon"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14981592?u=11406fb0121b15a93b3305388377a57b4d9c96f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Followup to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2326434456\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51959\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51959/hovercard\" href=\"https://github.com/rails/rails/pull/51959\">#51959</a>. The test I added in that PR can be improved by actually checking that the runner does what the expected behaviour is.</p>\n<p dir=\"auto\">Since support for minitest/spec should not be implied (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2326434456\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51959\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51959/hovercard?comment_id=1621385796&amp;comment_type=review_comment\" href=\"https://github.com/rails/rails/pull/51959#discussion_r1621385796\">#51959 (comment)</a>) I also slightly modified the test above</p>",
            "url": "https://github.com/rails/rails/pull/52002",
            "title": "Add a proper test for running tests by line with custom method",
            "date_modified": "2024-06-03T10:28:09.000Z",
            "date_published": "2024-06-03T10:28:04.000Z",
            "author": {
                "name": "Earlopain",
                "url": "https://github.com/Earlopain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2853450?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51995.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2329813988\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51995\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51995/hovercard\" href=\"https://github.com/rails/rails/issues/51995\">#51995</a></p>\n<p dir=\"auto\">Calling <code class=\"notranslate\">exists?</code> does not work with composite keys (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2179081656\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51295\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51295/hovercard\" href=\"https://github.com/rails/rails/issues/51295\">#51295</a>) which is used internally for <code class=\"notranslate\">include?</code> here it zips the primary key values into a hash with the primary key keys, a format that is supported by <code class=\"notranslate\">exists?</code> so it does not raise and returns the expected result.</p>",
            "url": "https://github.com/rails/rails/pull/51996",
            "title": "Fix `include?` on composite key relations",
            "date_modified": "2024-06-03T08:15:16.000Z",
            "date_published": "2024-06-02T18:54:30.000Z",
            "author": {
                "name": "jackozi",
                "url": "https://github.com/jackozi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1034?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">We realised the previous deprecation hadn't been warning for all users, so proceeding to removal could cause an un-warned change in behaviour.</p>\n<p dir=\"auto\">This Pull Request restores the previous deprecation, then adds an additional once-off warning the first time <code class=\"notranslate\">to_time</code> is called [if the config setting has not already been set].</p>\n<p dir=\"auto\">A one-time warning is a departure from our usual warn-every-call strategy, but seems like a better fit here:</p>\n<ul dir=\"auto\">\n<li>warning on every <code class=\"notranslate\">to_time</code> call would just be repetitive and overwhelming, and</li>\n<li>the immediately prompted action is itself one-shot.</li>\n</ul>\n<p dir=\"auto\">Even though an application could ultimately need to review each call site to confirm it's happy with the change in return value, the only measurable action is globally switching the config setting -- separately warning on each call does not provide a \"burn down\" list as it would for a change to the calling API.</p>",
            "url": "https://github.com/rails/rails/pull/51994",
            "title": "Re-roll deprecation of to_time_preserves_timezone",
            "date_modified": "2024-06-02T16:08:41.000Z",
            "date_published": "2024-06-02T16:08:36.000Z",
            "author": {
                "name": "matthewd",
                "url": "https://github.com/matthewd"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39144575?u=27bc8b51723fcd8f9a2de237a4082ecb370f0a59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Following up <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/317465a4a8f8c0ebaf9534921350c4540584c03c/hovercard\" href=\"https://github.com/rails/rails/commit/317465a4a8f8c0ebaf9534921350c4540584c03c\"><tt>317465a</tt></a>.</p>",
            "url": "https://github.com/rails/rails/pull/51993",
            "title": "Fix test title mismatch",
            "date_modified": "2024-06-02T01:59:18.000Z",
            "date_published": "2024-06-02T01:59:14.000Z",
            "author": {
                "name": "wonda-tea-coffee",
                "url": "https://github.com/wonda-tea-coffee"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This is to mitigate errors like:<br>\n<a href=\"https://buildkite.com/rails/rails/builds/107403#018f9917-fd63-4701-9620-f9caf2caaf2d/1163-1195\" rel=\"nofollow\">https://buildkite.com/rails/rails/builds/107403#018f9917-fd63-4701-9620-f9caf2caaf2d/1163-1195</a></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ERROR [karma-server]:\nError: [init({...}})] The environment you requested was unavailable.\"><pre class=\"notranslate\"><code class=\"notranslate\">ERROR [karma-server]:\nError: [init({...}})] The environment you requested was unavailable.\n</code></pre></div>\n<p dir=\"auto\">We can make buildkite-config retry this status and soft-fail on exit 3.</p>\n<p dir=\"auto\">For example,<br>\n<a href=\"https://buildkite.com/changelog/56-command-steps-can-now-be-made-to-soft-fail\" rel=\"nofollow\">https://buildkite.com/changelog/56-command-steps-can-now-be-made-to-soft-fail</a></p>\n<p dir=\"auto\">I <em>think</em> we can combine this with a retry policy on the exit status:<br>\n<a href=\"https://buildkite.com/docs/pipelines/command-step#retry-attributes-automatic-retry-attributes\" rel=\"nofollow\">https://buildkite.com/docs/pipelines/command-step#retry-attributes-automatic-retry-attributes</a></p>\n<p dir=\"auto\">/cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a></p>",
            "url": "https://github.com/rails/rails/pull/51990",
            "title": "Exit status 3 when Action Cable integration tests fail due to Saucelabs error",
            "date_modified": "2024-06-01T10:45:18.000Z",
            "date_published": "2024-06-01T10:44:54.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This backports <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2246919123\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51581\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51581/hovercard\" href=\"https://github.com/rails/rails/pull/51581\">#51581</a> to <code class=\"notranslate\">7-1-stable</code> branch to fix <a href=\"https://buildkite.com/rails/rails/builds/107922#018fd2e7-8e44-4bed-97ce-615fe907dddf/1111-1121\" rel=\"nofollow\">this build failure</a>.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Failure:\nActiveRecord::ConnectionAdapters::SchemaCacheTest#test_gzip_dumps_identical [test/cases/connection_adapters/schema_cache_test.rb:352]:\n--- expected\n+++ actual\n@@ -1,3 +1,3 @@\n # encoding: US-ASCII\n #    valid: true\n-&quot;c6e5a4aa0bf99c80b32c8d73c26d0ec9&quot;\n+&quot;b09eb0f057e1f6928e9de89c599f8b86&quot;\"><pre class=\"notranslate\"><code class=\"notranslate\">Failure:\nActiveRecord::ConnectionAdapters::SchemaCacheTest#test_gzip_dumps_identical [test/cases/connection_adapters/schema_cache_test.rb:352]:\n--- expected\n+++ actual\n@@ -1,3 +1,3 @@\n # encoding: US-ASCII\n #    valid: true\n-\"c6e5a4aa0bf99c80b32c8d73c26d0ec9\"\n+\"b09eb0f057e1f6928e9de89c599f8b86\"\n</code></pre></div>",
            "url": "https://github.com/rails/rails/pull/51988",
            "title": "[7-1-stable] fix flaky schema dump test to prefer YAML to Marshal",
            "date_modified": "2024-06-01T10:14:26.000Z",
            "date_published": "2024-06-01T09:45:21.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">I saw a few times <code class=\"notranslate\">.exists?</code>(instead of <code class=\"notranslate\">.any?</code>) being used on loaded relations.<br>\nSeems like there is no reason why we can't improve that method?</p>\n<p dir=\"auto\">This is a reworked <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2327575420\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51966\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51966/hovercard\" href=\"https://github.com/rails/rails/pull/51966\">#51966</a>.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a></p>",
            "url": "https://github.com/rails/rails/pull/51987",
            "title": "Optimize `ActiveRecord::Relation#exists?` with no conditions for loaded relations",
            "date_modified": "2024-06-01T09:24:33.000Z",
            "date_published": "2024-06-01T09:24:29.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Backports <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/fcec475438cd74483acc2db2477249358b5399bb/hovercard\" href=\"https://github.com/rails/rails/commit/fcec475438cd74483acc2db2477249358b5399bb\"><tt>fcec475</tt></a> to <code class=\"notranslate\">7-1-stable</code> to fix <a href=\"https://buildkite.com/rails/rails/builds/107922#018fd2e7-8da4-4968-b5f7-50512b946e00/1176-1216\" rel=\"nofollow\">this build failure</a>.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Error:\nEarlyHintsRequestTest#test_when_early_hints_is_set_in_the_env_link_headers_are_sent:\nRack::Lint::LintError: invalid header value link: &quot;&lt;/style.css&gt;; rel=preload; as=style\\n&lt;/script.js&gt;; rel=preload&quot;\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:721:in `check_header_value'\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:708:in `block in check_headers'\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:688:in `each'\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:688:in `check_headers'\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:656:in `block in check_early_hints'\n    lib/action_dispatch/http/request.rb:244:in `send_early_hints'\n    test/dispatch/request_test.rb:1411:in `block in &lt;class:EarlyHintsRequestTest&gt;'\"><pre class=\"notranslate\"><code class=\"notranslate\">Error:\nEarlyHintsRequestTest#test_when_early_hints_is_set_in_the_env_link_headers_are_sent:\nRack::Lint::LintError: invalid header value link: \"&lt;/style.css&gt;; rel=preload; as=style\\n&lt;/script.js&gt;; rel=preload\"\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:721:in `check_header_value'\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:708:in `block in check_headers'\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:688:in `each'\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:688:in `check_headers'\n    /usr/local/bundle/bundler/gems/rack-47b40d344526/lib/rack/lint.rb:656:in `block in check_early_hints'\n    lib/action_dispatch/http/request.rb:244:in `send_early_hints'\n    test/dispatch/request_test.rb:1411:in `block in &lt;class:EarlyHintsRequestTest&gt;'\n</code></pre></div>\n<hr>\n<p dir=\"auto\">See <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Link\" rel=\"nofollow\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Link</a>.</p>",
            "url": "https://github.com/rails/rails/pull/51986",
            "title": "[7-1-stable] Link should be separated by comma.",
            "date_modified": "2024-06-01T09:18:42.000Z",
            "date_published": "2024-06-01T09:18:37.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/44903779?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Sometimes when call stored attribute, it requires specific naming semantics. For example when you save some data from external source. This Pull Request adds mapping for store attribute keys</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Proposed changes</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class User &lt; ApplicationRecord\n  store_accessor :settings, :language, { country: :country_of_residence }\nend\n\nuser = User.new(country: &quot;US&quot;)\nuser.country # =&gt; &quot;US&quot;\nuser.settings[&quot;country_of_residence&quot;] # =&gt; &quot;US&quot;\nuser.settings[&quot;country_of_residence&quot;] = &quot;CA&quot;\nuser.country # =&gt; &quot;CA&quot;\nuser.country = &quot;NL&quot;\nuser.country # =&gt; &quot;NL&quot;\nuser.settings[&quot;country_of_residence&quot;] # =&gt; &quot;NL&quot;\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">store_accessor</span> <span class=\"pl-pds\">:settings</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:language</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">country</span>: <span class=\"pl-pds\">:country_of_residence</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">user</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">country</span>: <span class=\"pl-s\">\"US\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">country</span> <span class=\"pl-c\"># =&gt; \"US\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">settings</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"country_of_residence\"</span><span class=\"pl-kos\">]</span> <span class=\"pl-c\"># =&gt; \"US\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">settings</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"country_of_residence\"</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"CA\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">country</span> <span class=\"pl-c\"># =&gt; \"CA\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">country</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"NL\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">country</span> <span class=\"pl-c\"># =&gt; \"NL\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">settings</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"country_of_residence\"</span><span class=\"pl-kos\">]</span> <span class=\"pl-c\"># =&gt; \"NL\"</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">This was intended as non-breaking change</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51981",
            "title": "Add mapping to stored attributes",
            "date_modified": "2024-06-03T22:49:41.000Z",
            "date_published": "2024-06-01T00:48:08.000Z",
            "author": {
                "name": "mechnicov",
                "url": "https://github.com/mechnicov"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5059927?u=54cb27efd35253e1fe86d48663b299bf398d8d84&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Gems like apartment(<a href=\"https://github.com/rails-on-services/apartment\">https://github.com/rails-on-services/apartment</a>) prepend the database name to a models <code class=\"notranslate\">table_name</code> (i.e. my_prod_db.books). When it  goes to do an insert_all  you end up with an <code class=\"notranslate\">AS</code> clause that looks like the following:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"AS `my_prod_db`.`books_values` ON DUPLICATE KEY UPDATE `author`=`my_prod_db`.`books_values`.`author` \"><pre class=\"notranslate\"><code class=\"notranslate\">AS `my_prod_db`.`books_values` ON DUPLICATE KEY UPDATE `author`=`my_prod_db`.`books_values`.`author` \n</code></pre></div>\n<p dir=\"auto\">which results in a syntax error.</p>\n<p dir=\"auto\">This change calls parameterize on the table name to convert the period to a dash so it appears as one table name. Since this is just an alias the database name isnt needed in the name and it resolves the syntax error.</p>\n<p dir=\"auto\">After this change the above sql changes to:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"AS `my_prod_db-books_values` ON DUPLICATE KEY UPDATE `author`=`my_prod_db-books_values`.`author` \"><pre class=\"notranslate\"><code class=\"notranslate\">AS `my_prod_db-books_values` ON DUPLICATE KEY UPDATE `author`=`my_prod_db-books_values`.`author` \n</code></pre></div>\n\n<p dir=\"auto\">This Pull Request has been created because it resolves a possible syntax error when a models <code class=\"notranslate\">table_name</code> also contains the database name.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">This change is due to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2173543419\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51274\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51274/hovercard\" href=\"https://github.com/rails/rails/pull/51274\">#51274</a></p>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51969",
            "title": "Parameterize table_name when constructing insert alias to avoid syntax error when table_name contains the database name for mysql",
            "date_modified": "2024-06-03T13:27:32.000Z",
            "date_published": "2024-05-31T15:06:41.000Z",
            "author": {
                "name": "npezza93",
                "url": "https://github.com/npezza93"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5077225?u=e9f968c9eb790ee7734442f6b7998155400ad1d8&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">As detailed in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2044839875\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50370\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50370/hovercard\" href=\"https://github.com/rails/rails/pull/50370\">#50370</a>, the current use of SQLite's <code class=\"notranslate\">busy_timeout</code> functionality leads to notable increases in tail latency as well as occasional <code class=\"notranslate\">SQLite3::BusyException: database is locked</code> errors since it does not release the GVL while waiting to retry acquiring the SQLite database lock. Version 2.0 of the <code class=\"notranslate\">sqlite3</code> gem introduces a new <a href=\"https://github.com/sparklemotion/sqlite3-ruby/pull/456\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/sparklemotion/sqlite3-ruby/pull/456/hovercard\"><code class=\"notranslate\">SQLite3::Database#busy_handler_timeout=</code> method</a>, which provides a non-GVL-blocking, fair retry interval busy handler implementation.</p>\n<p dir=\"auto\">cc: <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/flavorjones/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/flavorjones\">@flavorjones</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/tenderlove/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/tenderlove\">@tenderlove</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR points the <code class=\"notranslate\">timeout</code> option the <code class=\"notranslate\">database.yml</code> config file at this new busy handler implementation. In order to ensure that this new method is present, I have also opened <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2326400791\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51957\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51957/hovercard\" href=\"https://github.com/rails/rails/pull/51957\">#51957</a> so that Rails 8 defaults to version &gt;= 2.0 for the <code class=\"notranslate\">sqlite3</code> gem.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">As detailed in <a href=\"https://fractaledmind.github.io/2024/04/15/sqlite-on-rails-the-how-and-why-of-optimal-performance/\" rel=\"nofollow\">my deep dive</a> on this topic, having such a busy handler is essential for running production-grade Rails application using SQLite. In my benchmarks, ensuring that the busy handler doesn't hold the GVL brought p95 latency down from &gt;5s to 0.19s. Then, ensuring that the retry interval was fair for both \"old\" and \"new\" queries brought p99.99 latency down from &gt;1.5s to 0.5s.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51958",
            "title": "SQLite non-GVL-blocking, fair retry interval busy handler",
            "date_modified": "2024-06-01T08:33:22.000Z",
            "date_published": "2024-05-30T19:39:08.000Z",
            "author": {
                "name": "fractaledmind",
                "url": "https://github.com/fractaledmind"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/64581?u=d8cec29b4b85089fa2c833d59f2f3c3cb9f9705d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">ActiveStorage currently allows variants to be created on demand (by default) or in the background (using preprocessed). This can be problematic for applications that have a lot of traffic. Immediately after an attachment is created, thousands of requests could be created for a single variant. Each controller receiving the request as well as a background job could all be racing to create the variant.</p>\n<p dir=\"auto\">In order to give more control variant creation, we are proposing an immediate option to allow variants to be created simultaneously with the attachment.</p>\n<p dir=\"auto\">This Pull Request has been created because products like ours need more control over variant creation.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes introduces the <code class=\"notranslate\">immediate</code> option and follows the existing patterns around <code class=\"notranslate\">preprocessed</code>.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  has_one_attached :avatar_with_immediate do |attachable|\n    attachable.variant :thumb, resize_to_limit: [4, 4], immediate: true\n  end\"><pre class=\"notranslate\"><code class=\"notranslate\">  has_one_attached :avatar_with_immediate do |attachable|\n    attachable.variant :thumb, resize_to_limit: [4, 4], immediate: true\n  end\n</code></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51951",
            "title": "`ActiveStorage` immediate variants",
            "date_modified": "2024-06-03T21:05:39.000Z",
            "date_published": "2024-05-30T13:41:48.000Z",
            "author": {
                "name": "tomrossi7",
                "url": "https://github.com/tomrossi7"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">As is the case when trying to use an integer as a key, which is unsupported.</p>\n<p dir=\"auto\">This replaces the following less-friendly error:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"NoMethodError: undefined method 'to_sym' for an instance of Integer\n    lib/active_support/ordered_options.rb:38:in 'ActiveSupport::OrderedOptions#[]='\n    lib/active_support/delegation.rb:167:in 'Kernel#public_send'\n    lib/active_support/delegation.rb:167:in 'ActiveSupport::EncryptedConfiguration#method_missing'\"><pre class=\"notranslate\"><code class=\"notranslate\">NoMethodError: undefined method 'to_sym' for an instance of Integer\n    lib/active_support/ordered_options.rb:38:in 'ActiveSupport::OrderedOptions#[]='\n    lib/active_support/delegation.rb:167:in 'Kernel#public_send'\n    lib/active_support/delegation.rb:167:in 'ActiveSupport::EncryptedConfiguration#method_missing'\n</code></pre></div>\n<p dir=\"auto\">With a more helpful error message:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ActiveSupport::EncryptedConfiguration::InvalidKeyError: Key '42' is invalid, it must not be an Integer or Float, and respond to '#to_sym' from configuration in '/tmp/config-20240530-4153925-tfzzt/credentials.yml.enc'.\n    lib/active_support/encrypted_configuration.rb:99:in 'block in ActiveSupport::EncryptedConfiguration#deep_symbolize_keys'\n    lib/active_support/core_ext/hash/keys.rb:120:in 'block in Hash#_deep_transform_keys_in_object'\n    lib/active_support/core_ext/hash/keys.rb:119:in 'Hash#each'\n    lib/active_support/core_ext/hash/keys.rb:119:in 'Enumerable#each_with_object'\n    lib/active_support/core_ext/hash/keys.rb:119:in 'Hash#_deep_transform_keys_in_object'\n    lib/active_support/core_ext/hash/keys.rb:66:in 'Hash#deep_transform_keys'\n    lib/active_support/encrypted_configuration.rb:96:in 'ActiveSupport::EncryptedConfiguration#deep_symbolize_keys'\n    lib/active_support/encrypted_configuration.rb:86:in 'ActiveSupport::EncryptedConfiguration#config'\"><pre class=\"notranslate\"><code class=\"notranslate\">ActiveSupport::EncryptedConfiguration::InvalidKeyError: Key '42' is invalid, it must not be an Integer or Float, and respond to '#to_sym' from configuration in '/tmp/config-20240530-4153925-tfzzt/credentials.yml.enc'.\n    lib/active_support/encrypted_configuration.rb:99:in 'block in ActiveSupport::EncryptedConfiguration#deep_symbolize_keys'\n    lib/active_support/core_ext/hash/keys.rb:120:in 'block in Hash#_deep_transform_keys_in_object'\n    lib/active_support/core_ext/hash/keys.rb:119:in 'Hash#each'\n    lib/active_support/core_ext/hash/keys.rb:119:in 'Enumerable#each_with_object'\n    lib/active_support/core_ext/hash/keys.rb:119:in 'Hash#_deep_transform_keys_in_object'\n    lib/active_support/core_ext/hash/keys.rb:66:in 'Hash#deep_transform_keys'\n    lib/active_support/encrypted_configuration.rb:96:in 'ActiveSupport::EncryptedConfiguration#deep_symbolize_keys'\n    lib/active_support/encrypted_configuration.rb:86:in 'ActiveSupport::EncryptedConfiguration#config'\n</code></pre></div>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51215.\">Fixes</span>: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2159201192\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51215\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51215/hovercard\" href=\"https://github.com/rails/rails/issues/51215\">#51215</a></p>",
            "url": "https://github.com/rails/rails/pull/51950",
            "title": "Raise when using key which can't respond to `#to_sym` in EncryptedConfiguration",
            "date_modified": "2024-06-03T13:27:16.000Z",
            "date_published": "2024-05-30T12:21:08.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14007?u=7d74620cf38d2057b13e9cbb7ee8c6ae35c1d019&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51938.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2323430140\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51938\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51938/hovercard\" href=\"https://github.com/rails/rails/issues/51938\">#51938</a></p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2276828951\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51721\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51721/hovercard\" href=\"https://github.com/rails/rails/pull/51721\">#51721</a> was a nice change, but it removed some existing behavior.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This change restores the ability for the inferred association class to be the same modularized name.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51948",
            "title": "Restore inferred association class with the same modularized name",
            "date_modified": "2024-05-30T09:55:12.000Z",
            "date_published": "2024-05-30T09:55:02.000Z",
            "author": {
                "name": "justinko",
                "url": "https://github.com/justinko"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/28561?u=095779352a57f75e734987829f3f67a10e5780ed&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Calling <code class=\"notranslate\">eager_load</code> will execute a single query with a join, not two. The original queries were probably the result of executing the code in the console, where <code class=\"notranslate\">books = Book.eager_load(:author).limit(10) </code> would execute the query.</p>",
            "url": "https://github.com/rails/rails/pull/51940",
            "title": "Fix query result of eager_load example in the guides. [ci-skip]",
            "date_modified": "2024-05-29T14:49:33.000Z",
            "date_published": "2024-05-29T14:49:29.000Z",
            "author": {
                "name": "p8",
                "url": "https://github.com/p8"
            }
        }
    ]
}