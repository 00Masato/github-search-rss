{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5122678?u=204301f9f9fe8930fd26fe3bfe65b6ffaffd8b59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52478.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2442642275\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52478\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52478/hovercard\" href=\"https://github.com/rails/rails/issues/52478\">#52478</a></p>\n<p dir=\"auto\">Prior to this commit, tests using <a href=\"https://edgeapi.rubyonrails.org/classes/ActiveJob/TestHelper.html#method-i-assert_enqueued_with\" rel=\"nofollow\">assert_enqueued_with</a> asserting against the <code class=\"notranslate\">at</code> argument would incorrectly pass if testing with values that used second-level precision.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class BuggyJobTest &lt; ActiveJob::TestCase\n  def test_should_fail\n    at =  Time.new(&quot;1989-12-31T12:00:01&quot;)\n    wait_until = Time.new(&quot;1989-12-31T12:00:02&quot;)\n\n    assert_not_equal at, wait_until\n    assert_enqueued_with(job: BuggyJob, at:) do\n      BuggyJob.set(wait_until:).perform_later\n    end\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">BuggyJobTest</span> &lt; <span class=\"pl-v\">ActiveJob</span>::<span class=\"pl-v\">TestCase</span>\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">test_should_fail</span>\n    <span class=\"pl-s1\">at</span> <span class=\"pl-c1\">=</span>  <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"1989-12-31T12:00:01\"</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">wait_until</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"1989-12-31T12:00:02\"</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-en\">assert_not_equal</span> <span class=\"pl-s1\">at</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">wait_until</span>\n    <span class=\"pl-en\">assert_enqueued_with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">job</span>: <span class=\"pl-v\">BuggyJob</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">at</span>:<span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n      <span class=\"pl-v\">BuggyJob</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">set</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">wait_until</span>:<span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">perform_later</span>\n    <span class=\"pl-k\">end</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52479",
            "title": "Support second-level precision for `assert_enqueued_with`",
            "date_modified": "2024-08-01T15:17:31.000Z",
            "date_published": "2024-08-01T14:45:12.000Z",
            "author": {
                "name": "stevepolitodesign",
                "url": "https://github.com/stevepolitodesign"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/44102752?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2435788027\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52441\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52441/hovercard\" href=\"https://github.com/rails/rails/issues/52441\">#52441</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes</p>\n<ul dir=\"auto\">\n<li>caching with rails doc</li>\n<li>updated development.rb.tt</li>\n</ul>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52474",
            "title": "Update development mode  default caching docs",
            "date_modified": "2024-08-02T05:48:08.000Z",
            "date_published": "2024-08-01T07:01:14.000Z",
            "author": {
                "name": "nikhilbhatt",
                "url": "https://github.com/nikhilbhatt"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/44280450?u=5d0b7f0d7535c39131a9d2d513cbf4691236b6e4&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Now that running in containers is more common, <code class=\"notranslate\">Concurrent.available_processor_count</code> is more appropriate than <code class=\"notranslate\">Concurrent.processor_count</code>. However, we keep a fallback for situations where available_processor cannot be retrieved.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52468",
            "title": "Use `RAILS_MAX_THREADS` in `ActiveJob::AsyncAdapter`",
            "date_modified": "2024-08-02T02:51:15.000Z",
            "date_published": "2024-07-31T16:11:01.000Z",
            "author": {
                "name": "heka1024",
                "url": "https://github.com/heka1024"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2779422?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Note that the PostgreSQL DROP EXTENSION statement does not accept a schema name (see <a href=\"https://www.postgresql.org/docs/current/sql-dropextension.html\" rel=\"nofollow\">https://www.postgresql.org/docs/current/sql-dropextension.html</a>). Since we allow <code class=\"notranslate\">enable_extension</code> to be called with a schema-qualified name, this commit allows <code class=\"notranslate\">disable_extension</code> to be similarly called with a schema-qualified name, but the schema name is chopped off in the generated SQL statement.</p>\n<p dir=\"auto\">See <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2403936559\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52312\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52312/hovercard\" href=\"https://github.com/rails/rails/issues/52312\">#52312</a> for context.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52452",
            "title": "Allow disable_extension to be called with schema-qualified name",
            "date_modified": "2024-08-01T19:39:29.000Z",
            "date_published": "2024-07-30T15:53:48.000Z",
            "author": {
                "name": "afn",
                "url": "https://github.com/afn"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2779422?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This PR makes <code class=\"notranslate\">create_schema</code> / <code class=\"notranslate\">drop_schema</code> reversible in migrations. See <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2403936559\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52312\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52312/hovercard\" href=\"https://github.com/rails/rails/issues/52312\">#52312</a> for context.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52451",
            "title": "Make create_schema / drop_schema reversible in migrations",
            "date_modified": "2024-07-31T19:31:15.000Z",
            "date_published": "2024-07-30T15:40:58.000Z",
            "author": {
                "name": "afn",
                "url": "https://github.com/afn"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1417956?u=d703572179f5cf17f36a5b3e17a98b743a9f2cdd&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Our team uses symlinks to share certain logic between projects in our monorepo. However, the current glob in <code class=\"notranslate\">ActiveSupport::FileUpdateChecker</code> does not follow symlinked directories, so shared code does not reload in development.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\"><code class=\"notranslate\">FileUpdateChecker</code> uses the glob pattern <code class=\"notranslate\">**/*</code> to find watched files, but this pattern does not include symlinked directories in file structure like this</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"❯ tree .\n.\n├── app\n│   ├── app.rb\n│   └── shared -&gt; ../shared\n└── shared\n    ├── shared.rb\n    └── subshared\n        └── subshared.rb\"><pre class=\"notranslate\">❯ tree <span class=\"pl-c1\">.</span>\n<span class=\"pl-c1\">.</span>\n├── app\n│   ├── app.rb\n│   └── shared -<span class=\"pl-k\">&gt;</span> ../shared\n└── shared\n    ├── shared.rb\n    └── subshared\n        └── subshared.rb</pre></div>\n<p dir=\"auto\">I tryed several patterns and <code class=\"notranslate\">**{,/*/**}/*.rb</code> seems to be the only correct one</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"irb(main):001&gt; Dir[&quot;./app/**/*.rb&quot;]\n=&gt; [&quot;./app/app.rb&quot;]\nirb(main):002&gt; Dir[&quot;./app/***/*.rb&quot;]\n=&gt; [&quot;./app/shared/shared.rb&quot;]\nirb(main):003&gt; Dir[&quot;./app/**/*/**/*.rb&quot;]\n=&gt; [&quot;./app/shared/shared.rb&quot;, &quot;./app/shared/subshared/subshared.rb&quot;]\nirb(main):004&gt; Dir[&quot;./app/**{,/*/**}/*.rb&quot;]\n=&gt; [&quot;./app/app.rb&quot;, &quot;./app/shared/shared.rb&quot;, &quot;./app/shared/subshared/subshared.rb&quot;]\"><pre class=\"notranslate\"><span class=\"pl-en\">irb</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">main</span><span class=\"pl-kos\">)</span>:<span class=\"pl-c1\">001</span>&gt; <span class=\"pl-v\">Dir</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/**/*.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/app.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-en\">irb</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">main</span><span class=\"pl-kos\">)</span>:<span class=\"pl-c1\">002</span>&gt; <span class=\"pl-v\">Dir</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/***/*.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/shared/shared.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-en\">irb</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">main</span><span class=\"pl-kos\">)</span>:<span class=\"pl-c1\">003</span>&gt; <span class=\"pl-v\">Dir</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/**/*/**/*.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/shared/shared.rb\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"./app/shared/subshared/subshared.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-en\">irb</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">main</span><span class=\"pl-kos\">)</span>:<span class=\"pl-c1\">004</span>&gt; <span class=\"pl-v\">Dir</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/**{,/*/**}/*.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/app.rb\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"./app/shared/shared.rb\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"./app/shared/subshared/subshared.rb\"</span><span class=\"pl-kos\">]</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">The final glob was found in <a href=\"https://stackoverflow.com/a/2724048\" rel=\"nofollow\">https://stackoverflow.com/a/2724048</a> and is also used in the <a href=\"https://github.com/grosser/parallel_tests/blob/v4.7.1/lib/parallel_tests/test/runner.rb#L263\">parallel_tests</a> gem</p>\n<h3 dir=\"auto\">Checklist</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52450",
            "title": "ActiveSupport::FileUpdateChecker with symlink support",
            "date_modified": "2024-07-31T11:12:35.000Z",
            "date_published": "2024-07-30T11:03:56.000Z",
            "author": {
                "name": "michaelkhabarov",
                "url": "https://github.com/michaelkhabarov"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/131752?u=32ddf1119b1d189c9bd241a721b36ea01c29f61e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">We special case singleton methods being added to ActiveRecord::Base subclasses whose names match methods on Kernel so that we can eagerly define them on the ClassSpecificRelation as otherwise we'd never hit method_missing.</p>\n<p dir=\"auto\">Previously, this would also eagerly define methods which were on the Kernel Module's singleton class rather than being defined as instance methods inside the module, which created quite a few unnecessary methods.</p>\n<p dir=\"auto\">Most notably this hit \"name\" which is defined on the anonymous HABTM classes. I think that case is worth fixing twice (it's an common error involving a complex interaction, that might only be foudn through luck) so the second commit here explicitly delegates <code class=\"notranslate\">name</code>. Either commit solves the <code class=\"notranslate\">name</code> issue (which I think is the only case I've seen this in the wild)</p>",
            "url": "https://github.com/rails/rails/pull/52449",
            "title": "Avoid eagerly generating Module methods on ActiveRecord::Relation delegation",
            "date_modified": "2024-07-30T21:38:20.000Z",
            "date_published": "2024-07-30T07:12:03.000Z",
            "author": {
                "name": "jhawthorn",
                "url": "https://github.com/jhawthorn"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/4289625?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because the current querying guide has no entries for CTE and the link to <code class=\"notranslate\">with</code> method.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds the entry for CTE.</p>\n<p dir=\"auto\">Note that this PR is a retry of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1942777044\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49630\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49630/hovercard\" href=\"https://github.com/rails/rails/pull/49630\">#49630</a>, including the following updates:</p>\n<ul dir=\"auto\">\n<li>Changed the code examples from <code class=\"notranslate\">Post</code> and <code class=\"notranslate\">Comment</code> models to <code class=\"notranslate\">Book</code> and <code class=\"notranslate\">Review</code> to be consistent with <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"623747852\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/39406\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/39406/hovercard\" href=\"https://github.com/rails/rails/pull/39406\">#39406</a></li>\n<li>Added the minimum version of SQLite to work with CTE</li>\n<li>Revised some English sentences with a little help of Claude 3.5 Sonnet</li>\n</ul>\n<p dir=\"auto\">The SQL queries in this PR were actually generated using a local Rails application running Rails 7.1.3.4 and Ruby 3.3.4.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/zzak/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zzak\">@zzak</a></p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">ref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"536810238\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/37944\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/37944/hovercard\" href=\"https://github.com/rails/rails/pull/37944\">#37944</a><br>\nref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1512256975\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/46843\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/46843/hovercard\" href=\"https://github.com/rails/rails/pull/46843\">#46843</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52423",
            "title": "[ci-skip][Docs][retry] Add description for CTE to querying guide",
            "date_modified": "2024-07-27T22:53:25.000Z",
            "date_published": "2024-07-26T05:34:11.000Z",
            "author": {
                "name": "hachi8833",
                "url": "https://github.com/hachi8833"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/19589006?u=4625e661fdb3256af0ed316629196771b9ee0c11&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because I wanted to have a Svelte store compatible way to monitor a channel, and create a clean interface to subscribe callbacks to a channel.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the Action Cable client <code class=\"notranslate\">Subscription</code> to add a <code class=\"notranslate\">.observer(parser = String)</code> accessor to create or find a <code class=\"notranslate\">SubscriptionObserver</code> which allows for subscribing callback functions to new data. The value in the <code class=\"notranslate\">SubscriptionObserver</code> gets replaced with each new packet.</p>\n<p dir=\"auto\">Here's a code example:</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"const observer = consumer.subscriptions.create({ channel: &quot;ExampleChannel&quot; }).observer(JSON.parse)\nconst unsubscribe = observer.subscribe((data) =&gt; console.log(data))\n\nsetTimeout(unsubscribe, 5000)\"><pre class=\"notranslate\"><span class=\"pl-k\">const</span> <span class=\"pl-s1\">observer</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">consumer</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">subscriptions</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span> <span class=\"pl-c1\">channel</span>: <span class=\"pl-s\">\"ExampleChannel\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">observer</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">JSON</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">parse</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">unsubscribe</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">observer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">subscribe</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">data</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">data</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-en\">setTimeout</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">unsubscribe</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">5000</span><span class=\"pl-kos\">)</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">This is fully compatible with <a href=\"https://svelte.dev/docs/svelte-components#script-4-prefix-stores-with-$-to-access-their-values\" rel=\"nofollow\">Svelte Stores</a>.</p>\n<p dir=\"auto\">A lot of inspiration was also taken from the <a href=\"https://rxjs.dev/guide/observable\" rel=\"nofollow\">RxJS Observable</a>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52411",
            "title": "Action Cable: Create `SubscriptionObserver` to facilitate callbacks for channel data",
            "date_modified": "2024-07-24T14:18:07.000Z",
            "date_published": "2024-07-24T14:17:37.000Z",
            "author": {
                "name": "reesericci",
                "url": "https://github.com/reesericci"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/987638?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">We remove files under the public directory for API-only Applications. </p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/a17aa6376d7974e38af90a2fe28e548b201baa63/railties/lib/rails/generators/rails/app/app_generator.rb#L500-L509\">rails/railties/lib/rails/generators/rails/app/app_generator.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 500 to 509\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/a17aa6376d7974e38af90a2fe28e548b201baa63\">a17aa63</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L500\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"500\"></td>\n          <td id=\"LC500\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">delete_public_files_if_api_option</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L501\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"501\"></td>\n          <td id=\"LC501\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">if</span> <span class=\"pl-en\">options</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:api</span><span class=\"pl-kos\">]</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L502\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"502\"></td>\n          <td id=\"LC502\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/404.html\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L503\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"503\"></td>\n          <td id=\"LC503\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/406-unsupported-browser.html\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L504\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"504\"></td>\n          <td id=\"LC504\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/422.html\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L505\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"505\"></td>\n          <td id=\"LC505\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/500.html\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L506\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"506\"></td>\n          <td id=\"LC506\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/icon.png\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L507\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"507\"></td>\n          <td id=\"LC507\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/icon.svg\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L508\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"508\"></td>\n          <td id=\"LC508\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L509\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"509\"></td>\n          <td id=\"LC509\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\">We should keep the behavior in <code class=\"notranslate\">app:update</code> command too.</p>\n<p dir=\"auto\">Follow up of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2325982279\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51952\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51952/hovercard\" href=\"https://github.com/rails/rails/pull/51952\">#51952</a>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52403",
            "title": "Don't update public directory during `app:update` command for API-only Applications",
            "date_modified": "2024-07-28T03:26:54.000Z",
            "date_published": "2024-07-23T05:51:28.000Z",
            "author": {
                "name": "y-yagi",
                "url": "https://github.com/y-yagi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/509837?u=697e4a265d5359363a5d57a24b07f9a79cb0b08a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Small enhancement to <a href=\"https://github.com/rails/rails/pull/50977\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50977/hovercard\">this awesome PR</a>, cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/Ridhwana/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/Ridhwana\">@Ridhwana</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/carlosantoniodasilva/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/carlosantoniodasilva\">@carlosantoniodasilva</a></p>\n<ul dir=\"auto\">\n<li>Tidied up some of the wording around how Active Storage works with Action Text.</li>\n<li>Added a warning about <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2347254602\" data-permission-text=\"Title is private\" data-url=\"https://github.com/basecamp/trix/issues/1159\" data-hovercard-type=\"issue\" data-hovercard-url=\"/basecamp/trix/issues/1159/hovercard\" href=\"https://github.com/basecamp/trix/issues/1159\">basecamp/trix#1159</a></li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52398",
            "title": "Update Action Text + Active Storage docs",
            "date_modified": "2024-07-29T06:33:30.000Z",
            "date_published": "2024-07-23T00:54:56.000Z",
            "author": {
                "name": "ghiculescu",
                "url": "https://github.com/ghiculescu"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/522155?u=2e71ed2ab56545207a94b885fafc434ee7350cf1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This PR is an alternative to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2378385100\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52228\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52228/hovercard\" href=\"https://github.com/rails/rails/pull/52228\">#52228</a>, exploring <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a>'s idea of a separate method from <code class=\"notranslate\">insert_all</code>. That way, the interface of <code class=\"notranslate\">insert_all</code> does not become too crowded.</p>\n<h2 dir=\"auto\">Background</h2>\n<p dir=\"auto\">We have some performance-critical endpoints where we want to allocate least # of objects and use <code class=\"notranslate\">insert_all</code> to write 1000s of rows into the database.</p>\n<p dir=\"auto\">However, we see <code class=\"notranslate\">insert_all</code> being ~2.5x slower compared to manually building <code class=\"notranslate\">INSERT INTO &lt;table&gt; VALUES (...), (...)</code>.</p>\n<p dir=\"auto\">I've been profiling <code class=\"notranslate\">insert_all</code> and that turned out to be largely because it 1) works with arrays of hashes and each hash needs to be traversed 2) it serializes attributes via Attributes API.</p>\n<p dir=\"auto\">That's great default behavior but if we're inserting 2000 tuples of <code class=\"notranslate\">(&lt;foreigh-key&gt;, &lt;foreigh-key&gt;, &lt;foreigh-key&gt;)</code>, we don't want to traverse hashes and run the complexity of casting integers to integers via Attributes API.</p>\n<p dir=\"auto\">I'd like to propose a \"column mode\" for inserting rows that takes arrays of arrays (no need to traverse hashes!) and makes attribute casting is the responsibility of the caller.</p>\n<p dir=\"auto\">With that approach, we're able to make <code class=\"notranslate\">insert_rows</code> as fast as direct string building:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ruby 3.3.1 (2024-04-23 revision c56cd86388) [arm64-darwin23]\nWarming up --------------------------------------\n          insert_all     4.000 i/100ms\ninsert_all with columns\n                        11.000 i/100ms\n             raw sql    13.000 i/100ms\n           with Arel    12.000 i/100ms\nCalculating -------------------------------------\n          insert_all     41.522 (± 7.2%) i/s -    168.000 in   4.066766s\ninsert_all with columns\n                         86.048 (±23.2%) i/s -    341.000 in   4.161382s\n             raw sql    114.595 (±14.0%) i/s -    455.000 in   4.055053s\n           with Arel    100.232 (±23.9%) i/s -    384.000 in   4.084465s\n\nComparison:\n             raw sql:      114.6 i/s\n           with Arel:      100.2 i/s - same-ish: difference falls within error\ninsert_all with columns:       86.0 i/s - same-ish: difference falls within error\n          insert_all:       41.5 i/s - 2.76x  slower\"><pre class=\"notranslate\"><code class=\"notranslate\">ruby 3.3.1 (2024-04-23 revision c56cd86388) [arm64-darwin23]\nWarming up --------------------------------------\n          insert_all     4.000 i/100ms\ninsert_all with columns\n                        11.000 i/100ms\n             raw sql    13.000 i/100ms\n           with Arel    12.000 i/100ms\nCalculating -------------------------------------\n          insert_all     41.522 (± 7.2%) i/s -    168.000 in   4.066766s\ninsert_all with columns\n                         86.048 (±23.2%) i/s -    341.000 in   4.161382s\n             raw sql    114.595 (±14.0%) i/s -    455.000 in   4.055053s\n           with Arel    100.232 (±23.9%) i/s -    384.000 in   4.084465s\n\nComparison:\n             raw sql:      114.6 i/s\n           with Arel:      100.2 i/s - same-ish: difference falls within error\ninsert_all with columns:       86.0 i/s - same-ish: difference falls within error\n          insert_all:       41.5 i/s - 2.76x  slower\n</code></pre></div>\n<details><summary>Benchmark code</summary>\n<p dir=\"auto\">\n</p><div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# frozen_string_literal: true\n\nrequire 'debug'\nrequire &quot;active_record&quot;\nrequire &quot;benchmark/ips&quot;\n\nGC.disable\n\nROWS_COUNT = 1000\n\nActiveRecord::Base.establish_connection({ adapter: &quot;sqlite3&quot;, database: &quot;:memory:&quot; })\n\nclass Commerce &lt; ActiveRecord::Base\n  connection.create_table :commerces, force: true do |t|\n    t.string :name, :email, :title, :tags\n    t.integer :variant_id, :product_id, :inventory_id, :something_id, :another_id\n    t.boolean :fulfilled\n    t.datetime :fulfilled_at, :deleted_at\n    t.timestamps null: true\n  end\nend\n\ndef db_time(value)\n  value.to_formatted_s(:db).inspect\nend\n\nATTRS = {\n  name: &quot;sam&quot;,\n  email: &quot;kirs@shopify.com&quot;,\n  title: &quot;title&quot;,\n  tags: &quot;tag1,tag2,tag3&quot;,\n  variant_id: 1,\n  product_id: 1,\n  inventory_id: 1,\n  something_id: 1,\n  another_id: 1,\n  fulfilled: true,\n  fulfilled_at: Time.now,\n  deleted_at: Time.now\n}\n\nBenchmark.ips do |x|\n  x.warmup = 2\n  x.time   = 4\n\n  relation = Commerce.all\n\n  x.report(&quot;insert_all&quot;) do\n    conn = Commerce.connection\n\n    relation.insert_all(\n      [ATTRS] * ROWS_COUNT\n    )\n  end\n\n  x.report(&quot;insert_all with columns&quot;) do\n    conn = Commerce.connection\n    attrs = ATTRS.dup\n    attrs[:fulfilled_at] = attrs[:fulfilled_at].to_formatted_s(:db)\n    attrs[:deleted_at] = attrs[:deleted_at].to_formatted_s(:db)\n    attrs[:created_at] = Time.now.to_formatted_s(:db)\n    attrs[:updated_at] = attrs[:created_at]\n\n    values = [\n      attrs[:name], attrs[:email], attrs[:title], attrs[:tags], attrs[:variant_id], attrs[:product_id], attrs[:inventory_id], attrs[:something_id], attrs[:another_id], attrs[:fulfilled], attrs[:fulfilled_at], attrs[:deleted_at], attrs[:created_at], attrs[:updated_at]\n    ]\n\n    relation.insert_all(\n      [values] * ROWS_COUNT,\n      columns: %w[name email title tags variant_id product_id inventory_id something_id another_id fulfilled fulfilled_at deleted_at created_at updated_at],\n    )\n  end\n\n  x.report(&quot;raw sql&quot;) do\n    conn = Commerce.connection\n    values = (1..ROWS_COUNT).map do\n      attrs = ATTRS\n      &quot;(#{conn.quote(attrs[:name])}, #{conn.quote(attrs[:email])}, #{conn.quote(attrs[:title])}, #{conn.quote(attrs[:tags])}, #{attrs[:variant_id]}, #{attrs[:product_id]}, #{attrs[:inventory_id]}, #{attrs[:something_id]}, #{attrs[:another_id]}, #{attrs[:fulfilled]}, #{db_time(attrs[:fulfilled_at])}, #{db_time(attrs[:deleted_at])}, #{db_time(Time.now)}, #{db_time(Time.now)})&quot;\n    end\n\n    conn.execute(\n      &quot;INSERT INTO commerces (name, email, title, tags, variant_id, product_id, inventory_id, something_id, another_id, fulfilled, fulfilled_at, deleted_at, created_at, updated_at) &quot;\\\n      &quot;VALUES #{values.join(',')}&quot;\n    )\n  end\n\n  x.report(&quot;with Arel&quot;) do\n    conn = Commerce.connection\n    columns = %w[name email title tags variant_id product_id inventory_id something_id another_id fulfilled fulfilled_at deleted_at created_at updated_at]\n    attrs = ATTRS.dup\n    attrs[:fulfilled_at] = (attrs[:fulfilled_at]).to_formatted_s(:db)\n    attrs[:deleted_at] = (attrs[:deleted_at]).to_formatted_s(:db)\n    attrs[:created_at] = (Time.now).to_formatted_s(:db)\n    attrs[:updated_at] = (Time.now).to_formatted_s(:db)\n\n    values_list = [attrs.values] * ROWS_COUNT\n\n    sql = &quot;INSERT INTO #{Commerce.quoted_table_name} (#{columns.join(',')}) &quot;\n    sql &lt;&lt; conn.visitor.compile(Arel::Nodes::ValuesList.new(values_list))\n    conn.execute(sql)\n  end\n\n  x.compare!\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># frozen_string_literal: true</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'debug'</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"active_record\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"benchmark/ips\"</span>\n\n<span class=\"pl-c1\">GC</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">disable</span>\n\n<span class=\"pl-c1\">ROWS_COUNT</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">1000</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">establish_connection</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-s\">\"sqlite3\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">database</span>: <span class=\"pl-s\">\":memory:\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Commerce</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:commerces</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-c1\">true</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:email</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:title</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:tags</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">integer</span> <span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:another_id</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">boolean</span> <span class=\"pl-pds\">:fulfilled</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">datetime</span> <span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:deleted_at</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">timestamps</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">true</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">value</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">inspect</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-c1\">ATTRS</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"sam\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">email</span>: <span class=\"pl-s\">\"kirs@shopify.com\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">title</span>: <span class=\"pl-s\">\"title\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">tags</span>: <span class=\"pl-s\">\"tag1,tag2,tag3\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">variant_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">product_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">inventory_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">something_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">another_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">fulfilled</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">fulfilled_at</span>: <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">deleted_at</span>: <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-v\">Benchmark</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">ips</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">x</span>|\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">warmup</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">2</span>\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">time</span>   <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">4</span>\n\n  <span class=\"pl-s1\">relation</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"insert_all\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n\n    <span class=\"pl-s1\">relation</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">insert_all</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-kos\">[</span><span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"insert_all with columns\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">dup</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span>\n\n    <span class=\"pl-s1\">values</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span>\n      <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:email</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:tags</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:another_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-kos\">]</span>\n\n    <span class=\"pl-s1\">relation</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">insert_all</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-kos\">[</span><span class=\"pl-s1\">values</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">columns</span>: <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">name</span> <span class=\"pl-s\">email</span> <span class=\"pl-s\">title</span> <span class=\"pl-s\">tags</span> <span class=\"pl-s\">variant_id</span> <span class=\"pl-s\">product_id</span> <span class=\"pl-s\">inventory_id</span> <span class=\"pl-s\">something_id</span> <span class=\"pl-s\">another_id</span> <span class=\"pl-s\">fulfilled</span> <span class=\"pl-s\">fulfilled_at</span> <span class=\"pl-s\">deleted_at</span> <span class=\"pl-s\">created_at</span> <span class=\"pl-s\">updated_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"raw sql\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">values</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-c1\">ROWS_COUNT</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">map</span> <span class=\"pl-k\">do</span>\n      <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span>\n      <span class=\"pl-s\">\"(<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:email</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:tags</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:another_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>)\"</span>\n    <span class=\"pl-k\">end</span>\n\n    <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-s\">\"INSERT INTO commerces (name, email, title, tags, variant_id, product_id, inventory_id, something_id, another_id, fulfilled, fulfilled_at, deleted_at, created_at, updated_at) \"</span>\\\n      <span class=\"pl-s\">\"VALUES <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">values</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">','</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>\"</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"with Arel\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">columns</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">name</span> <span class=\"pl-s\">email</span> <span class=\"pl-s\">title</span> <span class=\"pl-s\">tags</span> <span class=\"pl-s\">variant_id</span> <span class=\"pl-s\">product_id</span> <span class=\"pl-s\">inventory_id</span> <span class=\"pl-s\">something_id</span> <span class=\"pl-s\">another_id</span> <span class=\"pl-s\">fulfilled</span> <span class=\"pl-s\">fulfilled_at</span> <span class=\"pl-s\">deleted_at</span> <span class=\"pl-s\">created_at</span> <span class=\"pl-s\">updated_at</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">dup</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-s1\">values_list</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">values</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span>\n\n    <span class=\"pl-s1\">sql</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"INSERT INTO <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quoted_table_name</span><span class=\"pl-kos\">}</span></span> (<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">columns</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">','</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>) \"</span>\n    <span class=\"pl-s1\">sql</span> &lt;&lt; <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">visitor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">compile</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Arel</span>::<span class=\"pl-v\">Nodes</span>::<span class=\"pl-v\">ValuesList</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">values_list</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">sql</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">compare!</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\"></p>\n</details> ",
            "url": "https://github.com/rails/rails/pull/52395",
            "title": "Introduce ActiveRecord::Persistance#insert_rows",
            "date_modified": "2024-07-30T07:53:31.000Z",
            "date_published": "2024-07-22T23:36:45.000Z",
            "author": {
                "name": "kirs",
                "url": "https://github.com/kirs"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/509837?u=697e4a265d5359363a5d57a24b07f9a79cb0b08a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">When trying to implement it, I found <a href=\"https://edgeguides.rubyonrails.org/active_storage_overview.html#authenticated-controllers\" rel=\"nofollow\">this guide</a> hard to understand.</p>\n<p dir=\"auto\">This PR expands the example and gives a more options for how to move beyond the default security options in AS.</p>",
            "url": "https://github.com/rails/rails/pull/52388",
            "title": "Improve the Active Storage \"Authenticated Controllers\" guide",
            "date_modified": "2024-07-29T06:33:17.000Z",
            "date_published": "2024-07-22T04:37:43.000Z",
            "author": {
                "name": "ghiculescu",
                "url": "https://github.com/ghiculescu"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7331511?u=e5c461c2ed59b967e0925a515ab00b9a756715e3&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because the tests under the commands directory are including the Command namespace<br>\nbut this specific test is not and can create confusion for the developers.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the test to include the Command namespace.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52387",
            "title": "Add command namespace to runner test",
            "date_modified": "2024-07-22T04:39:34.000Z",
            "date_published": "2024-07-22T04:36:03.000Z",
            "author": {
                "name": "JuanVqz",
                "url": "https://github.com/JuanVqz"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/191128?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When resolving the adapter. for a url that is missing the schema (for example <code class=\"notranslate\">//root@localhost:3306/database_name</code>) the adapter resolution currently errors with <code class=\"notranslate\">NoMethodError: undefined method </code>to_sym' for nil<code class=\"notranslate\">when calling</code>ActiveRecord.protocol_adapters[]`.</p>\n<p dir=\"auto\">I am currently using such urls to allow for the adapter to be set by the application in the database.yml instead of the ENV vars which are managed externally to the application.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request prevents this error from being raised when resolving the adapter.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included. (This error is only occurring in beta releases, so I don't think a change log is required).</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52386",
            "title": "handle database urls that are missing schemas",
            "date_modified": "2024-08-01T01:33:25.000Z",
            "date_published": "2024-07-22T02:06:59.000Z",
            "author": {
                "name": "lsylvester",
                "url": "https://github.com/lsylvester"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">When tried to write tests in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2421635675\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52384\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52384/hovercard\" href=\"https://github.com/rails/rails/pull/52384\">#52384</a>, I noticed that records within individual batches are not sorted, which is a bug imo.</p>",
            "url": "https://github.com/rails/rails/pull/52385",
            "title": "Preserve order within individual batches for batch iteration",
            "date_modified": "2024-07-29T22:16:45.000Z",
            "date_published": "2024-07-21T23:43:11.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7427365?u=67ed8ab4a2204734e6d97e9ebbe4a963512a0fda&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Normalizes email_address before saving it to the DB.</p>",
            "url": "https://github.com/rails/rails/pull/52379",
            "title": "Session generator: Normalize email_address",
            "date_modified": "2024-07-29T14:17:46.000Z",
            "date_published": "2024-07-21T11:10:47.000Z",
            "author": {
                "name": "dixpac",
                "url": "https://github.com/dixpac"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Currently, <code class=\"notranslate\">error_on_ignore</code> option is not passed to the <code class=\"notranslate\">BatchEnumerator</code>. And when we iterate using it (via something like <code class=\"notranslate\">Post.in_batches(error_on_ignore: true).delete_all</code>) it is lost.<br>\nSo we need to check for the option presence before we return the <code class=\"notranslate\">BatchEnumerator</code> instance.</p>",
            "url": "https://github.com/rails/rails/pull/52378",
            "title": "Fix swallowing ignore order warning when batching using `BatchEnumerator`",
            "date_modified": "2024-07-29T22:12:36.000Z",
            "date_published": "2024-07-21T09:20:21.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22004610?u=8b285b31d33b20555541d5dda4c5ed77477eea3b&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because it does not feel friendly that the name of the class is mentioned in one of error messages, while its documentation is rendered private.</p>\n<p dir=\"auto\">Also edit the error message in order to navigate those who read first to the higher-level module, <code class=\"notranslate\">ActiveStorage::SetCurrent</code>.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52219.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2374293077\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52219\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52219/hovercard\" href=\"https://github.com/rails/rails/issues/52219\">#52219</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes three interrelated things:</p>\n<ol dir=\"auto\">\n<li>Document <code class=\"notranslate\">ActiveStorage::Current</code> from scratch</li>\n<li>Link the documentation of <code class=\"notranslate\">ActiveStorage::SetCurrent</code> to <code class=\"notranslate\">ActiveStorage::Current</code></li>\n<li>Change error message so it points to the wrapper module <code class=\"notranslate\">ActiveStorage::SetCurrent</code> rather than the underlying <code class=\"notranslate\">ActiveStorage::Current</code></li>\n</ol>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">My team and I could just use <code class=\"notranslate\">ActiveStorage::SetCurrent</code> to solve our problem when I created the issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2374293077\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52219\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52219/hovercard\" href=\"https://github.com/rails/rails/issues/52219\">#52219</a>. It is my imagination that there should be a case where <code class=\"notranslate\">ActiveStorage::SetCurrent</code> is not available to use, perhaps because url generation takes place in the background process or something. That's why I mentioned the case in the change but without a concrete solution.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52377",
            "title": "Document `ActiveStorage::Current`",
            "date_modified": "2024-07-25T17:00:14.000Z",
            "date_published": "2024-07-21T03:59:53.000Z",
            "author": {
                "name": "sato11",
                "url": "https://github.com/sato11"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22004610?u=8b285b31d33b20555541d5dda4c5ed77477eea3b&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because <code class=\"notranslate\">config.active_storage.replace_on_assign_to_many</code> has been removed at <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/b06252e2a7fa489782099653f7ddcecc5b07745c/hovercard\" href=\"https://github.com/rails/rails/commit/b06252e2a7fa489782099653f7ddcecc5b07745c\"><tt>b06252e</tt></a> and <code class=\"notranslate\">config.active_storage.silence_invalid_content_types_warning</code> at <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/0cf8444d614747e6a6257ec5ddb700934ebfec07/hovercard\" href=\"https://github.com/rails/rails/commit/0cf8444d614747e6a6257ec5ddb700934ebfec07\"><tt>0cf8444</tt></a>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">This is a follow-up to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1942177428\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49624\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49624/hovercard\" href=\"https://github.com/rails/rails/pull/49624\">#49624</a>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52376",
            "title": "Remove ActiveStorage's deprecated configs",
            "date_modified": "2024-07-24T01:02:25.000Z",
            "date_published": "2024-07-21T01:20:53.000Z",
            "author": {
                "name": "sato11",
                "url": "https://github.com/sato11"
            }
        }
    ]
}