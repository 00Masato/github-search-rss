{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/13675895?u=fd697659c1bd2fcda1d6d1426ba94bfd5bd1e0e3&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because there is no info about <code class=\"notranslate\">index_errors</code> in docs now.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds a missing <code class=\"notranslate\">+</code> for the <code class=\"notranslate\">index_errors</code> section.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52500",
            "title": "Show `index_errors` in docs",
            "date_modified": "2024-08-03T15:25:01.000Z",
            "date_published": "2024-08-03T15:24:57.000Z",
            "author": {
                "name": "GarrisonD",
                "url": "https://github.com/GarrisonD"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/706220?u=5d1df33ffca934dd9c1e9042df87131a348da6c4&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This PR adds a SAX-based parser with REXML as with other XmlMini.</p>\n<p dir=\"auto\">Use cases: Provide faster parsing than REXML(DOM) in situations where libxml-ruby or nokogiri is not available.</p>\n\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request requires the latest REXML 3.3.4 or higher to pass the XMLMiniEngineTest::EngineTests.test_exception_thrown_on_expansion_attack test.</p>\n<p dir=\"auto\">See: <a href=\"https://www.ruby-lang.org/en/news/2024/08/01/dos-rexml-cve-2024-41946/\" rel=\"nofollow\">https://www.ruby-lang.org/en/news/2024/08/01/dos-rexml-cve-2024-41946/</a></p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<ul dir=\"auto\">\n<li>sax_bench.yaml</li>\n</ul>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"loop_count: 100\ncontexts:\n  - name: YJIT=OFF\n  - name: YJIT=ON\n    prelude: |\n      RubyVM::YJIT.enable\n\nprelude: |\n  $LOAD_PATH.unshift(File.expand_path(&quot;activesupport/lib&quot;))\n  require 'active_support'\n  require 'active_support/core_ext'\n\n  n_elements = 5000\n  n_attributes = 10\n\n  def build_xml(n_elements, n_attributes)\n    xml = '&lt;?xml version=&quot;1.0&quot;?&gt;&lt;root&gt;'\n    n_elements.times do |i|\n      xml &lt;&lt; '&lt;child '\n      n_attributes.times {|j| xml &lt;&lt; &quot;id#{j}=\\&quot;#{i}\\&quot; &quot; }\n      xml &lt;&lt; '/&gt;'\n    end\n    xml &lt;&lt; '&lt;/root&gt;'\n  end\n  xml = build_xml(n_elements, n_attributes)\n\nbenchmark:\n  'LibXML'       : |\n    ActiveSupport::XmlMini.backend = 'LibXML'\n    hash = Hash.from_xml(xml)\n  'LibXMLSAX'       : |\n    ActiveSupport::XmlMini.backend = 'LibXMLSAX'\n    hash = Hash.from_xml(xml)\n  'Nokogiri'       : |\n    ActiveSupport::XmlMini.backend = 'Nokogiri'\n    hash = Hash.from_xml(xml)\n  'NokogiriSAX'       : |\n    ActiveSupport::XmlMini.backend = 'NokogiriSAX'\n    hash = Hash.from_xml(xml)\n  'REXML'       : |\n    ActiveSupport::XmlMini.backend = 'REXML'\n    hash = Hash.from_xml(xml)\n  'REXMLSAX'       : |\n    ActiveSupport::XmlMini.backend = 'REXMLSAX'\n    hash = Hash.from_xml(xml)\"><pre class=\"notranslate\"><code class=\"notranslate\">loop_count: 100\ncontexts:\n  - name: YJIT=OFF\n  - name: YJIT=ON\n    prelude: |\n      RubyVM::YJIT.enable\n\nprelude: |\n  $LOAD_PATH.unshift(File.expand_path(\"activesupport/lib\"))\n  require 'active_support'\n  require 'active_support/core_ext'\n\n  n_elements = 5000\n  n_attributes = 10\n\n  def build_xml(n_elements, n_attributes)\n    xml = '&lt;?xml version=\"1.0\"?&gt;&lt;root&gt;'\n    n_elements.times do |i|\n      xml &lt;&lt; '&lt;child '\n      n_attributes.times {|j| xml &lt;&lt; \"id#{j}=\\\"#{i}\\\" \" }\n      xml &lt;&lt; '/&gt;'\n    end\n    xml &lt;&lt; '&lt;/root&gt;'\n  end\n  xml = build_xml(n_elements, n_attributes)\n\nbenchmark:\n  'LibXML'       : |\n    ActiveSupport::XmlMini.backend = 'LibXML'\n    hash = Hash.from_xml(xml)\n  'LibXMLSAX'       : |\n    ActiveSupport::XmlMini.backend = 'LibXMLSAX'\n    hash = Hash.from_xml(xml)\n  'Nokogiri'       : |\n    ActiveSupport::XmlMini.backend = 'Nokogiri'\n    hash = Hash.from_xml(xml)\n  'NokogiriSAX'       : |\n    ActiveSupport::XmlMini.backend = 'NokogiriSAX'\n    hash = Hash.from_xml(xml)\n  'REXML'       : |\n    ActiveSupport::XmlMini.backend = 'REXML'\n    hash = Hash.from_xml(xml)\n  'REXMLSAX'       : |\n    ActiveSupport::XmlMini.backend = 'REXMLSAX'\n    hash = Hash.from_xml(xml)\n</code></pre></div>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ ruby -v\nruby 3.3.3 (2024-06-12 revision f1c7b6f435) [arm64-darwin22]\n$ gem list rexml libxml-ruby nokogiri\n\n*** LOCAL GEMS ***\n\nrexml (3.3.4)\n\n*** LOCAL GEMS ***\n\nlibxml-ruby (5.0.3)\n\n*** LOCAL GEMS ***\n\nnokogiri (1.16.7 arm64-darwin, 1.16.6 arm64-darwin, 1.16.5)\"><pre class=\"notranslate\"><code class=\"notranslate\">$ ruby -v\nruby 3.3.3 (2024-06-12 revision f1c7b6f435) [arm64-darwin22]\n$ gem list rexml libxml-ruby nokogiri\n\n*** LOCAL GEMS ***\n\nrexml (3.3.4)\n\n*** LOCAL GEMS ***\n\nlibxml-ruby (5.0.3)\n\n*** LOCAL GEMS ***\n\nnokogiri (1.16.7 arm64-darwin, 1.16.6 arm64-darwin, 1.16.5)\n</code></pre></div>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ benchmark-driver sax_bench.yaml\nCalculating -------------------------------------\n                       YJIT=OFF     YJIT=ON \n              LibXML     16.818      19.854 i/s -     100.000 times in 5.946048s 5.036691s\n           LibXMLSAX     18.235      23.218 i/s -     100.000 times in 5.483908s 4.306973s\n            Nokogiri     16.512      16.512 i/s -     100.000 times in 6.056280s 6.056372s\n         NokogiriSAX     13.469      15.905 i/s -     100.000 times in 7.424489s 6.287452s\n               REXML      3.341       5.426 i/s -     100.000 times in 29.928804s 18.428204s\n            REXMLSAX      4.390       6.301 i/s -     100.000 times in 22.777792s 15.869573s\"><pre class=\"notranslate\"><code class=\"notranslate\">$ benchmark-driver sax_bench.yaml\nCalculating -------------------------------------\n                       YJIT=OFF     YJIT=ON \n              LibXML     16.818      19.854 i/s -     100.000 times in 5.946048s 5.036691s\n           LibXMLSAX     18.235      23.218 i/s -     100.000 times in 5.483908s 4.306973s\n            Nokogiri     16.512      16.512 i/s -     100.000 times in 6.056280s 6.056372s\n         NokogiriSAX     13.469      15.905 i/s -     100.000 times in 7.424489s 6.287452s\n               REXML      3.341       5.426 i/s -     100.000 times in 29.928804s 18.428204s\n            REXMLSAX      4.390       6.301 i/s -     100.000 times in 22.777792s 15.869573s\n</code></pre></div>\n<ul dir=\"auto\">\n<li>YJIT=OFF : REXMLSAX is 1.31x  faster than REXML(DOM)</li>\n<li>YJIT=ON  : REXMLSAX is 1.16x  faster than REXML(DOM)</li>\n</ul>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52498",
            "title": "feature: Add SAX-based parser for XmlMini, using REXML",
            "date_modified": "2024-08-03T07:02:25.000Z",
            "date_published": "2024-08-03T07:02:20.000Z",
            "author": {
                "name": "naitoh",
                "url": "https://github.com/naitoh"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/99586?u=b4abd791d83e768c72cb832147b4a210caecf47d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>",
            "url": "https://github.com/rails/rails/pull/52497",
            "title": "Add a section about running tests by line range in contribution guide",
            "date_modified": "2024-08-03T03:33:17.000Z",
            "date_published": "2024-08-03T03:33:13.000Z",
            "author": {
                "name": "shouichi",
                "url": "https://github.com/shouichi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/81788481?u=ef236268111a50ec7269e837040fd86dcd872b2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">As you know, Windows OS filename convention has a list of special characters that are not allowed:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"&lt; (less than)\n&gt; (greater than)\n: (colon)\n&quot; (double quote)\n/ (forward slash)\n\\ (backslash)\n| (vertical bar or pipe)\n? (question mark)\n* (asterisk)\"><pre class=\"notranslate\"><code class=\"notranslate\">&lt; (less than)\n&gt; (greater than)\n: (colon)\n\" (double quote)\n/ (forward slash)\n\\ (backslash)\n| (vertical bar or pipe)\n? (question mark)\n* (asterisk)\n</code></pre></div>\n<p dir=\"auto\">References: <a href=\"https://learn.microsoft.com/en-us/windows/win32/fileio/naming-a-file#naming-conventions\" rel=\"nofollow\">https://learn.microsoft.com/en-us/windows/win32/fileio/naming-a-file#naming-conventions</a></p>\n\n<p dir=\"auto\">This pull request was created to add the characters <code class=\"notranslate\">\", &lt;, &gt;, ?, *</code> to the list of Filename sanitization needs</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes <code class=\"notranslate\">ActiveStorage::Filename#sanitized</code>:</p>\n<ul dir=\"auto\">\n<li>Current:</li>\n</ul>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"tr(&quot;\\u{202E}%$|:;/\\t\\r\\n\\\\&quot;, &quot;-&quot;)\"><pre class=\"notranslate\"><code class=\"notranslate\">tr(\"\\u{202E}%$|:;/\\t\\r\\n\\\\\", \"-\")\n</code></pre></div>\n<ul dir=\"auto\">\n<li>ToBe</li>\n</ul>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"tr(&quot;\\u{202E}%$|:;/&lt;&gt;?*\\&quot;\\t\\r\\n\\\\&quot;, &quot;-&quot;)\"><pre class=\"notranslate\"><code class=\"notranslate\">tr(\"\\u{202E}%$|:;/&lt;&gt;?*\\\"\\t\\r\\n\\\\\", \"-\")\n</code></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52496",
            "title": "Added new unsafe characters of Windows filename `\", <, >, ?, *` to `ActiveStorage::Filename#sanitized`",
            "date_modified": "2024-08-03T03:40:35.000Z",
            "date_published": "2024-08-03T02:54:28.000Z",
            "author": {
                "name": "martin-mfv",
                "url": "https://github.com/martin-mfv"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/99586?u=b4abd791d83e768c72cb832147b4a210caecf47d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Problem:</p>\n<p dir=\"auto\"><a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/f6c0a35b1b8b4fb4d033aa6c09c4efaaf6652bdc/hovercard\" href=\"https://github.com/rails/rails/commit/f6c0a35b1b8b4fb4d033aa6c09c4efaaf6652bdc\"><tt>f6c0a35</tt></a> changed <code class=\"notranslate\">human_attribute_name</code> to raise error if <code class=\"notranslate\">raise_on_missing_translations</code> is <code class=\"notranslate\">true</code>. This change had a major impact on existing applications (i.e., too many missing translation errors).</p>\n<p dir=\"auto\">Solution:</p>\n<p dir=\"auto\">Allow each model to decide whether to raise an error on missing translations.</p>",
            "url": "https://github.com/rails/rails/pull/52495",
            "title": "Enable raising an error for missing translations on a per-model basis",
            "date_modified": "2024-08-03T02:50:48.000Z",
            "date_published": "2024-08-03T02:50:43.000Z",
            "author": {
                "name": "shouichi",
                "url": "https://github.com/shouichi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The problem:</p>\n<p dir=\"auto\">Active Model support for JSON serialization and deserialization assumes underscored keys.</p>\n<p dir=\"auto\">Support for assigning Ruby attributes from snake_case JSON properties is well supported through <a href=\"https://edgeapi.rubyonrails.org/classes/ActiveModel/Serializers/JSON.html#method-i-from_json\" rel=\"nofollow\">ActiveModel::Serializers::JSON#from_json</a>:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class User\n  include ActiveModel::API\n  include ActiveModel::Serializers::JSON\n\n  attr_accessor :name, :born_on\n\n  def attributes\n    { name: name, born_on: born_on }\n  end\nend\n\nuser = User.new\nuser.from_json(&lt;&lt;~JSON)\n  {\n    &quot;name&quot;: &quot;Ruby on Rails&quot;,\n    &quot;born_on&quot;: &quot;2004-11-24&quot;\n  }\nJSON\n\nuser.name       # =&gt; &quot;Ruby on Rails&quot;\nuser.born_on    # =&gt; &quot;2004-11-24&quot;\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-c1\">API</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">Serializers</span>::<span class=\"pl-c1\">JSON</span>\n\n  <span class=\"pl-en\">attr_accessor</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:born_on</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">attributes</span>\n    <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-en\">name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">born_on</span>: <span class=\"pl-en\">born_on</span> <span class=\"pl-kos\">}</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">user</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">from_json</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">&lt;&lt;~JSON</span><span class=\"pl-kos\">)</span><span class=\"pl-s\"></span>\n<span class=\"pl-s\">  {</span>\n<span class=\"pl-s\">    \"name\": \"Ruby on Rails\",</span>\n<span class=\"pl-s\">    \"born_on\": \"2004-11-24\"</span>\n<span class=\"pl-s\">  }</span>\n<span class=\"pl-s\">JSON</span>\n\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span>       <span class=\"pl-c\"># =&gt; \"Ruby on Rails\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">born_on</span>    <span class=\"pl-c\"># =&gt; \"2004-11-24\"</span></pre></div>\n<p dir=\"auto\">However, assigning Ruby attributes from camelCase JSON properties is incompatible with <code class=\"notranslate\">ActiveModel::Serializers::JSON#from_json</code>. If the <code class=\"notranslate\">born_on</code> property were <code class=\"notranslate\">bornOn</code>, attribute assignment would fail for classes that also include <a href=\"https://edgeapi.rubyonrails.org/classes/ActiveModel/AttributeAssignment.html#method-i-attributes-3D\" rel=\"nofollow\">ActiveModel::AttributeAssignment</a> (like <code class=\"notranslate\">ActiveModel::Model</code> and <code class=\"notranslate\">ActiveRecord::Base</code>). Since <code class=\"notranslate\">ActiveModel::AttributeAssignment</code> calls <code class=\"notranslate\">send(\"#{attribute}=\", value)</code>, the most likely scenario is a <code class=\"notranslate\">NoMethodError</code>.</p>\n<p dir=\"auto\">To work around this shortcoming, models can declare aliases (<code class=\"notranslate\">alias_method :bornOn, :born_on</code> in the above example). This can be tedious, and feel incomplete as <em>not all</em> keys require aliases (for example, <code class=\"notranslate\">:name</code> yields the same property name regardless of casing).</p>\n<p dir=\"auto\">Similarly, serializing an instance to JSON assumes underscored keys. Unlike <code class=\"notranslate\">#from_json</code>, there are existing seams to modify keys before they are serialized. For example, models can override either <code class=\"notranslate\">#serializable_hash</code> or <code class=\"notranslate\">#as_json</code>. While viable, there are issues with both approach.</p>\n<p dir=\"auto\">Overriding <code class=\"notranslate\">#serializable_hash</code> with JSON-specific details is a breach of the abstraction. In theory, <code class=\"notranslate\">#serializable_hash</code> aims to transform attributes into a <code class=\"notranslate\">Hash</code> that is ready to be serialized into another format (JSON, XML, or otherwise).</p>\n<p dir=\"auto\">Overriding <code class=\"notranslate\">#as_json</code> is more appropriate, but lacks a corresponding abstraction for de-serializing and assigning values in a method like <code class=\"notranslate\">#from_json</code>. <a href=\"https://github.com/rails/rails/pull/51282\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51282/hovercard\">#51282</a> aims to introduce a corollary abstraction, but feels incomplete and awkward in comparison to what's proposed below.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">The proposal:</p>\n<p dir=\"auto\">This commit proposes the introduction of<br>\n<code class=\"notranslate\">ActiveModel::Serializers::JSON.key_format</code> to configure key transformations at the class level. The name and invocation style draw inspiration from <a href=\"https://github.com/rails/jbuilder\">jbuilder</a>, specifically its <a href=\"https://github.com/rails/jbuilder/tree/v2.12.0?tab=readme-ov-file#formatting-keys\">key_format</a> and <code class=\"notranslate\">key_format!</code> methods. For example, consider the following:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class User\n  include ActiveModel::API\n  include ActiveModel::Serializers::JSON\n\n  key_format from_json: :underscore,\n             to_json: -&gt;(key) { key.camelize :lower }\n\n  attr_accessor :name, :born_on\n\n  def attributes\n    { name: name, born_on: born_on }\n  end\nend\n\njson = { name: &quot;Ruby on Rails&quot;, bornOn: &quot;2004-11-24&quot; }.to_json\n\nuser = User.new\nuser.from_json(json)\nuser.name                       # =&gt; &quot;Ruby on Rails&quot;\nuser.born_on                    # =&gt; &quot;2004-11-24&quot;\nuser.to_json == json            # =&gt; true\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-c1\">API</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">Serializers</span>::<span class=\"pl-c1\">JSON</span>\n\n  <span class=\"pl-en\">key_format</span> <span class=\"pl-pds\">from_json</span>: <span class=\"pl-pds\">:underscore</span><span class=\"pl-kos\">,</span>\n             <span class=\"pl-pds\">to_json</span>: <span class=\"pl-c1\">-&gt;</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">key</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> <span class=\"pl-s1\">key</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">camelize</span> <span class=\"pl-pds\">:lower</span> <span class=\"pl-kos\">}</span>\n\n  <span class=\"pl-en\">attr_accessor</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:born_on</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">attributes</span>\n    <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-en\">name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">born_on</span>: <span class=\"pl-en\">born_on</span> <span class=\"pl-kos\">}</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">json</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"Ruby on Rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">bornOn</span>: <span class=\"pl-s\">\"2004-11-24\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_json</span>\n\n<span class=\"pl-s1\">user</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">from_json</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">json</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span>                       <span class=\"pl-c\"># =&gt; \"Ruby on Rails\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">born_on</span>                    <span class=\"pl-c\"># =&gt; \"2004-11-24\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_json</span> == <span class=\"pl-s1\">json</span>            <span class=\"pl-c\"># =&gt; true</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52494",
            "title": "Add `ActiveModel::Serializers::JSON.key_format`",
            "date_modified": "2024-08-02T22:18:09.000Z",
            "date_published": "2024-08-02T21:04:35.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/437?u=198b3dc94d58b619dc6e27f59bd4386945017d56&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Requiring <code class=\"notranslate\">action_dispatch/http/request</code> outside of Rails results in an error due to <code class=\"notranslate\">MimeNegotiation</code> depending on <code class=\"notranslate\">ActiveSupport::Concern</code> without requiring it.</p>",
            "url": "https://github.com/rails/rails/pull/52492",
            "title": "Adds missing require to action_dispatch/http/mime_negotiation",
            "date_modified": "2024-08-02T15:04:00.000Z",
            "date_published": "2024-08-02T15:03:55.000Z",
            "author": {
                "name": "foca",
                "url": "https://github.com/foca"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/97030518?u=44f65a79575affbfae38d5a4e75393694efa9d6c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because while reading the output from <code class=\"notranslate\">bin/rails credentials:help</code> I felt that some wording could have been improved.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request:</p>\n<ul dir=\"auto\">\n<li>Adds a few commas in a sentence in order to make it easier to read and syntactically correct;</li>\n<li>In a sentence where the implicit subject felt weird, I have replaced it with an explicit <code class=\"notranslate\">bin/rails credentials:edit</code> subject.</li>\n</ul>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52490",
            "title": "Improve wording of `bin/rails credentials:help` command",
            "date_modified": "2024-08-02T14:13:30.000Z",
            "date_published": "2024-08-02T14:13:16.000Z",
            "author": {
                "name": "Uaitt",
                "url": "https://github.com/Uaitt"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1334409?u=09d7ca64a9fcce78c0f5fd4267a9cc1ee4a1b60c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This PR adds the ability to skip validations on an instantiated AR record.</p>\n<p dir=\"auto\">Use cases:</p>\n<h4 dir=\"auto\">1. Creating associated records and you don't care about validations.</h4>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class User &lt; ApplicationRecord\n  validates :name, presence: true\nend\n\nclass Item &lt; ApplicationRecord\n  belongs_to :record, polymorphic: true\nend\n\nrecord = User.first # the name is blank for some reason\n\nrecord.skip_validations\n\nItem.create!(record:) # this will not raise validation errors because the name is missing\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">validates</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">presence</span>: <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Item</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:record</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">polymorphic</span>: <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">record</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">first</span> <span class=\"pl-c\"># the name is blank for some reason</span>\n\n<span class=\"pl-s1\">record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">skip_validations</span>\n\n<span class=\"pl-v\">Item</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">record</span>:<span class=\"pl-kos\">)</span> <span class=\"pl-c\"># this will not raise validation errors because the name is missing</span></pre></div>\n<h4 dir=\"auto\">2. Helps with orchestration in cases where we don't own the model file</h4>\n<p dir=\"auto\">This is common in libraries.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# In app code where we don't have access to\nclass User &lt; ApplicationRecord\n  validates :name, presence: true\nend\n\n# In library code we have access to the instantiated record\n\nrecord # User.first - the name is blank for some reason\nproperty # &quot;role&quot; - this is received from the app somehow (properly sanitised)\nvalue # &quot;admin&quot; - same, received from the app\n\nrecord.skip_validations\nrecord.update!(property, value) # the name validation won't be triggered\"><pre class=\"notranslate\"><span class=\"pl-c\"># In app code where we don't have access to</span>\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">validates</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">presence</span>: <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-c\"># In library code we have access to the instantiated record</span>\n\n<span class=\"pl-en\">record</span> <span class=\"pl-c\"># User.first - the name is blank for some reason</span>\n<span class=\"pl-en\">property</span> <span class=\"pl-c\"># \"role\" - this is received from the app somehow (properly sanitised)</span>\n<span class=\"pl-en\">value</span> <span class=\"pl-c\"># \"admin\" - same, received from the app</span>\n\n<span class=\"pl-en\">record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">skip_validations</span>\n<span class=\"pl-en\">record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update!</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">property</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">value</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\"># the name validation won't be triggered</span></pre></div>\n\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds the <code class=\"notranslate\">skip_validations</code> and <code class=\"notranslate\">reset_validations</code> methods which control the <code class=\"notranslate\">@skip_validations</code> ivar. This ivar in turn disabled the <code class=\"notranslate\">valid?</code> method if set to true.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">I don't know exactly the internal styling of these kinds of things (ex: should the ivar start with an underscore? or should the <code class=\"notranslate\">skip</code> and <code class=\"notranslate\">reset</code> methods end in <code class=\"notranslate\">!</code>) so I'll appreciate any guidance there.</p>\n<p dir=\"auto\">Thank you for evaluating this change.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52488",
            "title": "feature: Skip validations",
            "date_modified": "2024-08-03T13:20:47.000Z",
            "date_published": "2024-08-02T11:23:23.000Z",
            "author": {
                "name": "adrianthedev",
                "url": "https://github.com/adrianthedev"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/99586?u=b4abd791d83e768c72cb832147b4a210caecf47d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Problem:</p>\n<p dir=\"auto\"><a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/f6c0a35b1b8b4fb4d033aa6c09c4efaaf6652bdc/hovercard\" href=\"https://github.com/rails/rails/commit/f6c0a35b1b8b4fb4d033aa6c09c4efaaf6652bdc\"><tt>f6c0a35</tt></a> changed <code class=\"notranslate\">human_attribute_name</code> to raise error if <code class=\"notranslate\">raise_on_missing_translations</code> is <code class=\"notranslate\">true</code>. This change had a major impact on existing applications (i.e., too many missing translation errors).</p>\n<p dir=\"auto\">Solution:</p>\n<p dir=\"auto\">Change <code class=\"notranslate\">human_attribute_name</code> to raise an error iff <code class=\"notranslate\">raise_on_missing_translations</code> is <code class=\"notranslate\">:strict</code>.</p>",
            "url": "https://github.com/rails/rails/pull/52487",
            "title": "Change human_attribute_name to raise an error iff in strict mode",
            "date_modified": "2024-08-02T23:18:01.000Z",
            "date_published": "2024-08-02T09:01:57.000Z",
            "author": {
                "name": "shouichi",
                "url": "https://github.com/shouichi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5122678?u=204301f9f9fe8930fd26fe3bfe65b6ffaffd8b59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52478.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2442642275\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52478\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52478/hovercard\" href=\"https://github.com/rails/rails/issues/52478\">#52478</a></p>\n<p dir=\"auto\">Prior to this commit, tests using <a href=\"https://edgeapi.rubyonrails.org/classes/ActiveJob/TestHelper.html#method-i-assert_enqueued_with\" rel=\"nofollow\">assert_enqueued_with</a> asserting against the <code class=\"notranslate\">at</code> argument would incorrectly pass if testing with values that used second-level precision.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class BuggyJobTest &lt; ActiveJob::TestCase\n  def test_should_not_find_job\n    at =  Time.new(&quot;1989-12-31T12:00:01&quot;)\n    wait_until = Time.new(&quot;1989-12-31T12:00:02&quot;)\n\n    assert_enqueued_with(job: BuggyJob, at:) do\n      BuggyJob.set(wait_until:).perform_later\n    end\n\n    fail &quot;Should not reach this line because assert_enqueued_with should have failed&quot;\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">BuggyJobTest</span> &lt; <span class=\"pl-v\">ActiveJob</span>::<span class=\"pl-v\">TestCase</span>\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">test_should_not_find_job</span>\n    <span class=\"pl-s1\">at</span> <span class=\"pl-c1\">=</span>  <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"1989-12-31T12:00:01\"</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">wait_until</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"1989-12-31T12:00:02\"</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-en\">assert_enqueued_with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">job</span>: <span class=\"pl-v\">BuggyJob</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">at</span>:<span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n      <span class=\"pl-v\">BuggyJob</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">set</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">wait_until</span>:<span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">perform_later</span>\n    <span class=\"pl-k\">end</span>\n\n    <span class=\"pl-en\">fail</span> <span class=\"pl-s\">\"Should not reach this line because assert_enqueued_with should have failed\"</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52479",
            "title": "Support second-level precision for `assert_enqueued_with`",
            "date_modified": "2024-08-02T23:58:44.000Z",
            "date_published": "2024-08-01T14:45:12.000Z",
            "author": {
                "name": "stevepolitodesign",
                "url": "https://github.com/stevepolitodesign"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/44102752?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2435788027\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52441\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52441/hovercard\" href=\"https://github.com/rails/rails/issues/52441\">#52441</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes</p>\n<ul dir=\"auto\">\n<li>caching with rails doc</li>\n<li>updated development.rb.tt</li>\n</ul>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52474",
            "title": "Update development mode  default caching docs",
            "date_modified": "2024-08-02T21:34:10.000Z",
            "date_published": "2024-08-01T07:01:14.000Z",
            "author": {
                "name": "nikhilbhatt",
                "url": "https://github.com/nikhilbhatt"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2779422?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Note that the PostgreSQL DROP EXTENSION statement does not accept a schema name (see <a href=\"https://www.postgresql.org/docs/current/sql-dropextension.html\" rel=\"nofollow\">https://www.postgresql.org/docs/current/sql-dropextension.html</a>). Since we allow <code class=\"notranslate\">enable_extension</code> to be called with a schema-qualified name, this commit allows <code class=\"notranslate\">disable_extension</code> to be similarly called with a schema-qualified name, but the schema name is chopped off in the generated SQL statement.</p>\n<p dir=\"auto\">See <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2403936559\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52312\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52312/hovercard\" href=\"https://github.com/rails/rails/issues/52312\">#52312</a> for context.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52452",
            "title": "Allow disable_extension to be called with schema-qualified name",
            "date_modified": "2024-08-01T19:39:29.000Z",
            "date_published": "2024-07-30T15:53:48.000Z",
            "author": {
                "name": "afn",
                "url": "https://github.com/afn"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1417956?u=d703572179f5cf17f36a5b3e17a98b743a9f2cdd&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Our team uses symlinks to share certain logic between projects in our monorepo. However, the current glob in <code class=\"notranslate\">ActiveSupport::FileUpdateChecker</code> does not follow symlinked directories, so shared code does not reload in development.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\"><code class=\"notranslate\">FileUpdateChecker</code> uses the glob pattern <code class=\"notranslate\">**/*</code> to find watched files, but this pattern does not include symlinked directories in file structure like this</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"❯ tree .\n.\n├── app\n│   ├── app.rb\n│   └── shared -&gt; ../shared\n└── shared\n    ├── shared.rb\n    └── subshared\n        └── subshared.rb\"><pre class=\"notranslate\">❯ tree <span class=\"pl-c1\">.</span>\n<span class=\"pl-c1\">.</span>\n├── app\n│   ├── app.rb\n│   └── shared -<span class=\"pl-k\">&gt;</span> ../shared\n└── shared\n    ├── shared.rb\n    └── subshared\n        └── subshared.rb</pre></div>\n<p dir=\"auto\">I tryed several patterns and <code class=\"notranslate\">**{,/*/**}/*.rb</code> seems to be the only correct one</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"irb(main):001&gt; Dir[&quot;./app/**/*.rb&quot;]\n=&gt; [&quot;./app/app.rb&quot;]\nirb(main):002&gt; Dir[&quot;./app/***/*.rb&quot;]\n=&gt; [&quot;./app/shared/shared.rb&quot;]\nirb(main):003&gt; Dir[&quot;./app/**/*/**/*.rb&quot;]\n=&gt; [&quot;./app/shared/shared.rb&quot;, &quot;./app/shared/subshared/subshared.rb&quot;]\nirb(main):004&gt; Dir[&quot;./app/**{,/*/**}/*.rb&quot;]\n=&gt; [&quot;./app/app.rb&quot;, &quot;./app/shared/shared.rb&quot;, &quot;./app/shared/subshared/subshared.rb&quot;]\"><pre class=\"notranslate\"><span class=\"pl-en\">irb</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">main</span><span class=\"pl-kos\">)</span>:<span class=\"pl-c1\">001</span>&gt; <span class=\"pl-v\">Dir</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/**/*.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/app.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-en\">irb</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">main</span><span class=\"pl-kos\">)</span>:<span class=\"pl-c1\">002</span>&gt; <span class=\"pl-v\">Dir</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/***/*.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/shared/shared.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-en\">irb</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">main</span><span class=\"pl-kos\">)</span>:<span class=\"pl-c1\">003</span>&gt; <span class=\"pl-v\">Dir</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/**/*/**/*.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/shared/shared.rb\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"./app/shared/subshared/subshared.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-en\">irb</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">main</span><span class=\"pl-kos\">)</span>:<span class=\"pl-c1\">004</span>&gt; <span class=\"pl-v\">Dir</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/**{,/*/**}/*.rb\"</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"./app/app.rb\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"./app/shared/shared.rb\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"./app/shared/subshared/subshared.rb\"</span><span class=\"pl-kos\">]</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">The final glob was found in <a href=\"https://stackoverflow.com/a/2724048\" rel=\"nofollow\">https://stackoverflow.com/a/2724048</a> and is also used in the <a href=\"https://github.com/grosser/parallel_tests/blob/v4.7.1/lib/parallel_tests/test/runner.rb#L263\">parallel_tests</a> gem</p>\n<h3 dir=\"auto\">Checklist</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52450",
            "title": "ActiveSupport::FileUpdateChecker with symlink support",
            "date_modified": "2024-07-31T11:12:35.000Z",
            "date_published": "2024-07-30T11:03:56.000Z",
            "author": {
                "name": "michaelkhabarov",
                "url": "https://github.com/michaelkhabarov"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/131752?u=32ddf1119b1d189c9bd241a721b36ea01c29f61e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">We special case singleton methods being added to ActiveRecord::Base subclasses whose names match methods on Kernel so that we can eagerly define them on the ClassSpecificRelation as otherwise we'd never hit method_missing.</p>\n<p dir=\"auto\">Previously, this would also eagerly define methods which were on the Kernel Module's singleton class rather than being defined as instance methods inside the module, which created quite a few unnecessary methods.</p>\n<p dir=\"auto\">Most notably this hit \"name\" which is defined on the anonymous HABTM classes. I think that case is worth fixing twice (it's an common error involving a complex interaction, that might only be foudn through luck) so the second commit here explicitly delegates <code class=\"notranslate\">name</code>. Either commit solves the <code class=\"notranslate\">name</code> issue (which I think is the only case I've seen this in the wild)</p>",
            "url": "https://github.com/rails/rails/pull/52449",
            "title": "Avoid eagerly generating Module methods on ActiveRecord::Relation delegation",
            "date_modified": "2024-07-30T21:38:20.000Z",
            "date_published": "2024-07-30T07:12:03.000Z",
            "author": {
                "name": "jhawthorn",
                "url": "https://github.com/jhawthorn"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/4289625?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because the current querying guide has no entries for CTE and the link to <code class=\"notranslate\">with</code> method.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds the entry for CTE.</p>\n<p dir=\"auto\">Note that this PR is a retry of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1942777044\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49630\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49630/hovercard\" href=\"https://github.com/rails/rails/pull/49630\">#49630</a>, including the following updates:</p>\n<ul dir=\"auto\">\n<li>Changed the code examples from <code class=\"notranslate\">Post</code> and <code class=\"notranslate\">Comment</code> models to <code class=\"notranslate\">Book</code> and <code class=\"notranslate\">Review</code> to be consistent with <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"623747852\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/39406\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/39406/hovercard\" href=\"https://github.com/rails/rails/pull/39406\">#39406</a></li>\n<li>Added the minimum version of SQLite to work with CTE</li>\n<li>Revised some English sentences with a little help of Claude 3.5 Sonnet</li>\n</ul>\n<p dir=\"auto\">The SQL queries in this PR were actually generated using a local Rails application running Rails 7.1.3.4 and Ruby 3.3.4.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/zzak/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zzak\">@zzak</a></p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">ref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"536810238\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/37944\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/37944/hovercard\" href=\"https://github.com/rails/rails/pull/37944\">#37944</a><br>\nref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1512256975\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/46843\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/46843/hovercard\" href=\"https://github.com/rails/rails/pull/46843\">#46843</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52423",
            "title": "[ci-skip][Docs][retry] Add description for CTE to querying guide",
            "date_modified": "2024-07-27T22:53:25.000Z",
            "date_published": "2024-07-26T05:34:11.000Z",
            "author": {
                "name": "hachi8833",
                "url": "https://github.com/hachi8833"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/19589006?u=4625e661fdb3256af0ed316629196771b9ee0c11&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because I wanted to have a Svelte store compatible way to monitor a channel, and create a clean interface to subscribe callbacks to a channel.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the Action Cable client <code class=\"notranslate\">Subscription</code> to add a <code class=\"notranslate\">.observer(parser = String)</code> accessor to create or find a <code class=\"notranslate\">SubscriptionObserver</code> which allows for subscribing callback functions to new data. The value in the <code class=\"notranslate\">SubscriptionObserver</code> gets replaced with each new packet.</p>\n<p dir=\"auto\">Here's a code example:</p>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"const observer = consumer.subscriptions.create({ channel: &quot;ExampleChannel&quot; }).observer(JSON.parse)\nconst unsubscribe = observer.subscribe((data) =&gt; console.log(data))\n\nsetTimeout(unsubscribe, 5000)\"><pre class=\"notranslate\"><span class=\"pl-k\">const</span> <span class=\"pl-s1\">observer</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">consumer</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">subscriptions</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span> <span class=\"pl-c1\">channel</span>: <span class=\"pl-s\">\"ExampleChannel\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">observer</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">JSON</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">parse</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">unsubscribe</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">observer</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">subscribe</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">data</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-smi\">console</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">log</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">data</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-en\">setTimeout</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">unsubscribe</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">5000</span><span class=\"pl-kos\">)</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">This is fully compatible with <a href=\"https://svelte.dev/docs/svelte-components#script-4-prefix-stores-with-$-to-access-their-values\" rel=\"nofollow\">Svelte Stores</a>.</p>\n<p dir=\"auto\">A lot of inspiration was also taken from the <a href=\"https://rxjs.dev/guide/observable\" rel=\"nofollow\">RxJS Observable</a>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52411",
            "title": "Action Cable: Create `SubscriptionObserver` to facilitate callbacks for channel data",
            "date_modified": "2024-07-24T14:18:07.000Z",
            "date_published": "2024-07-24T14:17:37.000Z",
            "author": {
                "name": "reesericci",
                "url": "https://github.com/reesericci"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/987638?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">We remove files under the public directory for API-only Applications. </p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/a17aa6376d7974e38af90a2fe28e548b201baa63/railties/lib/rails/generators/rails/app/app_generator.rb#L500-L509\">rails/railties/lib/rails/generators/rails/app/app_generator.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 500 to 509\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/a17aa6376d7974e38af90a2fe28e548b201baa63\">a17aa63</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L500\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"500\"></td>\n          <td id=\"LC500\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">delete_public_files_if_api_option</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L501\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"501\"></td>\n          <td id=\"LC501\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">if</span> <span class=\"pl-en\">options</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:api</span><span class=\"pl-kos\">]</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L502\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"502\"></td>\n          <td id=\"LC502\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/404.html\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L503\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"503\"></td>\n          <td id=\"LC503\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/406-unsupported-browser.html\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L504\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"504\"></td>\n          <td id=\"LC504\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/422.html\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L505\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"505\"></td>\n          <td id=\"LC505\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/500.html\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L506\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"506\"></td>\n          <td id=\"LC506\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/icon.png\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L507\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"507\"></td>\n          <td id=\"LC507\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">remove_file</span> <span class=\"pl-s\">\"public/icon.svg\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L508\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"508\"></td>\n          <td id=\"LC508\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L509\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"509\"></td>\n          <td id=\"LC509\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\">We should keep the behavior in <code class=\"notranslate\">app:update</code> command too.</p>\n<p dir=\"auto\">Follow up of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2325982279\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51952\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51952/hovercard\" href=\"https://github.com/rails/rails/pull/51952\">#51952</a>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52403",
            "title": "Don't update public directory during `app:update` command for API-only Applications",
            "date_modified": "2024-07-28T03:26:54.000Z",
            "date_published": "2024-07-23T05:51:28.000Z",
            "author": {
                "name": "y-yagi",
                "url": "https://github.com/y-yagi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/509837?u=697e4a265d5359363a5d57a24b07f9a79cb0b08a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Small enhancement to <a href=\"https://github.com/rails/rails/pull/50977\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50977/hovercard\">this awesome PR</a>, cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/Ridhwana/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/Ridhwana\">@Ridhwana</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/carlosantoniodasilva/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/carlosantoniodasilva\">@carlosantoniodasilva</a></p>\n<ul dir=\"auto\">\n<li>Tidied up some of the wording around how Active Storage works with Action Text.</li>\n<li>Added a warning about <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2347254602\" data-permission-text=\"Title is private\" data-url=\"https://github.com/basecamp/trix/issues/1159\" data-hovercard-type=\"issue\" data-hovercard-url=\"/basecamp/trix/issues/1159/hovercard\" href=\"https://github.com/basecamp/trix/issues/1159\">basecamp/trix#1159</a></li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52398",
            "title": "Update Action Text + Active Storage docs",
            "date_modified": "2024-07-29T06:33:30.000Z",
            "date_published": "2024-07-23T00:54:56.000Z",
            "author": {
                "name": "ghiculescu",
                "url": "https://github.com/ghiculescu"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/522155?u=2e71ed2ab56545207a94b885fafc434ee7350cf1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This PR is an alternative to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2378385100\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52228\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52228/hovercard\" href=\"https://github.com/rails/rails/pull/52228\">#52228</a>, exploring <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a>'s idea of a separate method from <code class=\"notranslate\">insert_all</code>. That way, the interface of <code class=\"notranslate\">insert_all</code> does not become too crowded.</p>\n<h2 dir=\"auto\">Background</h2>\n<p dir=\"auto\">We have some performance-critical endpoints where we want to allocate least # of objects and use <code class=\"notranslate\">insert_all</code> to write 1000s of rows into the database.</p>\n<p dir=\"auto\">However, we see <code class=\"notranslate\">insert_all</code> being ~2.5x slower compared to manually building <code class=\"notranslate\">INSERT INTO &lt;table&gt; VALUES (...), (...)</code>.</p>\n<p dir=\"auto\">I've been profiling <code class=\"notranslate\">insert_all</code> and that turned out to be largely because it 1) works with arrays of hashes and each hash needs to be traversed 2) it serializes attributes via Attributes API.</p>\n<p dir=\"auto\">That's great default behavior but if we're inserting 2000 tuples of <code class=\"notranslate\">(&lt;foreigh-key&gt;, &lt;foreigh-key&gt;, &lt;foreigh-key&gt;)</code>, we don't want to traverse hashes and run the complexity of casting integers to integers via Attributes API.</p>\n<p dir=\"auto\">I'd like to propose a \"column mode\" for inserting rows that takes arrays of arrays (no need to traverse hashes!) and makes attribute casting is the responsibility of the caller.</p>\n<p dir=\"auto\">With that approach, we're able to make <code class=\"notranslate\">insert_rows</code> as fast as direct string building:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ruby 3.3.1 (2024-04-23 revision c56cd86388) [arm64-darwin23]\nWarming up --------------------------------------\n          insert_all     4.000 i/100ms\ninsert_all with columns\n                        11.000 i/100ms\n             raw sql    13.000 i/100ms\n           with Arel    12.000 i/100ms\nCalculating -------------------------------------\n          insert_all     41.522 (± 7.2%) i/s -    168.000 in   4.066766s\ninsert_all with columns\n                         86.048 (±23.2%) i/s -    341.000 in   4.161382s\n             raw sql    114.595 (±14.0%) i/s -    455.000 in   4.055053s\n           with Arel    100.232 (±23.9%) i/s -    384.000 in   4.084465s\n\nComparison:\n             raw sql:      114.6 i/s\n           with Arel:      100.2 i/s - same-ish: difference falls within error\ninsert_all with columns:       86.0 i/s - same-ish: difference falls within error\n          insert_all:       41.5 i/s - 2.76x  slower\"><pre class=\"notranslate\"><code class=\"notranslate\">ruby 3.3.1 (2024-04-23 revision c56cd86388) [arm64-darwin23]\nWarming up --------------------------------------\n          insert_all     4.000 i/100ms\ninsert_all with columns\n                        11.000 i/100ms\n             raw sql    13.000 i/100ms\n           with Arel    12.000 i/100ms\nCalculating -------------------------------------\n          insert_all     41.522 (± 7.2%) i/s -    168.000 in   4.066766s\ninsert_all with columns\n                         86.048 (±23.2%) i/s -    341.000 in   4.161382s\n             raw sql    114.595 (±14.0%) i/s -    455.000 in   4.055053s\n           with Arel    100.232 (±23.9%) i/s -    384.000 in   4.084465s\n\nComparison:\n             raw sql:      114.6 i/s\n           with Arel:      100.2 i/s - same-ish: difference falls within error\ninsert_all with columns:       86.0 i/s - same-ish: difference falls within error\n          insert_all:       41.5 i/s - 2.76x  slower\n</code></pre></div>\n<details><summary>Benchmark code</summary>\n<p dir=\"auto\">\n</p><div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# frozen_string_literal: true\n\nrequire 'debug'\nrequire &quot;active_record&quot;\nrequire &quot;benchmark/ips&quot;\n\nGC.disable\n\nROWS_COUNT = 1000\n\nActiveRecord::Base.establish_connection({ adapter: &quot;sqlite3&quot;, database: &quot;:memory:&quot; })\n\nclass Commerce &lt; ActiveRecord::Base\n  connection.create_table :commerces, force: true do |t|\n    t.string :name, :email, :title, :tags\n    t.integer :variant_id, :product_id, :inventory_id, :something_id, :another_id\n    t.boolean :fulfilled\n    t.datetime :fulfilled_at, :deleted_at\n    t.timestamps null: true\n  end\nend\n\ndef db_time(value)\n  value.to_formatted_s(:db).inspect\nend\n\nATTRS = {\n  name: &quot;sam&quot;,\n  email: &quot;kirs@shopify.com&quot;,\n  title: &quot;title&quot;,\n  tags: &quot;tag1,tag2,tag3&quot;,\n  variant_id: 1,\n  product_id: 1,\n  inventory_id: 1,\n  something_id: 1,\n  another_id: 1,\n  fulfilled: true,\n  fulfilled_at: Time.now,\n  deleted_at: Time.now\n}\n\nBenchmark.ips do |x|\n  x.warmup = 2\n  x.time   = 4\n\n  relation = Commerce.all\n\n  x.report(&quot;insert_all&quot;) do\n    conn = Commerce.connection\n\n    relation.insert_all(\n      [ATTRS] * ROWS_COUNT\n    )\n  end\n\n  x.report(&quot;insert_all with columns&quot;) do\n    conn = Commerce.connection\n    attrs = ATTRS.dup\n    attrs[:fulfilled_at] = attrs[:fulfilled_at].to_formatted_s(:db)\n    attrs[:deleted_at] = attrs[:deleted_at].to_formatted_s(:db)\n    attrs[:created_at] = Time.now.to_formatted_s(:db)\n    attrs[:updated_at] = attrs[:created_at]\n\n    values = [\n      attrs[:name], attrs[:email], attrs[:title], attrs[:tags], attrs[:variant_id], attrs[:product_id], attrs[:inventory_id], attrs[:something_id], attrs[:another_id], attrs[:fulfilled], attrs[:fulfilled_at], attrs[:deleted_at], attrs[:created_at], attrs[:updated_at]\n    ]\n\n    relation.insert_all(\n      [values] * ROWS_COUNT,\n      columns: %w[name email title tags variant_id product_id inventory_id something_id another_id fulfilled fulfilled_at deleted_at created_at updated_at],\n    )\n  end\n\n  x.report(&quot;raw sql&quot;) do\n    conn = Commerce.connection\n    values = (1..ROWS_COUNT).map do\n      attrs = ATTRS\n      &quot;(#{conn.quote(attrs[:name])}, #{conn.quote(attrs[:email])}, #{conn.quote(attrs[:title])}, #{conn.quote(attrs[:tags])}, #{attrs[:variant_id]}, #{attrs[:product_id]}, #{attrs[:inventory_id]}, #{attrs[:something_id]}, #{attrs[:another_id]}, #{attrs[:fulfilled]}, #{db_time(attrs[:fulfilled_at])}, #{db_time(attrs[:deleted_at])}, #{db_time(Time.now)}, #{db_time(Time.now)})&quot;\n    end\n\n    conn.execute(\n      &quot;INSERT INTO commerces (name, email, title, tags, variant_id, product_id, inventory_id, something_id, another_id, fulfilled, fulfilled_at, deleted_at, created_at, updated_at) &quot;\\\n      &quot;VALUES #{values.join(',')}&quot;\n    )\n  end\n\n  x.report(&quot;with Arel&quot;) do\n    conn = Commerce.connection\n    columns = %w[name email title tags variant_id product_id inventory_id something_id another_id fulfilled fulfilled_at deleted_at created_at updated_at]\n    attrs = ATTRS.dup\n    attrs[:fulfilled_at] = (attrs[:fulfilled_at]).to_formatted_s(:db)\n    attrs[:deleted_at] = (attrs[:deleted_at]).to_formatted_s(:db)\n    attrs[:created_at] = (Time.now).to_formatted_s(:db)\n    attrs[:updated_at] = (Time.now).to_formatted_s(:db)\n\n    values_list = [attrs.values] * ROWS_COUNT\n\n    sql = &quot;INSERT INTO #{Commerce.quoted_table_name} (#{columns.join(',')}) &quot;\n    sql &lt;&lt; conn.visitor.compile(Arel::Nodes::ValuesList.new(values_list))\n    conn.execute(sql)\n  end\n\n  x.compare!\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># frozen_string_literal: true</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'debug'</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"active_record\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"benchmark/ips\"</span>\n\n<span class=\"pl-c1\">GC</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">disable</span>\n\n<span class=\"pl-c1\">ROWS_COUNT</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">1000</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">establish_connection</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-s\">\"sqlite3\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">database</span>: <span class=\"pl-s\">\":memory:\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Commerce</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:commerces</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-c1\">true</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:email</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:title</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:tags</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">integer</span> <span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:another_id</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">boolean</span> <span class=\"pl-pds\">:fulfilled</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">datetime</span> <span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:deleted_at</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">timestamps</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">true</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">value</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">inspect</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-c1\">ATTRS</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"sam\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">email</span>: <span class=\"pl-s\">\"kirs@shopify.com\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">title</span>: <span class=\"pl-s\">\"title\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">tags</span>: <span class=\"pl-s\">\"tag1,tag2,tag3\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">variant_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">product_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">inventory_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">something_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">another_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">fulfilled</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">fulfilled_at</span>: <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">deleted_at</span>: <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-v\">Benchmark</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">ips</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">x</span>|\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">warmup</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">2</span>\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">time</span>   <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">4</span>\n\n  <span class=\"pl-s1\">relation</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"insert_all\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n\n    <span class=\"pl-s1\">relation</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">insert_all</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-kos\">[</span><span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"insert_all with columns\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">dup</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span>\n\n    <span class=\"pl-s1\">values</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span>\n      <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:email</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:tags</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:another_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-kos\">]</span>\n\n    <span class=\"pl-s1\">relation</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">insert_all</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-kos\">[</span><span class=\"pl-s1\">values</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">columns</span>: <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">name</span> <span class=\"pl-s\">email</span> <span class=\"pl-s\">title</span> <span class=\"pl-s\">tags</span> <span class=\"pl-s\">variant_id</span> <span class=\"pl-s\">product_id</span> <span class=\"pl-s\">inventory_id</span> <span class=\"pl-s\">something_id</span> <span class=\"pl-s\">another_id</span> <span class=\"pl-s\">fulfilled</span> <span class=\"pl-s\">fulfilled_at</span> <span class=\"pl-s\">deleted_at</span> <span class=\"pl-s\">created_at</span> <span class=\"pl-s\">updated_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"raw sql\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">values</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-c1\">ROWS_COUNT</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">map</span> <span class=\"pl-k\">do</span>\n      <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span>\n      <span class=\"pl-s\">\"(<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:email</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:tags</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:another_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>)\"</span>\n    <span class=\"pl-k\">end</span>\n\n    <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-s\">\"INSERT INTO commerces (name, email, title, tags, variant_id, product_id, inventory_id, something_id, another_id, fulfilled, fulfilled_at, deleted_at, created_at, updated_at) \"</span>\\\n      <span class=\"pl-s\">\"VALUES <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">values</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">','</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>\"</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"with Arel\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">columns</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">name</span> <span class=\"pl-s\">email</span> <span class=\"pl-s\">title</span> <span class=\"pl-s\">tags</span> <span class=\"pl-s\">variant_id</span> <span class=\"pl-s\">product_id</span> <span class=\"pl-s\">inventory_id</span> <span class=\"pl-s\">something_id</span> <span class=\"pl-s\">another_id</span> <span class=\"pl-s\">fulfilled</span> <span class=\"pl-s\">fulfilled_at</span> <span class=\"pl-s\">deleted_at</span> <span class=\"pl-s\">created_at</span> <span class=\"pl-s\">updated_at</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">dup</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-s1\">values_list</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">values</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span>\n\n    <span class=\"pl-s1\">sql</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"INSERT INTO <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quoted_table_name</span><span class=\"pl-kos\">}</span></span> (<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">columns</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">','</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>) \"</span>\n    <span class=\"pl-s1\">sql</span> &lt;&lt; <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">visitor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">compile</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Arel</span>::<span class=\"pl-v\">Nodes</span>::<span class=\"pl-v\">ValuesList</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">values_list</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">sql</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">compare!</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\"></p>\n</details> ",
            "url": "https://github.com/rails/rails/pull/52395",
            "title": "Introduce ActiveRecord::Persistance#insert_rows",
            "date_modified": "2024-07-30T07:53:31.000Z",
            "date_published": "2024-07-22T23:36:45.000Z",
            "author": {
                "name": "kirs",
                "url": "https://github.com/kirs"
            }
        }
    ]
}