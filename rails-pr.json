{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50051.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1991817449\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50051\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50051/hovercard\" href=\"https://github.com/rails/rails/issues/50051\">#50051</a>.</p>\n<p dir=\"auto\">The test case is a preceding test case, adapted for this change.</p>",
            "url": "https://github.com/rails/rails/pull/50060",
            "title": "Fix permitting arrays in numbered parameters for `StrongParameters`",
            "date_modified": "2023-11-14T18:00:25.000Z",
            "date_published": "2023-11-14T18:00:21.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/28561?u=095779352a57f75e734987829f3f67a10e5780ed&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">As Active Record relations respond to <code class=\"notranslate\">include?</code>, calling <code class=\"notranslate\">in?</code> will perform a query if the relation hasn't been loaded yet:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"mary = Person.create(name: &quot;Mary&quot;)\n# =&gt; #&lt;Person id: 654, name: &quot;Mary&quot;&gt;\nmary.in?(Person.where(name: &quot;Alice&quot;))\n# SELECT 1 AS one FROM &quot;people&quot; WHERE &quot;people&quot;.&quot;name&quot; =&quot;Alice&quot; ...\"><pre class=\"notranslate\"><span class=\"pl-s1\">mary</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"Mary\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># =&gt; #&lt;Person id: 654, name: \"Mary\"&gt;</span>\n<span class=\"pl-s1\">mary</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">in?</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Person</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"Alice\"</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># SELECT 1 AS one FROM \"people\" WHERE \"people\".\"name\" =\"Alice\" ...</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50059",
            "title": "Document `#in?` can perform queries for Active Record relations",
            "date_modified": "2023-11-14T18:25:17.000Z",
            "date_published": "2023-11-14T17:27:09.000Z",
            "author": {
                "name": "p8",
                "url": "https://github.com/p8"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/19192189?u=dd60737844a9db7f1475bab21fc3e5258a405e15&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Saves a lot of allocations. It's development only though.</p>",
            "url": "https://github.com/rails/rails/pull/50057",
            "title": "Routing::Mapper: Use Thread.each_caller_location if available",
            "date_modified": "2023-11-14T11:47:45.000Z",
            "date_published": "2023-11-14T11:44:48.000Z",
            "author": {
                "name": "casperisfine",
                "url": "https://github.com/casperisfine"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The flexibility provided by <code class=\"notranslate\">config.x</code> supports arbitrarily defining new configuration objects on-the-fly. Each new intermediate configuration object is constructed during chaining from its ancestor through a method invocation made without arguments.</p>\n<p dir=\"auto\">Conversely, writing to leaf configuration values occurs when the invoked method's name ends with <code class=\"notranslate\">=</code>, and the new configuration value is assigned to whatever that method's arguments are.</p>\n<p dir=\"auto\">There are no cases when reading from a <code class=\"notranslate\">config.x</code> value or building the intermediate values<br>\ninvolves arguments.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Prior to this commit, a read invoked with a method arguments would ignore those arguments. While this is robust and error-free, it's possible to obscure misuse.</p>\n<p dir=\"auto\">For example, consider a line like:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"config.x.my_config.enabled = true\nconfig.x.my_config.enabled #=&gt; true\"><pre class=\"notranslate\"><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">my_config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enabled</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">true</span>\n<span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">my_config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enabled</span> <span class=\"pl-c\">#=&gt; true</span></pre></div>\n<p dir=\"auto\">Now consider that first line with a typo that omits the <code class=\"notranslate\">=</code>:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"config.x.my_config.enabled true\nconfig.x.my_config.enabled #=&gt; nil\"><pre class=\"notranslate\"><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">my_config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enabled</span> <span class=\"pl-c1\">true</span>\n<span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">my_config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enabled</span> <span class=\"pl-c\">#=&gt; nil</span></pre></div>\n<p dir=\"auto\">This commit aims to provide more direct feedback for scenarios like the one above. There aren't legitimate use cases for invoking <code class=\"notranslate\">#enabled</code> with arguments, so raise a <code class=\"notranslate\">NoMethodError</code> when encountering a read with arguments.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50050",
            "title": "Raise `NoMethodError` when reading from `config.x` with arguments",
            "date_modified": "2023-11-14T00:31:53.000Z",
            "date_published": "2023-11-14T00:27:01.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/84159?u=611f8cb6bdccc221b89e645b60cb8471d9269ada&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">Problem</h2>\n<p dir=\"auto\">When <a href=\"https://github.com/rails/rails/blob/757f4896417f86b58303e416f4040a2b434abdd6/activerecord/lib/active_record.rb#L208-L213\"><code class=\"notranslate\">ActiveRecord.db_warnings_action</code></a> is set to anything other than <code class=\"notranslate\">:ignore</code>, I would expect that it would <em>always be called</em> when there are warnings.</p>\n<p dir=\"auto\">In MySQL this is not necessarily the case though. In the <code class=\"notranslate\">AbstractMysqlAdapter</code> the warnings are handled in two statements:<br>\n</p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/757f4896417f86b58303e416f4040a2b434abdd6/activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb#L750-L754\">rails/activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 750 to 754\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/757f4896417f86b58303e416f4040a2b434abdd6\">757f489</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L750\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"750\"></td>\n          <td id=\"LC750\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">return</span> <span class=\"pl-k\">if</span> <span class=\"pl-v\">ActiveRecord</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">db_warnings_action</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">nil?</span> || <span class=\"pl-c1\">@raw_connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">warning_count</span> == <span class=\"pl-c1\">0</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L751\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"751\"></td>\n          <td id=\"LC751\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L752\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"752\"></td>\n          <td id=\"LC752\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-c1\">@affected_rows_before_warnings</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">@raw_connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">affected_rows</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L753\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"753\"></td>\n          <td id=\"LC753\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s1\">result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">@raw_connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">query</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"SHOW WARNINGS\"</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L754\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"754\"></td>\n          <td id=\"LC754\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s1\">result</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">each</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">level</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">code</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">message</span>| </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\">Simplified, but the logic is:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"query_result = raw_connection.query(sql)\nif raw_connection.warning_count != 0\n  warning_result = raw_connection.query(&quot;SHOW WARNINGS&quot;)\n  warning_result.each do |warning|\n    ActiveRecord.db_warnings_action(warning)\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-s1\">query_result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">raw_connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">query</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">sql</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">if</span> <span class=\"pl-en\">raw_connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">warning_count</span> != <span class=\"pl-c1\">0</span>\n  <span class=\"pl-s1\">warning_result</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">raw_connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">query</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"SHOW WARNINGS\"</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">warning_result</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">each</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">warning</span>|\n    <span class=\"pl-v\">ActiveRecord</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">db_warnings_action</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">warning</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">So the query returns <code class=\"notranslate\">warning_count</code> as metadata from the result. A second <code class=\"notranslate\">\"SHOW WARNINGS\"</code> query is executed to get the warnings, and is assumed to always be correct. I know of two instances where this will return <code class=\"notranslate\">[]</code> despite <code class=\"notranslate\">warning_count</code> being greater than 0:</p>\n<ul dir=\"auto\">\n<li>If MySQL <code class=\"notranslate\">max_error_count</code> is set to 0, warnings are counted but never persisted, so <code class=\"notranslate\">SHOW WARNINGS</code> is always empty. <a href=\"https://dev.mysql.com/doc/refman/8.0/en/show-warnings.html\" rel=\"nofollow\">(source)</a></li>\n<li>If you are using ProxySQL it does not appear to propagate warnings at all. (see <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"372920090\" data-permission-text=\"Title is private\" data-url=\"https://github.com/sysown/proxysql/issues/1751\" data-hovercard-type=\"issue\" data-hovercard-url=\"/sysown/proxysql/issues/1751/hovercard\" href=\"https://github.com/sysown/proxysql/issues/1751\">sysown/proxysql#1751</a>)</li>\n</ul>\n<p dir=\"auto\">There may be others.</p>\n<p dir=\"auto\">So the behaviour to the user is that even when <code class=\"notranslate\">db_warnings_action</code> is set to something like <code class=\"notranslate\">:raise</code> or a proc, <strong>it is never executed and no warning is ever surfaced</strong>.</p>\n<h2 dir=\"auto\">Solution</h2>\n<p dir=\"auto\">In the case where <code class=\"notranslate\">warning_count</code> is non-zero, but <code class=\"notranslate\">SHOW WARNINGS</code> returns <code class=\"notranslate\">[]</code>, add a single warning with an error message. This isn't a super helpful message, but it is better than silently hiding that any warnings were encountered. This allows the user to update their DB config, or add a custom proc to report on or track warnings as is appropriate for their use case.</p>\n<p dir=\"auto\">I also found that <code class=\"notranslate\">trilogy</code> did not test the warning behaviour at all, so I first added tests for warnings that are essentially copies of what is done in the <code class=\"notranslate\">mysql2</code> tests.</p>\n<h3 dir=\"auto\">Questions</h3>\n<ul dir=\"auto\">\n<li>How is the voice and tone of the error message? I'm not tied to it, but it's the best I could come up with.</li>\n<li>Should I include documentation around <code class=\"notranslate\">db_warnings_action</code> with hints on how to tune the DB to prevent this state from occurring? I don't feel like it's the right place and I'm not sure if we give hints on infra in other places in the docs. Seems too specific and like it would get out of date.</li>\n</ul>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/adrianna-chang-shopify/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/adrianna-chang-shopify\">@adrianna-chang-shopify</a></p>",
            "url": "https://github.com/rails/rails/pull/50049",
            "title": "Handle case in MySQL where the `ActiveRecord.db_warnings_action` is not called even when a DB query has warnings",
            "date_modified": "2023-11-14T15:52:20.000Z",
            "date_published": "2023-11-13T21:31:47.000Z",
            "author": {
                "name": "kmcphillips",
                "url": "https://github.com/kmcphillips"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1371733?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Followup <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1991103105\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50044\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50044/hovercard\" href=\"https://github.com/rails/rails/pull/50044\">#50044</a> cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/jonathanhefner/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jonathanhefner\">@jonathanhefner</a></p>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">if an empty hash is passed to a preview call (<code class=\"notranslate\">blob.preview({})</code>) We go through the original preview instead of regenerating a variation based on the original preview image which would result in a performance penalty.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Calls to <code class=\"notranslate\">#url</code> or <code class=\"notranslate\">#key</code> would now use the original <code class=\"notranslate\">blob.preview_image</code> instead of generating a variant that has an empty transformation.</p>\n<p dir=\"auto\">==&gt; Resulting in saving both a <code class=\"notranslate\">MiniMagic/vips</code> call. + a network/IO call to the storage service</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50046",
            "title": "[ActiveStorage] Prevent `AS::Preview#processed` to generate a variant for an empty transformation",
            "date_modified": "2023-11-14T18:40:03.000Z",
            "date_published": "2023-11-13T19:24:53.000Z",
            "author": {
                "name": "chaadow",
                "url": "https://github.com/chaadow"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1655218?u=e159b7a9f5a2172e4e7e2aed6a9c69ee107b9144&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">I have IoT devices connecting to my Rails app via ActionCable, and I want to log when a device connects or disconnects.</p>\n<p dir=\"auto\">This is already doable via <code class=\"notranslate\">Cahnnel#subscribed</code> and <code class=\"notranslate\">Channel#unsubscribed</code>; and it works pretty well when a device properly connects, subscribes, and disconnects.</p>\n<p dir=\"auto\">But when a device improperly disconnects - e.g. if it gets unplugged from the network - its ActionCable connection doesn't close and can linger in the system for up to half an hour.</p>\n<p dir=\"auto\">This means that the server is using up resources to manage this connection, and send messages to it, when there isn't a client to receive them (since a client will reconnect if it misses 2 heartbeats which is about 6 sec). Some of these issues have been commented on in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1237667974\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45112\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/45112/hovercard\" href=\"https://github.com/rails/rails/issues/45112\">#45112</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"153616312\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/24908\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/24908/hovercard\" href=\"https://github.com/rails/rails/issues/24908\">#24908</a></p>\n<p dir=\"auto\">Currently, ActionCable doesn't have a mechanism to detect if it's connection is half-open (if a there is a client listening on the other end).</p>\n<p dir=\"auto\">This PR changes the protocol so that a client has to respond to a PING message with a PONG message. If it doesn't do so within 2 heartbeats (6 sec) the connection is assumed to be half-open and is closed.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #45112.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1237667974\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45112\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/45112/hovercard\" href=\"https://github.com/rails/rails/issues/45112\">#45112</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #24908.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"153616312\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/24908\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/24908/hovercard\" href=\"https://github.com/rails/rails/issues/24908\">#24908</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #29307.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"232767165\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/29307\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/29307/hovercard\" href=\"https://github.com/rails/rails/issues/29307\">#29307</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes pull request #32828.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"320577446\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/32828\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/32828/hovercard\" href=\"https://github.com/rails/rails/pull/32828\">#32828</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<h4 dir=\"auto\">Why not client-initiated heartbeats?</h4>\n<p dir=\"auto\">I've considered implementing client-initiated heartbeats (<a href=\"https://github.com/monorkin/actioncable-presence-detection-demo/commit/82a851f0de0f8db414e3c8055fa28be4031ffd90\">and did a proof of concept for it</a>) as was suggested in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1237667974\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45112\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/45112/hovercard\" href=\"https://github.com/rails/rails/issues/45112\">#45112</a> and in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"153616312\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/24908\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/24908/hovercard\" href=\"https://github.com/rails/rails/issues/24908\">#24908</a>, but opted for PONG responses because <a href=\"https://developer.chrome.com/blog/timer-throttling-in-chrome-88/\" rel=\"nofollow\">Chrome recently added a feature that throttles setTimeout and setInterval to run at most once a minute if a tab isn't in focus</a>.</p>\n<p dir=\"auto\">This throttling would cause clients to reconnect loop if the half-open threshold is set to below 1 min. And heartbeats with intervals greater than 1 min aren't always desirable, like in my case where I want to know that a device went offline withing seconds. Chrome's throttling also <a href=\"https://github.com/socketio/socket.io/issues/2769#issuecomment-639300952\" data-hovercard-type=\"issue\" data-hovercard-url=\"/socketio/socket.io/issues/2769/hovercard\">prompted socket.io to change it's heartbeat to be server-initated</a>.</p>\n<h4 dir=\"auto\">Backwards and forwards compatibility</h4>\n<p dir=\"auto\">To ensure that clients that <em>don't</em> know about PONG messages can still work with servers that <em>do</em>, and for clients that <em>do</em> know about PONG messages to work with servers that <em>don't</em>; I've created a minor revision of the protocol - <code class=\"notranslate\">actioncable-v1.1-json</code>.</p>\n<p dir=\"auto\">If a client sends that in a <code class=\"notranslate\">Sec-WebSocket-Protocol</code> header to the server and the server responds with <code class=\"notranslate\">actioncable-v1.1-json</code> both the client and server know that they should send and expect PONG messages.</p>\n<p dir=\"auto\">If the client doesn't send <code class=\"notranslate\">Sec-WebSocket-Protocol: actioncable-v1.1-json</code> or the server doesn't respond with <code class=\"notranslate\">Sec-WebSocket-Protocol: actioncable-v1.1-json</code> then the behavior from <code class=\"notranslate\">actioncable-v1-json</code> is used.</p>\n<h4 dir=\"auto\">Why is this logic on the connection object instead of the stream object?</h4>\n<p dir=\"auto\">In <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1237667974\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45112\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/45112/hovercard\" href=\"https://github.com/rails/rails/issues/45112\">#45112</a> there was a suggestion to implement this as a timeout in the event-loop / select-loop.<br>\nFrom my understanding implementing it that way wouldn't be that much different from the implementation in this PR.<br>\nThere would be some kind of last_message_read_at timestamp that's checked in each iteration, and if a threshold is exceeded the socket would be closed.</p>\n<p dir=\"auto\">I implemented everything on the connection object because doimainwise it makes sense to me that a connection keeps the heartbeat and responds to it.</p>\n<p dir=\"auto\">Though I can see the benefits of having everything in the event loop. I have no strong opinion on this.</p>\n<h4 dir=\"auto\">What about dropped message detection from <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"153616312\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/24908\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/24908/hovercard\" href=\"https://github.com/rails/rails/issues/24908\">#24908</a>?</h4>\n<p dir=\"auto\">I've opted not to tackle that in this PR as that seems to be a mini-framework within ActionCable.</p>\n<h4 dir=\"auto\">What about client-side latency measurements from <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"153616312\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/24908\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/24908/hovercard\" href=\"https://github.com/rails/rails/issues/24908\">#24908</a>?</h4>\n<p dir=\"auto\">I've opted not to include that in this PR. But this could probably be done by adding an <code class=\"notranslate\">echo</code> type message, or repurposing <code class=\"notranslate\">ping</code>, that just echos back what the client sends to the server.</p>\n<h4 dir=\"auto\">What about client-set heartbeat frequency from <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"153616312\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/24908\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/24908/hovercard\" href=\"https://github.com/rails/rails/issues/24908\">#24908</a>?</h4>\n<p dir=\"auto\">I've opted not to include that in this PR as it's an unrelated feature to this one.</p>\n<h4 dir=\"auto\">Why not native WebSocket PING and PONG messages like <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"320577446\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/32828\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/32828/hovercard\" href=\"https://github.com/rails/rails/pull/32828\">#32828</a>?</h4>\n<p dir=\"auto\">It currently isn't possible to process native PING and PONG messages in browsers, so an additional sub-protocol level heartbeat would be needed for clients to be able to detect that they have been disconnected. Therefore it makes more sense to have just the one sub-protocol level heartbeat for everything.</p>\n<h4 dir=\"auto\">What about the changelog?</h4>\n<p dir=\"auto\">The CHANGELOG file contains a link to the changes in Rails 7.1. I'm not sure what to do.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50039",
            "title": "Add ability to detect a half-open connection",
            "date_modified": "2023-11-14T05:42:39.000Z",
            "date_published": "2023-11-13T14:54:58.000Z",
            "author": {
                "name": "monorkin",
                "url": "https://github.com/monorkin"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Trying to debug <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1967223028\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49841\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49841/hovercard\" href=\"https://github.com/rails/rails/issues/49841\">#49841</a>.</p>",
            "url": "https://github.com/rails/rails/pull/50037",
            "title": "Debug CI flaky test",
            "date_modified": "2023-11-13T15:55:27.000Z",
            "date_published": "2023-11-13T00:22:44.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/13457494?u=fb7971eda2d2680c27e7d2e5a4db7b430745f04d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50024.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1989345714\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50024\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50024/hovercard\" href=\"https://github.com/rails/rails/issues/50024\">#50024</a></p>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Correctly cast boolean values for mysql to handle boolean filtering in JSON queries.<br>\nMysql doesn't treat '0' or '1' as a boolean in the context of the JSON field. Reference: <a href=\"https://bugs.mysql.com/bug.php?id=90469\" rel=\"nofollow\">https://bugs.mysql.com/bug.php?id=90469</a></p>\n<p dir=\"auto\">Previously, rails used to cast boolean values as 'TRUE' or 'FALSE' but after change introduced in <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/1dc69cab761fbfd46142f70d8ea58a41c6a12c12/hovercard\" href=\"https://github.com/rails/rails/commit/1dc69cab761fbfd46142f70d8ea58a41c6a12c12\"><tt>1dc69ca</tt></a>, this behavior has changed, and boolean casted values are converted into '1' or '0'.</p>\n<p dir=\"auto\">This Pull Request has been created because [REPLACE ME]</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">After the PR, if the bound value is boolean it will be casted to 'TRUE' or 'FALSE'.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50025",
            "title": "[Fix #50024] Correctly cast boolean values for mysql to handle boolean filtering in JSON queries",
            "date_modified": "2023-11-12T10:49:30.000Z",
            "date_published": "2023-11-12T10:49:26.000Z",
            "author": {
                "name": "the-spectator",
                "url": "https://github.com/the-spectator"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22231095?u=fc75f9764434943effe06d6c1dc48d40a5003b0c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><code class=\"notranslate\">uglifier</code> is an outdated and not used in modernjs application instead of that it recommends to use <code class=\"notranslate\">terser</code>.<br>\nref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1049157852\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/43623\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/43623/hovercard\" href=\"https://github.com/rails/rails/pull/43623\">#43623</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request removes <code class=\"notranslate\">uglifier</code> from the guide and test.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50023",
            "title": "Remove uglifier from guide and test",
            "date_modified": "2023-11-13T06:42:27.000Z",
            "date_published": "2023-11-12T07:12:22.000Z",
            "author": {
                "name": "akhilgkrishnan",
                "url": "https://github.com/akhilgkrishnan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49926.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1977782020\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49926\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49926/hovercard\" href=\"https://github.com/rails/rails/issues/49926\">#49926</a>.</p>\n<p dir=\"auto\">Currently, <code class=\"notranslate\">ActiveRecord.dump_schemas</code> (introduced in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"61916304\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/19347\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/19347/hovercard\" href=\"https://github.com/rails/rails/pull/19347\">#19347</a>) is only considered when dumping schema in a <code class=\"notranslate\">:sql</code> format. This PR fixes that by considering it also when dumping in a <code class=\"notranslate\">:ruby</code> format.</p>",
            "url": "https://github.com/rails/rails/pull/50020",
            "title": "Fix schema dumper to account for `ActiveRecord.dump_schemas` when dumping in `:ruby` format",
            "date_modified": "2023-11-13T21:39:15.000Z",
            "date_published": "2023-11-11T19:51:48.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/49003608?u=d6d2cb39cd6e439646f81385c732533a331433f1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created to add a helper method to get a column's comment, instead of reading from <code class=\"notranslate\">columns_hash</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This pull request adds a new method <code class=\"notranslate\">column_comment(column_name)</code> to the <code class=\"notranslate\">model_schema.rb</code> that helps to fetch a column's comment text from the <code class=\"notranslate\">columns_hash</code>. The <code class=\"notranslate\">column_name</code> provided to this method must exist on the table. If it does not exist, an error gets raised.</p>\n<p dir=\"auto\">Currently, to get a column's comment, you'd need to do</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Model.columns_hash['column_name'].comment\"><pre class=\"notranslate\"><span class=\"pl-v\">Model</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">columns_hash</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">'column_name'</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">comment</span></pre></div>\n<p dir=\"auto\">With the changes from this PR, you can now do</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Model.column_comment('column_name')\"><pre class=\"notranslate\"><span class=\"pl-v\">Model</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">column_comment</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'column_name'</span><span class=\"pl-kos\">)</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50019",
            "title": "Add column_comment method to model_schema.rb",
            "date_modified": "2023-11-11T20:09:41.000Z",
            "date_published": "2023-11-11T18:53:23.000Z",
            "author": {
                "name": "Tambiebarango",
                "url": "https://github.com/Tambiebarango"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/10229505?u=2871863a7667f0f4103aebc38dc1cb1835b9a632&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><a href=\"https://www.npmjs.com/package/karma\" rel=\"nofollow\">karma</a> npm package, used in actioncable and actionview, has been stale.</p>\n<p dir=\"auto\">karma 3.x was stable in 2018, but 6.x is now the latest.</p>\n<p dir=\"auto\">This Pull Request has been created because Rails developers are to use the latest karma and latest Node.js (20 LTS or 21).</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request updates karma package from 3.1.4 to 6.4.2, which prevents from using <code class=\"notranslate\">chokidar@2</code> (or <code class=\"notranslate\">fsevents@1</code>).</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">The package was introduced in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"380461495\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/34440\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/34440/hovercard\" href=\"https://github.com/rails/rails/pull/34440\">#34440</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1400973915\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/46206\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/46206/hovercard\" href=\"https://github.com/rails/rails/pull/46206\">#46206</a>. Also this change follows up <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1975819154\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49901\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49901/hovercard\" href=\"https://github.com/rails/rails/pull/49901\">#49901</a> (Node.js 20).</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li>[n/a] Tests are added or updated if you fix a bug or add a feature.</li>\n<li>[n/a] CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50018",
            "title": "test: update karma npm from 3.1.4 to 6.4.2",
            "date_modified": "2023-11-11T15:16:03.000Z",
            "date_published": "2023-11-11T14:53:27.000Z",
            "author": {
                "name": "tnir",
                "url": "https://github.com/tnir"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6979737?u=e5fc89c5f1b12b1fb83f942c742af204df2d1ca1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #26295.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"173580677\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/26295\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/26295/hovercard\" href=\"https://github.com/rails/rails/issues/26295\">#26295</a>. It was closed due to the issue becoming stale, not because it was fixed. It never had a satisfactory fix.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request modifies the order of attribute assignments for associations, e.g. <code class=\"notranslate\">collection.build</code> and <code class=\"notranslate\">build_foo</code>. Previously, if you were to build a record from an association, the attributes derived from the scope would be applied last. This is problematic when a setter on the model expects those scope values to be present, since they were technically defined first. This has bitten me a few times in a multi-tenant application, requiring a workaround where you supply the scope attributes again in <code class=\"notranslate\">#build</code>.</p>\n<p dir=\"auto\">I've tried to make this backwards compatible, by first applying the attributes from the scope via <code class=\"notranslate\">#scope_for_create</code>, then applying the provided attributes to <code class=\"notranslate\">#build</code> minus foreign keys from <code class=\"notranslate\">#scope_for_create</code>, and then finally initializing the record normally.</p>\n<p dir=\"auto\">Here's a small reproduction script of the problem: <a href=\"https://gist.github.com/ezekg/5722f5af2b79061a4f945d49f3ce734b\">https://gist.github.com/ezekg/5722f5af2b79061a4f945d49f3ce734b</a> (modified from <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/heaven/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/heaven\">@heaven</a>'s original reproduction script: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"173580677\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/26295\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/26295/hovercard?comment_id=246189123&amp;comment_type=issue_comment\" href=\"https://github.com/rails/rails/issues/26295#issuecomment-246189123\">#26295 (comment)</a>)</p>\n<p dir=\"auto\">I've written tests that fail without the changes to the <code class=\"notranslate\">#build_record</code> method.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50014",
            "title": "Fix order of scope- vs user-derived attribute assignments",
            "date_modified": "2023-11-10T23:09:32.000Z",
            "date_published": "2023-11-10T23:09:28.000Z",
            "author": {
                "name": "ezekg",
                "url": "https://github.com/ezekg"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/41791?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because there is inconsistent behavior with dirty attributes in transaction callbacks when a record is updated multiple times inside of a transaction.</p>\n<p dir=\"auto\">Consider this case:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class User &lt; ApplicationRecord\n  after_commit :notify_email_changes, if: :email_changed?\n\n  def notify_email_changes\n    NotifyEmailChangesJob.perform_later(id)\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">after_commit</span> <span class=\"pl-pds\">:notify_email_changes</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">if</span>: <span class=\"pl-pds\">:email_changed?</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">notify_email_changes</span>\n    <span class=\"pl-v\">NotifyEmailChangesJob</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">perform_later</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">id</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">This breaks if a record is saved twice in a single transaction.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"user.transaction do\n  user.update!(email: params[:email])\n  if user.last_visited_at &lt; 1.day.ago\n    user.update!(last_visited_at: Time.now)\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">transaction</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">email</span>: <span class=\"pl-en\">params</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:email</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">if</span> <span class=\"pl-en\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">last_visited_at</span> &lt; <span class=\"pl-c1\">1</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">day</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">ago</span>\n    <span class=\"pl-en\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">last_visited_at</span>: <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">In the case where we update the <code class=\"notranslate\">last_visited_at</code> field, the <code class=\"notranslate\">email_changed?</code> method will return false since the email address was not changed in the last save operation and <code class=\"notranslate\">notify_email_changes</code> method will not be called.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49898.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1974877238\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49898\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49898/hovercard\" href=\"https://github.com/rails/rails/issues/49898\">#49898</a>, <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1686385518\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48077\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48077/hovercard\" href=\"https://github.com/rails/rails/issues/48077\">#48077</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes how <code class=\"notranslate\">saved_changes</code> is calculated in transactions when a record is updated multiple times.</p>\n<p dir=\"auto\">After each save operation, the list of saved changes is pushed onto a list. <code class=\"notranslate\">saved_changes</code> in an <code class=\"notranslate\">after_save</code> callback is unaffected and will show only the changes for that save operation.</p>\n<p dir=\"auto\">Before a transaction is committed, the list of saved changes for all saves in the transaction are merged by reapplying them to the original attributes. Checking <code class=\"notranslate\">saved_changes</code> in an <code class=\"notranslate\">after_commit</code> callback will use the merged mutation tracker which includes all changes. Checking <code class=\"notranslate\">saved_changes</code> outside the transaction after it is committed will also include all changes.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50011",
            "title": "Aggregate saved changes for all updates inside of a transaction",
            "date_modified": "2023-11-10T22:07:55.000Z",
            "date_published": "2023-11-10T20:21:35.000Z",
            "author": {
                "name": "bdurand",
                "url": "https://github.com/bdurand"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Introduce Action Text bug report templates for contributors to reproduce issues with failing <code class=\"notranslate\">ActionDispatch::SystemTestCase</code> instances.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\"><strong>Currently, the template test case fails</strong></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Error:\nBugTest#test_Action_Text:\nNameError: undefined local variable or method `new_articles_path' for #&lt;BugTest:0x0000000135db1e48&gt;\n    /Users/seanpdoyle/.asdf/installs/ruby/3.2.0/lib/ruby/gems/3.2.0/bundler/gems/rails-fd20970d6539/actionpack/lib/action_dispatch/system_test_case.rb:185:in `method_missing'\n    guides/bug_report_templates/action_text_main.rb:96:in `block in &lt;class:BugTest&gt;'\"><pre class=\"notranslate\"><code class=\"notranslate\">Error:\nBugTest#test_Action_Text:\nNameError: undefined local variable or method `new_articles_path' for #&lt;BugTest:0x0000000135db1e48&gt;\n    /Users/seanpdoyle/.asdf/installs/ruby/3.2.0/lib/ruby/gems/3.2.0/bundler/gems/rails-fd20970d6539/actionpack/lib/action_dispatch/system_test_case.rb:185:in `method_missing'\n    guides/bug_report_templates/action_text_main.rb:96:in `block in &lt;class:BugTest&gt;'\n</code></pre></div>\n<p dir=\"auto\">I'm not sure why, but the routing helpers are unavailable to the test case.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50010",
            "title": "Add `actiontext` bug report template",
            "date_modified": "2023-11-13T23:46:37.000Z",
            "date_published": "2023-11-10T19:28:54.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1722965?u=48ec2cc360eddee4ae842724533c0c9d82543571&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Implement a :force option to delete cookies not present in the request.</p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This can be useful if you're trying to delete a cookie that has a path, from a different path, in which case it won't be present in the request and won't be deleted if the option is not passed.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49746.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1957056867\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49746\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49746/hovercard\" href=\"https://github.com/rails/rails/issues/49746\">#49746</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds a <code class=\"notranslate\">:force</code> option to <code class=\"notranslate\">cookies.delete</code> that skips checking if the cookie is present before marking it for removal.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">I initially tried simply removing the guard condition altogether (I gave my rationale for this in the linked Issue), but this broke some <code class=\"notranslate\">cookies.clear</code> tests, so I though it should probably be an opt-in behavior through an option.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50007",
            "title": "Implement a `:force` option to delete cookies not present in the request",
            "date_modified": "2023-11-10T22:30:37.000Z",
            "date_published": "2023-11-10T18:09:30.000Z",
            "author": {
                "name": "zavan",
                "url": "https://github.com/zavan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/17757590?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><code class=\"notranslate\">ActiveRecord::Relation</code> <code class=\"notranslate\">where</code> has a nice hash-style interface for forming the <code class=\"notranslate\">where</code> clause.<br>\nThis PR enables a similar style for <code class=\"notranslate\">order</code>, while maintaining all existing functionality.</p>\n<p dir=\"auto\">ActiveRecord::Relation can take a hash where keys are table name, value is a hash of key (column name) and value (order direction). For example:</p>\n<p dir=\"auto\"><code class=\"notranslate\">Topic.includes(:posts).order(posts: { created_at: :desc })</code></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Order can be passed several different arguments today:</p>\n<p dir=\"auto\">a) <code class=\"notranslate\">Topic.includes(:posts).order('posts.created_at')</code><br>\nb) <code class=\"notranslate\">Topic.includes(:posts).order('posts.created_at': :asc)</code><br>\nc) <code class=\"notranslate\">Topic.includes(:posts).order('posts.created_at', { follower_count: :desc }, 'posts.user_id desc' )</code><br>\nd) <code class=\"notranslate\">Topic.includes(:posts).order('posts.user_id', Post.arel_table[:created_at].desc)</code></p>\n<p dir=\"auto\">Each can be written re-written as a more structured hash:</p>\n<p dir=\"auto\">a) <code class=\"notranslate\">Topic.includes(:posts).order(posts: { created_at: :asc })</code><br>\nb) <code class=\"notranslate\">Topic.includes(:posts).order(posts: { created_at: :asc })</code><br>\nc) <code class=\"notranslate\">Topic.includes(:posts).order({ posts: { created_at: :asc } }, { topics: { follower_count: :desc } }, { posts: { user_id: :desc } })</code><br>\nd) <code class=\"notranslate\">Topic.includes(:posts).order(posts: { user_id: :asc, created_at: :desc })</code></p>\n<p dir=\"auto\">Or written in combination with the other existing strategies:</p>\n<p dir=\"auto\">c) <code class=\"notranslate\">Topic.includes(:posts).order('posts.created_at', { follower_count: :desc }, posts: { user_id: :desc})</code><br>\nd) <code class=\"notranslate\">Topic.includes(:posts).order({ posts: { user_id: :asc }}, Post.arel_table[:created_at].desc)</code></p>\n<p dir=\"auto\">It will properly reference table-name keys and maintains checks for directional keywords.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50000",
            "title": "`ActiveRecord::Relation#order` supports hash like `ActiveRecord::Relation#where`",
            "date_modified": "2023-11-10T14:37:57.000Z",
            "date_published": "2023-11-10T13:08:53.000Z",
            "author": {
                "name": "mylesboone",
                "url": "https://github.com/mylesboone"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/259568?u=088346ff0867534d6f143c32b5486953e158a6e4&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This PR adds support for the WITH PARSER option when creating a fulltext index in MYSQL.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes activerecord in order to support passing a <code class=\"notranslate\">with_parser</code> option when creating an index.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49996",
            "title": "Add support for WITH PARSER for full text search indexes",
            "date_modified": "2023-11-10T11:56:43.000Z",
            "date_published": "2023-11-10T11:22:49.000Z",
            "author": {
                "name": "Nerian",
                "url": "https://github.com/Nerian"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/53355525?u=10a9e3a54c30ab19bac03c95acfb7ff211949b1b&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">While I was reading the documentation of ActiveRecord I noticed that the links are not working.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR addresses that issue and changes the links to the right page of the API documentation.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49995",
            "title": "Fix links for the ActiveRecord readme [ci-skip]",
            "date_modified": "2023-11-10T11:10:39.000Z",
            "date_published": "2023-11-10T10:53:06.000Z",
            "author": {
                "name": "laicuRoot",
                "url": "https://github.com/laicuRoot"
            }
        }
    ]
}