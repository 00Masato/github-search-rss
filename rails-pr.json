{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/25400144?u=3ec6854deffaf90c34ee2d55607075164ccfe120&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When a new Rails app was initialized, there is a redundant database package in the test section in the <code class=\"notranslate\">.github/workflows/ci.yml</code> file.</p>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/25400144/337989779-7d5e03e3-e8f7-4b82-a070-4b2dd65c2104.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTc5NzQzODcsIm5iZiI6MTcxNzk3NDA4NywicGF0aCI6Ii8yNTQwMDE0NC8zMzc5ODk3NzktN2Q1ZTAzZTMtZThmNy00YjgyLWEwNzAtNGIyZGQ2NWMyMTA0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA2MDklMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNjA5VDIzMDEyN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZmMmNiOTg2NDI1OWIwOGU3MzNlOThlMzZhZGM5ZjNmMDUyODdiNTVjZmQwMzBjNDliMWRjZmE5MzQzZjdlYjAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.xoqCYymIuJqtjrUONn4Q6krro220PYmuWAfrmDRi4Eg\"><img width=\"1413\" alt=\"image\" src=\"https://private-user-images.githubusercontent.com/25400144/337989779-7d5e03e3-e8f7-4b82-a070-4b2dd65c2104.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTc5NzQzODcsIm5iZiI6MTcxNzk3NDA4NywicGF0aCI6Ii8yNTQwMDE0NC8zMzc5ODk3NzktN2Q1ZTAzZTMtZThmNy00YjgyLWEwNzAtNGIyZGQ2NWMyMTA0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA2MDklMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNjA5VDIzMDEyN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZmMmNiOTg2NDI1OWIwOGU3MzNlOThlMzZhZGM5ZjNmMDUyODdiNTVjZmQwMzBjNDliMWRjZmE5MzQzZjdlYjAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.xoqCYymIuJqtjrUONn4Q6krro220PYmuWAfrmDRi4Eg\" style=\"max-width: 100%;\"></a>\n<p dir=\"auto\">I found that the reason is that <code class=\"notranslate\">database.base_package</code> has been added in <code class=\"notranslate\">dockerfile_base_packages</code> (if not skipping ActiveRecord), because of this, the append in <code class=\"notranslate\">ci.yml</code> is unnecessary.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52069",
            "title": "remove redundant database package from ci.yml.tt template",
            "date_modified": "2024-06-09T16:11:01.000Z",
            "date_published": "2024-06-09T16:10:57.000Z",
            "author": {
                "name": "otorain",
                "url": "https://github.com/otorain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/743879?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The documentation on <code class=\"notranslate\">ActiveSupport::MessageVerifier</code> uses “sensitive data” string as an example of a message to sign/verify; that wording might induce the developer to think we’re dealing with encryption, while the payload is actually only Base64 encoded so it's actually cleartext and can be decoded by anyone.</p>\n<p dir=\"auto\">Actually, the fact that the signed string is base64 encoded and that the <code class=\"notranslate\">MessageVerifier</code> works with \"keys\" (the current docs even state about Key Rotation) might further cause the wrong impression in the developer that there's some encryption going on, whilst there is absolutely none.</p>\n<p dir=\"auto\">We add a reference to <code class=\"notranslate\">MessageEncryptor</code> to let the developer knows that, if he needs the payload to be encrypted, Rails already has that taken care of.</p>\n<p dir=\"auto\">Finally, we also improve the documentation on <code class=\"notranslate\">ActiveRecord::SignedId</code>, which uses <code class=\"notranslate\">MessageVerifier</code> and thereby will also expose the ID as encoded cleartext; we make it explicit that it’s not encryption, only signing, so the ID, albeit tamper proof, will be able to be read in cleartext by anyone.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">While working on this, I felt the desire to have <code class=\"notranslate\">ActiveRecord::EncryptedId</code>.</p>\n<p dir=\"auto\">It would behave just like <code class=\"notranslate\">ActiveRecord::SignedId</code> does, but it would use <code class=\"notranslate\">MessageEncryptor</code> instead of <code class=\"notranslate\">MessageVerifier</code>, so that the IDs would never be exposed.</p>\n<p dir=\"auto\">The API would respect the parity, so we would have <code class=\"notranslate\">user.encrypted_id</code> and <code class=\"notranslate\">User.find_encrypted(encrypted_id)</code>.</p>\n<p dir=\"auto\">I recently opened issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2341850532\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52063\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52063/hovercard\" href=\"https://github.com/rails/rails/issues/52063\">#52063</a> to discuss the last missing piece that I would use to implement <code class=\"notranslate\">ActiveRecord::EncryptedId</code>; I know this PR is just regarding documentation, but if any members could indicate if a PR for <code class=\"notranslate\">ActiveRecord::EncryptedId</code> had a chance of being accepted I would start working on it as soon as I could spare the time.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li>[ x] Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52064",
            "title": "[ci skip] Improve ActiveSupport::MessageVerifier and ActiveRecord::SignedId docs",
            "date_modified": "2024-06-09T10:59:38.000Z",
            "date_published": "2024-06-08T23:00:27.000Z",
            "author": {
                "name": "feliperaul",
                "url": "https://github.com/feliperaul"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The <a href=\"https://github.com/rails/rails/commit/0c76f17f2dbf0d7ad90c890e6f334743cacce41f\">deprecated secrets removal</a> ended up removing a bit of non-deprecated functionality related to config.secret_key_base:</p>\n<ul dir=\"auto\">\n<li>the original implementation prioritized the value of config.secret_key_base over other sources in all environments</li>\n<li>if unset, the value of config.secret_key_base would be updated to whichever fallback value was found</li>\n</ul>\n<p dir=\"auto\">The new implementation only sets config.secret_key_base to a fallback value when Rails.env.local?, and never considers it at all in production.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit aims to restore this missing functionality as well as simplify the implementation:</p>\n<ul dir=\"auto\">\n<li>Rails.application.secret_key_base now always delegates to config.secret_key_base (like the pre-secret-removal implementation)</li>\n<li>secret_key_base validation was moved from the reader to the writer</li>\n<li>config.secret_key_base now handles setting itself to a fallback value when unset</li>\n<li>In addition, generate_local_secret was simplified because it previously did 3 things: file manipulation, setting config.secret_key_base, and returning a value. Now it only creates the file if necessary and returns the value stored in it</li>\n</ul>\n<p dir=\"auto\">The new implementation has an additional benefit, which is that manually set config.secret_key_base values are now validated, whereas previously only fallback values were validated.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Add it back with a test</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52062",
            "title": "Restore some config.secret_key_base functionality",
            "date_modified": "2024-06-08T19:52:05.000Z",
            "date_published": "2024-06-08T15:00:53.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/12777550?u=415303ec1c626279c440cf729435fc0ee833d1c9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51817.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2295142022\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51817\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51817/hovercard\" href=\"https://github.com/rails/rails/issues/51817\">#51817</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Currently, Rails doesn't have a mechanism to allow the main record to efficiently access its <code class=\"notranslate\">has_one :through</code> associations via the middle record.</p>\n<p dir=\"auto\">When we define a <code class=\"notranslate\">has_one :through</code> association, Rails creates a <code class=\"notranslate\">HasOneThroughAssociation</code> object within that record. Like all other Association objects, <code class=\"notranslate\">HasOneThroughAssociation</code> works independently and doesn't check the loading status of other associations. If it doesn't find the record within the object itself, it simply queries the database. And this triggers an additional query even when all associated records are preloaded.</p>\n<p dir=\"auto\">On top of that, making another query for an already loaded association results in having two identical records in memory. This can confuse developers about which record is the single source of truth. When one record is updated, the other remains unchanged. Here is an example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"member.membership.club.name = 'New Club'\n\nmember.membership.club.name # =&gt; 'New Club'\nmember.club.name            # =&gt; 'Old Club'\"><pre class=\"notranslate\"><span class=\"pl-en\">member</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">membership</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">club</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">'New Club'</span>\n\n<span class=\"pl-en\">member</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">membership</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">club</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span> <span class=\"pl-c\"># =&gt; 'New Club'</span>\n<span class=\"pl-en\">member</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">club</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span>            <span class=\"pl-c\"># =&gt; 'Old Club'</span></pre></div>\n<p dir=\"auto\">The changes prevent the additional query and ensure there is a single source of truth.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">I tried to apply the same approach to the <code class=\"notranslate\">has_many :through</code> association, but it is not as straightforward as the <code class=\"notranslate\">has_one :through</code> association. All the final records are stored in each middle record's association object. So, we need to find a better way to implement this. I will look into this more and create another PR if I find a solution.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52060",
            "title": "[Fix #51817] Allow a preloaded association to be accessed without querying the database",
            "date_modified": "2024-06-08T13:02:16.000Z",
            "date_published": "2024-06-08T11:11:29.000Z",
            "author": {
                "name": "Jay0921",
                "url": "https://github.com/Jay0921"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52051.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2341068288\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52051\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52051/hovercard\" href=\"https://github.com/rails/rails/issues/52051\">#52051</a> (see there for a problem description and lengthy discussion).</p>",
            "url": "https://github.com/rails/rails/pull/52059",
            "title": "Explicitly load Active Record associations related errors",
            "date_modified": "2024-06-08T11:37:58.000Z",
            "date_published": "2024-06-08T09:57:04.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14007?u=7d74620cf38d2057b13e9cbb7ee8c6ae35c1d019&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52000.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2330195177\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52000\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52000/hovercard\" href=\"https://github.com/rails/rails/issues/52000\">#52000</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52054",
            "title": "Document TestFixtures#fixture",
            "date_modified": "2024-06-09T21:59:34.000Z",
            "date_published": "2024-06-08T02:38:32.000Z",
            "author": {
                "name": "justinko",
                "url": "https://github.com/justinko"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/83998?u=8bb33de7a19d113d9f589689f6d15bb622b132bd&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">There are many cases when using double quotes is necessary to properly identify type &amp; column names in PostgreSQL. This PR aims to address one subset of cases relating to Rails's support of PG Enums in <code class=\"notranslate\">schema.rb</code>.</p>\n<p dir=\"auto\">(If this change is accepted, I have additional cases I would propose in follow-up PRs, but I am focusing on one change at a time.)</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Note that I'm using <code class=\"notranslate\">.</code> here as an example, but there are other reasons why quote identifiers can be necessary, including case sensitivity.</p>\n<h4 dir=\"auto\">Before:</h4>\n<p dir=\"auto\"><em>Without</em> this PR's changes, the following migration:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create_enum '&quot;my.status&quot;', %w[complete in_progress]\ncreate_table :things do |t|\n  t.enum :status, enum_type: '&quot;my.status&quot;', default: &quot;in_progress&quot;, null: false\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">create_enum</span> <span class=\"pl-s\">'\"my.status\"'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">complete</span> <span class=\"pl-s\">in_progress</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:things</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:status</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">enum_type</span>: <span class=\"pl-s\">'\"my.status\"'</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">Produces the following in the <code class=\"notranslate\">schema.rb</code> file:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create_enum &quot;my.status&quot;, [&quot;complete&quot;, &quot;in_progress&quot;]\n\ncreate_table &quot;things&quot;, force: :cascade do |t|\n  t.enum &quot;status&quot;, default: &quot;in_progress&quot;, null: false, enum_type: &quot;&quot;my.status&quot;&quot;\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">create_enum</span> <span class=\"pl-s\">\"my.status\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"complete\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">]</span>\n\n<span class=\"pl-en\">create_table</span> <span class=\"pl-s\">\"things\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-pds\">:cascade</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enum</span> <span class=\"pl-s\">\"status\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">enum_type</span>: <span class=\"pl-s\">\"\"</span><span class=\"pl-en\">my</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">status</span><span class=\"pl-s\">\"\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">🐛 Both the <code class=\"notranslate\">create_enum</code> statement and the <code class=\"notranslate\">:enum_type</code> option do not function as expected. The former produces a <code class=\"notranslate\">PG::InvalidSchemaName</code> error (because it assumes <code class=\"notranslate\">my.</code> is a PG schema), and the latter is not even valid Ruby.</p>\n<h4 dir=\"auto\">After:</h4>\n<p dir=\"auto\"><em>With</em> this PR's changes, <code class=\"notranslate\">schema.rb</code> contains the following:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create_enum &quot;\\&quot;my.status\\&quot;&quot;, [&quot;complete&quot;, &quot;in_progress&quot;]\n\ncreate_table &quot;things&quot;, force: :cascade do |t|\n  t.enum &quot;status&quot;, default: &quot;in_progress&quot;, null: false, enum_type: &quot;\\&quot;my.status\\&quot;&quot;\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">create_enum</span> <span class=\"pl-s\">\"<span class=\"pl-cce\">\\\"</span>my.status<span class=\"pl-cce\">\\\"</span>\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"complete\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">]</span>\n\n<span class=\"pl-en\">create_table</span> <span class=\"pl-s\">\"things\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-pds\">:cascade</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enum</span> <span class=\"pl-s\">\"status\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">enum_type</span>: <span class=\"pl-s\">\"<span class=\"pl-cce\">\\\"</span>my.status<span class=\"pl-cce\">\\\"</span>\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">This should resolve cases where quote identifiers are necessary, without impacting cases where they are not <em>strictly</em> necessary.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52049",
            "title": "[ActiveRecord] Support PG enums with names that require quote-ident",
            "date_modified": "2024-06-07T21:27:08.000Z",
            "date_published": "2024-06-07T19:03:28.000Z",
            "author": {
                "name": "smudge",
                "url": "https://github.com/smudge"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This commit aims to clarify the types of arguments mentioned by the Association Callback documentation. In some cases, <code class=\"notranslate\">firm</code> arguments implied the object was a <code class=\"notranslate\">Firm</code>, but <code class=\"notranslate\">record</code> arguments did not imply any particular class.</p>\n<p dir=\"auto\">Similarly, the <code class=\"notranslate\">has_many</code> method documentation did not mention any of the Association Callback arguments (i.e. <code class=\"notranslate\">before_add</code>, <code class=\"notranslate\">after_add</code>, <code class=\"notranslate\">before_remove</code>, <code class=\"notranslate\">after_remove</code>). This commit includes those options in the list and links to the more thorough documentation under the Association Callbacks heading.</p>",
            "url": "https://github.com/rails/rails/pull/52047",
            "title": "Improve Active Record Association Callbacks docs [ci skip]",
            "date_modified": "2024-06-08T11:23:52.000Z",
            "date_published": "2024-06-07T17:51:03.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Based off the IRB tests: <a href=\"https://github.com/ruby/irb/blob/master/test/irb/helper.rb#L112-L120\">https://github.com/ruby/irb/blob/master/test/irb/helper.rb#L112-L120</a></p>\n<p dir=\"auto\">For example if you add this to your <code class=\"notranslate\">~/.irbrc</code>:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"IRB.conf[:PROMPT_MODE] = :SIMPLE\"><pre class=\"notranslate\"><code class=\"notranslate\">IRB.conf[:PROMPT_MODE] = :SIMPLE\n</code></pre></div>\n<p dir=\"auto\">This will result in the following test failures:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"F\n\nFailure:\nFullStackConsoleTest#test_prompt_allows_changing_irb_name [test/application/console_test.rb:32]:\n&quot;foo(test)&gt;&quot; expected, but got:\n\n&gt;&gt; a = 1\na = 1\n=&gt; ...\n&gt;&gt; .\nExpected &quot;&gt;&gt; a = 1\\r\\r\\na = 1\\r\\n=&gt; ...\\r\\n&gt;&gt; &quot; to include &quot;foo(test)&gt;&quot;.\n\nbin/test test/application/console_test.rb:120\n\n.............F\n\nFailure:\nFullStackConsoleTest#test_test_console_prompt [test/application/console_test.rb:32]:\n&quot;app-template(test)&gt; &quot; expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected &quot;\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; &quot; to include &quot;app-template(test)&gt; &quot;.\n\nbin/test test/application/console_test.rb:152\n\n...F\n\nFailure:\nFullStackConsoleTest#test_prompt_is_properly_set [test/application/console_test.rb:32]:\n&quot;app-template(test)&gt;&quot; expected, but got:\n\n&gt;&gt; a = 1\na = 1\n=&gt; ...\n&gt;&gt; .\nExpected &quot;&gt;&gt; a = 1\\r\\r\\na = 1\\r\\n=&gt; ...\\r\\n&gt;&gt; &quot; to include &quot;app-template(test)&gt;&quot;.\n\nbin/test test/application/console_test.rb:113\n\nF\n\nFailure:\nFullStackConsoleTest#test_production_console_prompt [test/application/console_test.rb:32]:\n&quot;app-template(prod)&gt;&quot; expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected &quot;\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; &quot; to include &quot;app-template(prod)&gt;&quot;.\n\nbin/test test/application/console_test.rb:138\n\n...F\n\nFailure:\nFullStackConsoleTest#test_development_console_prompt [test/application/console_test.rb:32]:\n&quot;app-template(dev)&gt; &quot; expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected &quot;\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; &quot; to include &quot;app-template(dev)&gt; &quot;.\n\nbin/test test/application/console_test.rb:145\n\nFinished in 137.655994s, 0.1743 runs/s, 1.8815 assertions/s.\n24 runs, 259 assertions, 5 failures, 0 errors, 0 skips\"><pre class=\"notranslate\"><code class=\"notranslate\">F\n\nFailure:\nFullStackConsoleTest#test_prompt_allows_changing_irb_name [test/application/console_test.rb:32]:\n\"foo(test)&gt;\" expected, but got:\n\n&gt;&gt; a = 1\na = 1\n=&gt; ...\n&gt;&gt; .\nExpected \"&gt;&gt; a = 1\\r\\r\\na = 1\\r\\n=&gt; ...\\r\\n&gt;&gt; \" to include \"foo(test)&gt;\".\n\nbin/test test/application/console_test.rb:120\n\n.............F\n\nFailure:\nFullStackConsoleTest#test_test_console_prompt [test/application/console_test.rb:32]:\n\"app-template(test)&gt; \" expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected \"\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; \" to include \"app-template(test)&gt; \".\n\nbin/test test/application/console_test.rb:152\n\n...F\n\nFailure:\nFullStackConsoleTest#test_prompt_is_properly_set [test/application/console_test.rb:32]:\n\"app-template(test)&gt;\" expected, but got:\n\n&gt;&gt; a = 1\na = 1\n=&gt; ...\n&gt;&gt; .\nExpected \"&gt;&gt; a = 1\\r\\r\\na = 1\\r\\n=&gt; ...\\r\\n&gt;&gt; \" to include \"app-template(test)&gt;\".\n\nbin/test test/application/console_test.rb:113\n\nF\n\nFailure:\nFullStackConsoleTest#test_production_console_prompt [test/application/console_test.rb:32]:\n\"app-template(prod)&gt;\" expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected \"\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; \" to include \"app-template(prod)&gt;\".\n\nbin/test test/application/console_test.rb:138\n\n...F\n\nFailure:\nFullStackConsoleTest#test_development_console_prompt [test/application/console_test.rb:32]:\n\"app-template(dev)&gt; \" expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected \"\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; \" to include \"app-template(dev)&gt; \".\n\nbin/test test/application/console_test.rb:145\n\nFinished in 137.655994s, 0.1743 runs/s, 1.8815 assertions/s.\n24 runs, 259 assertions, 5 failures, 0 errors, 0 skips\n</code></pre></div>",
            "url": "https://github.com/rails/rails/pull/52045",
            "title": "Avoid running console tests against users IRB config",
            "date_modified": "2024-06-08T10:48:48.000Z",
            "date_published": "2024-06-07T11:21:08.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This PR replaces <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2335914495\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52026\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52026/hovercard\" href=\"https://github.com/rails/rails/pull/52026\">#52026</a> by fixing the <code class=\"notranslate\">caller_locations</code>.</p>\n<p dir=\"auto\">Before:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"(called from include at /home/wojtek/.asdf/installs/ruby/3.3.2/lib/ruby/gems/3.3.0/gems/railties-7.2.0.beta2/lib/rails/console/methods.rb:6)\"><pre class=\"notranslate\"><code class=\"notranslate\">(called from include at /home/wojtek/.asdf/installs/ruby/3.3.2/lib/ruby/gems/3.3.0/gems/railties-7.2.0.beta2/lib/rails/console/methods.rb:6)\n</code></pre></div>\n<p dir=\"auto\">After:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"(called from block in &lt;class:Engine&gt; at /home/zzak/.rbenv/versions/3.4.0/lib/ruby/gems/3.4.0+0/bundler/gems/mission_control-jobs-7295d75ed735/lib/mission_control/jobs/engine.rb:73)\"><pre class=\"notranslate\"><code class=\"notranslate\">(called from block in &lt;class:Engine&gt; at /home/zzak/.rbenv/versions/3.4.0/lib/ruby/gems/3.4.0+0/bundler/gems/mission_control-jobs-7295d75ed735/lib/mission_control/jobs/engine.rb:73)\n</code></pre></div>",
            "url": "https://github.com/rails/rails/pull/52040",
            "title": "Rails::ConsoleMethods deprecation warning should point to the source",
            "date_modified": "2024-06-08T10:55:12.000Z",
            "date_published": "2024-06-07T03:00:10.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1034?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">I realised that <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2329736976\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51994\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51994/hovercard\" href=\"https://github.com/rails/rails/pull/51994\">#51994</a> was producing a deprecation warning while running the Active Record tests (I actually thought we'd made that fail CI, but I must be mis-remembering).</p>\n<p dir=\"auto\">While we could just explicitly opt in to the new setting within our test suite(s), I wanted to see if we could save similar callers [i.e. those that aren't particularly concerned with time zones] from having to know about / act upon the change at all.</p>\n<p dir=\"auto\">Mostly that comes down to the fact that for <code class=\"notranslate\">Time#to_time</code>, if the value is already a local time, there's no difference in behaviour, and so no need to warn.</p>\n<p dir=\"auto\">Correspondingly, I've avoided calling <code class=\"notranslate\">to_time</code> in the handful of places we were using it internally: it's easy to do, and we know we don't care about the zone, so again won't be affected by the change.</p>\n<p dir=\"auto\">I'm hoping this will mean that people who do see the deprecation are likely to actually be affected [or at least be genuinely at risk of being affected] by the change, thus justifying the disruption.</p>\n<p dir=\"auto\">It's worth noting that I currently have <em>not</em> changed <code class=\"notranslate\">ActiveSupport::TimeWithZone#to_time</code>: even when its zone matches local (including the most common case where both are UTC), we will still warn. That felt like the right choice at the time, though I'm now less sure... <code class=\"notranslate\">3.days.ago.to_time</code> seems like a pretty reasonable and ordinary thing to be doing, and (in the absence of any zone-related configuration) I believe it should be perfectly safe. 🤔</p>",
            "url": "https://github.com/rails/rails/pull/52031",
            "title": "Don't emit to_time deprecations in known-safe contexts",
            "date_modified": "2024-06-06T09:16:31.000Z",
            "date_published": "2024-06-06T09:16:27.000Z",
            "author": {
                "name": "matthewd",
                "url": "https://github.com/matthewd"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1034?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Alternate take on <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2332727777\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52016\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52016/hovercard\" href=\"https://github.com/rails/rails/pull/52016\">#52016</a></p>\n<p dir=\"auto\">Instead of a proxy object representing the always-instantaneous transaction state, here I'm going the other way, and giving the user an object that will always reference the <em>current</em> state of the then-current transaction at the time of creation.</p>\n<p dir=\"auto\">That means it will behave reasonably even if they do something thoroughly unreasonable, like add a callback after the transaction has already committed / rolled back.</p>\n<p dir=\"auto\">Definitely needs some tidying to be mergeable: at minimum I've lost the callback docs by moving them into a nodoc class -- and I haven't added tests that show the ways this differs from current HEAD behaviour.</p>",
            "url": "https://github.com/rails/rails/pull/52017",
            "title": "Allow users to add transaction callbacks after commit etc",
            "date_modified": "2024-06-04T19:21:41.000Z",
            "date_published": "2024-06-04T07:58:28.000Z",
            "author": {
                "name": "matthewd",
                "url": "https://github.com/matthewd"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14981592?u=11406fb0121b15a93b3305388377a57b4d9c96f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Followup to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2326434456\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51959\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51959/hovercard\" href=\"https://github.com/rails/rails/pull/51959\">#51959</a>. The test I added in that PR can be improved by actually checking that the runner does what the expected behaviour is.</p>\n<p dir=\"auto\">Since support for minitest/spec should not be implied (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2326434456\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51959\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51959/hovercard?comment_id=1621385796&amp;comment_type=review_comment\" href=\"https://github.com/rails/rails/pull/51959#discussion_r1621385796\">#51959 (comment)</a>) I also slightly modified the test above</p>",
            "url": "https://github.com/rails/rails/pull/52002",
            "title": "Add a proper test for running tests by line with custom method",
            "date_modified": "2024-06-03T10:28:09.000Z",
            "date_published": "2024-06-03T10:28:04.000Z",
            "author": {
                "name": "Earlopain",
                "url": "https://github.com/Earlopain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2853450?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51995.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2329813988\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51995\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51995/hovercard\" href=\"https://github.com/rails/rails/issues/51995\">#51995</a></p>\n<p dir=\"auto\">Calling <code class=\"notranslate\">exists?</code> does not work with composite keys (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2179081656\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51295\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51295/hovercard\" href=\"https://github.com/rails/rails/issues/51295\">#51295</a>) which is used internally for <code class=\"notranslate\">include?</code> here it zips the primary key values into a hash with the primary key keys, a format that is supported by <code class=\"notranslate\">exists?</code> so it does not raise and returns the expected result.</p>",
            "url": "https://github.com/rails/rails/pull/51996",
            "title": "Fix `include?` on composite key relations",
            "date_modified": "2024-06-03T08:15:16.000Z",
            "date_published": "2024-06-02T18:54:30.000Z",
            "author": {
                "name": "jackozi",
                "url": "https://github.com/jackozi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39144575?u=27bc8b51723fcd8f9a2de237a4082ecb370f0a59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Following up <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/317465a4a8f8c0ebaf9534921350c4540584c03c/hovercard\" href=\"https://github.com/rails/rails/commit/317465a4a8f8c0ebaf9534921350c4540584c03c\"><tt>317465a</tt></a>.</p>",
            "url": "https://github.com/rails/rails/pull/51993",
            "title": "Fix test title mismatch",
            "date_modified": "2024-06-02T01:59:18.000Z",
            "date_published": "2024-06-02T01:59:14.000Z",
            "author": {
                "name": "wonda-tea-coffee",
                "url": "https://github.com/wonda-tea-coffee"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This is to mitigate errors like:<br>\n<a href=\"https://buildkite.com/rails/rails/builds/107403#018f9917-fd63-4701-9620-f9caf2caaf2d/1163-1195\" rel=\"nofollow\">https://buildkite.com/rails/rails/builds/107403#018f9917-fd63-4701-9620-f9caf2caaf2d/1163-1195</a></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ERROR [karma-server]:\nError: [init({...}})] The environment you requested was unavailable.\"><pre class=\"notranslate\"><code class=\"notranslate\">ERROR [karma-server]:\nError: [init({...}})] The environment you requested was unavailable.\n</code></pre></div>\n<p dir=\"auto\">We can make buildkite-config retry this status and soft-fail on exit 3.</p>\n<p dir=\"auto\">For example,<br>\n<a href=\"https://buildkite.com/changelog/56-command-steps-can-now-be-made-to-soft-fail\" rel=\"nofollow\">https://buildkite.com/changelog/56-command-steps-can-now-be-made-to-soft-fail</a></p>\n<p dir=\"auto\">I <em>think</em> we can combine this with a retry policy on the exit status:<br>\n<a href=\"https://buildkite.com/docs/pipelines/command-step#retry-attributes-automatic-retry-attributes\" rel=\"nofollow\">https://buildkite.com/docs/pipelines/command-step#retry-attributes-automatic-retry-attributes</a></p>\n<p dir=\"auto\">/cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a></p>",
            "url": "https://github.com/rails/rails/pull/51990",
            "title": "Exit status 3 when Action Cable integration tests fail due to Saucelabs error",
            "date_modified": "2024-06-01T10:45:18.000Z",
            "date_published": "2024-06-01T10:44:54.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">I saw a few times <code class=\"notranslate\">.exists?</code>(instead of <code class=\"notranslate\">.any?</code>) being used on loaded relations.<br>\nSeems like there is no reason why we can't improve that method?</p>\n<p dir=\"auto\">This is a reworked <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2327575420\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51966\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51966/hovercard\" href=\"https://github.com/rails/rails/pull/51966\">#51966</a>.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a></p>",
            "url": "https://github.com/rails/rails/pull/51987",
            "title": "Optimize `ActiveRecord::Relation#exists?` with no conditions for loaded relations",
            "date_modified": "2024-06-01T09:24:33.000Z",
            "date_published": "2024-06-01T09:24:29.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/44903779?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Sometimes when call stored attribute, it requires specific naming semantics. For example when you save some data from external source. This Pull Request adds mapping for store attribute keys</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Proposed changes</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class User &lt; ApplicationRecord\n  store_accessor :settings, :language, { country: :country_of_residence }\nend\n\nuser = User.new(country: &quot;US&quot;)\nuser.country # =&gt; &quot;US&quot;\nuser.settings[&quot;country_of_residence&quot;] # =&gt; &quot;US&quot;\nuser.settings[&quot;country_of_residence&quot;] = &quot;CA&quot;\nuser.country # =&gt; &quot;CA&quot;\nuser.country = &quot;NL&quot;\nuser.country # =&gt; &quot;NL&quot;\nuser.settings[&quot;country_of_residence&quot;] # =&gt; &quot;NL&quot;\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">store_accessor</span> <span class=\"pl-pds\">:settings</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:language</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">country</span>: <span class=\"pl-pds\">:country_of_residence</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">user</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">country</span>: <span class=\"pl-s\">\"US\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">country</span> <span class=\"pl-c\"># =&gt; \"US\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">settings</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"country_of_residence\"</span><span class=\"pl-kos\">]</span> <span class=\"pl-c\"># =&gt; \"US\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">settings</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"country_of_residence\"</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"CA\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">country</span> <span class=\"pl-c\"># =&gt; \"CA\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">country</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"NL\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">country</span> <span class=\"pl-c\"># =&gt; \"NL\"</span>\n<span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">settings</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">\"country_of_residence\"</span><span class=\"pl-kos\">]</span> <span class=\"pl-c\"># =&gt; \"NL\"</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">This was intended as non-breaking change</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51981",
            "title": "Add mapping to stored attributes",
            "date_modified": "2024-06-03T22:49:41.000Z",
            "date_published": "2024-06-01T00:48:08.000Z",
            "author": {
                "name": "mechnicov",
                "url": "https://github.com/mechnicov"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5077225?u=e9f968c9eb790ee7734442f6b7998155400ad1d8&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">As detailed in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2044839875\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50370\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50370/hovercard\" href=\"https://github.com/rails/rails/pull/50370\">#50370</a>, the current use of SQLite's <code class=\"notranslate\">busy_timeout</code> functionality leads to notable increases in tail latency as well as occasional <code class=\"notranslate\">SQLite3::BusyException: database is locked</code> errors since it does not release the GVL while waiting to retry acquiring the SQLite database lock. Version 2.0 of the <code class=\"notranslate\">sqlite3</code> gem introduces a new <a href=\"https://github.com/sparklemotion/sqlite3-ruby/pull/456\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/sparklemotion/sqlite3-ruby/pull/456/hovercard\"><code class=\"notranslate\">SQLite3::Database#busy_handler_timeout=</code> method</a>, which provides a non-GVL-blocking, fair retry interval busy handler implementation.</p>\n<p dir=\"auto\">cc: <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/flavorjones/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/flavorjones\">@flavorjones</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/tenderlove/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/tenderlove\">@tenderlove</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR points the <code class=\"notranslate\">timeout</code> option the <code class=\"notranslate\">database.yml</code> config file at this new busy handler implementation. In order to ensure that this new method is present, I have also opened <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2326400791\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51957\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51957/hovercard\" href=\"https://github.com/rails/rails/pull/51957\">#51957</a> so that Rails 8 defaults to version &gt;= 2.0 for the <code class=\"notranslate\">sqlite3</code> gem.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">As detailed in <a href=\"https://fractaledmind.github.io/2024/04/15/sqlite-on-rails-the-how-and-why-of-optimal-performance/\" rel=\"nofollow\">my deep dive</a> on this topic, having such a busy handler is essential for running production-grade Rails application using SQLite. In my benchmarks, ensuring that the busy handler doesn't hold the GVL brought p95 latency down from &gt;5s to 0.19s. Then, ensuring that the retry interval was fair for both \"old\" and \"new\" queries brought p99.99 latency down from &gt;1.5s to 0.5s.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51958",
            "title": "SQLite non-GVL-blocking, fair retry interval busy handler",
            "date_modified": "2024-06-04T08:09:25.000Z",
            "date_published": "2024-05-30T19:39:08.000Z",
            "author": {
                "name": "fractaledmind",
                "url": "https://github.com/fractaledmind"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/64581?u=d8cec29b4b85089fa2c833d59f2f3c3cb9f9705d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">ActiveStorage currently allows variants to be created on demand (by default) or in the background (using preprocessed). This can be problematic for applications that have a lot of traffic. Immediately after an attachment is created, thousands of requests could be created for a single variant. Each controller receiving the request as well as a background job could all be racing to create the variant.</p>\n<p dir=\"auto\">In order to give more control variant creation, we are proposing an immediate option to allow variants to be created simultaneously with the attachment.</p>\n<p dir=\"auto\">This Pull Request has been created because products like ours need more control over variant creation.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes introduces the <code class=\"notranslate\">immediate</code> option and follows the existing patterns around <code class=\"notranslate\">preprocessed</code>.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  has_one_attached :avatar_with_immediate do |attachable|\n    attachable.variant :thumb, resize_to_limit: [4, 4], immediate: true\n  end\"><pre class=\"notranslate\"><code class=\"notranslate\">  has_one_attached :avatar_with_immediate do |attachable|\n    attachable.variant :thumb, resize_to_limit: [4, 4], immediate: true\n  end\n</code></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51951",
            "title": "`ActiveStorage` immediate variants",
            "date_modified": "2024-06-04T18:31:19.000Z",
            "date_published": "2024-05-30T13:41:48.000Z",
            "author": {
                "name": "tomrossi7",
                "url": "https://github.com/tomrossi7"
            }
        }
    ]
}