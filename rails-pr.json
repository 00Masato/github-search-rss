{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39735028?u=91330295c614cf3cec0b64bf242a14fc2ceb358f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because I want to make it easier to retry actionable errors that occur when running tests. Rails already knows how to recover these errors, so lets make it possible for the user to recover from them and run their tests without exiting the process.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Allow Actionable Errors encountered when running tests to be retried. This can be configured by <code class=\"notranslate\">config.actionable_command_line_errors</code> and is <code class=\"notranslate\">true</code> in the test environment unless the <code class=\"notranslate\">\"CI\"</code> env variable is set, and false otherwise.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Migrations are pending. To resolve this issue, run:\n\n        bin/rails db:migrate\n\nYou have 1 pending migration:\n\ndb/migrate/20240201213806_add_a_to_b.rb\nRun pending migrations? [Yn] Y\n== 20240201213806 AddAToB: migrating =========================================\n== 20240201213806 AddAToB: migrated (0.0000s) ================================\n\nRunning 7 tests in a single process (parallelization threshold is 50)\nRun options: --seed 22200\n\n# Running:\n\n.......\n\nFinished in 0.243394s, 28.7600 runs/s, 45.1942 assertions/s.\n7 runs, 11 assertions, 0 failures, 0 errors, 0 skips\"><pre class=\"notranslate\"><code class=\"notranslate\">Migrations are pending. To resolve this issue, run:\n\n        bin/rails db:migrate\n\nYou have 1 pending migration:\n\ndb/migrate/20240201213806_add_a_to_b.rb\nRun pending migrations? [Yn] Y\n== 20240201213806 AddAToB: migrating =========================================\n== 20240201213806 AddAToB: migrated (0.0000s) ================================\n\nRunning 7 tests in a single process (parallelization threshold is 50)\nRun options: --seed 22200\n\n# Running:\n\n.......\n\nFinished in 0.243394s, 28.7600 runs/s, 45.1942 assertions/s.\n7 runs, 11 assertions, 0 failures, 0 errors, 0 skips\n</code></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Right now this is only implemented in the Test Runner, but I'd also like to follow up with a similar implementation for <code class=\"notranslate\">Rails::Command::CorrectableNameError</code>s.</p>\n<p dir=\"auto\">Also we could introduce a new framework default for the configuration if this is the direction in this PR is acceptable.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50941",
            "title": "Retry `ActionError`s when running tests",
            "date_modified": "2024-02-01T22:01:24.000Z",
            "date_published": "2024-02-01T21:50:43.000Z",
            "author": {
                "name": "andrewn617",
                "url": "https://github.com/andrewn617"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Minitest::Test does not support all of the same options as ActiveSupport::TestCase, such as running bin/test : and -n /regex/. Trying to use these options on this file would just run all of the Minitest::Tests no matter what options were passed.</p>\n<p dir=\"auto\">This commit fixes the ability to use those options by using ActiveSupport::TestCase (like every other test in the repo).</p>\n<p dir=\"auto\">Before:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ bin/test test/template/dependency_tracker_test.rb:217\nRunning 59 tests in parallel using 8 processes\nRun options: --seed 42725\n\n.........................................................\n\nFinished in 0.322759s, 176.6024 runs/s, 176.6024 assertions/s.\n57 runs, 57 assertions, 0 failures, 0 errors, 0 skips\"><pre class=\"notranslate\"><code class=\"notranslate\">$ bin/test test/template/dependency_tracker_test.rb:217\nRunning 59 tests in parallel using 8 processes\nRun options: --seed 42725\n\n.........................................................\n\nFinished in 0.322759s, 176.6024 runs/s, 176.6024 assertions/s.\n57 runs, 57 assertions, 0 failures, 0 errors, 0 skips\n</code></pre></div>\n<p dir=\"auto\">After:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ bin/test test/template/dependency_tracker_test.rb:217\nRunning 59 tests in parallel using 8 processes\nRun options: --seed 15213\n\n...\n\nFinished in 0.359162s, 8.3528 runs/s, 8.3528 assertions/s.\n3 runs, 3 assertions, 0 failures, 0 errors, 0 skips\"><pre class=\"notranslate\"><code class=\"notranslate\">$ bin/test test/template/dependency_tracker_test.rb:217\nRunning 59 tests in parallel using 8 processes\nRun options: --seed 15213\n\n...\n\nFinished in 0.359162s, 8.3528 runs/s, 8.3528 assertions/s.\n3 runs, 3 assertions, 0 failures, 0 errors, 0 skips\n</code></pre></div>",
            "url": "https://github.com/rails/rails/pull/50940",
            "title": "Use ActiveSupport::TestCase for Tracker tests",
            "date_modified": "2024-02-01T20:46:29.000Z",
            "date_published": "2024-02-01T20:46:24.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/19192189?u=dd60737844a9db7f1475bab21fc3e5258a405e15&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Ref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2088694143\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50793\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50793/hovercard\" href=\"https://github.com/rails/rails/pull/50793\">#50793</a></p>\n<p dir=\"auto\">If we want to stop caching the checked out connections, then we must persist the cache in the pool, and assign it to the connection when it's checked out.</p>\n<p dir=\"auto\">The pool become responsible for managing the cache lifecycle.</p>\n<p dir=\"auto\">This also open the door to sharing the cache between multiple connections, which is valuable for read replicas, etc.</p>\n<p dir=\"auto\">This change only really make sense if we go through with no longer caching checked out connections. Otherwise it's just extra complexity.</p>",
            "url": "https://github.com/rails/rails/pull/50938",
            "title": "Refactor QueryCache to be owned by the pool",
            "date_modified": "2024-02-01T13:40:44.000Z",
            "date_published": "2024-02-01T13:40:41.000Z",
            "author": {
                "name": "casperisfine",
                "url": "https://github.com/casperisfine"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/18654173?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because <code class=\"notranslate\">algorithm</code> option for create_index is available even if you are using mysql.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes documents for <code class=\"notranslate\">algorithm</code> option for  <code class=\"notranslate\">create_index</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\"></p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/4332988337b109f3c63fa2710d8a588d42d1b263/activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb#L189-L196\">rails/activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 189 to 196\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/4332988337b109f3c63fa2710d8a588d42d1b263\">4332988</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L189\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"189\"></td>\n          <td id=\"LC189\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">index_algorithms</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L190\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"190\"></td>\n          <td id=\"LC190\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-kos\">{</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L191\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"191\"></td>\n          <td id=\"LC191\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-pds\">default</span>: <span class=\"pl-s\">\"ALGORITHM = DEFAULT\"</span><span class=\"pl-kos\">,</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L192\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"192\"></td>\n          <td id=\"LC192\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-pds\">copy</span>:    <span class=\"pl-s\">\"ALGORITHM = COPY\"</span><span class=\"pl-kos\">,</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L193\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"193\"></td>\n          <td id=\"LC193\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-pds\">inplace</span>: <span class=\"pl-s\">\"ALGORITHM = INPLACE\"</span><span class=\"pl-kos\">,</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L194\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"194\"></td>\n          <td id=\"LC194\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-pds\">instant</span>: <span class=\"pl-s\">\"ALGORITHM = INSTANT\"</span><span class=\"pl-kos\">,</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L195\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"195\"></td>\n          <td id=\"LC195\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-kos\">}</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L196\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"196\"></td>\n          <td id=\"LC196\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50933",
            "title": "[ci skip] [docs] Updated docs to indicate that mysql supports the algorithm",
            "date_modified": "2024-02-01T10:10:50.000Z",
            "date_published": "2024-02-01T06:45:14.000Z",
            "author": {
                "name": "1060ki",
                "url": "https://github.com/1060ki"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/79303?u=99e3bc7887879138e88a4538ca623b0a3d7538cb&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This fixes race condition in Active Storage when multiple preprocessed variants are defined for a <code class=\"notranslate\">Previewable</code> file is attached.</p>\n<h2 dir=\"auto\">Background</h2>\n<p dir=\"auto\">When a variant is specified for a \"previewable\" file type (e.g. video  or PDF) attachment, a <code class=\"notranslate\">preview_image</code> attachment is first created and attached on the original blob and then any user-specified variants are derived from <em>that</em> preview image. When those variants are named and have <code class=\"notranslate\">preprocessed: true</code>, the jobs to create those variants are queued simultaneously.</p>\n<p dir=\"auto\">Example from my case:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"  has_one_attached :file, dependent: :purge_later do |attachable|\n    attachable.variant :preview, resize_to_fill: [400, 400], preprocessed: true\n    attachable.variant :still, format: &quot;jpg&quot;, saver: {quality: 85}, preprocessed: true\n  end\"><pre class=\"notranslate\">  <span class=\"pl-en\">has_one_attached</span> <span class=\"pl-pds\">:file</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">dependent</span>: <span class=\"pl-pds\">:purge_later</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">attachable</span>|\n    <span class=\"pl-s1\">attachable</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">variant</span> <span class=\"pl-pds\">:preview</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">resize_to_fill</span>: <span class=\"pl-kos\">[</span><span class=\"pl-c1\">400</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">400</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">preprocessed</span>: <span class=\"pl-c1\">true</span>\n    <span class=\"pl-s1\">attachable</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">variant</span> <span class=\"pl-pds\">:still</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">format</span>: <span class=\"pl-s\">\"jpg\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">saver</span>: <span class=\"pl-kos\">{</span><span class=\"pl-pds\">quality</span>: <span class=\"pl-c1\">85</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">preprocessed</span>: <span class=\"pl-c1\">true</span>\n  <span class=\"pl-k\">end</span></pre></div>\n<h2 dir=\"auto\">The issue</h2>\n<p dir=\"auto\">When a <code class=\"notranslate\">Previewable</code> attachment is created (a video, in my case), <code class=\"notranslate\">TransformJob.perform_later</code> is called for each named variant with <code class=\"notranslate\">preprocessed: true</code>. Unless your queue adapter is synchronous (e.g. :inline or :test), this results in a race condition in which every such variant's worker will check <code class=\"notranslate\">processed?</code>, see that no <code class=\"notranslate\">preview_image</code> attachment exists yet on the <code class=\"notranslate\">ActiveStorage::Blob</code>, and:</p>\n<ol dir=\"auto\">\n<li>Redundantly download the file from storage</li>\n<li>Create duplicative ActiveStorage::Attachment and <code class=\"notranslate\">ActiveStorage::Blob</code> records for the <code class=\"notranslate\">preview_image</code> attachment (all but one of which will be orphaned from the original blob's <code class=\"notranslate\">has_one_attached :preview_image</code>)</li>\n<li>Create variant blobs (and associated <code class=\"notranslate\">ActiveStorage::VariantRecord</code>) that are similarly orphaned (by virtue of being a variant of an orphaned <code class=\"notranslate\">preview_image</code> blob)</li>\n</ol>\n<p dir=\"auto\">As a result, if the video is ever purged, <code class=\"notranslate\">PurgeJob</code> will only find the current <code class=\"notranslate\">has_one_attached :preview_image</code> and whatever variant demanded it into existence, then leave the rest as orphaned records in the database and in storage.</p>\n<h2 dir=\"auto\">The fix</h2>\n<p dir=\"auto\">Pretty simple: wrap the first step of the job in <code class=\"notranslate\">blob.with_lock {}</code>. By pessimistically locking on the blob, we can prevent processing the preview image multiple times by multiple <code class=\"notranslate\">TransformJob</code> jobs running concurrently.</p>\n<p dir=\"auto\">Alternate approaches would all be more work:</p>\n<ul dir=\"auto\">\n<li>Queuing a <code class=\"notranslate\">PreviewImage</code> job instead of N <code class=\"notranslate\">TransformJob</code> and have it, only after <code class=\"notranslate\">preview_image</code> is attached, enqueue those <code class=\"notranslate\">TransformJob</code> jobs</li>\n<li>Batching up all the named variant transformations into a single meta-job</li>\n</ul>\n<h2 dir=\"auto\">Testing caveat</h2>\n<p dir=\"auto\">Writing a test for this inside Rails would be difficult because it would require running the resulting TransformJob jobs concurrently. I <a href=\"https://github.com/searls/rails/blob/fix-video-duplicate-preview-variants/activestorage/test/models/variant_with_record_test.rb#L348-L367\">started a test</a> but failed to reproduce, in part because the test queue adapter will perform enqueued jobs inline instead of concurrently. In order to write a test that replicated the issue appropriately, we might first need a new option for <code class=\"notranslate\">perform_enqueued_jobs(async: true) { … }</code></p>\n<p dir=\"auto\">If you're interested, <a href=\"https://gist.github.com/searls/5b8298abe88b3206f670ea3c6d574aab\">this gist</a> includes a driver script and output before and after the patch showing it working.</p>\n<h2 dir=\"auto\">Evaluating impact on existing Active Storage users</h2>\n<p dir=\"auto\">I only found this because I'm a total cheapskate and was literally counting records in my S3 bucket to ensure <code class=\"notranslate\">PurgeJob</code> worked. Then I wasted the next two days trying to figure out why before landing on this. I strongly suspect that ActiveStorage users who host video and take advantage of <code class=\"notranslate\">preprocessed: true</code> named variants will have a lot of orphaned stuff floating around their buckets.</p>\n<p dir=\"auto\">To see if you have any such \"zombie\" preview_images (and presumably, associated variants) floating around your application that would survive calls to <code class=\"notranslate\">purge</code> on the owning attachment, you could write a query like this:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ActiveStorage::Attachment\n  .joins(&quot;INNER JOIN active_storage_attachments as other_attachments ON\n          active_storage_attachments.record_id = other_attachments.record_id AND\n          active_storage_attachments.id != other_attachments.id&quot;)\n  .where(\n    :name =&gt; &quot;preview_image&quot;,\n    :record_type =&gt; &quot;ActiveStorage::Blob&quot;,\n    &quot;other_attachments.name&quot; =&gt; &quot;preview_image&quot;,\n    &quot;other_attachments.record_type&quot; =&gt; &quot;ActiveStorage::Blob&quot;\n  )\n  .distinct\"><pre class=\"notranslate\"><code class=\"notranslate\">ActiveStorage::Attachment\n  .joins(\"INNER JOIN active_storage_attachments as other_attachments ON\n          active_storage_attachments.record_id = other_attachments.record_id AND\n          active_storage_attachments.id != other_attachments.id\")\n  .where(\n    :name =&gt; \"preview_image\",\n    :record_type =&gt; \"ActiveStorage::Blob\",\n    \"other_attachments.name\" =&gt; \"preview_image\",\n    \"other_attachments.record_type\" =&gt; \"ActiveStorage::Blob\"\n  )\n  .distinct\n</code></pre></div>\n<p dir=\"auto\">Clearing out one's production database and backend storage to get this all right-sized should be a fun exercise for the reader.</p>",
            "url": "https://github.com/rails/rails/pull/50928",
            "title": "Fixes race condition for multiple preprocessed video variants",
            "date_modified": "2024-02-01T02:00:54.000Z",
            "date_published": "2024-01-31T18:49:44.000Z",
            "author": {
                "name": "searls",
                "url": "https://github.com/searls"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/9632282?u=d1d9bde9378bac255001728ebbe3a3f48b48b683&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">right now the caching won't trigger writing over an empty string returned from the cache store.  This will ensure that an option passed down called no_blanks, (no_blanks: true), will make it so that if the cache returns and empty string, we will trigger a write over.</p>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Right now if a key has an empty string from the cache store, an empty string will just be rendered to the page as the fragment.  For my app fragments kept coming up blank, and the writing was not being triggered.  So in a sense it was stuck.  This will ensure that an option passed down called blanks_ok, (blanks_ok: true/false), will make it so that if the cache returns and empty string, we will trigger a write over or it will return the empty string if it is set to true. (the default value is false, must explicitly pass true to get blank strings back)</p>\n<p dir=\"auto\">This Pull Request has been created because my app had to way of escaping blank strings being returned from the cache.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the way that caching writes are triggered.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">For my app I simply monkey patched the action view helper, but I would like to move away from that and try to contribute bug fixes I found useful.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50927",
            "title": "Fix problem with empty strings from cache",
            "date_modified": "2024-02-01T21:38:05.000Z",
            "date_published": "2024-01-30T21:16:51.000Z",
            "author": {
                "name": "laomatt",
                "url": "https://github.com/laomatt"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1734607?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">ActiveRecord Encryption doesn't prevent you from encrypting binary columns but it doesn't have proper support for it either.</p>\n<p dir=\"auto\">When the data is fed through encrypt/decrypt it is converted to a String. This means that the the encryption layer is not transparent to binary data - which should be passed as Type::Binary::Data.</p>\n<p dir=\"auto\">As a result the data is not properly escaped in the SQL queries or deserialized correctly after decryption.</p>\n<p dir=\"auto\">However it just happens to work fine for MySQL and SQLite because the MessageSerializer doesn't use any characters that need to be encoded. However if you try to use a custom serializer that does then it breaks.</p>\n<p dir=\"auto\">PostgreSQL on the other hand does not work - because the Bytea type is passed a String rather than a Type::Binary::Data to deserialize, it attempts to unescape the data and either mangles it or raises an error if it contains null bytes.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">The commit fixes the issue, by reserializing the data after encryption and decryption. For text data that's a no-op, but for binary data we'll convert it back to a Type::Binary::Data.</p>",
            "url": "https://github.com/rails/rails/pull/50920",
            "title": "Support encrypting binary columns",
            "date_modified": "2024-01-30T13:43:35.000Z",
            "date_published": "2024-01-30T10:53:34.000Z",
            "author": {
                "name": "djmb",
                "url": "https://github.com/djmb"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/12777550?u=415303ec1c626279c440cf729435fc0ee833d1c9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">In certain situation, we might need to store and query <code class=\"notranslate\">negative</code> values. Having the option to bypass the auto-generated negative scopes can avoid the conflicts.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Add <code class=\"notranslate\">negative_scopes</code> option to <code class=\"notranslate\">ActiveRecord::Enum#enum</code>, this offers the flexibility to optionally skip the creation of negative scopes.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50919",
            "title": "Add negative_scopes option to ActiveRecord's enum method",
            "date_modified": "2024-01-30T09:40:23.000Z",
            "date_published": "2024-01-30T09:11:41.000Z",
            "author": {
                "name": "Jay0921",
                "url": "https://github.com/Jay0921"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39735028?u=91330295c614cf3cec0b64bf242a14fc2ceb358f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2064753125\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50566\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50566/hovercard\" href=\"https://github.com/rails/rails/issues/50566\">#50566</a></p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created to generate <code class=\"notranslate\">devcontainer</code> files for new Rails apps.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds templates for devcontainer files (<code class=\"notranslate\">devcontainer.json</code>, <code class=\"notranslate\">Dockerfile</code> and <code class=\"notranslate\">docker-compose.yml</code>) to be generated on <code class=\"notranslate\">rails new</code>.</p>\n<p dir=\"auto\">By default the devcontainer contains the following:</p>\n<ul dir=\"auto\">\n<li>A redis container for Sidekiq and Action Cable</li>\n<li>A database (SQLite, Postgres, MySQL or MariaDB)</li>\n<li>A Headless chrome container for system tests</li>\n<li>Active Storage configured to use the local disk and with preview features working</li>\n</ul>\n<p dir=\"auto\">If <code class=\"notranslate\">rails new</code> is called with options to skip any of the above they will be removed from the dev container config.</p>\n<p dir=\"auto\">The dev container can be skipped entirely with the <code class=\"notranslate\">--skip_devcontainer</code> option.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">A few changes are needed to other files generated by rails new to make sure new Rails apps can be developed both in a container and locally.</p>\n<ul dir=\"auto\">\n<li>Differentiate <code class=\"notranslate\">CABLE_REDIS_URL</code> and <code class=\"notranslate\">JOBS_REDIS_URL</code> instead of just using <code class=\"notranslate\">REDIS_URL</code> for both (A PR will need to be opened to turbo-rails to make this change as well)</li>\n<li>For MariaDB and MySQL use the <code class=\"notranslate\">RAILS_DATABASE_HOST</code> if it's set (which it will be in a container) and fallback to <code class=\"notranslate\">localhost</code></li>\n<li>For Postgres set the host (<code class=\"notranslate\">RAILS_DATABASE_HOST</code>), username and password when in a container</li>\n</ul>\n<p dir=\"auto\">For system tests, we need to configure the <code class=\"notranslate\">Capybara</code> host and port to the selenium container. Rather than expose the implementation details of <code class=\"notranslate\">Capybara</code> to the developer, we created a new <code class=\"notranslate\">served_by</code> method on <code class=\"notranslate\">SystemTestCase</code> to configure these.</p>\n<p dir=\"auto\"><code class=\"notranslate\">db:system:change</code> re-generates <code class=\"notranslate\">database.yml</code>. I added a <code class=\"notranslate\">skip-devcontainer</code> option to this generator with a default of <code class=\"notranslate\">true</code>. So, any existing apps that use this command will not get devcontainer config in their db yaml. Users can opt in to have devcontainer config added to the new db yml by adding <code class=\"notranslate\">--skip-devcontainer=false</code>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50914",
            "title": "Generate devcontainer files by default",
            "date_modified": "2024-02-01T11:45:34.000Z",
            "date_published": "2024-01-29T23:03:25.000Z",
            "author": {
                "name": "andrewn617",
                "url": "https://github.com/andrewn617"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/40373?u=97283b5a00bd596840c2024f7e430ac9e41ca503&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">As of December, <a href=\"https://github.com/rails/rails/blob/main/actionpack/lib/action_controller/metal/rate_limiting.rb\">ActionController::Metal::RateLimiting</a> provides rate limiting through the <code class=\"notranslate\">increment</code> method of any cache store. RateLimiting relies on a feature of the underlying store. This feature needs to be documented, so that it remains supported, and so alternative stores know to support it.</p>\n<p dir=\"auto\">This PR has been created to document this behavior.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">The feature is that <code class=\"notranslate\">increment</code>, when passed <code class=\"notranslate\">expires_in</code>, will set expiration time when the key is first created, and ignore that option if the key already exists.</p>\n<p dir=\"auto\">That functionality is already tested <a href=\"https://github.com/rails/rails/blob/cf26c5482924babca573e6c01594d77e3321ae58/activesupport/test/cache/behaviors/cache_increment_decrement_behavior.rb#L34\">here</a>, in the <code class=\"notranslate\">CacheIncrementDecrementBehavior</code> test module.</p>\n<p dir=\"auto\">This Pull Request changes the documentation of <code class=\"notranslate\">ActiveSupport::Cache::Store.increment</code> to reflect a now-required feature of existing stores.</p>",
            "url": "https://github.com/rails/rails/pull/50909",
            "title": "[ci skip] [docs] make increment requirement explicit",
            "date_modified": "2024-01-29T00:20:53.000Z",
            "date_published": "2024-01-29T00:07:29.000Z",
            "author": {
                "name": "jamiemccarthy",
                "url": "https://github.com/jamiemccarthy"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/54629302?u=be8de5137bf940532cddd05aff823129ab8a39db&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50897.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2103568249\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50897\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50897/hovercard\" href=\"https://github.com/rails/rails/issues/50897\">#50897</a><br>\nSimilar to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1501158537\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/46759\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/46759/hovercard\" href=\"https://github.com/rails/rails/pull/46759\">#46759</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Updates <code class=\"notranslate\">ActiveRecord::AutosaveAssociation#save_has_one_association</code> to only update the foreign key attribute on the child record if it has changed. This makes its behaviour consistent with <code class=\"notranslate\">belongs_to</code> associations and ensures that <code class=\"notranslate\">ActiveRecord::ReadOnlyAttributeError</code> isn't raised when no changes have been made to the attribute.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">None.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50901",
            "title": "[Fix #50897] Autosaving `has_one` sets foreign key attribute when unchanged",
            "date_modified": "2024-01-30T10:42:10.000Z",
            "date_published": "2024-01-28T09:30:20.000Z",
            "author": {
                "name": "joshuay03",
                "url": "https://github.com/joshuay03"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/25781337?u=bd8d8c8e062d4ee487b4727c750d0529ee547e7d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<h4 dir=\"auto\">My Specific Use Case</h4>\n<p dir=\"auto\">In my project, where <code class=\"notranslate\">ActiveStorage.track_variants = true</code>, I needed to generate a variant of an image (a thumbnail for a room on a floorplan) but did not want to create a variant record of the original image record. This is because I intended to save the variant on a child relation, separate from the original image record.</p>\n<h4 dir=\"auto\">The Challenge</h4>\n<p dir=\"auto\">With <code class=\"notranslate\">ActiveStorage.track_variants = true</code> every variant generated through <code class=\"notranslate\">ActiveStorage</code> is automatically tracked in the database to the original record. There are cases in this application where we <strong>do</strong> want to track these variant records so I was unable to change the default configuration. This meant to properly generate my variant I had to use <code class=\"notranslate\">ImageProcessing::Vips</code> directly to not generate the variant record. This worked but generated two concerns for me:</p>\n<ol dir=\"auto\">\n<li>This specific code is dependent on <code class=\"notranslate\">ImageProcessing::Vips</code> and if we were to ever migrate to another image processor we would have to remember to update this code as well instead of just relying on the <code class=\"notranslate\">ActiveStorage</code> default processor.</li>\n<li>It strays enough from the standard pattern when generating <code class=\"notranslate\">ActiveStorage</code> variants that without good documentation it can become confusing to maintain.</li>\n</ol>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This pull request adds the <code class=\"notranslate\">track</code> option to the <code class=\"notranslate\">variant</code> method which allows for overriding of the <code class=\"notranslate\">ActiveStorage.track_variants</code>. This is useful when in cases where you want to stray from the application's standard configuration.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"ActiveSupport.track_variants\n# =&gt; true\nuser.avatar.variant(track: false, resize_to_limit: [100, 100])\n# =&gt; #&lt;ActiveStorage::Variant:0x00007f4e0004ffb0&gt; \"><pre class=\"notranslate\"><span class=\"pl-v\">ActiveSupport</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">track_variants</span>\n<span class=\"pl-c\"># =&gt; true</span>\n<span class=\"pl-en\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">avatar</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">variant</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">track</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">resize_to_limit</span>: <span class=\"pl-kos\">[</span><span class=\"pl-c1\">100</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">100</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># =&gt; #&lt;ActiveStorage::Variant:0x00007f4e0004ffb0&gt; </span></pre></div>\n<p dir=\"auto\">and</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"ActiveSupport.track_variants\n# =&gt; false\nuser.avatar.variant(track: true, resize_to_limit: [100, 100])\n# =&gt; #&lt;ActiveStorage::VariantWithRecord:0x00007f4e0004ffb0&gt; \"><pre class=\"notranslate\"><span class=\"pl-v\">ActiveSupport</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">track_variants</span>\n<span class=\"pl-c\"># =&gt; false</span>\n<span class=\"pl-en\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">avatar</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">variant</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">track</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">resize_to_limit</span>: <span class=\"pl-kos\">[</span><span class=\"pl-c1\">100</span><span class=\"pl-kos\">,</span> <span class=\"pl-c1\">100</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># =&gt; #&lt;ActiveStorage::VariantWithRecord:0x00007f4e0004ffb0&gt; </span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">This is my first time contributing to Rails and I appreciate anyone who takes the time to read all this. I tried my best to follow all conventions and to keep all current functionality, but in the case that I missed something I'd be happy to discuss and fix whatever is needed.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50895",
            "title": "Enhanced ActiveStorage variant tracking control",
            "date_modified": "2024-01-27T04:42:19.000Z",
            "date_published": "2024-01-27T04:41:38.000Z",
            "author": {
                "name": "JaceBayless",
                "url": "https://github.com/JaceBayless"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/545604?u=f4a12e38b365d7686f15e93391b6ffa88c0545cd&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">There may be instances where a developer is working in an environment where a higher cost than the default (12) for BCrypt is required either due to arbitrary security requirements or the recommended minimum changes and the version of bcrypt used isn't updated.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This change adds a <code class=\"notranslate\">cost:</code> argument to <code class=\"notranslate\">has_secure_password</code>. If provided, it will use that value for the password cost. Its value is validated to make sure it's between <code class=\"notranslate\">BCrypt::Engine::MIN_COST</code> and <code class=\"notranslate\">BCrypt::Engine::MAX_COST</code>.</p>\n<p dir=\"auto\">Additionally <code class=\"notranslate\">[password attribute]_cost</code> is exposed as a convenience method to determine the cost used for the set password hash. This can be used to review the current costs from a user record and either transparently upgrade the user's password or force a password reset.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">I'm not 100% married to using <code class=\"notranslate\">cost</code> as the argument name as it affects only new passwords created for the record going forward.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50894",
            "title": "Add cost argument to has_secure_password",
            "date_modified": "2024-01-27T05:30:09.000Z",
            "date_published": "2024-01-26T22:52:12.000Z",
            "author": {
                "name": "t27duck",
                "url": "https://github.com/t27duck"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/140453075?u=31aa0dde240c10a498b4e951209be7ae12efb191&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Give further context about the requirements for using the has_one_attached method.</p>\n<p dir=\"auto\">I have an application that does not have an ActiveJob::Backend queue adapter. When I tried to destroy a record, it raised an error that I needed a queue adapter. There is a dependency between the has_one_attached method and a queue adapter.</p>\n<p dir=\"auto\">That is why adding more context about the functionality and requirements about using the has_one_attached method is important.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50892",
            "title": "Documentation: Expand documentation on has_one_attached method [ci-skip].",
            "date_modified": "2024-01-30T18:45:39.000Z",
            "date_published": "2024-01-26T20:02:30.000Z",
            "author": {
                "name": "Takahashi-Seiji",
                "url": "https://github.com/Takahashi-Seiji"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When discussing testing frameworks for new projects, the absence of <code class=\"notranslate\">around</code> hooks is usually a focal point of the conversation that pushes consensus toward alternative test harnesses.</p>\n<p dir=\"auto\">Minitest itself <a href=\"https://github.com/minitest/minitest/issues/892\" data-hovercard-type=\"issue\" data-hovercard-url=\"/minitest/minitest/issues/892/hovercard\">will not support built-in <code class=\"notranslate\">around</code> hooks</a>. While the <a href=\"https://github.com/jeremyevans/minitest-hooks\">minitest-hooks</a> gem provides support for <code class=\"notranslate\">around</code>, Active Support's callback system makes adding <code class=\"notranslate\">around</code> hooks fairly trivial, and is guaranteed to be implemented in the same way as all other callbacks (Controller, Jobs, Mailers, etc.).</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Add a callback, which runs around <code class=\"notranslate\">TestCase#setup</code>, the <code class=\"notranslate\">test</code> block, and <code class=\"notranslate\">TestCase#teardown</code>. Yields the test class instance and the test case to the block:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class Test &lt; ActiveSupport::TestCase\n  around do |test_case, &amp;block|\n    Client.with(stubbed: true, &amp;block)\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">Test</span> &lt; <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">TestCase</span>\n  <span class=\"pl-en\">around</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">test_case</span><span class=\"pl-kos\">,</span> &amp;<span class=\"pl-s1\">block</span>|\n    <span class=\"pl-v\">Client</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">stubbed</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span> &amp;<span class=\"pl-s1\">block</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Additional Information</h3>\n<p dir=\"auto\">To support this change, rename the <code class=\"notranslate\">activesupport/test/testing/after_teardown_test.rb</code> file to <code class=\"notranslate\">activesupport/test/testing/callbacks_test.rb</code>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50889",
            "title": "Introduce `ActiveSupport::TestCase.around`",
            "date_modified": "2024-01-29T19:58:05.000Z",
            "date_published": "2024-01-26T15:29:23.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/54629302?u=be8de5137bf940532cddd05aff823129ab8a39db&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50812.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2091410608\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50812\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50812/hovercard\" href=\"https://github.com/rails/rails/issues/50812\">#50812</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes <code class=\"notranslate\">#merge_select_values</code>, <code class=\"notranslate\">#merge_joins</code> and <code class=\"notranslate\">#merge_outer_joins</code> in <code class=\"notranslate\">ActiveRecord::Relation::Merger</code> to unionise selects, inner and outer joins when the two sources of a <code class=\"notranslate\">merge</code> are related via STI.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">The only similar case left in <code class=\"notranslate\">ActiveRecord::Relation::Merger</code> is when <a href=\"https://github.com/rails/rails/blob/68eade83c87ae309191add6dfa4959d7d7e07464/activerecord/lib/active_record/relation/merger.rb#L101\">merging preloads</a>.</p>\n<p dir=\"auto\">I don't think that is similar to these cases since the preload values are simply used to preload associations. I thought I would just mention it anyway.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50886",
            "title": "[Fix #50812] Don't duplicate selects, inner and outer joins when merging with STI",
            "date_modified": "2024-01-30T10:41:26.000Z",
            "date_published": "2024-01-26T13:54:50.000Z",
            "author": {
                "name": "joshuay03",
                "url": "https://github.com/joshuay03"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/122306143?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Adds documentation for the <code class=\"notranslate\">attachment_changes</code> method of Active Storage.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50885",
            "title": "Document Attached::Model#attachment_changes [ci skip]",
            "date_modified": "2024-01-26T14:14:49.000Z",
            "date_published": "2024-01-26T13:18:39.000Z",
            "author": {
                "name": "tsvallender",
                "url": "https://github.com/tsvallender"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/19192189?u=dd60737844a9db7f1475bab21fc3e5258a405e15&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Ref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2028934613\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50284\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50284/hovercard\" href=\"https://github.com/rails/rails/pull/50284\">#50284</a></p>\n<p dir=\"auto\">While having the inverse association configured it generally positive as it avoid some extra queries etc, infering it may break legecy code, as evidenced by how it broke <code class=\"notranslate\">ActiveStorage::Blob</code> in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2089482274\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50800\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50800/hovercard\" href=\"https://github.com/rails/rails/pull/50800\">#50800</a></p>\n<p dir=\"auto\">As such we can't just enable this behavior immediately, we need to provide and upgrade path for users.</p>\n<p dir=\"auto\">At this stage this PR is just a quick draft to discuss how exactly we should gate this. We can just make it a regular framework default, but perhaps emitting a deprecation warning when we would have infered the inverse relation would help users upgrade?  cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a> as you generally have great insights on this kind of new framework default.</p>",
            "url": "https://github.com/rails/rails/pull/50883",
            "title": "Put plural inverse association inference behind a configuration flag",
            "date_modified": "2024-01-26T17:23:32.000Z",
            "date_published": "2024-01-26T09:19:56.000Z",
            "author": {
                "name": "casperisfine",
                "url": "https://github.com/casperisfine"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/47848?u=41ccf0d1865a17f47d140f73a3293f1f3559fc0f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Related to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2082675602\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50759\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50759/hovercard\" href=\"https://github.com/rails/rails/issues/50759\">#50759</a></p>\n<p dir=\"auto\"><code class=\"notranslate\">./tools/rdoc-to-md -a --only=actionpack</code> to reproduce the results.</p>",
            "url": "https://github.com/rails/rails/pull/50879",
            "title": "Transform actionpack documentation to Markdown",
            "date_modified": "2024-01-25T22:29:37.000Z",
            "date_published": "2024-01-25T19:53:03.000Z",
            "author": {
                "name": "rafaelfranca",
                "url": "https://github.com/rafaelfranca"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/519226?u=59a6c3425b6e478c5da291701c8e9df97422d039&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">this pull request improve the current implementation of ignoring table during the schema dump by allowing to ignore tables from other postgres schema than \"public\".</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes [REPLACE ME]</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">the proposed implementation lack the ability to specify exactly from which schema, the table is ignored but I think that even do, it's better than the current implementation.</p>\n<ul dir=\"auto\">\n<li><a href=\"https://www.postgresql.org/docs/current/app-pgdump.html\" rel=\"nofollow\">pg_dump documentation</a></li>\n<li>[pattern documentation](<a href=\"https://www.postgresql.org/docs/current/app-psql.html#APP-PSQL-PATTERNS\" rel=\"nofollow\">https://www.postgresql.org/docs/current/app-psql.html#APP-PSQL-PATTERNS</a></li>\n</ul>\n<h3 dir=\"auto\">Checklist</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>\n<p dir=\"auto\">I feel that the code change is too small to request updating CHANGELOG or writing new tests</p>",
            "url": "https://github.com/rails/rails/pull/50873",
            "title": "dump schema: ignore tables from any postgres schema",
            "date_modified": "2024-01-25T13:41:01.000Z",
            "date_published": "2024-01-25T13:31:52.000Z",
            "author": {
                "name": "gagalago",
                "url": "https://github.com/gagalago"
            }
        }
    ]
}