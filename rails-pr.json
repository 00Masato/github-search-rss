{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Database-backed Active Record models are Rails's de-facto classes for business logic, which makes sense. Reading from and writing to the database can encompass the majority of most application's logic.</p>\n<p dir=\"auto\">However, there are circumstances where Active Record classes either aren't a good fit, have grown large enough to make their maintenance burdens outweigh the benefits of new code, or are tedious to special-case for context-specific integrations with other parts of Rails like Action Pack routing or Action View form building.</p>\n<p dir=\"auto\"><strong>This is not a new perspective</strong>. There are various philosophies on how to categorize and bucket business logic when Active Record isn't the best candidate.</p>\n<p dir=\"auto\">The de-facto alternative is plain-old Ruby classes, or Ruby classes that mix-in variations of what the <code class=\"notranslate\">ActiveModel</code> module has to offer (e.g. <code class=\"notranslate\">ActiveModel::API</code>, <code class=\"notranslate\">ActiveModel::Model</code>, <code class=\"notranslate\">ActiveModel::Attributes</code>, etc.).</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This pull request proposed a synthesis of all those modules into a class that draws inspiration from Active Record.</p>\n<p dir=\"auto\">Its use cases are likely familiar: integrate with Action View helpers (like <code class=\"notranslate\">form_with</code>, <code class=\"notranslate\">fields</code>, <code class=\"notranslate\">dom_id</code>, etc.), Action Pack helpers and classes (like <code class=\"notranslate\">ActionController::Base</code>, <code class=\"notranslate\">url_for</code>, <code class=\"notranslate\">link_to</code>, etc), and Active Model attributes and validations.</p>\n<p dir=\"auto\"><strong>What's novel about this approach is its use of <code class=\"notranslate\">#save!</code> as an operation</strong>. It can serve as a coordinating method to integrate multiple Active Record (of Active Model) classes with validations and side-effects. It potentially fits into an application architecture where teams might reach for a Service Object or Interactor, while remaining familiar and intuitive to anyone that knows how to use Active Record.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class Session &lt; ActiveModel::Base\n  attr_accessor :email, :password, :request\n\n  validates :email, :password, presence: true\n\n  def save!\n    if (user = User.authenticate_by(email: email, password: password))\n      request.cookies[:signed_user_id] = user.signed_id\n    else\n      errors.add(:base, :invalid)\n\n      raise ActiveModel::ValidationError.new(self)\n    end\n  end\nend\n\nsession = Session.new(email: &quot;&quot;, password: &quot;secret&quot;, request: request)\nsession.persisted? # =&gt; false\nsession.save! # =&gt; raises ActiveModel::ValidationError\nsession.update! email: &quot;user@example.com&quot; # =&gt; true\nsession.persisted? # =&gt; true\nsession.email = &quot;user@example.com&quot;\nUser.find_signed(request.cookies[:signed_user_id]) == User.authenticate_by(email: &quot;user@example.com&quot;, password: &quot;secret&quot;) # =&gt; true\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">Session</span> &lt; <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">attr_accessor</span> <span class=\"pl-pds\">:email</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:password</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:request</span>\n\n  <span class=\"pl-en\">validates</span> <span class=\"pl-pds\">:email</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:password</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">presence</span>: <span class=\"pl-c1\">true</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">save!</span>\n    <span class=\"pl-k\">if</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">user</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">authenticate_by</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">email</span>: <span class=\"pl-en\">email</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">password</span>: <span class=\"pl-en\">password</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n      <span class=\"pl-en\">request</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">cookies</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:signed_user_id</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">user</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">signed_id</span>\n    <span class=\"pl-k\">else</span>\n      <span class=\"pl-en\">errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">add</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:base</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:invalid</span><span class=\"pl-kos\">)</span>\n\n      <span class=\"pl-en\">raise</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">ValidationError</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-smi\">self</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">end</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">session</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Session</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">email</span>: <span class=\"pl-s\">\"\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">password</span>: <span class=\"pl-s\">\"secret\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">request</span>: <span class=\"pl-en\">request</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">session</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">persisted?</span> <span class=\"pl-c\"># =&gt; false</span>\n<span class=\"pl-s1\">session</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">save!</span> <span class=\"pl-c\"># =&gt; raises ActiveModel::ValidationError</span>\n<span class=\"pl-s1\">session</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">update!</span> <span class=\"pl-pds\">email</span>: <span class=\"pl-s\">\"user@example.com\"</span> <span class=\"pl-c\"># =&gt; true</span>\n<span class=\"pl-s1\">session</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">persisted?</span> <span class=\"pl-c\"># =&gt; true</span>\n<span class=\"pl-s1\">session</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">email</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"user@example.com\"</span>\n<span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">find_signed</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">request</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">cookies</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:signed_user_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span> == <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">authenticate_by</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">email</span>: <span class=\"pl-s\">\"user@example.com\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">password</span>: <span class=\"pl-s\">\"secret\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\"># =&gt; true</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49647",
            "title": "Introduce `ActiveModel::Base` class",
            "date_modified": "2023-10-15T21:59:30.000Z",
            "date_published": "2023-10-15T21:52:51.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/771968?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><code class=\"notranslate\">ActiveRecord::Base::normalizes_attributes_of_type</code> behaves like <code class=\"notranslate\">ActiveRecord::Base::normalizes</code>, but targets attributes having one of the specified types.  For example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class Snippet &lt; ActiveRecord::Base\n  normalizes_attributes_of_type :string, :text, except: [:code], with: -&gt; { _1.strip }\nend\n\nsnippet = Snippet.new(title: &quot;  Title&quot;, description: &quot;Description.\\n&quot;, code: &quot;  code\\n&quot;)\nsnippet.title        # =&gt; &quot;Title&quot;\nsnippet.description  # =&gt; &quot;Description.&quot;\nsnippet.code         # =&gt; &quot;  code\\n&quot;\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">Snippet</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">normalizes_attributes_of_type</span> <span class=\"pl-pds\">:string</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:text</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">except</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:code</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">with</span>: <span class=\"pl-c1\">-&gt;</span> <span class=\"pl-kos\">{</span> <span class=\"pl-en\">_1</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strip</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">snippet</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Snippet</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">title</span>: <span class=\"pl-s\">\"  Title\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">description</span>: <span class=\"pl-s\">\"Description.<span class=\"pl-cce\">\\n</span>\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">code</span>: <span class=\"pl-s\">\"  code<span class=\"pl-cce\">\\n</span>\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">snippet</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">title</span>        <span class=\"pl-c\"># =&gt; \"Title\"</span>\n<span class=\"pl-s1\">snippet</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">description</span>  <span class=\"pl-c\"># =&gt; \"Description.\"</span>\n<span class=\"pl-s1\">snippet</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">code</span>         <span class=\"pl-c\"># =&gt; \"  code\\n\"</span></pre></div>\n<hr>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes pull request #49314.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1901813639\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49314\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49314/hovercard\" href=\"https://github.com/rails/rails/pull/49314\">#49314</a>.</p>\n<p dir=\"auto\"><a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/codergeek121/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/codergeek121\">@codergeek121</a> I've added you as a co-author for your work on <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1901813639\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49314\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49314/hovercard\" href=\"https://github.com/rails/rails/pull/49314\">#49314</a>.</p>",
            "url": "https://github.com/rails/rails/pull/49646",
            "title": "Add `AR::Base::normalizes_attributes_of_type`",
            "date_modified": "2023-10-15T21:46:48.000Z",
            "date_published": "2023-10-15T21:39:16.000Z",
            "author": {
                "name": "jonathanhefner",
                "url": "https://github.com/jonathanhefner"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/3317191?u=ff590b976739abed13b66f761286b812d3f71d89&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">Exit status is zero when there is an error creating the migration file.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"% bin/rails generate migration ChangeFieldToUsers\n      invoke  active_record\n    conflict    db/migrate/20231015071420_change_field_to_users.rb\nAnother migration is already named change_field_to_users: /path/to/rails/db/migrate/20231015020422_change_field_to_users.rb. Use --force to replace this migration or --skip to ignore conflicted file.\n% echo $?\n0\"><pre class=\"notranslate\"><code class=\"notranslate\">% bin/rails generate migration ChangeFieldToUsers\n      invoke  active_record\n    conflict    db/migrate/20231015071420_change_field_to_users.rb\nAnother migration is already named change_field_to_users: /path/to/rails/db/migrate/20231015020422_change_field_to_users.rb. Use --force to replace this migration or --skip to ignore conflicted file.\n% echo $?\n0\n</code></pre></div>\n<p dir=\"auto\">This is a success status despite the failure, so it is considered a success by a script, for example. This pull request returns 1 as the exit status on failure.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"% bin/rails generate migration ChangeFieldToUsers\n      invoke  active_record\n    conflict    db/migrate/20231015071420_change_field_to_users.rb\nAnother migration is already named change_field_to_users: /path/to/rails/db/migrate/20231015020422_change_field_to_users.rb. Use --force to replace this migration or --skip to ignore conflicted file.\n% echo $?\n1\"><pre class=\"notranslate\"><code class=\"notranslate\">% bin/rails generate migration ChangeFieldToUsers\n      invoke  active_record\n    conflict    db/migrate/20231015071420_change_field_to_users.rb\nAnother migration is already named change_field_to_users: /path/to/rails/db/migrate/20231015020422_change_field_to_users.rb. Use --force to replace this migration or --skip to ignore conflicted file.\n% echo $?\n1\n</code></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">The change that the exit status always be zero was made in <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/c49bb4d58587ddc2f3eee9944f92c97189094b46/hovercard\" href=\"https://github.com/rails/rails/commit/c49bb4d58587ddc2f3eee9944f92c97189094b46\"><tt>c49bb4d</tt></a>. The commit message says</p>\n<blockquote>\n<p dir=\"auto\">We should investigate which command we want to return a non-zero<br>\nstatus when it fails but for now I'm just disabling the warning and<br>\nkeeping the old behavior.</p>\n</blockquote>\n<p dir=\"auto\">However, I think it should always be non-zero on failure; there are probably no cases where it should be zero.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49644",
            "title": "Non-zero exit status on migration file creation errors",
            "date_modified": "2023-10-15T07:38:58.000Z",
            "date_published": "2023-10-15T07:38:54.000Z",
            "author": {
                "name": "kyoshidajp",
                "url": "https://github.com/kyoshidajp"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/4085?u=1a6686201552c6d1ef1136ee76bbbeaa8317a41f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because it decouples ActionView and Rails::HTML::Sanitizer. This allows other frameworks like <a href=\"https://rubyonjets.com/\" rel=\"nofollow\">Jets</a> to use ActionView for rendering.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the actionview <code class=\"notranslate\">sanitize_helper.rb</code> to remove</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"require &quot;rails-html-sanitzer&quot;\"><pre class=\"notranslate\"><span class=\"pl-en\">require</span> <span class=\"pl-s\">\"rails-html-sanitzer\"</span></pre></div>\n<p dir=\"auto\">And the default <code class=\"notranslate\">sanitizer_vendor</code> of <code class=\"notranslate\">Rails::HTML4::Sanitizer</code></p>\n<p dir=\"auto\">This decouples actionview from Rails. It takes care of the only spot in actionview that refers to <code class=\"notranslate\">Rails</code> and couples actionview to Rails.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Related PR: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1943733259\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails-html-sanitizer/issues/170\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails-html-sanitizer/pull/170/hovercard\" href=\"https://github.com/rails/rails-html-sanitizer/pull/170\">rails/rails-html-sanitizer#170</a></p>\n<p dir=\"auto\">Note, I updated the relevant gemspec to use an <code class=\"notranslate\">rails-html-sanitizer ~&gt; 1.6.1</code>. This is just a suggested patch bump and just helps to explain what would need to be done to roll this out.</p>\n<ol dir=\"auto\">\n<li>Release rails-html-sanitizer</li>\n<li>Release rails to use the updated rails-html-sanitizer that has the railtie</li>\n</ol>\n<p dir=\"auto\">Thanks for considering this PR.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49643",
            "title": "Decouple ActionView and Rails HTML Sanitizer to Allow Other Frameworks to Use ActionView",
            "date_modified": "2023-10-15T22:30:25.000Z",
            "date_published": "2023-10-15T06:16:40.000Z",
            "author": {
                "name": "tongueroo",
                "url": "https://github.com/tongueroo"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/99301559?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because it would be very helpful to provide a link that explains ERB in more depth for people learning the Rails framework. ERB is a very essential part of a Rails application.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds the important fact that ERB stands for \"Embedded Ruby.\" This helps readers better understand the meaning of ERB. This Pull Request also provides a link to a very useful Wikipedia page explaining ERB in more depth for readers who want to explore the topic in more depth.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49640",
            "title": "Added link further explaining ERB in the 'Getting Started' documentation [ci skip]",
            "date_modified": "2023-10-15T19:09:21.000Z",
            "date_published": "2023-10-14T18:54:48.000Z",
            "author": {
                "name": "mguan2020",
                "url": "https://github.com/mguan2020"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/4685176?u=a21aedc92c0cafb71a134e8af830fcbbe9014f5d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This allows for conditional execution of ErrorReporter's <code class=\"notranslate\">handle</code> and <code class=\"notranslate\">record</code> methods. :if/:unless options can be passed to the methods to if the handling/recording should continue. Either way the given block is executed.</p>\n<p dir=\"auto\">This allows for finer control over the error handling and is especially useful when you only want to handle/record errors in certain environments.</p>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">I was beginning to work on replacing some of our current way of swallowing errors with this newer <code class=\"notranslate\">Rails.errors.handle...</code>. I noticed that there were a number of places where we did this, but only in certain environments. For example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"def do_something\n  this_might_raise\nrescue SomeError =&gt; e\n  # Swallow the error unless this is a test\n  raise if Rails.env.test?\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">def</span> <span class=\"pl-en\">do_something</span>\n  <span class=\"pl-en\">this_might_raise</span>\n<span class=\"pl-k\">rescue</span> <span class=\"pl-v\">SomeError</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-en\">e</span>\n  <span class=\"pl-c\"># Swallow the error unless this is a test</span>\n  <span class=\"pl-en\">raise</span> <span class=\"pl-k\">if</span> <span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">env</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">test?</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">There wasn't a great way to reproduce this conditional handling with <code class=\"notranslate\">AS::ErrorReporter</code>. If I wanted to only handle these conditions in certain environments, I'd have to duplicate the block with something like this:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"if Rails.env.test?\n  # some logic\n  raise &quot;Always raises in test environment\nelse\n  Rails.errors.handle do\n    # some logic\n    raise &quot;Won't raise in non-test environments\n  end\nend\n\n### Detail\n\nThis adds the conditional options of `:if` and `:unless` to `AS::ErrorReporter`'s `handle` and `record` methods. Handling and reporting will only happen if the condition is met.\n\n```ruby\nRails.errors.handle(if: Rails.env.production?) do\n  # some logic\n  raise &quot;Won't raise in production&quot;\nend\n\nRails.errors.report(unless: Rails.env.test?) do\n  # some logic\n  raise &quot;Error won't be reported in the test environment&quot;\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">if</span> <span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">env</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">test?</span>\n  <span class=\"pl-c\"># some logic</span>\n  <span class=\"pl-en\">raise</span> <span class=\"pl-s\">\"Always raises in test environment</span>\n<span class=\"pl-s\">else</span>\n<span class=\"pl-s\">  Rails.errors.handle do</span>\n<span class=\"pl-s\">    # some logic</span>\n<span class=\"pl-s\">    raise \"</span><span class=\"pl-v\">Won</span><span class=\"pl-s\">'t raise in non-test environments</span>\n<span class=\"pl-s\">  end</span>\n<span class=\"pl-s\">end</span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\">### Detail</span>\n<span class=\"pl-s\"></span>\n<span class=\"pl-s\">This adds the conditional options of `:if` and `:unless` to `AS::ErrorReporter`'</span><span class=\"pl-en\">s</span> <span class=\"pl-s\">`handle`</span> <span class=\"pl-k\">and</span> <span class=\"pl-s\">`record`</span> <span class=\"pl-en\">methods</span><span class=\"pl-kos\">.</span> <span class=\"pl-en\">Handling</span> <span class=\"pl-k\">and</span> <span class=\"pl-en\">reporting</span> <span class=\"pl-en\">will</span> <span class=\"pl-en\">only</span> <span class=\"pl-en\">happen</span> <span class=\"pl-k\">if</span> <span class=\"pl-en\">the</span> <span class=\"pl-en\">condition</span> <span class=\"pl-en\">is</span> <span class=\"pl-en\">met</span><span class=\"pl-kos\">.</span>\n\n`<span class=\"pl-s\">``</span><span class=\"pl-en\">ruby</span>\n<span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">handle</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">if</span>: <span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">env</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">production?</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-c\"># some logic</span>\n  <span class=\"pl-en\">raise</span> <span class=\"pl-s\">\"Won't raise in production\"</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">unless</span>: <span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">env</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">test?</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-c\"># some logic</span>\n  <span class=\"pl-en\">raise</span> <span class=\"pl-s\">\"Error won't be reported in the test environment\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">This pattern is based on what Rails has for callbacks and before_actions. Unlike those, this doesn't take a callable. I considered adding support for that (and could still), but it seems unnecessary since it would need to be called immediately. I'm definitely open to feedback on that.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49638",
            "title": "Add conditional options to ErrorReporter",
            "date_modified": "2023-10-15T21:39:50.000Z",
            "date_published": "2023-10-14T16:23:09.000Z",
            "author": {
                "name": "dustinbrownman",
                "url": "https://github.com/dustinbrownman"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Largely inspired by the Active Record implementation, this commit introduces support for assigning instances of objects to classes that <code class=\"notranslate\">include ActiveModel::Model</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">It aims to handle assignment of <code class=\"notranslate\">_attributes</code>-suffixed values in an ActionView- and ActionPack-compliant way:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Author = Struct.new(:name)\nCategory = Struct.new(:name)\n\nclass Article\n  include ActiveModel::Model\n  include ActiveModel::NestedAttributes\n\n  attr_accessor :author\n  attr_accessor :tags\n\n  accepts_nested_attributes_for :author\n  accepts_nested_attributes_for :tags, class_name: Category\nend\n\narticle = Article.new(\n  author_attributes: { name: &quot;Pseudo Nym&quot; },\n  tags_attributes: {\n      0 =&gt; { name: &quot;actionview&quot; },\n      1 =&gt; { name: &quot;actionpack&quot; },\n  }\n)\n\narticle.author.name # =&gt; &quot;Pseudo Nym&quot;\narticle.tags.pluck(:name) # =&gt; [&quot;actionview&quot;, &quot;actionpack&quot;]\"><pre class=\"notranslate\"><span class=\"pl-v\">Author</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Struct</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">Category</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Struct</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Article</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">Model</span>\n  <span class=\"pl-en\">include</span> <span class=\"pl-v\">ActiveModel</span>::<span class=\"pl-v\">NestedAttributes</span>\n\n  <span class=\"pl-en\">attr_accessor</span> <span class=\"pl-pds\">:author</span>\n  <span class=\"pl-en\">attr_accessor</span> <span class=\"pl-pds\">:tags</span>\n\n  <span class=\"pl-en\">accepts_nested_attributes_for</span> <span class=\"pl-pds\">:author</span>\n  <span class=\"pl-en\">accepts_nested_attributes_for</span> <span class=\"pl-pds\">:tags</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">class_name</span>: <span class=\"pl-v\">Category</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">article</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-pds\">author_attributes</span>: <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"Pseudo Nym\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">tags_attributes</span>: <span class=\"pl-kos\">{</span>\n      <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"actionview\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-c1\">1</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"actionpack\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-kos\">)</span>\n\n<span class=\"pl-s1\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">author</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span> <span class=\"pl-c\"># =&gt; \"Pseudo Nym\"</span>\n<span class=\"pl-s1\">article</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">tags</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluck</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">)</span> <span class=\"pl-c\"># =&gt; [\"actionview\", \"actionpack\"]</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49637",
            "title": "Introduce `ActiveModel::NestedAttributes`",
            "date_modified": "2023-10-15T21:56:01.000Z",
            "date_published": "2023-10-14T15:36:22.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/3461?u=9efd36318b3e64f5d97809072d39f6312321ad4b&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">PostgreSQL's <code class=\"notranslate\">NOTIFY</code> command which is used by the ActionCable PostgreSQL adapter has a hard coded payload limit of 8000 bytes. As stated in the <a href=\"https://www.postgresql.org/docs/16/sql-notify.html\" rel=\"nofollow\">NOTIFY docs</a>:</p>\n<blockquote>\n<p dir=\"auto\">The ‚Äúpayload‚Äù string to be communicated along with the notification. This must be specified as a simple string literal. In the default configuration it must be shorter than 8000 bytes. (If binary data or large amounts of information need to be communicated, it's best to put it in a database table and send the key of the record.)</p>\n</blockquote>\n<p dir=\"auto\">Note that the limit can not be reconfigured, even though the documentation makes it seem like it by mentioning \"default configuration\".</p>\n<p dir=\"auto\">In practice this implies that whenever <code class=\"notranslate\">ActionCable::SubscriptionAdapter::PostgreSQL#broadcast</code> is invoked with a large payload it will fail with the <code class=\"notranslate\">PG::InvalidParameterValue: ERROR: payload string too long</code> exception.</p>\n<p dir=\"auto\">When googling for information about this adapter, this issue surfaced in quite a few places and seems to be a major reason why it sees so little real world usage.</p>\n<p dir=\"auto\">Also, given the push from 37 signals to move caching and queuing to the SQL database layer via Solid Cache / Solid Queue this leaves only ActionCable left to enable a super simple \"SQL database only\" deployment possibility for a fully featured Rails app. Which was a big motivation for me to look into solving this issue.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request evolves the implementation of the adapter by following the advice given in the Postgres documentation, ie. to store large payloads in a table, then pass the record ID as the message payload, then fetch the payload from the table when running the listener callback.</p>\n<p dir=\"auto\">Documentation is provided in the Rails Guides for how to create the table. If no table exists, instead of the previous <code class=\"notranslate\">PG::InvalidParameterValue</code> exception, a helpful custom exception will be raised instead, linking to the documentation.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<h4 dir=\"auto\">Performance</h4>\n<p dir=\"auto\">Storing and fetching payloads from a table will clearly have a performance impact. However, since the approach is used only for payloads violating the limit, and only if a dedicated table has been explicitly created, this PR avoids any performance implications for existing users (if there even are any üòÖ).</p>\n<h4 dir=\"auto\">Alternatives / ideas</h4>\n<p dir=\"auto\">Having to manually create the large payloads table doesn't make for a completely seamless developer experience. I considered lazily creating the table \"on the fly\" as needed. However this might go too far in hiding what's going on in the database from the developer, it would also create confusing diffs from <code class=\"notranslate\">db:schema:dump</code> which would now include the lazily created table unless we also add the table to <code class=\"notranslate\">ActiveRecord::SchemaDumper.ignore_tables</code> during Rails boot.</p>\n<p dir=\"auto\">Not having built in expiry of old payloads could be reconsidered. One approach of doing it would be to delete old payloads at the same time as we insert new entries (simiilar to how <a href=\"https://github.com/rails/solid_cache/blob/e4865809025d650736d818fce26d09737f6623b1/lib/solid_cache/cluster/expiry.rb#L6-L7\">Solid Cache approaches this problem</a>). To avoid too much database churn we could do it for every 100 or 1000 messages by looking at the auto incrementing ID returned during insert-time. Feedback appreciated!</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49634",
            "title": "ActionCable PostgreSQL adapter: support payloads larger than 8000 bytes",
            "date_modified": "2023-10-15T21:13:51.000Z",
            "date_published": "2023-10-14T12:32:22.000Z",
            "author": {
                "name": "dbackeus",
                "url": "https://github.com/dbackeus"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/4289625?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because the <code class=\"notranslate\">config.active_record.sqlite3_production_warning</code> config that was merged as <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"883978598\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/42191\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/42191/hovercard\" href=\"https://github.com/rails/rails/pull/42191\">#42191</a> in <a href=\"https://github.com/rails/rails/blob/7-0-stable/activerecord/CHANGELOG.md#rails-700alpha1-september-15-2021\">Rails 7.0.0.alpha1</a> still has not been added to the configuring guide.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds the entry for <code class=\"notranslate\">config.active_record.sqlite3_production_warning</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">As far as I see, the current config entries for Active Record are unsorted and I'm a bit wondering if the line I added is appropriate or not. This time I added it to the next line of <code class=\"notranslate\">sqlite3_adapter_strict_strings_by_default</code>.</p>\n<p dir=\"auto\">Or if you think adding <code class=\"notranslate\">config.active_record.sqlite3_production_warning</code> to the configuring guide is redundant because the warning indicates the one, just close the PR.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Oct 14 05:38:10 PM  W, [2023-10-14T08:38:07.617001 #1]  WARN -- : You are running SQLite in production, this is generally not recommended. You can disable this warning by setting &quot;config.active_record.sqlite3_production_warning=false&quot;.\"><pre class=\"notranslate\"><code class=\"notranslate\">Oct 14 05:38:10 PM  W, [2023-10-14T08:38:07.617001 #1]  WARN -- : You are running SQLite in production, this is generally not recommended. You can disable this warning by setting \"config.active_record.sqlite3_production_warning=false\".\n</code></pre></div>\n<p dir=\"auto\">cc: <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/intrip/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/intrip\">@intrip</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49633",
            "title": "[ci-skip][Docs]Add sqlite3_production_warning to configuring guide",
            "date_modified": "2023-10-15T07:08:16.000Z",
            "date_published": "2023-10-14T08:57:03.000Z",
            "author": {
                "name": "hachi8833",
                "url": "https://github.com/hachi8833"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This fixes the following warnings with initialized apps:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"DEPRECATION WARNING: Support for `config.active_support.cache_format_version = 6.1` has been deprecated and will be removed in Rails 7.2.\n\nCheck the Rails upgrade guide at https://guides.rubyonrails.org/upgrading_ruby_on_rails.html#new-activesupport-cache-serialization-format\nfor more information on how to upgrade.\n (called from &lt;main&gt; at bug_report_templates/action_mailbox_main.rb:43)\"><pre class=\"notranslate\"><code class=\"notranslate\">DEPRECATION WARNING: Support for `config.active_support.cache_format_version = 6.1` has been deprecated and will be removed in Rails 7.2.\n\nCheck the Rails upgrade guide at https://guides.rubyonrails.org/upgrading_ruby_on_rails.html#new-activesupport-cache-serialization-format\nfor more information on how to upgrade.\n (called from &lt;main&gt; at bug_report_templates/action_mailbox_main.rb:43)\n</code></pre></div>\n<p dir=\"auto\">I've opted to use 7.0 (rather than 7.1) since that is the lowest possible change to resolve the warning.</p>\n<p dir=\"auto\">Another question is why not use <code class=\"notranslate\">load_defaults</code> to the latest version in the bug_report_templates?</p>",
            "url": "https://github.com/rails/rails/pull/49631",
            "title": "Add cache_format_version 7.0 to bug_report_templates",
            "date_modified": "2023-10-15T21:42:24.000Z",
            "date_published": "2023-10-14T00:10:27.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/4289625?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because the current querying guide has no entries for CTE and the link to <code class=\"notranslate\">with</code> method.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds the entry for CTE.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">ref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"536810238\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/37944\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/37944/hovercard\" href=\"https://github.com/rails/rails/pull/37944\">#37944</a><br>\nref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1512256975\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/46843\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/46843/hovercard\" href=\"https://github.com/rails/rails/pull/46843\">#46843</a></p>\n<p dir=\"auto\">cc: <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/vlado/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/vlado\">@vlado</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/palkan/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/palkan\">@palkan</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49630",
            "title": "[ci-skip][Docs]Add description for CTE to querying guide",
            "date_modified": "2023-10-13T23:34:48.000Z",
            "date_published": "2023-10-13T23:33:02.000Z",
            "author": {
                "name": "hachi8833",
                "url": "https://github.com/hachi8833"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">There is an inherit complexity with wrapping the Rack body inside Rails which can lead to bugs, like <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1938260080\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49588\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49588/hovercard\" href=\"https://github.com/rails/rails/issues/49588\">#49588</a>.</p>\n<p dir=\"auto\">While <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1941124766\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49616\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49616/hovercard\" href=\"https://github.com/rails/rails/pull/49616\">#49616</a> fixed the bug, it's probably not a good long-term solution.</p>\n<p dir=\"auto\">If we go all the way back to <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/6a89850dfe1e8c8331fd8482525aa4b9b2530cad/hovercard\" href=\"https://github.com/rails/rails/commit/6a89850dfe1e8c8331fd8482525aa4b9b2530cad\"><tt>6a89850</tt></a>, we can see this was the original behavior. However, we were trying to solve a separate issue with streaming bodies during disconnect.</p>\n<p dir=\"auto\">The <code class=\"notranslate\">live_stream_test#test_abort_with_full_buffer</code> test fails in this PR, but I wanted to raise that maybe this could be handled a different way.</p>\n<p dir=\"auto\">Also there are two failures in <code class=\"notranslate\">response_test</code> which are questions to me:</p>\n<ul dir=\"auto\">\n<li><code class=\"notranslate\">ResponseTest#test_[response.to_a].flatten_does_not_recurse_infinitely</code></li>\n<li><code class=\"notranslate\">ResponseTest#test_compatibility_with_Rack::ContentLength</code></li>\n</ul>\n<p dir=\"auto\">The first seems it is actually resolved upstream, per this comment: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1551606029\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47092\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47092/hovercard?comment_id=1087250243&amp;comment_type=review_comment\" href=\"https://github.com/rails/rails/pull/47092#discussion_r1087250243\">#47092 (comment)</a></p>\n<p dir=\"auto\">The second means we broke <code class=\"notranslate\">Rack::ContentLength</code> and there is a bit on this in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1213748347\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/44953\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/44953/hovercard\" href=\"https://github.com/rails/rails/pull/44953\">#44953</a>.</p>\n<p dir=\"auto\">FWIW: I'm not proposing this PR exactly, but looking for a path forward and would love some feedback. üôá</p>\n<p dir=\"auto\">/cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/ioquatix/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ioquatix\">@ioquatix</a></p>",
            "url": "https://github.com/rails/rails/pull/49627",
            "title": "Use Rack::BodyProxy instead of RackBody",
            "date_modified": "2023-10-13T22:38:58.000Z",
            "date_published": "2023-10-13T18:30:03.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/47848?u=41ccf0d1865a17f47d140f73a3293f1f3559fc0f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Remove all code deprecated in 7.1.</p>",
            "url": "https://github.com/rails/rails/pull/49624",
            "title": "Remove all deprecated code",
            "date_modified": "2023-10-13T17:34:18.000Z",
            "date_published": "2023-10-13T15:33:35.000Z",
            "author": {
                "name": "rafaelfranca",
                "url": "https://github.com/rafaelfranca"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22231095?u=fc75f9764434943effe06d6c1dc48d40a5003b0c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">If you specify the protocol (e.g., 'https') within the <code class=\"notranslate\">host</code> option in a URL, it may lead to unexpected results. This is because the host option is typically overridden by the default 'http' protocol, causing the URL to be constructed with 'http' instead of the desired 'https' protocol. If we want to get the result with https, we pass that in the protocol option (<code class=\"notranslate\">protocol: \"https\"</code>).</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# bin/rails c\n# Loading development environment (Rails 7.2.0.alpha)\n\n&gt;&gt; app.rails_health_check_url\n=&gt; &quot;http://www.example.com/up&quot;\n\n&gt;&gt; app.rails_health_check_url host: &quot;https://github.com&quot;\n=&gt; &quot;http://github.com/up&quot;\"><pre class=\"notranslate\"><span class=\"pl-c\"># bin/rails c</span>\n<span class=\"pl-c\"># Loading development environment (Rails 7.2.0.alpha)</span>\n\n&gt;&gt; <span class=\"pl-en\">app</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">rails_health_check_url</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-s\">\"http://www.example.com/up\"</span>\n\n&gt;&gt; <span class=\"pl-en\">app</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">rails_health_check_url</span> <span class=\"pl-pds\">host</span>: <span class=\"pl-s\">\"https://github.com\"</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-s\">\"http://github.com/up\"</span></pre></div>\n<p dir=\"auto\">ref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1510320164\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/46822\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/46822/hovercard?comment_id=1365401165&amp;comment_type=issue_comment\" href=\"https://github.com/rails/rails/issues/46822#issuecomment-1365401165\">#46822 (comment)</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds a warning to the url host, it  shows the warning if  the url host options contains the protocol.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>\n<p dir=\"auto\">/cc: <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/ghiculescu/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ghiculescu\">@ghiculescu</a>, <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/zzak/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zzak\">@zzak</a></p>",
            "url": "https://github.com/rails/rails/pull/49623",
            "title": "Show warning if the url host option contains the protocol",
            "date_modified": "2023-10-15T04:39:02.000Z",
            "date_published": "2023-10-13T13:26:07.000Z",
            "author": {
                "name": "akhilgkrishnan",
                "url": "https://github.com/akhilgkrishnan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/47848?u=41ccf0d1865a17f47d140f73a3293f1f3559fc0f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Trix also defines the same constant, so if both Trix and Action Cable files and minified with Terser, we will get an error.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49599.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1939804222\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49599\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49599/hovercard\" href=\"https://github.com/rails/rails/issues/49599\">#49599</a>.</p>",
            "url": "https://github.com/rails/rails/pull/49615",
            "title": "Don't define global const `extend` in Action Cable JS",
            "date_modified": "2023-10-13T13:10:03.000Z",
            "date_published": "2023-10-12T23:17:00.000Z",
            "author": {
                "name": "rafaelfranca",
                "url": "https://github.com/rafaelfranca"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1121058?u=4b65e000f98e70877d9bdd05b687c238cb2f5d48&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #18818.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"56625554\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/18818\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/18818/hovercard\" href=\"https://github.com/rails/rails/issues/18818\">#18818</a>.</p>\n\n<p dir=\"auto\">This Pull Request has been created to add support for specifying variants in the URL via <code class=\"notranslate\">format+variant</code> syntax.  Besides being a requested feature from DHH, this would be useful for requesting variants of partials for rendering in different contexts, e.g. <code class=\"notranslate\">post.html+list</code> could be used render a post that would be shown in a list page.</p>\n<p dir=\"auto\">This PR is a continuation of these previous PRs:</p>\n<ul dir=\"auto\">\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"128188780\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/23189\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/23189/hovercard\" href=\"https://github.com/rails/rails/pull/23189\">#23189</a></li>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"60198393\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/19245\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/19245/hovercard\" href=\"https://github.com/rails/rails/pull/19245\">#19245</a></li>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"57129290\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/18865\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/18865/hovercard\" href=\"https://github.com/rails/rails/pull/18865\">#18865</a></li>\n</ul>\n<p dir=\"auto\">Notably, in the most recent PR (<a href=\"https://github.com/rails/rails/pull/23189\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/23189/hovercard\">23189</a>), <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/kaspth/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/kaspth\">@kaspth</a> <a href=\"https://github.com/rails/rails/pull/23189#issuecomment-190349099\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/23189/hovercard\">mentioned</a> not moving forward with the PR due to internal discussions:</p>\n<blockquote>\n<p dir=\"auto\">Punted to 5.1 because of internal discussions where we concluded we need more time to evaluate changing the meaning of + in generated URLs.</p>\n</blockquote>\n<p dir=\"auto\">It's been a while since then, so I'd like to see if we can reassess what those concerns were and if they're still applicable?  If they are -- I'm wondering if we can flag this behavior via configuration setting to allow apps to opt in/out of this behavior?</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">The implementation is based on the prior work from the other PRs, which seems primarily centered around a couple of small changes to action_dispatch/routing/mapper.rb.</p>\n<p dir=\"auto\">One particular area of interest for this PR is the change to actionpack/lib/action_dispatch/journey/path/pattern.rb.  I'm not sure how the previous PRs avoided touching this file, but it seems necessary in order to ensure the variant is ignored when routing with anchored routes.  Totally open to other approaches there, this is my first foray into that area of the Rails codebase.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49614",
            "title": "Variants support through url",
            "date_modified": "2023-10-13T16:39:04.000Z",
            "date_published": "2023-10-12T22:59:29.000Z",
            "author": {
                "name": "mgodwin",
                "url": "https://github.com/mgodwin"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/290782?u=457c89a040827a608bb8609d03d39a17adb6d04a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1928198301\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49499\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49499/hovercard\" href=\"https://github.com/rails/rails/issues/49499\">#49499</a> should be fixed in Rails 7.1.2.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes auto start logic for <code class=\"notranslate\">@rails/ujs</code> as ESM.<br>\nThis start logic has been changed since <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1298361773\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45546\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/45546/hovercard\" href=\"https://github.com/rails/rails/pull/45546\">#45546</a> unexpectedly.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">In the spec of ECMAScript, <code class=\"notranslate\">this</code> should be <code class=\"notranslate\">undefined</code>.</p>\n<blockquote>\n<p dir=\"auto\">8.1.1.5 Module Environment Records<br>\n8.1.1.5.4 <code class=\"notranslate\">GetThisBinding</code> ()</p>\n<ol dir=\"auto\">\n<li>Return <code class=\"notranslate\">undefined</code>.</li>\n</ol>\n</blockquote>\n<p dir=\"auto\">Ref: <a href=\"https://262.ecma-international.org/8.0/#sec-module-environment-records-getthisbinding\" rel=\"nofollow\">https://262.ecma-international.org/8.0/#sec-module-environment-records-getthisbinding</a></p>\n<p dir=\"auto\">Since some of build tools (e.g. esbuild) don't have <code class=\"notranslate\">exports</code> nor <code class=\"notranslate\">module</code> object, adding <code class=\"notranslate\">this</code> checking is required whether this file is imported as esm or not.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49499.\">Close</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1928198301\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49499\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49499/hovercard\" href=\"https://github.com/rails/rails/issues/49499\">#49499</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49606",
            "title": "Don't call `Rails.start()` in automatically when `@rails/ujs` is imported as ESM",
            "date_modified": "2023-10-12T17:20:47.000Z",
            "date_published": "2023-10-12T15:11:27.000Z",
            "author": {
                "name": "tricknotes",
                "url": "https://github.com/tricknotes"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/149785?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When you use <code class=\"notranslate\">ActiveSupport::Notifications</code> to instrument <code class=\"notranslate\">process_middleware.action_dispatch</code>, certain errors may cause a very large error message to be generated. This can exhaust resources and make the application unresponsive</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This problem happens if the object that caused the exception has direct or indirect reference back to the application middleware stack and the error's exception message includes a representation of the object that raised. For example, a <code class=\"notranslate\">NoMethod</code> error on an instance of <code class=\"notranslate\">ActionDispatch::Request::Session</code> causes this as this has a reference to <code class=\"notranslate\">ActionDispatch::Session::CookieStore</code> which contains a reference to the middleware stack through <code class=\"notranslate\">@app</code>.</p>\n<p dir=\"auto\">The error message grows incredibly large because the instrumenter runs around each middleware and handles an error by saving the error message to the <code class=\"notranslate\">@payload</code> instance variable. When the next middleware runs, the it error message will include the string of the previously generated error message. This causes the length of the error to more than double for each middleware in the stack.</p>\n<p dir=\"auto\">This effected a real application that I work on, and caused an error to be generated that was an estimated <strong>61,000,000 characters long</strong>.</p>\n<p dir=\"auto\">This change prevents this problem by stopping the <code class=\"notranslate\">@payload</code> instance variable from being inspected. <code class=\"notranslate\">@payload</code> contains the <code class=\"notranslate\">:exception_object</code> and <code class=\"notranslate\">:exception</code> keys that cause the error message to grow and grow. The change makes sure <code class=\"notranslate\">@middleware</code> is still inspected to match current behavior as much as possible.</p>\n<p dir=\"auto\">This is reproducible in Rails 6.1.7.6, 7.0.8 and 7.1.0. Note that this is no longer an issue for <code class=\"notranslate\">NoMethodError</code> in Ruby 3.3.0 preview 1, <a href=\"https://github.com/ruby/ruby/pull/6950\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/ruby/ruby/pull/6950/hovercard\">as the exception message no longer includes the printed representation of the object</a>. I haven't investigated if other standard library errors trigger this behavior.</p>\n<p dir=\"auto\">I originally reported this to the Rails security team as it could be use to perform denial of service attacks on applications, but we decided that this is unlikely because of the very specific error that needs to be raised to trigger this issue.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Here's a minimal reproduction of the issue:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# frozen_string_literal: true\nrequire 'bundler/inline'\n\ngemfile(true) do\n  source 'https://rubygems.org'\n\n  gem 'rails', '7.0.8'\n  gem 'puma'\nend\n\nrequire &quot;rails&quot;\nrequire &quot;action_controller/railtie&quot;\nrequire &quot;action_view/railtie&quot;\n\nclass App &lt; Rails::Application\n  config.root = __dir__\n  config.consider_all_requests_local = true\n  config.secret_key_base = 'i_am_a_secret'\n  config.eager_load = false\n\n  routes.append do\n    root to: 'welcome#index'\n  end\nend\n\nActiveSupport::Notifications.subscribe('process_middleware.action_dispatch') do |x|\n  # just subscribing is enough to trigger this issue\nend\n\nclass WelcomeController &lt; ActionController::Base\n  def index\n    session[:key] = 'initialize-session'\n    session.non_existant_method\n    render inline: 'never reached'\n  end\nend\n\nApp.initialize!\n\nRack::Server.start(app: App)\n\n# see error message by visiting / on app\"><pre class=\"notranslate\"><span class=\"pl-c\"># frozen_string_literal: true</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'bundler/inline'</span>\n\n<span class=\"pl-en\">gemfile</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">source</span> <span class=\"pl-s\">'https://rubygems.org'</span>\n\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'rails'</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'7.0.8'</span>\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'puma'</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"rails\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"action_controller/railtie\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"action_view/railtie\"</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">App</span> &lt; <span class=\"pl-v\">Rails</span>::<span class=\"pl-v\">Application</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">root</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">__dir__</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">consider_all_requests_local</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">true</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">secret_key_base</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">'i_am_a_secret'</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">eager_load</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">false</span>\n\n  <span class=\"pl-en\">routes</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">append</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-en\">root</span> <span class=\"pl-pds\">to</span>: <span class=\"pl-s\">'welcome#index'</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">Notifications</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">subscribe</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'process_middleware.action_dispatch'</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">x</span>|\n  <span class=\"pl-c\"># just subscribing is enough to trigger this issue</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">WelcomeController</span> &lt; <span class=\"pl-v\">ActionController</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">index</span>\n    <span class=\"pl-en\">session</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:key</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">'initialize-session'</span>\n    <span class=\"pl-en\">session</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">non_existant_method</span>\n    <span class=\"pl-en\">render</span> <span class=\"pl-pds\">inline</span>: <span class=\"pl-s\">'never reached'</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">App</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">initialize!</span>\n\n<span class=\"pl-v\">Rack</span>::<span class=\"pl-v\">Server</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">start</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">app</span>: <span class=\"pl-v\">App</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-c\"># see error message by visiting / on app</span></pre></div>\n<p dir=\"auto\">Here's the <a href=\"https://github.com/rails/rails/files/12871979/example_error_before_patch.txt\">error the example produces before</a> and <a href=\"https://github.com/rails/rails/files/12871978/example_error_after_patch.txt\">after</a> the change.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49586",
            "title": "Prevent large error messages when using middleware instrumentation",
            "date_modified": "2023-10-12T16:55:15.000Z",
            "date_published": "2023-10-11T15:49:49.000Z",
            "author": {
                "name": "zetter",
                "url": "https://github.com/zetter"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1080678?u=b6e211b7766e6aa01e794067f67dd65d419c0150&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Don't change conn spec name if there are more connections</p>\n<p dir=\"auto\">Previously we were setting <code class=\"notranslate\">connection_specification_name</code> to <code class=\"notranslate\">nil</code><br>\nwhich would cause connection calls to fall back to the parent,<br>\n<code class=\"notranslate\">ActiveRecord::Base</code>. This is fine in a single db app, but in a multi-db<br>\napp we should not do this unless it is the last remaining connection on<br>\nthat class. So now we check the pool list size before setting the name<br>\nto <code class=\"notranslate\">nil</code>. I move the <code class=\"notranslate\">remove_connection_pool</code> call inside<br>\n<code class=\"notranslate\">retrieve_connection</code> because you literally can't remove a connection<br>\nthat does not exist, so it doesn't change behavior and is just more<br>\naccurate.</p>\n<p dir=\"auto\">This also undoes the changes in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1915139173\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49403\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49403/hovercard\" href=\"https://github.com/rails/rails/pull/49403\">#49403</a> that are no longer necessary<br>\nwhich requires us to remove the <code class=\"notranslate\">not_default</code> shard connection in<br>\nanother test since we don't want that one sticking around.</p>\n<p dir=\"auto\">Related: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1912469952\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49382\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49382/hovercard\" href=\"https://github.com/rails/rails/pull/49382\">#49382</a>, <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1915139173\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49403\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49403/hovercard\" href=\"https://github.com/rails/rails/pull/49403\">#49403</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49373.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1910682345\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49373\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49373/hovercard\" href=\"https://github.com/rails/rails/issues/49373\">#49373</a></p>\n<p dir=\"auto\">cc/ <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/fractaledmind/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/fractaledmind\">@fractaledmind</a></p>",
            "url": "https://github.com/rails/rails/pull/49584",
            "title": "Fix remove connection for shards",
            "date_modified": "2023-10-13T13:28:04.000Z",
            "date_published": "2023-10-11T14:47:34.000Z",
            "author": {
                "name": "eileencodes",
                "url": "https://github.com/eileencodes"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Prior to this commit, passing an <code class=\"notranslate\">ActiveRecord::Relation</code> <strong>was</strong> supported, but it was effective only because its records would be coerced into an <code class=\"notranslate\">Array</code> through the splatting, <code class=\"notranslate\">flatten!</code>-ing, and <code class=\"notranslate\">compact!</code>-ing.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit adds explicit support, and optimizes the underlying query by omitting all fields that aren't the table's primary key.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49570",
            "title": "Optimize `ActiveRecord::QueryMethods.excluding`",
            "date_modified": "2023-10-12T19:12:25.000Z",
            "date_published": "2023-10-10T20:44:52.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        }
    ]
}