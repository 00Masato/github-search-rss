{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/509837?u=697e4a265d5359363a5d57a24b07f9a79cb0b08a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Small enhancement to <a href=\"https://github.com/rails/rails/pull/50977\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50977/hovercard\">this awesome PR</a>, cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/Ridhwana/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/Ridhwana\">@Ridhwana</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/carlosantoniodasilva/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/carlosantoniodasilva\">@carlosantoniodasilva</a></p>\n<ul dir=\"auto\">\n<li>Tidied up some of the wording around how Active Storage works with Action Text.</li>\n<li>Added a warning about <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2347254602\" data-permission-text=\"Title is private\" data-url=\"https://github.com/basecamp/trix/issues/1159\" data-hovercard-type=\"issue\" data-hovercard-url=\"/basecamp/trix/issues/1159/hovercard\" href=\"https://github.com/basecamp/trix/issues/1159\">basecamp/trix#1159</a></li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52398",
            "title": "Update Action Text :: Active Storage docs",
            "date_modified": "2024-07-23T00:55:00.000Z",
            "date_published": "2024-07-23T00:54:56.000Z",
            "author": {
                "name": "ghiculescu",
                "url": "https://github.com/ghiculescu"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/522155?u=2e71ed2ab56545207a94b885fafc434ee7350cf1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This PR is an alternative to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2378385100\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52228\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52228/hovercard\" href=\"https://github.com/rails/rails/pull/52228\">#52228</a>, exploring <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a>'s idea of a separate method from <code class=\"notranslate\">insert_all</code>.</p>\n<h2 dir=\"auto\">Background</h2>\n<p dir=\"auto\">We have some performance-critical endpoints where we want to allocate least # of objects and use <code class=\"notranslate\">insert_all</code> to write 1000s of rows into the database.</p>\n<p dir=\"auto\">However, we see <code class=\"notranslate\">insert_all</code> being ~2.5x slower compared to manually building <code class=\"notranslate\">INSERT INTO &lt;table&gt; VALUES (...), (...)</code>.</p>\n<p dir=\"auto\">I've been profiling <code class=\"notranslate\">insert_all</code> and that turned out to be largely because it 1) works with arrays of hashes and each hash needs to be traversed 2) it serializes attributes via Attributes API.</p>\n<p dir=\"auto\">That's great default behavior but if we're inserting 2000 tuples of <code class=\"notranslate\">(&lt;foreigh-key&gt;, &lt;foreigh-key&gt;, &lt;foreigh-key&gt;)</code>, we don't want to traverse hashes and run the complexity of casting integers to integers via Attributes API.</p>\n<p dir=\"auto\">I'd like to propose a \"column mode\" for inserting rows that takes arrays of arrays (no need to traverse hashes!) and makes attribute casting is the responsibility of the caller.</p>\n<p dir=\"auto\">With that approach, we're able to make <code class=\"notranslate\">insert_rows</code> as fast as direct string building:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ruby 3.3.1 (2024-04-23 revision c56cd86388) [arm64-darwin23]\nWarming up --------------------------------------\n          insert_all     4.000 i/100ms\ninsert_all with columns\n                        11.000 i/100ms\n             raw sql    13.000 i/100ms\n           with Arel    12.000 i/100ms\nCalculating -------------------------------------\n          insert_all     41.522 (Â± 7.2%) i/s -    168.000 in   4.066766s\ninsert_all with columns\n                         86.048 (Â±23.2%) i/s -    341.000 in   4.161382s\n             raw sql    114.595 (Â±14.0%) i/s -    455.000 in   4.055053s\n           with Arel    100.232 (Â±23.9%) i/s -    384.000 in   4.084465s\n\nComparison:\n             raw sql:      114.6 i/s\n           with Arel:      100.2 i/s - same-ish: difference falls within error\ninsert_all with columns:       86.0 i/s - same-ish: difference falls within error\n          insert_all:       41.5 i/s - 2.76x  slower\"><pre class=\"notranslate\"><code class=\"notranslate\">ruby 3.3.1 (2024-04-23 revision c56cd86388) [arm64-darwin23]\nWarming up --------------------------------------\n          insert_all     4.000 i/100ms\ninsert_all with columns\n                        11.000 i/100ms\n             raw sql    13.000 i/100ms\n           with Arel    12.000 i/100ms\nCalculating -------------------------------------\n          insert_all     41.522 (Â± 7.2%) i/s -    168.000 in   4.066766s\ninsert_all with columns\n                         86.048 (Â±23.2%) i/s -    341.000 in   4.161382s\n             raw sql    114.595 (Â±14.0%) i/s -    455.000 in   4.055053s\n           with Arel    100.232 (Â±23.9%) i/s -    384.000 in   4.084465s\n\nComparison:\n             raw sql:      114.6 i/s\n           with Arel:      100.2 i/s - same-ish: difference falls within error\ninsert_all with columns:       86.0 i/s - same-ish: difference falls within error\n          insert_all:       41.5 i/s - 2.76x  slower\n</code></pre></div>\n<details><summary>Benchmark code</summary>\n<p dir=\"auto\">\n</p><div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# frozen_string_literal: true\n\nrequire 'debug'\nrequire &quot;active_record&quot;\nrequire &quot;benchmark/ips&quot;\n\nGC.disable\n\nROWS_COUNT = 1000\n\nActiveRecord::Base.establish_connection({ adapter: &quot;sqlite3&quot;, database: &quot;:memory:&quot; })\n\nclass Commerce &lt; ActiveRecord::Base\n  connection.create_table :commerces, force: true do |t|\n    t.string :name, :email, :title, :tags\n    t.integer :variant_id, :product_id, :inventory_id, :something_id, :another_id\n    t.boolean :fulfilled\n    t.datetime :fulfilled_at, :deleted_at\n    t.timestamps null: true\n  end\nend\n\ndef db_time(value)\n  value.to_formatted_s(:db).inspect\nend\n\nATTRS = {\n  name: &quot;sam&quot;,\n  email: &quot;kirs@shopify.com&quot;,\n  title: &quot;title&quot;,\n  tags: &quot;tag1,tag2,tag3&quot;,\n  variant_id: 1,\n  product_id: 1,\n  inventory_id: 1,\n  something_id: 1,\n  another_id: 1,\n  fulfilled: true,\n  fulfilled_at: Time.now,\n  deleted_at: Time.now\n}\n\nBenchmark.ips do |x|\n  x.warmup = 2\n  x.time   = 4\n\n  relation = Commerce.all\n\n  x.report(&quot;insert_all&quot;) do\n    conn = Commerce.connection\n\n    relation.insert_all(\n      [ATTRS] * ROWS_COUNT\n    )\n  end\n\n  x.report(&quot;insert_all with columns&quot;) do\n    conn = Commerce.connection\n    attrs = ATTRS.dup\n    attrs[:fulfilled_at] = attrs[:fulfilled_at].to_formatted_s(:db)\n    attrs[:deleted_at] = attrs[:deleted_at].to_formatted_s(:db)\n    attrs[:created_at] = Time.now.to_formatted_s(:db)\n    attrs[:updated_at] = attrs[:created_at]\n\n    values = [\n      attrs[:name], attrs[:email], attrs[:title], attrs[:tags], attrs[:variant_id], attrs[:product_id], attrs[:inventory_id], attrs[:something_id], attrs[:another_id], attrs[:fulfilled], attrs[:fulfilled_at], attrs[:deleted_at], attrs[:created_at], attrs[:updated_at]\n    ]\n\n    relation.insert_all(\n      [values] * ROWS_COUNT,\n      columns: %w[name email title tags variant_id product_id inventory_id something_id another_id fulfilled fulfilled_at deleted_at created_at updated_at],\n    )\n  end\n\n  x.report(&quot;raw sql&quot;) do\n    conn = Commerce.connection\n    values = (1..ROWS_COUNT).map do\n      attrs = ATTRS\n      &quot;(#{conn.quote(attrs[:name])}, #{conn.quote(attrs[:email])}, #{conn.quote(attrs[:title])}, #{conn.quote(attrs[:tags])}, #{attrs[:variant_id]}, #{attrs[:product_id]}, #{attrs[:inventory_id]}, #{attrs[:something_id]}, #{attrs[:another_id]}, #{attrs[:fulfilled]}, #{db_time(attrs[:fulfilled_at])}, #{db_time(attrs[:deleted_at])}, #{db_time(Time.now)}, #{db_time(Time.now)})&quot;\n    end\n\n    conn.execute(\n      &quot;INSERT INTO commerces (name, email, title, tags, variant_id, product_id, inventory_id, something_id, another_id, fulfilled, fulfilled_at, deleted_at, created_at, updated_at) &quot;\\\n      &quot;VALUES #{values.join(',')}&quot;\n    )\n  end\n\n  x.report(&quot;with Arel&quot;) do\n    conn = Commerce.connection\n    columns = %w[name email title tags variant_id product_id inventory_id something_id another_id fulfilled fulfilled_at deleted_at created_at updated_at]\n    attrs = ATTRS.dup\n    attrs[:fulfilled_at] = (attrs[:fulfilled_at]).to_formatted_s(:db)\n    attrs[:deleted_at] = (attrs[:deleted_at]).to_formatted_s(:db)\n    attrs[:created_at] = (Time.now).to_formatted_s(:db)\n    attrs[:updated_at] = (Time.now).to_formatted_s(:db)\n\n    values_list = [attrs.values] * ROWS_COUNT\n\n    sql = &quot;INSERT INTO #{Commerce.quoted_table_name} (#{columns.join(',')}) &quot;\n    sql &lt;&lt; conn.visitor.compile(Arel::Nodes::ValuesList.new(values_list))\n    conn.execute(sql)\n  end\n\n  x.compare!\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># frozen_string_literal: true</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'debug'</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"active_record\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"benchmark/ips\"</span>\n\n<span class=\"pl-c1\">GC</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">disable</span>\n\n<span class=\"pl-c1\">ROWS_COUNT</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">1000</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">establish_connection</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-s\">\"sqlite3\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">database</span>: <span class=\"pl-s\">\":memory:\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Commerce</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:commerces</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-c1\">true</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:email</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:title</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:tags</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">integer</span> <span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:another_id</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">boolean</span> <span class=\"pl-pds\">:fulfilled</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">datetime</span> <span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:deleted_at</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">timestamps</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">true</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">value</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">inspect</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-c1\">ATTRS</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"sam\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">email</span>: <span class=\"pl-s\">\"kirs@shopify.com\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">title</span>: <span class=\"pl-s\">\"title\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">tags</span>: <span class=\"pl-s\">\"tag1,tag2,tag3\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">variant_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">product_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">inventory_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">something_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">another_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">fulfilled</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">fulfilled_at</span>: <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">deleted_at</span>: <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-v\">Benchmark</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">ips</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">x</span>|\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">warmup</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">2</span>\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">time</span>   <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">4</span>\n\n  <span class=\"pl-s1\">relation</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"insert_all\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n\n    <span class=\"pl-s1\">relation</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">insert_all</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-kos\">[</span><span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"insert_all with columns\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">dup</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span>\n\n    <span class=\"pl-s1\">values</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span>\n      <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:email</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:tags</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:another_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-kos\">]</span>\n\n    <span class=\"pl-s1\">relation</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">insert_all</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-kos\">[</span><span class=\"pl-s1\">values</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">columns</span>: <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">name</span> <span class=\"pl-s\">email</span> <span class=\"pl-s\">title</span> <span class=\"pl-s\">tags</span> <span class=\"pl-s\">variant_id</span> <span class=\"pl-s\">product_id</span> <span class=\"pl-s\">inventory_id</span> <span class=\"pl-s\">something_id</span> <span class=\"pl-s\">another_id</span> <span class=\"pl-s\">fulfilled</span> <span class=\"pl-s\">fulfilled_at</span> <span class=\"pl-s\">deleted_at</span> <span class=\"pl-s\">created_at</span> <span class=\"pl-s\">updated_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"raw sql\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">values</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-c1\">ROWS_COUNT</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">map</span> <span class=\"pl-k\">do</span>\n      <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span>\n      <span class=\"pl-s\">\"(<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:email</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:tags</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:another_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>)\"</span>\n    <span class=\"pl-k\">end</span>\n\n    <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-s\">\"INSERT INTO commerces (name, email, title, tags, variant_id, product_id, inventory_id, something_id, another_id, fulfilled, fulfilled_at, deleted_at, created_at, updated_at) \"</span>\\\n      <span class=\"pl-s\">\"VALUES <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">values</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">','</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>\"</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"with Arel\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">columns</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">name</span> <span class=\"pl-s\">email</span> <span class=\"pl-s\">title</span> <span class=\"pl-s\">tags</span> <span class=\"pl-s\">variant_id</span> <span class=\"pl-s\">product_id</span> <span class=\"pl-s\">inventory_id</span> <span class=\"pl-s\">something_id</span> <span class=\"pl-s\">another_id</span> <span class=\"pl-s\">fulfilled</span> <span class=\"pl-s\">fulfilled_at</span> <span class=\"pl-s\">deleted_at</span> <span class=\"pl-s\">created_at</span> <span class=\"pl-s\">updated_at</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">dup</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-s1\">values_list</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">values</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span>\n\n    <span class=\"pl-s1\">sql</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"INSERT INTO <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quoted_table_name</span><span class=\"pl-kos\">}</span></span> (<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">columns</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">','</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>) \"</span>\n    <span class=\"pl-s1\">sql</span> &lt;&lt; <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">visitor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">compile</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Arel</span>::<span class=\"pl-v\">Nodes</span>::<span class=\"pl-v\">ValuesList</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">values_list</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">sql</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">compare!</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\"></p>\n</details> ",
            "url": "https://github.com/rails/rails/pull/52395",
            "title": "Introduce ActiveRecord::Persistance#insert_rows",
            "date_modified": "2024-07-23T00:14:14.000Z",
            "date_published": "2024-07-22T23:36:45.000Z",
            "author": {
                "name": "kirs",
                "url": "https://github.com/kirs"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/509837?u=697e4a265d5359363a5d57a24b07f9a79cb0b08a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">When trying to implement it, I found <a href=\"https://edgeguides.rubyonrails.org/active_storage_overview.html#authenticated-controllers\" rel=\"nofollow\">this guide</a> hard to understand.</p>\n<p dir=\"auto\">This PR expands the example and gives a more options for how to move beyond the default security options in AS.</p>",
            "url": "https://github.com/rails/rails/pull/52388",
            "title": "Improve the Active Storage \"Authenticated Controllers\" guide",
            "date_modified": "2024-07-22T04:48:27.000Z",
            "date_published": "2024-07-22T04:37:43.000Z",
            "author": {
                "name": "ghiculescu",
                "url": "https://github.com/ghiculescu"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7331511?u=e5c461c2ed59b967e0925a515ab00b9a756715e3&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because the tests under the commands directory are including the Command namespace<br>\nbut this specific test is not and can create confusion for the developers.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the test to include the Command namespace.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52387",
            "title": "Add command namespace to runner test",
            "date_modified": "2024-07-22T04:39:34.000Z",
            "date_published": "2024-07-22T04:36:03.000Z",
            "author": {
                "name": "JuanVqz",
                "url": "https://github.com/JuanVqz"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/191128?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When resolving the adapter. for a url that is missing the schema (for example <code class=\"notranslate\">//root@localhost:3306/database_name</code>) the adapter resolution currently errors with <code class=\"notranslate\">NoMethodError: undefined method </code>to_sym' for nil<code class=\"notranslate\">when calling</code>ActiveRecord.protocol_adapters[]`.</p>\n<p dir=\"auto\">I am currently using such urls to allow for the adapter to be set by the application in the database.yml instead of the ENV vars which are managed externally to the application.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request prevents this error from being raised when resolving the adapter.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included. (This error is only occurring in beta releases, so I don't think a change log is required).</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52386",
            "title": "handle database urls that are missing schemas",
            "date_modified": "2024-07-22T02:07:03.000Z",
            "date_published": "2024-07-22T02:06:59.000Z",
            "author": {
                "name": "lsylvester",
                "url": "https://github.com/lsylvester"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">When tried to write tests in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2421635675\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52384\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52384/hovercard\" href=\"https://github.com/rails/rails/pull/52384\">#52384</a>, I noticed that records within individual batches are not sorted, which is a bug imo.</p>",
            "url": "https://github.com/rails/rails/pull/52385",
            "title": "Preserve order within individual batches for batch iteration",
            "date_modified": "2024-07-21T23:43:15.000Z",
            "date_published": "2024-07-21T23:43:11.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This  PR is based on <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2407398119\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52329\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52329/hovercard\" href=\"https://github.com/rails/rails/pull/52329\">#52329</a> fix (and includes its changes), so that should be merged first.</p>\n<p dir=\"auto\">Example usage:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Product.in_batches(column: [:shop_id, :id]) do |relation|\n  # do something with relation\nend\"><pre class=\"notranslate\"><span class=\"pl-v\">Product</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">in_batches</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">column</span>: <span class=\"pl-kos\">[</span><span class=\"pl-pds\">:shop_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">relation</span>|\n  <span class=\"pl-c\"># do something with relation</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">Currently, we can batch only using primary key columns, which is very limiting. We may want to include some kind of parent (or tenant) column for better use of clustered indexes (or just process all the records from one parent before starting over the other), or iterate using some \"position\" column within parent etc.</p>\n<p dir=\"auto\">I already implemented custom batch iterators a few times in my own gems, because of the lack of ability to iterate using custom columns. For example, <a href=\"https://github.com/fatkodima/online_migrations/blob/master/lib/online_migrations/batch_iterator.rb\">one</a>, <a href=\"https://github.com/fatkodima/sidekiq-iteration/blob/master/lib/sidekiq_iteration/active_record_enumerator.rb\">two</a>, <a href=\"https://github.com/fatkodima/pluck_in_batches/blob/master/lib/pluck_in_batches/iterator.rb\">three</a>, <a href=\"https://github.com/healthie/activerecord_cursor_paginate/blob/master/lib/activerecord_cursor_paginate/paginator.rb\">four</a>. I also currently have a need in the current project to be able to batch over custom columns.</p>\n<p dir=\"auto\">Fortunately, supporting this is very easy, given that we already have support for ordering by multiple columns (via <code class=\"notranslate\">:order</code>) and support for composite primary keys (aka multiple columns).</p>\n<p dir=\"auto\">It is easy for people by mistake to use some non unique columns and get incorrect results (duplicates or missed rows), so this implementation enforces to have some combination of unique columns in the list of provided columns (like a primary key or some columns included in the unique index).</p>",
            "url": "https://github.com/rails/rails/pull/52384",
            "title": "Support batching using custom columns",
            "date_modified": "2024-07-21T22:57:48.000Z",
            "date_published": "2024-07-21T22:57:43.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/13472945?u=ef29693db9743ffa3d8a02d9faa0bdec7fb0892d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2407396802\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52328\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52328/hovercard\" href=\"https://github.com/rails/rails/pull/52328\">#52328</a> added sessions - ability for existing users to sign in.</p>\n<p dir=\"auto\">This adds the possibility for a new user to sign up (registrations).</p>\n<p dir=\"auto\">We already have database uniqueness validation for <code class=\"notranslate\">email_address</code>, now we add validations in the <code class=\"notranslate\">User</code> model to display errors during registration.</p>",
            "url": "https://github.com/rails/rails/pull/52383",
            "title": "Sessions generator: add basic registrations",
            "date_modified": "2024-07-21T21:27:39.000Z",
            "date_published": "2024-07-21T21:17:39.000Z",
            "author": {
                "name": "yshmarov",
                "url": "https://github.com/yshmarov"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/10753327?u=86c075e9f1796312a3a998811bffbe9014128e46&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52381.\">FIXES</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2421510148\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52381\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52381/hovercard\" href=\"https://github.com/rails/rails/issues/52381\">#52381</a></p>\n<p dir=\"auto\">This Pull Request ensures the namespace option is handled when using <code class=\"notranslate\">form_with</code>. I can add tests and CHANGELOG update once we get ðŸ‘€ on this change and consensus this is the right approach. Thanks!</p>",
            "url": "https://github.com/rails/rails/pull/52382",
            "title": "Ensure the namespace option is handled when using form_with",
            "date_modified": "2024-07-21T17:34:57.000Z",
            "date_published": "2024-07-21T16:35:21.000Z",
            "author": {
                "name": "heratyian",
                "url": "https://github.com/heratyian"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7427365?u=67ed8ab4a2204734e6d97e9ebbe4a963512a0fda&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Currently it is possible to save user without email address. This commit adds validation to disallow saving empty email_address.</p>",
            "url": "https://github.com/rails/rails/pull/52380",
            "title": "Sessions: Don't allow saving user without an email",
            "date_modified": "2024-07-21T13:07:46.000Z",
            "date_published": "2024-07-21T13:07:42.000Z",
            "author": {
                "name": "dixpac",
                "url": "https://github.com/dixpac"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7427365?u=67ed8ab4a2204734e6d97e9ebbe4a963512a0fda&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Normalizes email_address before saving it to the DB.</p>",
            "url": "https://github.com/rails/rails/pull/52379",
            "title": "Session generator: Normalize email_address",
            "date_modified": "2024-07-21T21:13:32.000Z",
            "date_published": "2024-07-21T11:10:47.000Z",
            "author": {
                "name": "dixpac",
                "url": "https://github.com/dixpac"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Currently, <code class=\"notranslate\">error_on_ignore</code> option is not passed to the <code class=\"notranslate\">BatchEnumerator</code>. And when we iterate using it (via something like <code class=\"notranslate\">Post.in_batches(error_on_ignore: true).delete_all</code>) it is lost.<br>\nSo we need to check for the option presence before we return the <code class=\"notranslate\">BatchEnumerator</code> instance.</p>",
            "url": "https://github.com/rails/rails/pull/52378",
            "title": "Fix swallowing ignore order warning when batching using `BatchEnumerator`",
            "date_modified": "2024-07-21T09:20:25.000Z",
            "date_published": "2024-07-21T09:20:21.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22004610?u=8b285b31d33b20555541d5dda4c5ed77477eea3b&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because it does not feel friendly that the name of the class is mentioned in one of error messages, while its documentation is rendered private.</p>\n<p dir=\"auto\">Also edit the error message in order to navigate those who read first to the higher-level module, <code class=\"notranslate\">ActiveStorage::SetCurrent</code>.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52219.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2374293077\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52219\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52219/hovercard\" href=\"https://github.com/rails/rails/issues/52219\">#52219</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes three interrelated things:</p>\n<ol dir=\"auto\">\n<li>Document <code class=\"notranslate\">ActiveStorage::Current</code> from scratch</li>\n<li>Link the documentation of <code class=\"notranslate\">ActiveStorage::SetCurrent</code> to <code class=\"notranslate\">ActiveStorage::Current</code></li>\n<li>Change error message so it points to the wrapper module <code class=\"notranslate\">ActiveStorage::SetCurrent</code> rather than the underlying <code class=\"notranslate\">ActiveStorage::Current</code></li>\n</ol>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">My team and I could just use <code class=\"notranslate\">ActiveStorage::SetCurrent</code> to solve our problem when I created the issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2374293077\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52219\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52219/hovercard\" href=\"https://github.com/rails/rails/issues/52219\">#52219</a>. It is my imagination that there should be a case where <code class=\"notranslate\">ActiveStorage::SetCurrent</code> is not available to use, perhaps because url generation takes place in the background process or something. That's why I mentioned the case in the change but without a concrete solution.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52377",
            "title": "Document `ActiveStorage::Current`",
            "date_modified": "2024-07-21T03:59:57.000Z",
            "date_published": "2024-07-21T03:59:53.000Z",
            "author": {
                "name": "sato11",
                "url": "https://github.com/sato11"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22004610?u=8b285b31d33b20555541d5dda4c5ed77477eea3b&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because <code class=\"notranslate\">config.active_storage.replace_on_assign_to_many</code> has been removed at <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/b06252e2a7fa489782099653f7ddcecc5b07745c/hovercard\" href=\"https://github.com/rails/rails/commit/b06252e2a7fa489782099653f7ddcecc5b07745c\"><tt>b06252e</tt></a> and <code class=\"notranslate\">config.active_storage.silence_invalid_content_types_warning</code> at <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/0cf8444d614747e6a6257ec5ddb700934ebfec07/hovercard\" href=\"https://github.com/rails/rails/commit/0cf8444d614747e6a6257ec5ddb700934ebfec07\"><tt>0cf8444</tt></a>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This is a follow-up to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1942177428\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49624\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49624/hovercard\" href=\"https://github.com/rails/rails/pull/49624\">#49624</a>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">In the upgrade guide the versions which the config was deprecated and removed have become inaccurate so this commit also corrects them accordingly.</p>\n<p dir=\"auto\">The deprecation of <code class=\"notranslate\">config.active_storage.replace_on_assign_to_many</code> took place at <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/c720b7eba8bab1d227553ad4f962bf35abd41c88/hovercard\" href=\"https://github.com/rails/rails/commit/c720b7eba8bab1d227553ad4f962bf35abd41c88\"><tt>c720b7e</tt></a> which apparently became available at Rails 7.1.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52376",
            "title": "Remove ActiveStorage's deprecated configs",
            "date_modified": "2024-07-22T23:51:38.000Z",
            "date_published": "2024-07-21T01:20:53.000Z",
            "author": {
                "name": "sato11",
                "url": "https://github.com/sato11"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/49515?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created for two reasons</p>\n<ol dir=\"auto\">\n<li>Running the Rails application with Docker in development has become more common/standard, developers will not be able to use <code class=\"notranslate\">web_console</code> to debug application without updating the <code class=\"notranslate\">allowed_ips</code>. Additionally, the message doesn't  direct a developer how to make it it work without searching for the message online.</li>\n<li>Because every time a Rails app is upgraded to a new version of Rails and <code class=\"notranslate\">app:update</code> is run, it overwrites my changes for <code class=\"notranslate\">allowed_ips</code>.</li>\n</ol>\n<p dir=\"auto\">Now that Docker related files (Dockerfile and dev container) are part of the default <code class=\"notranslate\">rails new</code> generation, it is fairly standard to develop and debug against a Rails app running a Docker container. Out of the box, this leads to the whiny warning:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\" Cannot render console from 192.168.167.1! Allowed networks: 127.0.0.0/127.255.255.255, ::1\"><pre class=\"notranslate\"><code class=\"notranslate\"> Cannot render console from 192.168.167.1! Allowed networks: 127.0.0.0/127.255.255.255, ::1\n</code></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the generated <code class=\"notranslate\">development.rb</code> file and docker compose to allow Docker network IPs to be used in the <code class=\"notranslate\">allowed_ips</code> configuration. The defaults proposed here are static and broad for simplicity, but there are other options. It could be more dynamically set, or maybe the possibilities are just too varied to provide a good default and setting the env var would be left to the developer to populate (with a doc/guide update note perhaps as well?)</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">Discussion of various solutions for what to set the value to in <a href=\"https://stackoverflow.com/questions/29417328/how-to-disable-cannot-render-console-from-on-rails\" rel=\"nofollow\">https://stackoverflow.com/questions/29417328/how-to-disable-cannot-render-console-from-on-rails</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52374",
            "title": "Set allowed_ips in generated development configuration",
            "date_modified": "2024-07-22T23:57:56.000Z",
            "date_published": "2024-07-20T21:58:19.000Z",
            "author": {
                "name": "ryanwi",
                "url": "https://github.com/ryanwi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/131752?u=32ddf1119b1d189c9bd241a721b36ea01c29f61e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This updates <code class=\"notranslate\">TimeWithZone#inspect</code> to match the ISO 8601 style time which Ruby has used for <code class=\"notranslate\">Time#inspect</code> since 1.9+  instead of the variant of rfc822. This makes TimeWithZone match Time's formatting except for the precision in the timestamp and including the zone's name.</p>\n<p dir=\"auto\">This only impacts <code class=\"notranslate\">TimeWithZone#inspect</code>, <code class=\"notranslate\">TimeWithZone#to_s</code> had already been updated to use the new ISO 8601 style formatting. Because <code class=\"notranslate\">#inspect</code> should just be used for presenting the time to developers, I don't think we need do go through a deprecation cycle for it.</p>\n<p dir=\"auto\">That said I think this should target 8.0, not 7.2</p>\n<p dir=\"auto\"><strong>Before</strong></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"&gt; Time.zone.now\n=&gt; Fri, 31 Dec 1999 19:00:00.000000000 EST -05:00\"><pre class=\"notranslate\"><code class=\"notranslate\">&gt; Time.zone.now\n=&gt; Fri, 31 Dec 1999 19:00:00.000000000 EST -05:00\n</code></pre></div>\n<p dir=\"auto\"><strong>After</strong></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"&gt; Time.zone.now\n=&gt; 1999-12-31 19:00:00.000000000 EST -05:00\"><pre class=\"notranslate\"><code class=\"notranslate\">&gt; Time.zone.now\n=&gt; 1999-12-31 19:00:00.000000000 EST -05:00\n</code></pre></div>\n<hr>\n<p dir=\"auto\">Just for curiosity, here is the history of how Ruby has formatted <code class=\"notranslate\">Time#inspect</code> (unlike for <code class=\"notranslate\">TimeWithZone</code>, <code class=\"notranslate\">Time#inspect</code> is the same as <code class=\"notranslate\">Time#to_s</code>)</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ docker run -e 'ALL_RUBY_SINCE=ruby-1.0' --rm rubylang/all-ruby ./all-ruby -e 'p Time.at(0).to_s'\nruby-1.0-961225       &quot;Thu Jan 01 00:00:00 UTC 1970&quot;\n...\nruby-1.8.5-preview2   &quot;Thu Jan 01 00:00:00 UTC 1970&quot;\nruby-1.8.5-preview3   &quot;Thu Jan 01 00:00:00 +0000 1970&quot;\n...\nruby-1.8.5-p231       &quot;Thu Jan 01 00:00:00 +0000 1970&quot;\nruby-1.8.6-preview1   &quot;Thu, Jan 01 1970 00:00:00 +0000&quot;\n...\nruby-1.8.6-preview3   &quot;Thu, Jan 01 1970 00:00:00 +0000&quot;\nruby-1.8.6            &quot;Thu Jan 01 00:00:00 +0000 1970&quot;\n...\nruby-1.8.7-p374       &quot;Thu Jan 01 00:00:00 +0000 1970&quot;\nruby-1.9.0-0          &quot;1970-01-01 00:00:00 +0000&quot;\n...\nruby-3.4.0-preview1   &quot;1970-01-01 00:00:00 +0000&quot;\"><pre class=\"notranslate\"><code class=\"notranslate\">$ docker run -e 'ALL_RUBY_SINCE=ruby-1.0' --rm rubylang/all-ruby ./all-ruby -e 'p Time.at(0).to_s'\nruby-1.0-961225       \"Thu Jan 01 00:00:00 UTC 1970\"\n...\nruby-1.8.5-preview2   \"Thu Jan 01 00:00:00 UTC 1970\"\nruby-1.8.5-preview3   \"Thu Jan 01 00:00:00 +0000 1970\"\n...\nruby-1.8.5-p231       \"Thu Jan 01 00:00:00 +0000 1970\"\nruby-1.8.6-preview1   \"Thu, Jan 01 1970 00:00:00 +0000\"\n...\nruby-1.8.6-preview3   \"Thu, Jan 01 1970 00:00:00 +0000\"\nruby-1.8.6            \"Thu Jan 01 00:00:00 +0000 1970\"\n...\nruby-1.8.7-p374       \"Thu Jan 01 00:00:00 +0000 1970\"\nruby-1.9.0-0          \"1970-01-01 00:00:00 +0000\"\n...\nruby-3.4.0-preview1   \"1970-01-01 00:00:00 +0000\"\n</code></pre></div>",
            "url": "https://github.com/rails/rails/pull/52371",
            "title": "Update TimeWithZone#inspect to match Ruby 1.9+ ISO 8601 format",
            "date_modified": "2024-07-20T04:32:43.000Z",
            "date_published": "2024-07-19T23:20:08.000Z",
            "author": {
                "name": "jhawthorn",
                "url": "https://github.com/jhawthorn"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/13472945?u=ef29693db9743ffa3d8a02d9faa0bdec7fb0892d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">When an authenticated user clicks `button_to 'Sign out', session_path, method: :delete&gt;, he gets an error:</p>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/13472945/350541022-7dcdd078-1767-4468-99bd-31b12642b0e3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjE2OTgzNzcsIm5iZiI6MTcyMTY5ODA3NywicGF0aCI6Ii8xMzQ3Mjk0NS8zNTA1NDEwMjItN2RjZGQwNzgtMTc2Ny00NDY4LTk5YmQtMzFiMTI2NDJiMGUzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MjMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzIzVDAxMjc1N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTNhZTkyNjJlOWZlMWM4NGNjZDYzNDY3ODBiYWM1ZmVkMzhlMGJlMDJhOTVkMDIzMzEyZGUxMmY4ZTk4ZDQ2OTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.fItUWZfifot1RScrOAzOkQW0qddXP4S_ctJmX4jUvVY\"><img width=\"696\" alt=\"Screenshot 2024-07-19 at 21 39 54\" src=\"https://private-user-images.githubusercontent.com/13472945/350541022-7dcdd078-1767-4468-99bd-31b12642b0e3.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjE2OTgzNzcsIm5iZiI6MTcyMTY5ODA3NywicGF0aCI6Ii8xMzQ3Mjk0NS8zNTA1NDEwMjItN2RjZGQwNzgtMTc2Ny00NDY4LTk5YmQtMzFiMTI2NDJiMGUzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MjMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzIzVDAxMjc1N1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTNhZTkyNjJlOWZlMWM4NGNjZDYzNDY3ODBiYWM1ZmVkMzhlMGJlMDJhOTVkMDIzMzEyZGUxMmY4ZTk4ZDQ2OTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.fItUWZfifot1RScrOAzOkQW0qddXP4S_ctJmX4jUvVY\" style=\"max-width: 100%;\"></a>\n<p dir=\"auto\">This will fix it.</p>",
            "url": "https://github.com/rails/rails/pull/52369",
            "title": "Session generator - NoMethodError on sign out",
            "date_modified": "2024-07-21T09:33:36.000Z",
            "date_published": "2024-07-19T20:10:50.000Z",
            "author": {
                "name": "yshmarov",
                "url": "https://github.com/yshmarov"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/44478?u=4c419870ae62d57a3ba05958360a9abba81a97f7&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This PR adds documentation around the sharp knife and unexpected behavior introduced in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"556383416\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/38339\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/38339/hovercard\" href=\"https://github.com/rails/rails/pull/38339\">#38339</a>.</p>\n<p dir=\"auto\">While all the examples in the current documentation execute single queries or build and return single relationships (and thus, work without surprise) one might want to use the same block to build many relationships, only to find the returning relationship is automatically loaded from the expected role, while the other relationship(s) are not.</p>\n<p dir=\"auto\">Further, if the block does not actually return an ARel, then the user may be surprised.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR updates the guides and api docs for <code class=\"notranslate\">connected_to</code> to highlight this unexpected behavior.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52368",
            "title": "Improve documentation around build ActiveRecord Relations in connected_to blocks [ci skip]",
            "date_modified": "2024-07-19T20:42:42.000Z",
            "date_published": "2024-07-19T17:24:48.000Z",
            "author": {
                "name": "danielwestendorf",
                "url": "https://github.com/danielwestendorf"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/65364356?u=1014147e171ea3ad9d4ba4411344d41a0c69d4d2&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The <code class=\"notranslate\">report-uri</code> directive has been slated for <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri\" rel=\"nofollow\">deprecation</a> in favor of the new <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to\" rel=\"nofollow\">report-to</a> directive through the new <a href=\"https://w3c.github.io/reporting/\" rel=\"nofollow\">ReportingAPI</a></p>\n<p dir=\"auto\">This Pull Request has been created to introduce support for the new ReportingAPI (CSP level 3) while maintaining bidirectional compatibility with older browsers that still prefer the old <code class=\"notranslate\">report-uri</code> directive (CSP level 2)</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #35937.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"432035004\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/35937\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/35937/hovercard\" href=\"https://github.com/rails/rails/issues/35937\">#35937</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request introduces a new <code class=\"notranslate\">report_to</code> option for adding reporting endpoint(s)</p>\n<h4 dir=\"auto\">Example</h4>\n<ul dir=\"auto\">\n<li>Single URL/Endpoint</li>\n</ul>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# config/initializers/content_security_policy.rb\n\nRails.application.config.content_security_policy do |policy|\n  # Specify URI for violation reports\n\n  policy.report_to &quot;/csp-violation-report-endpoint&quot;\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># config/initializers/content_security_policy.rb</span>\n\n<span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">application</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">content_security_policy</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">policy</span>|\n  <span class=\"pl-c\"># Specify URI for violation reports</span>\n\n  <span class=\"pl-s1\">policy</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report_to</span> <span class=\"pl-s\">\"/csp-violation-report-endpoint\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<ul dir=\"auto\">\n<li>Multiple endpoints that share the same configuration under a single <strong>group</strong> name using a lambda</li>\n</ul>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Rails.application.config.content_security_policy do |policy|\n\n  policy.report_to &quot;default&quot;,  -&gt; {{ \n      default: {\n        urls: [&quot;/csp-violation-report-endpoint&quot;, &quot;https://example.com/csp-violation-report&quot;],\n        max_age: 30.minutes,\n        include_subdomains: true\n      },\n      group_2: &quot;https://example.com/hpkp-reports&quot;\n    }\n  }\nend\"><pre class=\"notranslate\"><span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">application</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">content_security_policy</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">policy</span>|\n\n  <span class=\"pl-s1\">policy</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report_to</span> <span class=\"pl-s\">\"default\"</span><span class=\"pl-kos\">,</span>  <span class=\"pl-c1\">-&gt;</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">{</span> \n      <span class=\"pl-pds\">default</span>: <span class=\"pl-kos\">{</span>\n        <span class=\"pl-pds\">urls</span>: <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"/csp-violation-report-endpoint\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"https://example.com/csp-violation-report\"</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span>\n        <span class=\"pl-pds\">max_age</span>: <span class=\"pl-c1\">30</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">minutes</span><span class=\"pl-kos\">,</span>\n        <span class=\"pl-pds\">include_subdomains</span>: <span class=\"pl-c1\">true</span>\n      <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">group_2</span>: <span class=\"pl-s\">\"https://example.com/hpkp-reports\"</span>\n    <span class=\"pl-kos\">}</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<ul dir=\"auto\">\n<li>The <code class=\"notranslate\">report_to</code> directive automatically adds the <code class=\"notranslate\">report_uri</code> directive by default to enforce bidirectional compatibility</li>\n<li>This is my first PR to this repo, so please let me know if there are any improvements I can make.</li>\n</ul>\n<h4 dir=\"auto\">Reporting API-specific information</h4>\n<ul dir=\"auto\">\n<li>\n<p dir=\"auto\">The Reporting API is only available in <a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts/features_restricted_to_secure_contexts\" rel=\"nofollow\">secure contexts</a></p>\n</li>\n<li>\n<p dir=\"auto\">Reports are delivered <a href=\"https://en.wikipedia.org/wiki/Out-of-band_datahttps://en.wikipedia.org/wiki/Out-of-band_data\" rel=\"nofollow\">out-of-band</a> by the browser itself, rather than by your server or site, meaning the browser controls when reports are delivered to your server(s). With CSP level 2 (<code class=\"notranslate\">report-uri</code>), reports are sent immediately. In contrast, with CSP level 3 (<code class=\"notranslate\">report-to</code>), reports are sent at the browserâ€™s discretion, potentially with delays of up to a minute.</p>\n<p dir=\"auto\">This approach allows reports to be <strong>batched</strong> rather than sent <strong>individually</strong>, which helps save bandwidth and is particularly considerate of users' network connections, especially on mobile devices.</p>\n</li>\n<li>\n<p dir=\"auto\">Reports sent via the <a href=\"https://csplite.com/csp124/\" rel=\"nofollow\">report-to</a> directive have a universal format, since not only a report on CSP violation can be sent via it, but also any reports about problems that occurred in the browser. The Content Security Policy violation report will have of type \"<a href=\"https://csplite.com/csp66/#type\" rel=\"nofollow\">csp-violation</a>\", while the content of the violation report itself will be sent in the \"<a href=\"https://csplite.com/csp66/#body\" rel=\"nofollow\">body</a>\" field:</p>\n</li>\n<li>\n<p dir=\"auto\">The field names differ from the standard names of a violation report, sent via <code class=\"notranslate\">report_uri</code>, changing from <code class=\"notranslate\">kebab-case</code> to <code class=\"notranslate\">camelCase</code>.:</p>\n</li>\n</ul>\n<markdown-accessiblity-table><table role=\"table\">\n<thead>\n<tr>\n<th>report-uri</th>\n<th>-&gt;</th>\n<th>report-to</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>document-uri</td>\n<td>-&gt;</td>\n<td>documentURL</td>\n</tr>\n<tr>\n<td>effective-directive</td>\n<td>-&gt;</td>\n<td>effectiveDirective</td>\n</tr>\n<tr>\n<td>violated-directive</td>\n<td>-&gt;</td>\n<td>violatedDirective</td>\n</tr>\n<tr>\n<td>source-file</td>\n<td>-&gt;</td>\n<td>sourceFile</td>\n</tr>\n<tr>\n<td>original-policy</td>\n<td>-&gt;</td>\n<td>originalPolicy</td>\n</tr>\n<tr>\n<td>line-number</td>\n<td>-&gt;</td>\n<td>lineNumber</td>\n</tr>\n<tr>\n<td>status-code</td>\n<td>-&gt;</td>\n<td>statusCode</td>\n</tr>\n</tbody>\n</table></markdown-accessiblity-table>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52367",
            "title": "Add Content Security Policy Reporting Api Support",
            "date_modified": "2024-07-19T17:07:39.000Z",
            "date_published": "2024-07-19T15:50:01.000Z",
            "author": {
                "name": "adeyinkaezra123",
                "url": "https://github.com/adeyinkaezra123"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/564142?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because  <span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52364.\">fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2419088328\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52364\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52364/hovercard\" href=\"https://github.com/rails/rails/issues/52364\">#52364</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes to add conditional values of IPAddr class for TagHelper#tag_option.<br>\nIt outputs with a prefix when IPAddr value has a prefix.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52365",
            "title": "ActionView: fix html form attribute when IPAddr value has prefix",
            "date_modified": "2024-07-19T14:51:53.000Z",
            "date_published": "2024-07-19T14:44:12.000Z",
            "author": {
                "name": "taketo1113",
                "url": "https://github.com/taketo1113"
            }
        }
    ]
}