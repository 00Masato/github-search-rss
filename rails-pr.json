{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/816901?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><ul dir=\"auto\">\n<li><strong>Remove leaks from namespaced_generators_test.rb</strong></li>\n<li><strong>Fix test leak in railties</strong></li>\n<li><strong>Fix most tests in <code class=\"notranslate\">reporter_test.rb</code> when run with <code class=\"notranslate\">bin/test</code></strong></li>\n<li><strong>Fix failing test in reporter_test.rb</strong></li>\n</ul>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">Had a rather poor experience trying to make a change in railties and running the tests with <code class=\"notranslate\">bin/tests</code> to confirm I didn't break anything.<br>\nSo many tests seemed to fail without being related.<br>\nI investigated a bit and found a few possible causes.<br>\nLess flaky failures means more reliable tests and less things getting on the way of contributors.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">I made four changes in four separate commits, and documented them in their respective commit message.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">There's probably more, but this is a good start.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53200",
            "title": "Fix some (flaky?) failures in railties tests",
            "date_modified": "2024-10-06T04:25:11.000Z",
            "date_published": "2024-10-05T14:12:33.000Z",
            "author": {
                "name": "davidstosik",
                "url": "https://github.com/davidstosik"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/122436?u=ec54cf625a213bbe6cf0ed04a3d14551dac7875d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">AS::TimeZone exposes MAPPING as way to normalize TZ name But using it is pretty inconvinient</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"    zone = ActiveSupport::TimeZone['Hawaii']\n    # Old way\n    ActiveSupport::TimeZone::MAPPING[zone.name]\n    # New way\n    zone.standard_name\"><pre class=\"notranslate\">    <span class=\"pl-s1\">zone</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">TimeZone</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">'Hawaii'</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-c\"># Old way</span>\n    <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">TimeZone</span>::<span class=\"pl-c1\">MAPPING</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">zone</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-c\"># New way</span>\n    <span class=\"pl-s1\">zone</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">standard_name</span></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds <code class=\"notranslate\">AS::TimeZone#standard_name</code> method</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53199",
            "title": "Add AS::TimeZone#standard_name method",
            "date_modified": "2024-10-06T04:45:15.000Z",
            "date_published": "2024-10-05T14:02:07.000Z",
            "author": {
                "name": "bogdan",
                "url": "https://github.com/bogdan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/151224?u=85901a0a1d5c58fb953d17b754f7b980ffab2cab&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">It would be nice to rely on built-in extract dimensions logic when writing custom image analyzer like this:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class CustomeImageAnalyzer &lt; ActiveStorage::Analyzer::ImageAnalyzer::Vips\n  def metadata\n    read_image do |image|\n      extract_dimensions_metadata(image).tap do |metadata|\n        metadata[:aspect_ratio] = metadata[:width].to_f / metadata[:height]\n      end\n    end\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">CustomeImageAnalyzer</span> &lt; <span class=\"pl-v\">ActiveStorage</span>::<span class=\"pl-v\">Analyzer</span>::<span class=\"pl-v\">ImageAnalyzer</span>::<span class=\"pl-v\">Vips</span>\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">metadata</span>\n    <span class=\"pl-en\">read_image</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">image</span>|\n      <span class=\"pl-en\">extract_dimensions_metadata</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">image</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">tap</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">metadata</span>|\n        <span class=\"pl-s1\">metadata</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:aspect_ratio</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">metadata</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:width</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_f</span> / <span class=\"pl-s1\">metadata</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:height</span><span class=\"pl-kos\">]</span>\n      <span class=\"pl-k\">end</span>\n    <span class=\"pl-k\">end</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">This pull request introduces <code class=\"notranslate\">extract_dimensions_metadata</code>, the method idea is <a href=\"https://github.com/rails/rails/blob/main/activestorage/lib/active_storage/analyzer/image_analyzer.rb#L21\">similar</a> to<code class=\"notranslate\">rotated_image?</code>. Not a big deal, but still.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53195",
            "title": "Add extract_dimensions_metadata to image analyzer",
            "date_modified": "2024-10-05T08:22:21.000Z",
            "date_published": "2024-10-05T08:22:17.000Z",
            "author": {
                "name": "aishek",
                "url": "https://github.com/aishek"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1709692?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This commit addresses the issue by ensuring that the id is always passed</p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">Currently, calling reload does not pass the id information to the exception when the record is not found.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52598.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2464301253\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52598\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52598/hovercard\" href=\"https://github.com/rails/rails/issues/52598\">#52598</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the <code class=\"notranslate\">_find_record</code> method in the <code class=\"notranslate\">Persistence</code> module to stop using <code class=\"notranslate\">find_by!</code> and instead use <code class=\"notranslate\">find_by</code>. This way if the record is not found the method can populate the exception message with the right id information.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">It seems that the original change (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1432226606\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/46402\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/46402/hovercard\" href=\"https://github.com/rails/rails/pull/46402\">#46402</a>) was introduced to support <code class=\"notranslate\">query_constraints_list</code>. I have tried to ensure that <code class=\"notranslate\">query_constraints_list</code> is used in generating the error object, but I couldn't find any prior art, so I had to come up with my own approach.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53194",
            "title": "Fix reloading destroyed model does not set id on RecordNotFound exception",
            "date_modified": "2024-10-05T08:58:42.000Z",
            "date_published": "2024-10-05T06:29:26.000Z",
            "author": {
                "name": "cmaruz",
                "url": "https://github.com/cmaruz"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1034?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Rack is looking at some minor changes to how they parse query strings, but we have learned hard-won lessons about changing even edge case behaviours.</p>\n<p dir=\"auto\">Simultaneously, this narrow instance has highlighted a more general situation: prior to Rack 3, we always had the option to adopt our own parameter parsing strategy (e.g. if we wanted to invent some meaning for a structured parameter name of <code class=\"notranslate\">foo[@]/bar</code> or something). As Rack 3 eliminated the obligation for the input body to be rewindable, only the first-to-read is guaranteed to be able to see the full set of parameters.</p>\n<p dir=\"auto\">The Rack side of this has been alleviated via <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1768882464\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rack/rack/issues/2088\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rack/rack/pull/2088/hovercard\" href=\"https://github.com/rack/rack/pull/2088\">rack/rack#2088</a> -- it's still true that only the first reader can parse the input, and ecosystem consistency requires that reader to be Rack... but it will now provide a more literal, less processed, view of the parameters it saw.</p>\n<p dir=\"auto\">Here, we adopt that new raw parameter list (where available), and do the structured parsing for ourselves.</p>\n<p dir=\"auto\">Interestingly, this allows us to be more direct in getting to a true Rails parameter set: indifferent hash access, nil munging, and string encoding controls can all be applied as we go, instead of through post-processing.</p>\n<hr>\n<p dir=\"auto\">The intention is that there are no observable behaviour changes here: the only short-term effect will be to insulate us from future-Rack's <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1812208010\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rack/rack/issues/2098\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rack/rack/pull/2098/hovercard\" href=\"https://github.com/rack/rack/pull/2098\">rack/rack#2098</a>.</p>\n<p dir=\"auto\">This PR <em>will</em> result in new/different exception classes being raised for various invalid-parameter situations, but apart from changing spelling of some log messages, I'm not sure it's practical, let alone likely, for an application to be rescuing them.</p>",
            "url": "https://github.com/rails/rails/pull/53193",
            "title": "Do more request parameter parsing ourselves",
            "date_modified": "2024-10-05T05:29:33.000Z",
            "date_published": "2024-10-05T05:29:29.000Z",
            "author": {
                "name": "matthewd",
                "url": "https://github.com/matthewd"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5122678?u=204301f9f9fe8930fd26fe3bfe65b6ffaffd8b59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The current guidance on how to initialize a custom serializer does not work. Instead, it raises a <code class=\"notranslate\">NameError</code>.</p>\n<p dir=\"auto\">I found I needed to use the <code class=\"notranslate\">to_prepare</code> <a href=\"https://guides.rubyonrails.org/configuring.html#initialization-events\" rel=\"nofollow\">initialization events</a><br>\nto correctly configure a custom serializer:</p>\n<p dir=\"auto\">Additionally, add the private <code class=\"notranslate\">klass</code> instance method to match the example in the API.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53192",
            "title": "Guides: Update serialization section [ci skip]",
            "date_modified": "2024-10-05T09:51:06.000Z",
            "date_published": "2024-10-05T02:11:56.000Z",
            "author": {
                "name": "stevepolitodesign",
                "url": "https://github.com/stevepolitodesign"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/148003?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">… model and inverse of</p>\n<p dir=\"auto\">Before this was not possible:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class Zine &lt; ActiveRecord::Base\n  has_many :interests, inverse_of: :zine\n  has_many :humans, through: :interests, source: :interestable, source_type: 'Human'\nend\n\nclass Interest &lt; ActiveRecord::Base\n  belongs_to :zine, inverse_of: :interests\n  belongs_to :interestable, polymorphic: true, inverse_of: :interests\nend\n\nclass Human &lt; ActiveRecord::Base\n  has_many :interests, as: :interestable, inverse_of: :interestable\nend\n\nzine = Zine.create!\nzine.humans.create!\n\n# =&gt; ArgumentError: Polymorphic associations do not support computing the class.\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">Zine</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">has_many</span> <span class=\"pl-pds\">:interests</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">inverse_of</span>: <span class=\"pl-pds\">:zine</span>\n  <span class=\"pl-en\">has_many</span> <span class=\"pl-pds\">:humans</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">through</span>: <span class=\"pl-pds\">:interests</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">source</span>: <span class=\"pl-pds\">:interestable</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">source_type</span>: <span class=\"pl-s\">'Human'</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Interest</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:zine</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">inverse_of</span>: <span class=\"pl-pds\">:interests</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:interestable</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">polymorphic</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">inverse_of</span>: <span class=\"pl-pds\">:interests</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Human</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">has_many</span> <span class=\"pl-pds\">:interests</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-pds\">:interestable</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">inverse_of</span>: <span class=\"pl-pds\">:interestable</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">zine</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Zine</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span>\n<span class=\"pl-s1\">zine</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">humans</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span>\n\n<span class=\"pl-c\"># =&gt; ArgumentError: Polymorphic associations do not support computing the class.</span></pre></div>\n<p dir=\"auto\">Now the code checks whether the association is polymorphic and uses the correct code to get the inverse association.</p>\n<p dir=\"auto\">See below for a bug template. You can change the <code class=\"notranslate\">rails</code> gem at the top to point it to this PR/branch which fixes the test.</p>\n<details>\n<summary>Bug Template</summary>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# frozen_string_literal: true\n\nrequire 'bundler/inline'\n\ngemfile(true) do\n  source 'https://rubygems.org'\n\n  gem 'rails'\n\n  # If you want to test against edge Rails replace the previous line with this:\n  # gem &quot;rails&quot;, github: &quot;rails/rails&quot;, branch: &quot;main&quot;\n\n  # fixed in this branch\n  # gem 'rails', github: 'Stellenticket/rails', branch: :polymorphic_inverse_of_chain\n\n  gem 'sqlite3'\nend\n\nrequire 'active_record'\nrequire 'minitest/autorun'\nrequire 'logger'\n\n# This connection will do for database-independent bug reports.\nActiveRecord::Base.establish_connection(adapter: 'sqlite3', database: ':memory:')\nActiveRecord::Base.logger = Logger.new(STDOUT)\n\nActiveRecord::Schema.define do\n  create_table :zines, force: true do |t|\n  end\n\n  create_table :interests, force: true do |t|\n    t.references :zine\n    t.references :interestable, polymorphic: true\n  end\n\n  create_table :humen, force: true do |t|\n  end\nend\n\nclass Zine &lt; ActiveRecord::Base\n  has_many :interests, inverse_of: :zine\n  has_many :humans, through: :interests, source: :interestable, source_type: 'Human'\nend\n\nclass Interest &lt; ActiveRecord::Base\n  belongs_to :zine, inverse_of: :interests\n  belongs_to :interestable, polymorphic: true, inverse_of: :interests\nend\n\nclass Human &lt; ActiveRecord::Base\n  has_many :interests, as: :interestable, inverse_of: :interestable\nend\n\nclass BugTest &lt; Minitest::Test\n  def test_association_stuff\n    zine = Zine.create!\n    zine.humans.create!\n\n    assert_equal 1, zine.reload.humans.count\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># frozen_string_literal: true</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'bundler/inline'</span>\n\n<span class=\"pl-en\">gemfile</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">source</span> <span class=\"pl-s\">'https://rubygems.org'</span>\n\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'rails'</span>\n\n  <span class=\"pl-c\"># If you want to test against edge Rails replace the previous line with this:</span>\n  <span class=\"pl-c\"># gem \"rails\", github: \"rails/rails\", branch: \"main\"</span>\n\n  <span class=\"pl-c\"># fixed in this branch</span>\n  <span class=\"pl-c\"># gem 'rails', github: 'Stellenticket/rails', branch: :polymorphic_inverse_of_chain</span>\n\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'sqlite3'</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'active_record'</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'minitest/autorun'</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'logger'</span>\n\n<span class=\"pl-c\"># This connection will do for database-independent bug reports.</span>\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">establish_connection</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">adapter</span>: <span class=\"pl-s\">'sqlite3'</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">database</span>: <span class=\"pl-s\">':memory:'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">logger</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">STDOUT</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Schema</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">define</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:zines</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-c1\">true</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:interests</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-c1\">true</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">references</span> <span class=\"pl-pds\">:zine</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">references</span> <span class=\"pl-pds\">:interestable</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">polymorphic</span>: <span class=\"pl-c1\">true</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:humen</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-c1\">true</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Zine</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">has_many</span> <span class=\"pl-pds\">:interests</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">inverse_of</span>: <span class=\"pl-pds\">:zine</span>\n  <span class=\"pl-en\">has_many</span> <span class=\"pl-pds\">:humans</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">through</span>: <span class=\"pl-pds\">:interests</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">source</span>: <span class=\"pl-pds\">:interestable</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">source_type</span>: <span class=\"pl-s\">'Human'</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Interest</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:zine</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">inverse_of</span>: <span class=\"pl-pds\">:interests</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:interestable</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">polymorphic</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">inverse_of</span>: <span class=\"pl-pds\">:interests</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Human</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">has_many</span> <span class=\"pl-pds\">:interests</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">as</span>: <span class=\"pl-pds\">:interestable</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">inverse_of</span>: <span class=\"pl-pds\">:interestable</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">BugTest</span> &lt; <span class=\"pl-v\">Minitest</span>::<span class=\"pl-v\">Test</span>\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">test_association_stuff</span>\n    <span class=\"pl-s1\">zine</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Zine</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span>\n    <span class=\"pl-s1\">zine</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">humans</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span>\n\n    <span class=\"pl-en\">assert_equal</span> <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">zine</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">reload</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">humans</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">count</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n</details>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53176",
            "title": "allow to autosave associations with polymorphic has many through join…",
            "date_modified": "2024-10-04T13:56:50.000Z",
            "date_published": "2024-10-04T12:09:41.000Z",
            "author": {
                "name": "doits",
                "url": "https://github.com/doits"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/55020167?u=3e0880f7916aeabde344be62e94e72f2bd1c0596&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">I try to deploy a brand-new rails \"8.0.0.beta1\" app with esbuild and deploy it with the shiny Kamal V2.1.<br>\nDocker image build step fails due to yarn installation :</p>\n<p dir=\"auto\"><strong>the default Dockerfile :</strong></p>\n<div class=\"highlight highlight-source-dockerfile notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# syntax=docker/dockerfile:1\n# check=error=true\n\n# This Dockerfile is designed for production, not development. Use with Kamal or build'n'run by hand:\n# docker build -t fix_yarn .\n# docker run -d -p 80:80 -e RAILS_MASTER_KEY=&lt;value from config/master.key&gt; --name fix_yarn fix_yarn\n\n# For a containerized dev environment, see Dev Containers: https://guides.rubyonrails.org/getting_started_with_devcontainer.html\n\n# Make sure RUBY_VERSION matches the Ruby version in .ruby-version\nARG RUBY_VERSION=3.3.5\nFROM docker.io/library/ruby:$RUBY_VERSION-slim AS base\n\n# Rails app lives here\nWORKDIR /rails\n\n# Install base packages\nRUN apt-get update -qq &amp;&amp; \\\n    apt-get install --no-install-recommends -y curl libjemalloc2 libvips sqlite3 &amp;&amp; \\\n    rm -rf /var/lib/apt/lists /var/cache/apt/archives\n\n# Set production environment\nENV RAILS_ENV=&quot;production&quot; \\\n    BUNDLE_DEPLOYMENT=&quot;1&quot; \\\n    BUNDLE_PATH=&quot;/usr/local/bundle&quot; \\\n    BUNDLE_WITHOUT=&quot;development&quot;\n\n# Throw-away build stage to reduce size of final image\nFROM base AS build\n\n# Install packages needed to build gems and node modules\nRUN apt-get update -qq &amp;&amp; \\\n    apt-get install --no-install-recommends -y build-essential git node-gyp pkg-config python-is-python3 &amp;&amp; \\\n    rm -rf /var/lib/apt/lists /var/cache/apt/archives\n\n# Install JavaScript dependencies\nARG NODE_VERSION=22.9.0\nARG YARN_VERSION=3.3.1\nENV PATH=/usr/local/node/bin:$PATH\nRUN curl -sL https://github.com/nodenv/node-build/archive/master.tar.gz | tar xz -C /tmp/ &amp;&amp; \\\n    /tmp/node-build-master/bin/node-build &quot;${NODE_VERSION}&quot; /usr/local/node &amp;&amp; \\\n    npm install -g yarn@$YARN_VERSION &amp;&amp; \\\n    rm -rf /tmp/node-build-master\n\n# Install application gems\nCOPY Gemfile Gemfile.lock ./\nRUN bundle install &amp;&amp; \\\n    rm -rf ~/.bundle/ &quot;${BUNDLE_PATH}&quot;/ruby/*/cache &quot;${BUNDLE_PATH}&quot;/ruby/*/bundler/gems/*/.git &amp;&amp; \\\n    bundle exec bootsnap precompile --gemfile\n\n# Install node modules\nCOPY package.json yarn.lock ./\nRUN yarn install --frozen-lockfile\n\n# Copy application code\nCOPY . .\n\n# Precompile bootsnap code for faster boot times\nRUN bundle exec bootsnap precompile app/ lib/\n\n# Precompiling assets for production without requiring secret RAILS_MASTER_KEY\nRUN SECRET_KEY_BASE_DUMMY=1 ./bin/rails assets:precompile\n\n\nRUN rm -rf node_modules\n\n\n# Final stage for app image\nFROM base\n\n# Copy built artifacts: gems, application\nCOPY --from=build &quot;${BUNDLE_PATH}&quot; &quot;${BUNDLE_PATH}&quot;\nCOPY --from=build /rails /rails\n\n# Run and own only the runtime files as a non-root user for security\nRUN groupadd --system --gid 1000 rails &amp;&amp; \\\n    useradd rails --uid 1000 --gid 1000 --create-home --shell /bin/bash &amp;&amp; \\\n    chown -R rails:rails db log storage tmp\nUSER 1000:1000\n\n# Entrypoint prepares the database.\nENTRYPOINT [&quot;/rails/bin/docker-entrypoint&quot;]\n\n# Start server via Thruster by default, this can be overwritten at runtime\nEXPOSE 80\nCMD [&quot;./bin/thrust&quot;, &quot;./bin/rails&quot;, &quot;server&quot;]\n\"><pre class=\"notranslate\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> syntax=docker/dockerfile:1</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> check=error=true</span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> This Dockerfile is designed for production, not development. Use with Kamal or build'n'run by hand:</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> docker build -t fix_yarn .</span>\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> docker run -d -p 80:80 -e RAILS_MASTER_KEY=&lt;value from config/master.key&gt; --name fix_yarn fix_yarn</span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> For a containerized dev environment, see Dev Containers: https://guides.rubyonrails.org/getting_started_with_devcontainer.html</span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Make sure RUBY_VERSION matches the Ruby version in .ruby-version</span>\n<span class=\"pl-k\">ARG</span> RUBY_VERSION=3.3.5\n<span class=\"pl-k\">FROM</span> docker.io/library/ruby:$RUBY_VERSION-slim AS base\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Rails app lives here</span>\n<span class=\"pl-k\">WORKDIR</span> /rails\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Install base packages</span>\n<span class=\"pl-k\">RUN</span> apt-get update -qq &amp;&amp; \\\n    apt-get install --no-install-recommends -y curl libjemalloc2 libvips sqlite3 &amp;&amp; \\\n    rm -rf /var/lib/apt/lists /var/cache/apt/archives\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Set production environment</span>\n<span class=\"pl-k\">ENV</span> RAILS_ENV=<span class=\"pl-s\">\"production\"</span> \\\n    BUNDLE_DEPLOYMENT=<span class=\"pl-s\">\"1\"</span> \\\n    BUNDLE_PATH=<span class=\"pl-s\">\"/usr/local/bundle\"</span> \\\n    BUNDLE_WITHOUT=<span class=\"pl-s\">\"development\"</span>\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Throw-away build stage to reduce size of final image</span>\n<span class=\"pl-k\">FROM</span> base AS build\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Install packages needed to build gems and node modules</span>\n<span class=\"pl-k\">RUN</span> apt-get update -qq &amp;&amp; \\\n    apt-get install --no-install-recommends -y build-essential git node-gyp pkg-config python-is-python3 &amp;&amp; \\\n    rm -rf /var/lib/apt/lists /var/cache/apt/archives\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Install JavaScript dependencies</span>\n<span class=\"pl-k\">ARG</span> NODE_VERSION=22.9.0\n<span class=\"pl-k\">ARG</span> YARN_VERSION=3.3.1\n<span class=\"pl-k\">ENV</span> PATH=/usr/local/node/bin:$PATH\n<span class=\"pl-k\">RUN</span> curl -sL https://github.com/nodenv/node-build/archive/master.tar.gz | tar xz -C /tmp/ &amp;&amp; \\\n    /tmp/node-build-master/bin/node-build <span class=\"pl-s\">\"${NODE_VERSION}\"</span> /usr/local/node &amp;&amp; \\\n    npm install -g yarn@$YARN_VERSION &amp;&amp; \\\n    rm -rf /tmp/node-build-master\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Install application gems</span>\n<span class=\"pl-k\">COPY</span> Gemfile Gemfile.lock ./\n<span class=\"pl-k\">RUN</span> bundle install &amp;&amp; \\\n    rm -rf ~/.bundle/ <span class=\"pl-s\">\"${BUNDLE_PATH}\"</span>/ruby/*/cache <span class=\"pl-s\">\"${BUNDLE_PATH}\"</span>/ruby/*/bundler/gems/*/.git &amp;&amp; \\\n    bundle exec bootsnap precompile --gemfile\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Install node modules</span>\n<span class=\"pl-k\">COPY</span> package.json yarn.lock ./\n<span class=\"pl-k\">RUN</span> yarn install --frozen-lockfile\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Copy application code</span>\n<span class=\"pl-k\">COPY</span> . .\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Precompile bootsnap code for faster boot times</span>\n<span class=\"pl-k\">RUN</span> bundle exec bootsnap precompile app/ lib/\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Precompiling assets for production without requiring secret RAILS_MASTER_KEY</span>\n<span class=\"pl-k\">RUN</span> SECRET_KEY_BASE_DUMMY=1 ./bin/rails assets:precompile\n\n\n<span class=\"pl-k\">RUN</span> rm -rf node_modules\n\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Final stage for app image</span>\n<span class=\"pl-k\">FROM</span> base\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Copy built artifacts: gems, application</span>\n<span class=\"pl-k\">COPY</span> --from=build <span class=\"pl-s\">\"${BUNDLE_PATH}\"</span> <span class=\"pl-s\">\"${BUNDLE_PATH}\"</span>\n<span class=\"pl-k\">COPY</span> --from=build /rails /rails\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Run and own only the runtime files as a non-root user for security</span>\n<span class=\"pl-k\">RUN</span> groupadd --system --gid 1000 rails &amp;&amp; \\\n    useradd rails --uid 1000 --gid 1000 --create-home --shell /bin/bash &amp;&amp; \\\n    chown -R rails:rails db log storage tmp\n<span class=\"pl-k\">USER</span> 1000:1000\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Entrypoint prepares the database.</span>\n<span class=\"pl-k\">ENTRYPOINT</span> [<span class=\"pl-s\">\"/rails/bin/docker-entrypoint\"</span>]\n\n<span class=\"pl-c\"><span class=\"pl-c\">#</span> Start server via Thruster by default, this can be overwritten at runtime</span>\n<span class=\"pl-k\">EXPOSE</span> 80\n<span class=\"pl-k\">CMD</span> [<span class=\"pl-s\">\"./bin/thrust\"</span>, <span class=\"pl-s\">\"./bin/rails\"</span>, <span class=\"pl-s\">\"server\"</span>]\n</pre></div>\n<p dir=\"auto\"><strong>The failure :</strong></p>\n<details>\n<summary>Details</summary>\n<div class=\"highlight highlight-source-red notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#11 [build  2/10] RUN curl -sL https://github.com/nodenv/node-build/archive/master.tar.gz | tar xz -C /tmp/ &amp;&amp;     /tmp/node-build-master/bin/node-build &quot;22.9.0&quot; /usr/local/node &amp;&amp;     npm install -g yarn@3.3.1 &amp;&amp;     rm -rf /tmp/node-build-master\n#11 1.522 To follow progress, use 'tail -f /tmp/node-build.20241004094359.13.log' or pass --verbose\n#11 1.619 Downloading node-v22.9.0-linux-x64.tar.gz...\n#11 1.619 -&gt; https://nodejs.org/dist/v22.9.0/node-v22.9.0-linux-x64.tar.gz\n#11 13.82 Installing node-v22.9.0-linux-x64...\n#11 21.34 Installed node-v22.9.0-linux-x64 to /usr/local/node\n#11 21.34 \n#11 23.34 npm error code ETARGET\n#11 23.34 npm error notarget No matching version found for yarn@3.3.1.\n#11 23.34 npm error notarget In most cases you or one of your dependencies are requesting\n#11 23.34 npm error notarget a package version that doesn't exist.\n#11 23.35 npm notice\n#11 23.35 npm notice New minor version of npm available! 10.8.3 -&gt; 10.9.0\n#11 23.35 npm notice Changelog: https://github.com/npm/cli/releases/tag/v10.9.0\n#11 23.35 npm notice To update run: npm install -g npm@10.9.0\n#11 23.35 npm notice\n#11 23.35 npm error A complete log of this run can be found in: /root/.npm/_logs/2024-10-04T09_44_19_632Z-debug-0.log\n#11 ERROR: process &quot;/bin/sh -c curl -sL https://github.com/nodenv/node-build/archive/master.tar.gz | tar xz -C /tmp/ &amp;&amp;     /tmp/node-build-master/bin/node-build \\&quot;${NODE_VERSION}\\&quot; /usr/local/node &amp;&amp;     npm install -g yarn@$YARN_VERSION &amp;&amp;     rm -rf /tmp/node-build-master&quot; did not complete successfully: exit code: 1\n------\n &gt; [build  2/10] RUN curl -sL https://github.com/nodenv/node-build/archive/master.tar.gz | tar xz -C /tmp/ &amp;&amp;     /tmp/node-build-master/bin/node-build &quot;22.9.0&quot; /usr/local/node &amp;&amp;     npm install -g yarn@3.3.1 &amp;&amp;     rm -rf /tmp/node-build-master:\n23.34 npm error code ETARGET\n23.34 npm error notarget No matching version found for yarn@3.3.1.\n23.34 npm error notarget In most cases you or one of your dependencies are requesting\n23.34 npm error notarget a package version that doesn't exist.\n23.35 npm notice\n23.35 npm notice New minor version of npm available! 10.8.3 -&gt; 10.9.0\n23.35 npm notice Changelog: https://github.com/npm/cli/releases/tag/v10.9.0\n23.35 npm notice To update run: npm install -g npm@10.9.0\n23.35 npm notice\n23.35 npm error A complete log of this run can be found in: /root/.npm/_logs/2024-10-04T09_44_19_632Z-debug-0.log\n------\nDockerfile:40\n--------------------\n  39 |     ENV PATH=/usr/local/node/bin:$PATH\n  40 | &gt;&gt;&gt; RUN curl -sL https://github.com/nodenv/node-build/archive/master.tar.gz | tar xz -C /tmp/ &amp;&amp; \\\n  41 | &gt;&gt;&gt;     /tmp/node-build-master/bin/node-build &quot;${NODE_VERSION}&quot; /usr/local/node &amp;&amp; \\\n  42 | &gt;&gt;&gt;     npm install -g yarn@$YARN_VERSION &amp;&amp; \\\n  43 | &gt;&gt;&gt;     rm -rf /tmp/node-build-master\n  44 |     \n--------------------\nERROR: failed to solve: process &quot;/bin/sh -c curl -sL https://github.com/nodenv/node-build/archive/master.tar.gz | tar xz -C /tmp/ &amp;&amp;     /tmp/node-build-master/bin/node-build \\&quot;${NODE_VERSION}\\&quot; /usr/local/node &amp;&amp;     npm install -g yarn@$YARN_VERSION &amp;&amp;     rm -rf /tmp/node-build-master&quot; did not complete successfully: exit code: 1\"><pre class=\"notranslate\"><span class=\"pl-s\">#11</span> [build  <span class=\"pl-c1\">2</span><span class=\"pl-k\">/10</span>] RUN curl -sL <span class=\"pl-s\">https://github.com/nodenv/node-build/archive/master.tar.gz</span> | tar xz -C <span class=\"pl-k\">/tmp/</span> &amp;&amp;     <span class=\"pl-k\">/tmp/node-build-master/bin/node-build</span> <span class=\"pl-s\">\"22.9.0\"</span> <span class=\"pl-k\">/usr/local/node</span> &amp;&amp;     npm install -g <span class=\"pl-s\">yarn@3.3.1</span> &amp;&amp;     rm -rf <span class=\"pl-k\">/tmp/node-build-master</span>\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">1.522</span> To follow progress, <span class=\"pl-c1\">use</span> 'tail -f <span class=\"pl-k\">/tmp/node-build.20241004094359.13.log'</span> <span class=\"pl-k\">or</span> pass --verbose\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">1.619</span> Downloading node-v22.9.0-linux-x64.tar.gz...\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">1.619</span> -<span class=\"pl-k\">&gt;</span> <span class=\"pl-s\">https://nodejs.org/dist/v22.9.0/node-v22.9.0-linux-x64.tar.gz</span>\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">13.82</span> Installing node-v22.9.0-linux-x64...\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">21.34</span> Installed node-v22.9.0-linux-x64 <span class=\"pl-c1\">to</span> <span class=\"pl-k\">/usr/local/node</span>\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">21.34</span> \n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.34</span> npm error code ETARGET\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.34</span> npm error notarget No matching version found <span class=\"pl-c1\">for</span> <span class=\"pl-s\">yarn@3.3.1.</span>\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.34</span> npm error notarget <span class=\"pl-c1\">In</span> most cases you <span class=\"pl-k\">or</span> one of your dependencies are requesting\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.34</span> npm error notarget a package version that doesn't exist.\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.35</span> npm notice\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.35</span> npm notice New minor version of npm <span class=\"pl-c1\">available!</span> 10.8.3 -<span class=\"pl-k\">&gt;</span> 10.9.0\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.35</span> npm notice <span class=\"pl-c1\">Changelog:</span> <span class=\"pl-s\">https://github.com/npm/cli/releases/tag/v10.9.0</span>\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.35</span> npm notice To <span class=\"pl-c1\">update</span> <span class=\"pl-c1\">run:</span> npm install -g <span class=\"pl-s\">npm@10.9.0</span>\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.35</span> npm notice\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">23.35</span> npm error A complete log of this run can be found <span class=\"pl-c1\">in:</span> <span class=\"pl-k\">/root/.npm/_logs/2024-10-04T09_44_19_632Z-debug-0.log</span>\n<span class=\"pl-s\">#11</span> <span class=\"pl-c1\">ERROR:</span> process <span class=\"pl-s\">\"/bin/sh -c curl -sL https://github.com/nodenv/node-build/archive/master.tar.gz | tar xz -C /tmp/ &amp;&amp;     /tmp/node-build-master/bin/node-build \\\"</span>$<span class=\"pl-s\">{NODE_VERSION}</span>\\<span class=\"pl-s\">\" /usr/local/node &amp;&amp;     npm install -g yarn@$YARN_VERSION &amp;&amp;     rm -rf /tmp/node-build-master\"</span> did <span class=\"pl-c1\">not</span> complete <span class=\"pl-c1\">successfully:</span> <span class=\"pl-k\">exit</span> <span class=\"pl-c1\">code:</span> <span class=\"pl-c1\">1</span>\n------\n <span class=\"pl-k\">&gt;</span> [build  <span class=\"pl-c1\">2</span><span class=\"pl-k\">/10</span>] RUN curl -sL <span class=\"pl-s\">https://github.com/nodenv/node-build/archive/master.tar.gz</span> | tar xz -C <span class=\"pl-k\">/tmp/</span> &amp;&amp;     <span class=\"pl-k\">/tmp/node-build-master/bin/node-build</span> <span class=\"pl-s\">\"22.9.0\"</span> <span class=\"pl-k\">/usr/local/node</span> &amp;&amp;     npm install -g <span class=\"pl-s\">yarn@3.3.1</span> &amp;&amp;     rm -rf <span class=\"pl-k\">/tmp/node-build-master:</span>\n<span class=\"pl-c1\">23.34</span> npm error code ETARGET\n<span class=\"pl-c1\">23.34</span> npm error notarget No matching version found <span class=\"pl-c1\">for</span> <span class=\"pl-s\">yarn@3.3.1.</span>\n<span class=\"pl-c1\">23.34</span> npm error notarget <span class=\"pl-c1\">In</span> most cases you <span class=\"pl-k\">or</span> one of your dependencies are requesting\n<span class=\"pl-c1\">23.34</span> npm error notarget a package version that doesn't exist.\n<span class=\"pl-c1\">23.35</span> npm notice\n<span class=\"pl-c1\">23.35</span> npm notice New minor version of npm <span class=\"pl-c1\">available!</span> 10.8.3 -<span class=\"pl-k\">&gt;</span> 10.9.0\n<span class=\"pl-c1\">23.35</span> npm notice <span class=\"pl-c1\">Changelog:</span> <span class=\"pl-s\">https://github.com/npm/cli/releases/tag/v10.9.0</span>\n<span class=\"pl-c1\">23.35</span> npm notice To <span class=\"pl-c1\">update</span> <span class=\"pl-c1\">run:</span> npm install -g <span class=\"pl-s\">npm@10.9.0</span>\n<span class=\"pl-c1\">23.35</span> npm notice\n<span class=\"pl-c1\">23.35</span> npm error A complete log of this run can be found <span class=\"pl-c1\">in:</span> <span class=\"pl-k\">/root/.npm/_logs/2024-10-04T09_44_19_632Z-debug-0.log</span>\n------\n<span class=\"pl-s\">Dockerfile:40</span>\n--------------------\n  <span class=\"pl-c1\">39</span> |     ENV <span class=\"pl-c1\">PATH=/usr/local/node/bin:</span>$PATH\n  <span class=\"pl-c1\">40</span> | <span class=\"pl-k\">&gt;&gt;&gt;</span> RUN curl -sL <span class=\"pl-s\">https://github.com/nodenv/node-build/archive/master.tar.gz</span> | tar xz -C <span class=\"pl-k\">/tmp/</span> &amp;&amp; \\\n  <span class=\"pl-c1\">41</span> | <span class=\"pl-k\">&gt;&gt;&gt;</span>     <span class=\"pl-k\">/tmp/node-build-master/bin/node-build</span> <span class=\"pl-s\">\"${NODE_VERSION}\"</span> <span class=\"pl-k\">/usr/local/node</span> &amp;&amp; \\\n  <span class=\"pl-c1\">42</span> | <span class=\"pl-k\">&gt;&gt;&gt;</span>     npm install -g <span class=\"pl-s\">yarn@$YARN_VERSION</span> &amp;&amp; \\\n  <span class=\"pl-c1\">43</span> | <span class=\"pl-k\">&gt;&gt;&gt;</span>     rm -rf <span class=\"pl-k\">/tmp/node-build-master</span>\n  <span class=\"pl-c1\">44</span> |     \n--------------------\n<span class=\"pl-c1\">ERROR:</span> failed <span class=\"pl-c1\">to</span> <span class=\"pl-c1\">solve:</span> process <span class=\"pl-s\">\"/bin/sh -c curl -sL https://github.com/nodenv/node-build/archive/master.tar.gz | tar xz -C /tmp/ &amp;&amp;     /tmp/node-build-master/bin/node-build \\\"</span>$<span class=\"pl-s\">{NODE_VERSION}</span>\\<span class=\"pl-s\">\" /usr/local/node &amp;&amp;     npm install -g yarn@$YARN_VERSION &amp;&amp;     rm -rf /tmp/node-build-master\"</span> did <span class=\"pl-c1\">not</span> complete <span class=\"pl-c1\">successfully:</span> <span class=\"pl-k\">exit</span> <span class=\"pl-c1\">code:</span> <span class=\"pl-c1\">1</span></pre></div>\n</details>\nSo, I dig the yarn documentation and found why `npm install -g yarn@3.3.1 &amp;&amp;` fail.\nBecause Yarn &gt; 1.x.x isn't installable through NPM since 2019. \n<p dir=\"auto\">Extract from Yarn documentation :<br>\n<a href=\"https://yarnpkg.com/getting-started/qa#why-is-the-yarn-package-on-npm-still-on-1x\" rel=\"nofollow\">Why is the yarn package on npm still on 1.x?</a></p>\n<blockquote>\n<p dir=\"auto\">Why is the yarn package on npm still on 1.x?</p>\n<p dir=\"auto\">Modern releases of Yarn haven't been distributed on npm since 2019.</p>\n<p dir=\"auto\">The reason is simple: because Yarn wasn't distributed alongside Node.js, many people relied on something like npm install -g yarn as part of their image building. It meant that any breaking change would make their way on everyone using this pattern, and break their deployments.</p>\n<p dir=\"auto\">As a result, we decided to retire the yarn npm package and only use it for the few 1.x maintenance releases needed. Yarn is now installed directly from our website, via either Corepack or yarn set version.\"</p>\n</blockquote>\n<p dir=\"auto\">After this fix, Yarn warns us that <code class=\"notranslate\">--frozen-lockfile</code> is deprecated, so I've replaced it with <code class=\"notranslate\">--immutable</code>.</p>\n\n<h3 dir=\"auto\">Detail</h3>\n<ul dir=\"auto\">\n<li>This Pull Request changes add a method in the app generator to check if the yarn version need installation through Corepack instead of NPM (&gt;1.x.x).</li>\n<li>The yarn flag <code class=\"notranslate\">--frozen-lockfile</code> is deprecated, so I've replaced it with <code class=\"notranslate\">--immutable</code></li>\n</ul>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">As it's my first rails PR, I'm sorry if this fix isn't relevant.</p>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53174",
            "title": "[Dockerfile] Fix yarn installation method for yarn > 1.x.x",
            "date_modified": "2024-10-04T10:06:00.000Z",
            "date_published": "2024-10-04T10:05:56.000Z",
            "author": {
                "name": "BarnabeD",
                "url": "https://github.com/BarnabeD"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Follow up to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2563418980\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/53160\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/53160/hovercard\" href=\"https://github.com/rails/rails/pull/53160\">#53160</a></p>\n<p dir=\"auto\">Technically this is a behavior change so adding a changelog and tests to prevent regressions.</p>\n<p dir=\"auto\">That change was also backported to 7.2, so this can be too.</p>",
            "url": "https://github.com/rails/rails/pull/53169",
            "title": "Add tests and changelog for \"Fix log level of ActiveJob :retry_stopped event\"",
            "date_modified": "2024-10-04T16:25:23.000Z",
            "date_published": "2024-10-04T05:50:34.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/12413247?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request addresses the issue of caching bundler dependencies in a Dev Container setup, which can significantly speed up container startup times by avoiding the need to reinstall gems on every new container creation.</p>\n<p dir=\"auto\">It is a follow-up to an existing PR (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2557605519\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/53123\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/53123/hovercard\" href=\"https://github.com/rails/rails/pull/53123\">#53123</a>) by <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/patriciomacadden/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/patriciomacadden\">@patriciomacadden</a>, which introduced a similar feature using <code class=\"notranslate\">ghcr.io/rails/devcontainer/features/bundler-cache</code>.</p>\n<p dir=\"auto\">However, as discussed in that PR, my approach offers a simpler solution by directly mounting a volume for the <code class=\"notranslate\">.rbenv</code> directory, which includes bundler dependencies. This implementation minimizes additional configuration while still solving the problem effectively.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the <code class=\"notranslate\">devcontainer.json</code> configuration by adding a volume that caches the <code class=\"notranslate\">.rbenv</code> directory.</p>\n<h3 dir=\"auto\">Additional Information</h3>\n<p dir=\"auto\">For more context, please refer to my related PR in an example Rails app repository: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2561168912\" data-permission-text=\"Title is private\" data-url=\"https://github.com/viktorianer/rails8-devcontainer-enhancements/issues/13\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/viktorianer/rails8-devcontainer-enhancements/pull/13/hovercard\" href=\"https://github.com/viktorianer/rails8-devcontainer-enhancements/pull/13\">viktorianer/rails8-devcontainer-enhancements#13</a>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53161",
            "title": "Add bundler-cache feature in dev container setup",
            "date_modified": "2024-10-04T22:22:09.000Z",
            "date_published": "2024-10-03T10:14:41.000Z",
            "author": {
                "name": "viktorianer",
                "url": "https://github.com/viktorianer"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Prior to this commit, <code class=\"notranslate\">:block</code> options only supported callables. This commit aims to bring browser blocking closer in parity to callbacks declarations like <code class=\"notranslate\">before_action</code> and <code class=\"notranslate\">after_action</code> by supporting instance method names as well.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53158",
            "title": "AllowBrowser: support method names for `:block`",
            "date_modified": "2024-10-05T00:41:45.000Z",
            "date_published": "2024-10-03T01:37:46.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Currently, when multiple databases are configured and someone runs <code class=\"notranslate\">bin/rails db:schema:load:name</code>, rails will load schema to the relevant <code class=\"notranslate\">development</code> database and just drop the <code class=\"notranslate\">test</code> database (without loading the schema). This is incorrect and differs from the behavior when only a single database is configured (both for <code class=\"notranslate\">development</code> and <code class=\"notranslate\">test</code> the schema is loaded).</p>\n<p dir=\"auto\">Also, if the application does not have a <code class=\"notranslate\">test</code> databases configured in <code class=\"notranslate\">config/database.yml</code>, <code class=\"notranslate\">bin/rails db:schema:load:name</code> fails with the following error:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"bin/rails aborted!\nTypeError: Invalid type for configuration. Expected Symbol, String, or Hash. Got nil (TypeError)\n\n        raise TypeError, &quot;Invalid type for configuration. Expected Symbol, String, or Hash. Got #{config.inspect}&quot;\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\"><pre class=\"notranslate\"><code class=\"notranslate\">bin/rails aborted!\nTypeError: Invalid type for configuration. Expected Symbol, String, or Hash. Got nil (TypeError)\n\n        raise TypeError, \"Invalid type for configuration. Expected Symbol, String, or Hash. Got #{config.inspect}\"\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre></div>\n<p dir=\"auto\">Both of these problems are fixed in this PR.</p>",
            "url": "https://github.com/rails/rails/pull/53156",
            "title": "Load test shard schema when loading development shard schema",
            "date_modified": "2024-10-03T16:33:56.000Z",
            "date_published": "2024-10-03T00:40:57.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This was inspired by <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2049804724\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50405\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50405/hovercard\" href=\"https://github.com/rails/rails/pull/50405\">#50405</a>.</p>\n<p dir=\"auto\">If you accidentally pretty print <code class=\"notranslate\">ActiveStorage::Blob.services</code> and have the entire config which may contain secrets persit in logs or elsewhere.</p>\n<p dir=\"auto\">Or in Ruby 3.2 and older, raising an exception on those objects, e.g. <code class=\"notranslate\">ActiveStorage::Blob.services[:local]</code> instead of <code class=\"notranslate\">fetch</code>.<br>\nFor this reason, I would also like to consider this a bug-fix and backport it to 7.2 and 7.1, where the issue is even more apparent given the older versions of Ruby supported.</p>\n<p dir=\"auto\">Before:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"pp ActiveStorage::Blob.services\n  #&lt;ActiveStorage::Service::Registry:0x00007f2a68469d28\n    @configurations={\n      :s3 =&gt; {\n        :service=&gt;&quot;S3&quot;,\n        :access_key_id=&gt;&quot;test_key&quot;,\n        :secret_access_key=&gt;&quot;test_secret&quot;,\n        :region=&gt;&quot;us-east-1&quot;,\n        :bucket=&gt;&quot;rails-test&quot;\n      },\n      :gcs =&gt; { :service=&gt;&quot;GCS&quot;, :credentials=&gt; &quot;secret-hash&quot; }\n    }\n    @services={}&gt;\"><pre class=\"notranslate\"><span class=\"pl-en\">pp</span> <span class=\"pl-v\">ActiveStorage</span>::<span class=\"pl-v\">Blob</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">services</span>\n  <span class=\"pl-c\">#&lt;ActiveStorage::Service::Registry:0x00007f2a68469d28</span>\n    <span class=\"pl-c1\">@configurations</span><span class=\"pl-c1\">=</span><span class=\"pl-kos\">{</span>\n      <span class=\"pl-pds\">:s3</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n        <span class=\"pl-pds\">:service</span><span class=\"pl-c1\">=&gt;</span><span class=\"pl-s\">\"S3\"</span><span class=\"pl-kos\">,</span>\n        <span class=\"pl-pds\">:access_key_id</span><span class=\"pl-c1\">=&gt;</span><span class=\"pl-s\">\"test_key\"</span><span class=\"pl-kos\">,</span>\n        <span class=\"pl-pds\">:secret_access_key</span><span class=\"pl-c1\">=&gt;</span><span class=\"pl-s\">\"test_secret\"</span><span class=\"pl-kos\">,</span>\n        <span class=\"pl-pds\">:region</span><span class=\"pl-c1\">=&gt;</span><span class=\"pl-s\">\"us-east-1\"</span><span class=\"pl-kos\">,</span>\n        <span class=\"pl-pds\">:bucket</span><span class=\"pl-c1\">=&gt;</span><span class=\"pl-s\">\"rails-test\"</span>\n      <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">:gcs</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">:service</span><span class=\"pl-c1\">=&gt;</span><span class=\"pl-s\">\"GCS\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:credentials</span><span class=\"pl-c1\">=&gt;</span> <span class=\"pl-s\">\"secret-hash\"</span> <span class=\"pl-kos\">}</span>\n    <span class=\"pl-kos\">}</span>\n    <span class=\"pl-c1\">@services</span><span class=\"pl-c1\">=</span><span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span>&gt;<span class=\"pl-en\"></span></pre></div>\n<p dir=\"auto\">After</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"  #&lt;ActiveStorage::Service::Registry configurations=[:s3, :gcs]&gt;\"><pre class=\"notranslate\">  <span class=\"pl-c\">#&lt;ActiveStorage::Service::Registry configurations=[:s3, :gcs]&gt;</span></pre></div>",
            "url": "https://github.com/rails/rails/pull/53153",
            "title": "Add inspect to ActiveStorage::Service, ActiveStorage::Service::Registry, and ActiveStorage::Service::Configurator",
            "date_modified": "2024-10-02T14:38:28.000Z",
            "date_published": "2024-10-02T14:38:24.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Prior to this commit, <code class=\"notranslate\">:by</code> and <code class=\"notranslate\">:with</code> options only supported callables. This commit aims to bring rate limiting closer in parity to callbacks declarations like <code class=\"notranslate\">before_action</code> and <code class=\"notranslate\">after_action</code> by supporting instance method names as well.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">In order to support methods, this commit extends the <code class=\"notranslate\">#request</code> object to be aware of the rate limit data. Additionally, this commit changes the default behavior from a <code class=\"notranslate\">head :too_many_requests</code> call to instead raise a new <code class=\"notranslate\">ActionController::TooManyRequests</code> error. Application-side controllers can be configured to <code class=\"notranslate\">rescue_from</code> that exception, or they can rely on a new <code class=\"notranslate\">ActionController::TooManyRequests</code> to <code class=\"notranslate\">429 Too many requests</code> status mapping entry in the<br>\n<code class=\"notranslate\">ActionDispatch/Middleware/ExceptionWrapper</code> error-to-status mapping.</p>\n<p dir=\"auto\">To support that change, this commit introduces the <code class=\"notranslate\">ActionController::RateLimiting::Request</code> and<br>\n<code class=\"notranslate\">ActionController::RateLimiting::Response</code> modules to mix into <code class=\"notranslate\">ActionDispatch::Request</code> and <code class=\"notranslate\">ActionDispatch::Response</code>, respectively.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">These extensions make rate limit information available to each object: the name, count, and cooldown period available to the request (through the <code class=\"notranslate\">#rate_limit</code> attribute), and the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After\" rel=\"nofollow\">Retry-After</a> header timestamp available to the response (through the <code class=\"notranslate\">#retry_after</code> attribute).</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53146",
            "title": "RateLimiting: support method names for `:by` and `:with`",
            "date_modified": "2024-10-04T14:39:45.000Z",
            "date_published": "2024-10-02T03:42:20.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/111?u=698df752d6ea3357a89cb8edd8571b446038d525&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Currently, :resque is still listed in the generated production.rb file.</p>\n<p dir=\"auto\">This changes the generated <code class=\"notranslate\">production.rb</code> to :solid_queue and specifies the :queue database which is how it's generated in new applications.</p>\n<p dir=\"auto\">I noticed it when upgrading my application to 8.0 as it was nuking my :solid_queue configuration in production.</p>\n<p dir=\"auto\">I believe this was likely intended to be included in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2506558220\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52804\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52804/hovercard\" href=\"https://github.com/rails/rails/pull/52804\">#52804</a></p>\n<p dir=\"auto\">Addresses <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2560053921\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/53141\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/53141/hovercard\" href=\"https://github.com/rails/rails/issues/53141\">#53141</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/53143",
            "title": "Use Solid Queue in the production environment configuration",
            "date_modified": "2024-10-03T17:44:15.000Z",
            "date_published": "2024-10-01T19:54:49.000Z",
            "author": {
                "name": "HamptonMakes",
                "url": "https://github.com/HamptonMakes"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5658207?u=596fe0fc2e3ea62c7c5e970efca3006eb3b81089&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">The motivation for this change is because we wish to make use of transactions in our tests but there are some databases that we don't or cannot use transactions with.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This pull request adds a new attribute to <code class=\"notranslate\">TestFixtures</code>, <code class=\"notranslate\">ignore_transactions_dbnames</code> that allows you to return an array of database names to disable transactions for that database. This is orthogonal to the <code class=\"notranslate\">use_transactional_tests</code> setting to disable or enable transactions for <em>all</em> connections.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">N/A</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>\n<p dir=\"auto\">cc: <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/mmareve/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/mmareve\">@mmareve</a>, <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/vdye/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/vdye\">@vdye</a>, <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a></p>",
            "url": "https://github.com/rails/rails/pull/53139",
            "title": "Add support for disabling transactions per database in `ActiveRecord`",
            "date_modified": "2024-10-05T06:36:40.000Z",
            "date_published": "2024-10-01T15:28:43.000Z",
            "author": {
                "name": "mjcheetham",
                "url": "https://github.com/mjcheetham"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/245443?u=a95b823cd933875b07547e7bd1a81ae227e83603&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><code class=\"notranslate\">rubocop -A</code> would generate false positive fixes.<br>\nAfter this change we use <code class=\"notranslate\">rubocop -a</code> instead.<br>\nThe idea is not to change semantics with RuboCop<br>\nSee <a href=\"https://docs.rubocop.org/rubocop/usage/auto_correct.html#safe-auto-correct\" rel=\"nofollow\">https://docs.rubocop.org/rubocop/usage/auto_correct.html#safe-auto-correct</a></p>",
            "url": "https://github.com/rails/rails/pull/53138",
            "title": "Autocorrect safely with RuboCop",
            "date_modified": "2024-10-01T15:55:39.000Z",
            "date_published": "2024-10-01T15:12:24.000Z",
            "author": {
                "name": "schmijos",
                "url": "https://github.com/schmijos"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14981592?u=11406fb0121b15a93b3305388377a57b4d9c96f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">It's commonly used for normalization but there is a dedicated method in AR for that. Switch it out to an example that doesn't perform normalization, and suggest <code class=\"notranslate\">normalizes</code> if the user wants to do that.</p>\n<p dir=\"auto\">I'm don't know how orthodox it is to mention ActiveRecord in ActiveModel docs. There are at least some matches right now already.</p>",
            "url": "https://github.com/rails/rails/pull/53133",
            "title": "Promote `normalizes` in `before_validation` docs",
            "date_modified": "2024-10-03T12:50:16.000Z",
            "date_published": "2024-10-01T12:28:05.000Z",
            "author": {
                "name": "Earlopain",
                "url": "https://github.com/Earlopain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/236461?u=cd87f40664f26021ba65daabaf812a036c1f4c8e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><code class=\"notranslate\">rails new --help</code> currently shows this after <code class=\"notranslate\">[--skip-solid</code>]: <code class=\"notranslate\"># Skip Solid Cache &amp; Queue setup</code>.</p>\n<p dir=\"auto\">This PR adds a missing mention to <code class=\"notranslate\">Cable</code>.</p>\n<p dir=\"auto\">Alternatively the help message could just say <code class=\"notranslate\">Skip Solid adapters</code>.</p>",
            "url": "https://github.com/rails/rails/pull/53128",
            "title": "Mention Cable in `--skip-solid` help",
            "date_modified": "2024-10-03T12:42:51.000Z",
            "date_published": "2024-10-01T02:41:45.000Z",
            "author": {
                "name": "jeromedalbert",
                "url": "https://github.com/jeromedalbert"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/4910785?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">All meta descriptions and og:description meta tags currently are prefixed with the specific guide's h1. This happens when sanitizing the headers html fragment.</p>\n<p dir=\"auto\">For example:</p>\n<p dir=\"auto\">Before this change the (og)-description of the ActionCable guide was:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"content=&quot;Action Cable OverviewIn this guide...\"><pre class=\"notranslate\"><code class=\"notranslate\">content=\"Action Cable OverviewIn this guide...\n</code></pre></div>\n<p dir=\"auto\">Note the \"Action Cable Overview\" prefix without a whitespace.</p>\n<p dir=\"auto\">After this change the description is:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"content=&quot;In this guide...&quot;\"><pre class=\"notranslate\"><code class=\"notranslate\">content=\"In this guide...\"\n</code></pre></div>",
            "url": "https://github.com/rails/rails/pull/53124",
            "title": "Fix prefixed headings in guide pages meta descriptions",
            "date_modified": "2024-10-04T01:25:39.000Z",
            "date_published": "2024-09-30T20:46:18.000Z",
            "author": {
                "name": "codergeek121",
                "url": "https://github.com/codergeek121"
            }
        }
    ]
}