{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/58582?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Taken from: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2165609779\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51242\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51242/hovercard\" href=\"https://github.com/rails/rails/issues/51242\">#51242</a></p>\n<p dir=\"auto\">In ActiveRecord 7.1, a new option was added to <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Batches.html#method-i-in_batches\" rel=\"nofollow\">ActiveRecord::Batches#in_batches</a>, <code class=\"notranslate\">use_ranges: true</code>, that enables a more efficient way to generate queries from the provided scope for each batch.</p>\n<p dir=\"auto\">The resulting queries use ranges to select record ids, e.g. <code class=\"notranslate\">WHERE id &gt; 10000 AND id &lt;= 20000</code> instead of passing a possibly very long list of ids in an <code class=\"notranslate\">IN</code> clause, e.g. <code class=\"notranslate\">IN (10000, 10001, [...,] 19999, 20000)</code>.</p>\n<p dir=\"auto\">This option was implemented in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1277547479\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45414\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/45414/hovercard\" href=\"https://github.com/rails/rails/pull/45414\">#45414</a>.</p>\n<p dir=\"auto\">The implementation of <code class=\"notranslate\">use_ranges: true</code> relies on the already implemented strategy to select all ids from the range (needed for <code class=\"notranslate\">use_ranges: false</code>), when generating the scope for each batch.</p>\n<p dir=\"auto\">The typical SQL query to generate a scope for a batch is (example with batches of 10k records):</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"SELECT &quot;users&quot;.&quot;id&quot; FROM &quot;users&quot; WHERE &quot;users&quot;.&quot;id&quot; &gt; ... ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT 10000;\"><pre class=\"notranslate\"><span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">WHERE</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">&gt;</span> ... <span class=\"pl-k\">ORDER BY</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">ASC</span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">10000</span>;</pre></div>\n<p dir=\"auto\">But subsequently, all these ids but the last one are discarded:</p>\n<p dir=\"auto\"><a href=\"https://github.com/rails/rails/blob/v7.1.3.2/activerecord/lib/active_record/relation/batches.rb#L379-L380\">https://github.com/rails/rails/blob/v7.1.3.2/activerecord/lib/active_record/relation/batches.rb#L379-L380</a></p>\n<p dir=\"auto\"><strong>This method wastes resources in the database (CPU, I/O), in transit (bandwidth) and in the Ruby process (RAM).</strong></p>\n<p dir=\"auto\">This Pull Request is a proposal to save these resources by implementing <strong>an additional optimisation</strong>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">The description below applies only to the use of <code class=\"notranslate\">in_batches</code> <strong>with</strong> the option <code class=\"notranslate\">use_ranges: true</code>.</p>\n<p dir=\"auto\">Instead of returning all the ids for each batch, we use <code class=\"notranslate\">OFFSET</code> to search for the last id of the next batch and return only this single id, e.g.</p>\n<div class=\"highlight highlight-source-diff notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"  -- queries for all batches but the last (before/after)\n- SELECT &quot;users&quot;.&quot;id&quot; FROM &quot;users&quot; WHERE &quot;users&quot;.&quot;id&quot; &gt; ... ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT 10000;\n+ SELECT &quot;users&quot;.&quot;id&quot; FROM &quot;users&quot; WHERE &quot;users&quot;.&quot;id&quot; &gt; ... ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT 1 OFFSET 9999;\"><pre class=\"notranslate\">  -- queries for all batches but the last (before/after)\n<span class=\"pl-md\"><span class=\"pl-md\">-</span> SELECT \"users\".\"id\" FROM \"users\" WHERE \"users\".\"id\" &gt; ... ORDER BY \"users\".\"id\" ASC LIMIT 10000;</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span> SELECT \"users\".\"id\" FROM \"users\" WHERE \"users\".\"id\" &gt; ... ORDER BY \"users\".\"id\" ASC LIMIT 1 OFFSET 9999;</span></pre></div>\n<p dir=\"auto\">There is one downside, however.</p>\n<p dir=\"auto\">Our <code class=\"notranslate\">OFFSET</code>-based query won't be able to return the last id if the next batch is smaller than the limit or if there's no next batch. In that case, we need one additional query to get the size and last id of the very last batch, as we did before:</p>\n<div class=\"highlight highlight-source-diff notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"  -- queries for the last batch (before/after)\n- SELECT &quot;users&quot;.&quot;id&quot; FROM &quot;users&quot; WHERE &quot;users&quot;.&quot;id&quot; &gt; ... ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT 10000;\n+ SELECT &quot;users&quot;.&quot;id&quot; FROM &quot;users&quot; WHERE &quot;users&quot;.&quot;id&quot; &gt; ... ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT 1 OFFSET 9999;\n+ SELECT &quot;users&quot;.&quot;id&quot; FROM &quot;users&quot; WHERE &quot;users&quot;.&quot;id&quot; &gt; ... ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT 10000;\"><pre class=\"notranslate\">  -- queries for the last batch (before/after)\n<span class=\"pl-md\"><span class=\"pl-md\">-</span> SELECT \"users\".\"id\" FROM \"users\" WHERE \"users\".\"id\" &gt; ... ORDER BY \"users\".\"id\" ASC LIMIT 10000;</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span> SELECT \"users\".\"id\" FROM \"users\" WHERE \"users\".\"id\" &gt; ... ORDER BY \"users\".\"id\" ASC LIMIT 1 OFFSET 9999;</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span> SELECT \"users\".\"id\" FROM \"users\" WHERE \"users\".\"id\" &gt; ... ORDER BY \"users\".\"id\" ASC LIMIT 10000;</span></pre></div>\n<p dir=\"auto\">Unless we only have a handful of small batches, this strategy is a winner overall, as it reduces the time and network resources spent generating batches, as shown by the benchmark below.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<h4 dir=\"auto\">Benchmark</h4>\n<p dir=\"auto\">Let's reuse the benchmark from the description of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1277547479\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45414\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/45414/hovercard\" href=\"https://github.com/rails/rails/pull/45414\">#45414</a>, i.e. the same <code class=\"notranslate\">users</code> table with <code class=\"notranslate\">10M</code> records, but with two modifications:</p>\n<ul dir=\"auto\">\n<li>Batches of 10k records instead of 1k;</li>\n<li>No call to <code class=\"notranslate\">batch.count</code> on each batch since we are measuring only on the time and resources needed to generate the scopes, not to use them.</li>\n</ul>\n<p dir=\"auto\">Here is the code used:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"CREATE TABLE users (id bigserial PRIMARY KEY, val integer DEFAULT 0);\nINSERT INTO users SELECT i FROM generate_series(1, 10000000) AS i;\"><pre class=\"notranslate\"><span class=\"pl-k\">CREATE</span> <span class=\"pl-k\">TABLE</span> <span class=\"pl-en\">users</span> (id <span class=\"pl-k\">bigserial</span> <span class=\"pl-k\">PRIMARY KEY</span>, val <span class=\"pl-k\">integer</span> DEFAULT <span class=\"pl-c1\">0</span>);\n<span class=\"pl-k\">INSERT INTO</span> users <span class=\"pl-k\">SELECT</span> i <span class=\"pl-k\">FROM</span> generate_series(<span class=\"pl-c1\">1</span>, <span class=\"pl-c1\">10000000</span>) <span class=\"pl-k\">AS</span> i;</pre></div>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"start = Process.clock_gettime(Process::CLOCK_MONOTONIC)\n\ncount = 0\nUser.in_batches(of: 10_000) do |batch|\n  count += 1  # previously: batch.count, but we don't want to trigger any other queries in this benchmark\nend\n\nputs &quot;Count = #{count}&quot;\nelapsed = Process.clock_gettime(Process::CLOCK_MONOTONIC) - start\nputs &quot;Elapsed: #{elapsed}s&quot;\"><pre class=\"notranslate\"><span class=\"pl-s1\">start</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Process</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">clock_gettime</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Process</span>::<span class=\"pl-c1\">CLOCK_MONOTONIC</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-s1\">count</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">0</span>\n<span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">in_batches</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">of</span>: <span class=\"pl-c1\">10_000</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">batch</span>|\n  <span class=\"pl-s1\">count</span> += <span class=\"pl-c1\">1</span>  <span class=\"pl-c\"># previously: batch.count, but we don't want to trigger any other queries in this benchmark</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-en\">puts</span> <span class=\"pl-s\">\"Count = <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">count</span><span class=\"pl-kos\">}</span></span>\"</span>\n<span class=\"pl-s1\">elapsed</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Process</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">clock_gettime</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Process</span>::<span class=\"pl-c1\">CLOCK_MONOTONIC</span><span class=\"pl-kos\">)</span> - <span class=\"pl-s1\">start</span>\n<span class=\"pl-en\">puts</span> <span class=\"pl-s\">\"Elapsed: <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">elapsed</span><span class=\"pl-kos\">}</span></span>s\"</span></pre></div>\n<p dir=\"auto\">The benchmark is executed on a single machine (a recent macbook), with a round-trip-time &lt; 1ms.</p>\n<p dir=\"auto\">The network (I/O) stats are obtained by comparing the result of this command before/after a benchmark run:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"docker stats --no-stream postgres --format 'table {{.NetIO}}'\"><pre class=\"notranslate\"><code class=\"notranslate\">docker stats --no-stream postgres --format 'table {{.NetIO}}'\n</code></pre></div>\n<p dir=\"auto\"><strong>Here are the results:</strong></p>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Batching method</th>\n<th align=\"right\">Duration</th>\n<th align=\"right\">Network (I/O)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>in_batches(use_ranges: true)</td>\n<td align=\"right\">5.6 s.</td>\n<td align=\"right\">¬†¬†1.2 MB / ¬†¬†180 MB</td>\n</tr>\n<tr>\n<td>in_batches(use_ranges: true) + optim from this PR</td>\n<td align=\"right\">2.3 s.</td>\n<td align=\"right\">¬†¬†&lt; 0.5 MB /  &lt; 0.2 MB</td>\n</tr>\n</tbody>\n</table>\n<p dir=\"auto\">In this benchmark, we managed to <strong>generate scopes for batches <code class=\"notranslate\">x2.4</code> times faster and with <code class=\"notranslate\">x900</code> times less bandwidth</strong>. These results will of course typically vary with the batch size used, and the network speed.</p>\n<p dir=\"auto\">The absolute values may not seem like huge gains, but I'm considering using <code class=\"notranslate\">in_batches(use_ranges: true)</code> on tables with over 3 billion records, where this benchmark would show a saving of at least <code class=\"notranslate\">16+ minutes</code> and <code class=\"notranslate\">52.7 GB</code> of bandwidth (+ the database resources needed to extract/send this traffic).</p>\n<h4 dir=\"auto\">Other strategies considered</h4>\n<p dir=\"auto\">Using <code class=\"notranslate\">OFFSET</code> is not be the only way to achieve the same kind of optimisation.</p>\n<p dir=\"auto\">For example, we could consider using a strategy based on the calculation of the maximum id + batch size for each batch (details folded below).</p>\n<details>\n  <summary>Using a CTE</summary>\n<br>\nWe could use a CTE like this one:\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"WITH &quot;batch_ids&quot; AS (\n    -- same query as today\n    SELECT &quot;users&quot;.&quot;id&quot; FROM &quot;users&quot; WHERE (id &gt; 10000) ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT 10000\n)\nSELECT COUNT(id) AS last_batch_size, MAX(id) AS last_batch_id FROM batch_ids;\"><pre class=\"notranslate\">WITH <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>batch_ids<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">AS</span> (\n    <span class=\"pl-c\"><span class=\"pl-c\">--</span> same query as today</span>\n    <span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">WHERE</span> (id <span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">10000</span>) <span class=\"pl-k\">ORDER BY</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">ASC</span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">10000</span>\n)\n<span class=\"pl-k\">SELECT</span> <span class=\"pl-c1\">COUNT</span>(id) <span class=\"pl-k\">AS</span> last_batch_size, <span class=\"pl-c1\">MAX</span>(id) <span class=\"pl-k\">AS</span> last_batch_id <span class=\"pl-k\">FROM</span> batch_ids;</pre></div>\n<p dir=\"auto\">This would be advantageous, as we would not have to use that \"extra\" query for the last batch as we did above.</p>\n<p dir=\"auto\">Nevertheless, using a CTE would have the following downsides:</p>\n<ol dir=\"auto\">\n<li>CTEs are not supported yet by all RDBMS supported by Active Record (MySQL &lt; 8.0)</li>\n<li>To my knowledge, ActiveRecord does not provide any way to easily generate a query with to distinct \"calculations\" such as a count and a maximum. The \"manual\" workarounds for this could be complicated.</li>\n</ol>\n<p dir=\"auto\">For the record, the query above can be generated with:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"User.connection.select_one(\n  User\n    .with(batch_ids: User.select('id').where('id &gt; 10000').order(:id).limit(10000))\n    .from('batch_ids')\n    .select('COUNT(id) AS last_batch_size', 'MAX(id) AS last_batch_id')\n)\"><pre class=\"notranslate\"><span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">select_one</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-v\">User</span>\n    <span class=\"pl-kos\">.</span><span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">batch_ids</span>: <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">select</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'id'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'id &gt; 10000'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">order</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">limit</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">10000</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-kos\">.</span><span class=\"pl-en\">from</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'batch_ids'</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-kos\">.</span><span class=\"pl-en\">select</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'COUNT(id) AS last_batch_size'</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'MAX(id) AS last_batch_id'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-kos\">)</span></pre></div>\n</details>\n<details>\n  <summary>Using a subquery</summary>\n<br>\nWe could use a subquery like this one:\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"SELECT\n    COUNT(id) AS last_batch_size, MAX(id) AS last_batch_id\nFROM (\n    -- same query as today\n    SELECT &quot;users&quot;.&quot;id&quot; FROM &quot;users&quot; WHERE (id &gt; 10000) ORDER BY &quot;users&quot;.&quot;id&quot; ASC LIMIT 10000\n) subquery;\"><pre class=\"notranslate\"><span class=\"pl-k\">SELECT</span>\n    <span class=\"pl-c1\">COUNT</span>(id) <span class=\"pl-k\">AS</span> last_batch_size, <span class=\"pl-c1\">MAX</span>(id) <span class=\"pl-k\">AS</span> last_batch_id\n<span class=\"pl-k\">FROM</span> (\n    <span class=\"pl-c\"><span class=\"pl-c\">--</span> same query as today</span>\n    <span class=\"pl-k\">SELECT</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">FROM</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">WHERE</span> (id <span class=\"pl-k\">&gt;</span> <span class=\"pl-c1\">10000</span>) <span class=\"pl-k\">ORDER BY</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>users<span class=\"pl-pds\">\"</span></span>.<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>id<span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">ASC</span> <span class=\"pl-k\">LIMIT</span> <span class=\"pl-c1\">10000</span>\n) subquery;</pre></div>\n<p dir=\"auto\">Even better than the CTE version because this would be compatible with all RDBMS supported by ActiveRecord.</p>\n<p dir=\"auto\">For the record, the query above can be generated with:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"User.connection.select_one(\n  User.select('COUNT(id) AS last_batch_size', 'MAX(id) AS last_batch_id').from(\n    User.select('id').where('id &gt; 10000').order(:id).limit(10000)\n  )\n)\"><pre class=\"notranslate\"><span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">select_one</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">select</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'COUNT(id) AS last_batch_size'</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'MAX(id) AS last_batch_id'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">from</span><span class=\"pl-kos\">(</span>\n    <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">select</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'id'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'id &gt; 10000'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">order</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">limit</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">10000</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">)</span>\n<span class=\"pl-kos\">)</span></pre></div>\n<p dir=\"auto\">But to support all sorts of primary keys (including composites) and multiple calculations in a single query, I suspect some complicated work is required in Active Record. If you think this is feasible at a reasonable cost, please provide some guidance üôè</p>\n</details>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51243",
            "title": "[Fix #51242] Rework in_batches(use_ranges: true) to be more efficient",
            "date_modified": "2024-03-03T23:02:59.000Z",
            "date_published": "2024-03-03T23:02:54.000Z",
            "author": {
                "name": "maximerety",
                "url": "https://github.com/maximerety"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/3300?u=cf3591c7a347fea0be56c1a5701ad7b3731579f5&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">In using the <a href=\"https://api.rubyonrails.org/classes/ActionView/Helpers/TagHelper.html#method-i-tag\" rel=\"nofollow\"><code class=\"notranslate\">tag</code> helper</a> I found myself a little confused about how to use the block form of the helper with attributes. I wanted to ensure this usage was captured in the documentation for others.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">I've changed the example tag and added some attributes to illustrate usage.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51239",
            "title": "More complicated tag helper example",
            "date_modified": "2024-03-02T18:51:21.000Z",
            "date_published": "2024-03-02T18:51:17.000Z",
            "author": {
                "name": "jherdman",
                "url": "https://github.com/jherdman"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Related to <a href=\"https://github.com/rails/actiontext/issues/41\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/actiontext/issues/41/hovercard\">rails/actiontext#41</a></p>\n<p dir=\"auto\">The main aim of this changeset is to provide a single, extensible entrypoint for third-party editors (that are not Trix) to integrate with Action Text.</p>\n<p dir=\"auto\">The <code class=\"notranslate\">Editor</code> class (and the <code class=\"notranslate\">TrixEditor</code> implementation to integrate with <a href=\"https://trix-editor.org\" rel=\"nofollow\">Trix</a>) is introduced without a public interface. They are both introduced marked with <code class=\"notranslate\">:nodoc:</code> so that all of their methods are considered <code class=\"notranslate\">:nodoc:</code> as well. They're the only \"public\" part of this PR at the moment. This diff acknowledges their existence, but doesn't commit to any particular interface.</p>\n<p dir=\"auto\">Their surface area is intentionally small, and the scope of what's public is aggressively limited for the sake of deprecating the old methods and merging the changes that introduce the new methods. The idea is for Action Text to declare \"public interface bankruptcy\" for the majority of its inner classes. From that interface bankruptcy, third-party integrates can make ad-hoc extensions as they explore what methods are good candidates to be added and maintained as part of the <code class=\"notranslate\">Editor</code> API (for all Ruby, HTTP, and JavaScript interfaces). Once there's a need to pave the cowpaths, Action Text will have an opportunity to make additions to the interface without much burden of responsibility to maintain historical choices.</p>\n<p dir=\"auto\">Without the existence of the <code class=\"notranslate\">Editor</code> class to consolidate the rich text processing and rendering canonicalized <code class=\"notranslate\">&lt;action-text-attachment&gt;</code> elements, third-party extension would be challenging and potentially more tedious.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This proposes that the entry point should be the <code class=\"notranslate\">ActionText::Editor</code> class. In addition to introducing the new class itself along with its first <code class=\"notranslate\">ActionText::TrixEditor</code> subclass, this changeset also required additional integration points with the existing models and classes.</p>\n<h4 dir=\"auto\">Additions</h4>\n<p dir=\"auto\">The initial responsibilities of the <code class=\"notranslate\">ActionText::Editor</code> have been determined by consolidating a variety of (class- and instance-) methods across a variety of classes to reduce the number of touchpoints for applications and engines that provide third-party editor integrations. The vast majority of its method definitions are direct copy-and-pastes from their original sources. Any method that previously mentioned <code class=\"notranslate\">trix</code> in its name or argument list has replaced and generalized that occurrence with <code class=\"notranslate\">editor</code>.</p>\n<p dir=\"auto\">For example, this proposal draws inspiration from the <code class=\"notranslate\">ActiveStorage::Service</code> class and its related <code class=\"notranslate\">Registry</code> and <code class=\"notranslate\">Configurator</code> infrastructural classes to store per-record information about the editor used to create its constituent data.</p>\n<p dir=\"auto\">To store that metadata, this commit introduces a new migration that adds an <code class=\"notranslate\">action_text_rich_texts.editor_name</code> column to encode the editor. Since the out-of-the-box configuration (and the only historical choice) uses <code class=\"notranslate\">trix</code>, the migration backfills old data with <code class=\"notranslate\">action_text_rich_texts.editor_name = 'trix'</code>.</p>\n<p dir=\"auto\">The editors will be configured through a new <code class=\"notranslate\">config/rich_text.yml</code> file that also draws inspiration from <code class=\"notranslate\">config/storage.yml</code>. Applications (as well as third-party Editor engines) will provide their own <code class=\"notranslate\">config/rich_text.yml</code> files to introduce and configure additional editors.</p>\n<h4 dir=\"auto\">Changes</h4>\n<p dir=\"auto\">With the addition of the <code class=\"notranslate\">ActionText::Editor</code> class and the <code class=\"notranslate\">ActionText::RichText#editor</code> method, there is an opportunity to outsource the details of rendering editor form controls along with filling them out in System Tests to the Editor itself. This commit inverts the responsibility to render the field by introducing the <code class=\"notranslate\">Editor#rich_text_area_tag</code>. The <code class=\"notranslate\">rich_text_area_tag</code> method accepts an instance of <code class=\"notranslate\">ActionView::Base</code> as the <code class=\"notranslate\">view_context</code> argument to access the necessary render helpers. Similarly, the<br>\n<code class=\"notranslate\">Editor#fill_in_rich_text_area</code> method accepts a Capybara session argument.</p>\n<p dir=\"auto\">There is an opportunity to define <code class=\"notranslate\">Editor#rich_text_area_tag</code> in terms of <code class=\"notranslate\">#render_in(view_context, **locals, &amp;block)</code> once the <code class=\"notranslate\">#render_in</code> interface is extended to incorporate call-site keyword arguments and blocks.</p>\n<p dir=\"auto\">On the client-side, this changeset contains some noteworthy JavaScript modifications. For example, it exports the <code class=\"notranslate\">AttachmentUpload</code> class so that third-party editors can utilize it. To do so, it also modifies the constructor arguments to be more generalized. Instead of expecting a <code class=\"notranslate\">Trix.Attachment</code> instance and a browser <code class=\"notranslate\">File</code>, it accepts a \"delegate\" object to provide the <code class=\"notranslate\">File</code> and to respond to upload lifecycle methods.</p>\n<p dir=\"auto\">Additionally, the <code class=\"notranslate\">AttachmentUpload.start</code> function returns a <code class=\"notranslate\">Promise</code> to match asynchronous programming styles that don't utilize callbacks.</p>\n<h4 dir=\"auto\">Deprecations</h4>\n<p dir=\"auto\">The introduction of the <code class=\"notranslate\">Editor</code> class enables the deprecation of a variety of class- and instance-level methods across the <code class=\"notranslate\">ActionText</code> namespace. The main motivation of these deprecations is to seize the opportunity to reset Action Text's public API.</p>\n<p dir=\"auto\">There are two categories of deprecations in this changeset: <code class=\"notranslate\">module</code>/<code class=\"notranslate\">class</code> deprecations and method deprecations.</p>\n<p dir=\"auto\">The <code class=\"notranslate\">module</code> and <code class=\"notranslate\">class</code> deprecations target modules that are internal and \"private\" in intent, but public in Ruby and not marked as <code class=\"notranslate\">:nodoc:</code>. They're either particular to Trix, or their responsibilities have been given to <code class=\"notranslate\">ActionText::Editor</code>.</p>\n<p dir=\"auto\">The method deprecations also target methods that are internal and \"private\" in intent, but <code class=\"notranslate\">public</code> in Ruby and not marked as <code class=\"notranslate\">:nodoc:</code>. In general, determining whether or not to deprecate a method hinged on whether its name or arguments mentioned <code class=\"notranslate\">\"trix\"</code>, <em>or</em> if it lacked method-level documentation or comments of any kind.</p>\n<p dir=\"auto\">When possible, the previous code paths have been deprecated <em>and</em> re-implemented in terms of an <code class=\"notranslate\">ActionText::TrixEditor</code> instance.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">In its current state, this PR includes a test suite that <code class=\"notranslate\">ProsemirrorEditor</code> implementation to integrate with the <a href=\"https://prosemirror.net\" rel=\"nofollow\">ProseMirror</a> package. It contains a Ruby-side implementation as well as an ad hoc JavaScript implementation. The main purpose of this code was to explore what it'd take to replace Trix, and to drive out the necessary extensible methods and points of integration.</p>\n<p dir=\"auto\">It is not my intent to foist the burden of maintaining a third-party editor plugin in the test suite. I am also not proposing that ProseMirror be the first third-party editor to be given built-in support. I'm not sure how to proceed with the code, and have included it here to provide a general sketch of how an application or engine might integrate a WYSIWYG editor. I've left them included in the diff to provide code reviewers from Core with an opportunity to assess the client-side requirements and scan for opportunity to introduce new abstractions that Rails would want to support as part of its \"public\" JavaScript API.</p>\n<p dir=\"auto\">Once the reset of the code is in a mergable state, I'm happy to remove the Prosemirror Ruby / JavaScript / test code.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51238",
            "title": "Introduce `ActionText::Editor` to support WYSIWYG Editors",
            "date_modified": "2024-03-02T16:59:55.000Z",
            "date_published": "2024-03-02T13:22:19.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/50948617?u=e0731fc7b612eceeae21f01b0d425cf0aee40da4&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This PR is created because when a <code class=\"notranslate\">form_for</code> has the <code class=\"notranslate\">namespace</code> option, all other fields are prefixed with it except for the <code class=\"notranslate\">label</code> tag which has the <code class=\"notranslate\">for</code> option.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"form_for(@post, namespace: SecureRandom.urlsafe_base64) do |f|\n  concat f.label(:title, for: &quot;my_custom_post_title&quot;)\n  concat f.text_field(:title, id: &quot;my_custom_post_title&quot;)\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">form_for</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">@post</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">namespace</span>: <span class=\"pl-v\">SecureRandom</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">urlsafe_base64</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">f</span>|\n  <span class=\"pl-en\">concat</span> <span class=\"pl-s1\">f</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">label</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">for</span>: <span class=\"pl-s\">\"my_custom_post_title\"</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-en\">concat</span> <span class=\"pl-s1\">f</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">text_field</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">id</span>: <span class=\"pl-s\">\"my_custom_post_title\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">In the above example, the label will not be linked to the text field, which shouldn't be the case just because the <code class=\"notranslate\">namespace</code> option is present.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51237",
            "title": "Fix label with `for` option not getting prefixed by form `namespace` value",
            "date_modified": "2024-03-02T11:37:18.000Z",
            "date_published": "2024-03-02T11:37:13.000Z",
            "author": {
                "name": "abeidahmed",
                "url": "https://github.com/abeidahmed"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1966473?u=fe117732163d3610f051fca80df4e04c1b91335d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created to update and improve the Active Record Basics guide.</p>\n<h3 dir=\"auto\">Detail</h3>\n<ul dir=\"auto\">\n<li>Add more code examples and update existing examples.</li>\n<li>Make the connection between Active Record and Active Model clear</li>\n<li>Update Intro language to be more friendly, less jargon-y, clearly explain terms like ORM</li>\n</ul>\n<h3 dir=\"auto\">Testing</h3>\n<p dir=\"auto\">Run <code class=\"notranslate\">guides:generate</code> and <code class=\"notranslate\">guides:lint</code> locally and review the generated guide.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51226",
            "title": "[RF DOCS] Active Record Basics Guide [ci-skip]",
            "date_modified": "2024-03-04T00:01:06.000Z",
            "date_published": "2024-02-29T19:06:10.000Z",
            "author": {
                "name": "bhumi1102",
                "url": "https://github.com/bhumi1102"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5104186?u=c6802aa87b5de2965f8269a3798d468a08a2843b&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">I wanted to be able to use the native debugger tools in Neovim instead of having to use WebConsole or using the logger for debugging.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">The <code class=\"notranslate\">debug</code> gem, which is included in the Gemfile template supports remote debugging as of <a href=\"https://github.com/ruby/debug/releases/tag/v1.8.0\">version 1.8.0</a>. A <code class=\"notranslate\">debug</code> gem maintainer also maintains a <a href=\"https://marketplace.visualstudio.com/items?itemName=KoichiSasada.vscode-rdbg\" rel=\"nofollow\">VS Code extension</a> that can be used to connect to the running rdbg server in Rails.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">I'm not sure how to go about testing this. The entire change is to require files at the right times.</p>\n<p dir=\"auto\">I know the <code class=\"notranslate\">gem 'debug'</code> line will auto-require the debug gem. I thought it was a nicer developer experience to manually require it in case someone included <code class=\"notranslate\">, require: false</code>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51225",
            "title": "Add initializer to set up remote debugging in local environments",
            "date_modified": "2024-03-01T18:10:04.000Z",
            "date_published": "2024-02-29T18:02:26.000Z",
            "author": {
                "name": "natematykiewicz",
                "url": "https://github.com/natematykiewicz"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/605293?u=f09ba4ff4c7ffec1622589eca129d566d785e38e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2022175891\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50247\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50247/hovercard\" href=\"https://github.com/rails/rails/pull/50247\">#50247</a> introduced a regression for engines already defining a <code class=\"notranslate\">table_name_prefix</code> method which would make the default behaviour (ActiveRecord's config + engine's name) take precedence over the user defined method.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes how <code class=\"notranslate\">table_name_prefix</code> is programmatically defined when not already user-defined, removing usage of <code class=\"notranslate\">ActiveSupport.on_load(:active_record)</code> which delay execution of the block until later.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51223",
            "title": "Fix regression in isolated engine's `table_name_prefix` behaviour",
            "date_modified": "2024-02-29T14:47:57.000Z",
            "date_published": "2024-02-29T14:47:52.000Z",
            "author": {
                "name": "hubb",
                "url": "https://github.com/hubb"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/17757590?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49999.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1987597183\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49999\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49999/hovercard\" href=\"https://github.com/rails/rails/issues/49999\">#49999</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">ActiveRecord::Relation#order now properly references Arel::Attribute arguments</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51219",
            "title": "[Fix #49999] properly reference from Arel::Attribute args",
            "date_modified": "2024-02-29T19:21:31.000Z",
            "date_published": "2024-02-28T23:27:21.000Z",
            "author": {
                "name": "mylesboone",
                "url": "https://github.com/mylesboone"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5122678?u=204301f9f9fe8930fd26fe3bfe65b6ffaffd8b59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Re-opens <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1556770087\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47136\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47136/hovercard\" href=\"https://github.com/rails/rails/pull/47136\">#47136</a> which was accidentally closed when dealing with a merge conflict.</p>\n<hr>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Introduces <code class=\"notranslate\">other!</code> to the list of <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#module-ActiveRecord::Associations::ClassMethods-label-Singular+associations+-28one-to-one-29\" rel=\"nofollow\">generated methods</a> for singular associations.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"account.beneficiary\n#=&gt; nil\n\naccount.benificiary!\n#=&gt; #&lt;ActiveRecord::RecordNotFound&gt;\n\nBenificiary.create!(account: account)\naccount.benificiary!\n#=&gt; #&lt;Benificiary&gt;\n\nBenificiary.create!(account: account)\naccount.benificiary!\n#=&gt; #&lt;ActiveRecord::SoleRecordExceeded&gt;\"><pre class=\"notranslate\"><span class=\"pl-en\">account</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">beneficiary</span>\n<span class=\"pl-c\">#=&gt; nil</span>\n\n<span class=\"pl-en\">account</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">benificiary!</span>\n<span class=\"pl-c\">#=&gt; #&lt;ActiveRecord::RecordNotFound&gt;</span>\n\n<span class=\"pl-v\">Benificiary</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">account</span>: <span class=\"pl-en\">account</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-en\">account</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">benificiary!</span>\n<span class=\"pl-c\">#=&gt; #&lt;Benificiary&gt;</span>\n\n<span class=\"pl-v\">Benificiary</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">account</span>: <span class=\"pl-en\">account</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-en\">account</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">benificiary!</span>\n<span class=\"pl-c\">#=&gt; #&lt;ActiveRecord::SoleRecordExceeded&gt;</span></pre></div>\n<p dir=\"auto\">Rails provides the ability to <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/FinderMethods.html#method-i-sole\" rel=\"nofollow\">find the sole matching record via sole</a>. I thought adding this predicate method would compliment that existing behavior.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51214",
            "title": "Add `predicate` method to `has_one` accessors",
            "date_modified": "2024-02-28T15:12:24.000Z",
            "date_published": "2024-02-28T15:03:39.000Z",
            "author": {
                "name": "stevepolitodesign",
                "url": "https://github.com/stevepolitodesign"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/50305489?u=932e2c0a90f6fc4bf029e7e95faf5dcb5b0e2b97&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because there's no example for <code class=\"notranslate\">around_ </code> callbacks, so I think it's useful for newcomers like me</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes 2 files, adding an example for an <code class=\"notranslate\">around_update</code> callback:</p>\n<ul dir=\"auto\">\n<li><code class=\"notranslate\">activerecord/lib/active_record/callbacks.rb</code></li>\n<li><code class=\"notranslate\">guides/source/active_record_callbacks.md</code></li>\n</ul>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51211",
            "title": "[ci skip] docs: add around_update callback example",
            "date_modified": "2024-02-27T23:09:17.000Z",
            "date_published": "2024-02-27T14:45:38.000Z",
            "author": {
                "name": "MiguelArgentina",
                "url": "https://github.com/MiguelArgentina"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2786819?u=722b21f1f48dc9a97c9494aba04c4f657d31e941&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created to update the Active Model Basics Documentation.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds the following two sections:</p>\n<ul dir=\"auto\">\n<li>AttributeAssignment</li>\n<li>Attributes</li>\n</ul>\n<p dir=\"auto\">It updates the rest of the sections by trying to provide more information, be more clear, and include more examples. In some parts, it references the API where more information about the methods can be provided.</p>\n<p dir=\"auto\">I also addressed these as part of the changes:</p>\n<blockquote>\n<p dir=\"auto\">There's the new ActiveModel::API module that was essentially a split from ActiveModel::Model, this difference can be better explained in the guides as it is in <a href=\"https://github.com/rails/rails/pull/42042\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/42042/hovercard\">the original PR</a>.</p>\n</blockquote>\n<blockquote>\n<p dir=\"auto\">The Lint Tests section example shows ActiveModel::Model, it should probably be ActiveModel::API.</p>\n</blockquote>\n<blockquote>\n<p dir=\"auto\">It's possible to expand validations with how to check for errors, and other common usage. As well as different types of callback examples.</p>\n</blockquote>\n<blockquote>\n<p dir=\"auto\">Some examples use send, those can be updated to use public_send instead.</p>\n</blockquote>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51210",
            "title": "[RF DOCS] Active Model Basics Documentation [ci-skip]",
            "date_modified": "2024-03-01T10:57:20.000Z",
            "date_published": "2024-02-27T14:05:15.000Z",
            "author": {
                "name": "Ridhwana",
                "url": "https://github.com/Ridhwana"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/94690524?u=34457881e242cefc75851e4d53b90fed38bd5748&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">In current implementations, formatting numerical or date values in messages generated by validations typically requires specifying the message option or implementing custom validators.<br>\nHowever, I only want to format the <code class=\"notranslate\">%{count}</code> and do not need to handle the message, apart from the message option, so I believe it should be a native feature of the framework.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This pull request introduces the value_format option for validations such as <code class=\"notranslate\">numericality</code>, <code class=\"notranslate\">length</code>, and <code class=\"notranslate\">comparison</code>. With this option, it becomes possible to format the value passed to <code class=\"notranslate\">%{count}</code> in i18n messages.</p>\n<p dir=\"auto\">e.g. messages like <em>\"must be equal to 1,000\"</em> can now be generated.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class MyModel &lt; ApplicationRecord\n  validates :my_attribute, numericality: {\n    equal_to: 1_000,\n    value_format: -&gt; (value) { value.to_fs(:delimited) }\n  }\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">MyModel</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">validates</span> <span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">numericality</span>: <span class=\"pl-kos\">{</span>\n    <span class=\"pl-pds\">equal_to</span>: <span class=\"pl-c1\">1_000</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-pds\">value_format</span>: <span class=\"pl-c1\">-&gt;</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> <span class=\"pl-s1\">value</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_fs</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:delimited</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">}</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">There have been several similar PRs submitted in the past:</p>\n<ul dir=\"auto\">\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1094118461\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/44076\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/44076/hovercard\" href=\"https://github.com/rails/rails/pull/44076\">#44076</a></li>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"810561657\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/41482\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/41482/hovercard\" href=\"https://github.com/rails/rails/pull/41482\">#41482</a></li>\n</ul>\n<p dir=\"auto\">Comparing them,</p>\n<ul dir=\"auto\">\n<li>There is no impact on existing implementation since it can be specified with options.</li>\n<li>It also supports <code class=\"notranslate\">length</code> and <code class=\"notranslate\">comparison</code> where <code class=\"notranslate\">%{count}</code> is used, not limited to <code class=\"notranslate\">numericality</code>.</li>\n</ul>\n<br>\n<p dir=\"auto\">If there are any errors or inconsistencies in the English language in the change log or documentation, please point them out.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51208",
            "title": "Add `value_format` option to `numericality`, `length`, and `comparison` validators",
            "date_modified": "2024-02-27T11:19:04.000Z",
            "date_published": "2024-02-27T11:18:59.000Z",
            "author": {
                "name": "techkato",
                "url": "https://github.com/techkato"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/49816584?u=4918bbfadc3c8dc7e0ecb7d4cc23075ca75eef38&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because we have so many syntax sugar, like for <code class=\"notranslate\">present?</code> method we have <code class=\"notranslate\">blank?</code>, and so on, so, that's would be really nice to add opposite method for a <code class=\"notranslate\">exists?</code> instead of writing always <code class=\"notranslate\">!</code>, or using unless</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes adds just an inverted <code class=\"notranslate\">exists?</code> method called <code class=\"notranslate\">missing?</code>. So, it's really simple, but powerful change</p>\n<p dir=\"auto\">Rework of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2144326539\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51138\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51138/hovercard\" href=\"https://github.com/rails/rails/pull/51138\">#51138</a> PR</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51203",
            "title": "Add a `.missing?` method as opposite for a `.exists?`",
            "date_modified": "2024-03-01T07:42:47.000Z",
            "date_published": "2024-02-27T08:35:33.000Z",
            "author": {
                "name": "loqimean",
                "url": "https://github.com/loqimean"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/314453?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50850.\">Resolves</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2095807650\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50850\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50850/hovercard\" href=\"https://github.com/rails/rails/issues/50850\">#50850</a></p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51127.\">Resolves</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2142754949\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51127\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51127/hovercard\" href=\"https://github.com/rails/rails/issues/51127\">#51127</a> by allowing users to set all query constraints on association definitions, leaving model in a state compatible with active_storage (and active_text) associations.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR merges handling of primary keys by <code class=\"notranslate\">belongs_to</code> association and <code class=\"notranslate\">has_</code> associations into one, rendering aforementioned associations' behaviour expectedly symmetrical.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51189",
            "title": "Handle array values of belongs_to primary_key option",
            "date_modified": "2024-02-27T08:30:33.000Z",
            "date_published": "2024-02-25T19:51:32.000Z",
            "author": {
                "name": "Slotos",
                "url": "https://github.com/Slotos"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/15771072?u=702f73a95b60fa32430e8825432f7639ab72983a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">In mysql, there are two column data types: linestring and multilinestring. At the moment, we cannot create those two using</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"t.column :test_col, :linestring\nt.column :test_mcol, :multilinestring\"><pre class=\"notranslate\"><span class=\"pl-en\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">column</span> <span class=\"pl-pds\">:test_col</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:linestring</span>\n<span class=\"pl-en\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">column</span> <span class=\"pl-pds\">:test_mcol</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:multilinestring</span></pre></div>\n<p dir=\"auto\">When run <code class=\"notranslate\">db:migrate</code>, it will print to <code class=\"notranslate\">schema.rb</code></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Could not dump table &quot;tests&quot; because of following StandardError\n#   Unknown type 'linestring' for column 'ls'\"><pre class=\"notranslate\"><span class=\"pl-c\"># Could not dump table \"tests\" because of following StandardError</span>\n<span class=\"pl-c\">#   Unknown type 'linestring' for column 'ls'</span></pre></div>\n<p dir=\"auto\">Test repo: <a href=\"https://github.com/zgid123/test-mysql-data-type\">https://github.com/zgid123/test-mysql-data-type</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">I followed this PR: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1967279132\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49842\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49842/hovercard\" href=\"https://github.com/rails/rails/pull/49842\">#49842</a> to add those two types. I still not know how to write unit test for this case. Please help me this one.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Here the result after the fix</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"ActiveRecord::Schema[7.2].define(version: 2024_02_25_192506) do\n  create_table &quot;tests&quot;, charset: &quot;utf8mb3&quot;, force: :cascade do |t|\n    t.string &quot;name&quot;\n    t.decimal &quot;number&quot;, precision: 10\n    t.linestring &quot;ls&quot;\n    t.multilinestring &quot;mls&quot;\n    t.datetime &quot;created_at&quot;, null: false\n    t.datetime &quot;updated_at&quot;, null: false\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Schema</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">7.2</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">define</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">version</span>: <span class=\"pl-c1\">2024_02_25_192506</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">create_table</span> <span class=\"pl-s\">\"tests\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">charset</span>: <span class=\"pl-s\">\"utf8mb3\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-pds\">:cascade</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-s\">\"name\"</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">decimal</span> <span class=\"pl-s\">\"number\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">precision</span>: <span class=\"pl-c1\">10</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">linestring</span> <span class=\"pl-s\">\"ls\"</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">multilinestring</span> <span class=\"pl-s\">\"mls\"</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">datetime</span> <span class=\"pl-s\">\"created_at\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">datetime</span> <span class=\"pl-s\">\"updated_at\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/15771072/307617632-8bb7d5cb-c1d9-4028-92e3-ce4438b8b1fc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDk1MTA5NjAsIm5iZiI6MTcwOTUxMDY2MCwicGF0aCI6Ii8xNTc3MTA3Mi8zMDc2MTc2MzItOGJiN2Q1Y2ItYzFkOS00MDI4LTkyZTMtY2U0NDM4YjhiMWZjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzA0VDAwMDQyMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTE2NTg0M2ViZGFlYzBmOWYyOTNhNDk0NTI2ZDhmOWRiZjI0NDQzOGY2ZmI3MTE3NThkYTQzZDM2ZWNjOThiOGEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.tzt7hpItUtYx2enVkXJjcjuP4nXcO5VvOoCLqYvsxnY\"><img width=\"1159\" alt=\"image\" src=\"https://private-user-images.githubusercontent.com/15771072/307617632-8bb7d5cb-c1d9-4028-92e3-ce4438b8b1fc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDk1MTA5NjAsIm5iZiI6MTcwOTUxMDY2MCwicGF0aCI6Ii8xNTc3MTA3Mi8zMDc2MTc2MzItOGJiN2Q1Y2ItYzFkOS00MDI4LTkyZTMtY2U0NDM4YjhiMWZjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzA0VDAwMDQyMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTE2NTg0M2ViZGFlYzBmOWYyOTNhNDk0NTI2ZDhmOWRiZjI0NDQzOGY2ZmI3MTE3NThkYTQzZDM2ZWNjOThiOGEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.tzt7hpItUtYx2enVkXJjcjuP4nXcO5VvOoCLqYvsxnY\" style=\"max-width: 100%;\"></a>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51188",
            "title": "add linestring and multilinestring for mysql",
            "date_modified": "2024-02-25T19:40:01.000Z",
            "date_published": "2024-02-25T19:19:14.000Z",
            "author": {
                "name": "zgid123",
                "url": "https://github.com/zgid123"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/12777550?u=415303ec1c626279c440cf729435fc0ee833d1c9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51129.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2142954735\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51129\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51129/hovercard\" href=\"https://github.com/rails/rails/issues/51129\">#51129</a>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">When using composite primary keys in a model, the <code class=\"notranslate\">primary_key</code> will be an array. This raises an issue when calling the <code class=\"notranslate\">&lt;association&gt;_ids</code> method on a preloaded association. Internally, Rails uses the <code class=\"notranslate\">pluck</code> method from Enumerable to retrieve the preloaded results. However, the <code class=\"notranslate\">pluck</code> method does not accept an array as its argument. To accommodate that, we need to use the splat operator to split the array into multiple arguments dynamically.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51167",
            "title": "[Fix #51129] Fix issue with IDs reader on preloaded associations for composite primary keys",
            "date_modified": "2024-02-25T07:42:08.000Z",
            "date_published": "2024-02-22T15:46:48.000Z",
            "author": {
                "name": "Jay0921",
                "url": "https://github.com/Jay0921"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22918438?u=bb0e029cc4992c777cb2926b3647ab8ac20b0bf5&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">SELECT queries are idempotent and thus safe to retry automatically. This commit leverages <code class=\"notranslate\">allow_retry</code> to enable automatic retries on queries that go through <code class=\"notranslate\">ActiveRecord::ConnectionAdaptersDatabaseStatements#select</code>.</p>\n<p dir=\"auto\">This should help with connection-related exceptions stemming from network issues. Notably, at Shopify, our applications have been encountering sporadic <code class=\"notranslate\">Trilogy::EOFError</code> exceptions on finds / relation loads.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Pass <code class=\"notranslate\">allow_retry: true</code> when calling <code class=\"notranslate\">#internal_exec_query</code> from <code class=\"notranslate\">ActiveRecord::ConnectionAdaptersDatabaseStatements#select</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">There was discussion around retrying UPDATE and DELETE queries as well. This is potentially still valuable, though most Active Record updates and deletes are wrapped inside transactions that are retry-able anyways. Retrying <code class=\"notranslate\">SELECT</code> queries will make a far more significant difference, so we're proposing we start by making these queries retry-able.</p>\n<p dir=\"auto\">We'd also like to make the case to backport this to <code class=\"notranslate\">7-1-stable</code>: some of Shopify's Rails applications are having trouble moving to trilogy because connection-related exceptions have been popping up, and the DB adapter hasn't been able to retry + reconnect. It's unclear why Trilogy in particular is experiencing these issues, but Trilogy is not usable for some of our applications without these changes. Making this available in the next patch release would help.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51166",
            "title": "Retry SELECT queries on connection-related exceptions",
            "date_modified": "2024-02-28T06:45:17.000Z",
            "date_published": "2024-02-22T15:23:29.000Z",
            "author": {
                "name": "adrianna-chang-shopify",
                "url": "https://github.com/adrianna-chang-shopify"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/8269566?u=89925864a291198526e9d6bb71540244578f2cf8&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because some endless and beginless range comparisons raise <code class=\"notranslate\">RangeError</code> due to <code class=\"notranslate\">ActiveSupport::CompareWithRange</code></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the <code class=\"notranslate\">CompareWithRange#===</code> and <code class=\"notranslate\">CompareWithRange#include?</code> methods to support begin and endless ranges on the left and right hand side of the comparison.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">POR:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&gt; (1..) === (2..)\n=&gt; false\n&gt; (..1) === (..2)\n=&gt; false\"><pre class=\"notranslate\">&gt; <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span><span class=\"pl-c1\">2</span>..<span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">false</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">2</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">false</span></pre></div>\n<p dir=\"auto\">Rails 7.1.3:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&gt; (1..) === (2..)\nRangeError: cannot get the last element of endless range\nfrom ‚Ä¶/activesupport-7.1.3/lib/active_support/core_ext/range/compare_range.rb:23:in `last'\n&gt; (..1) === (..2)\nRangeError: cannot get the first element of beginless range\nfrom ‚Ä¶/activesupport-7.1.3/lib/active_support/core_ext/range/compare_range.rb:24:in `first'\"><pre class=\"notranslate\">&gt; <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span><span class=\"pl-c1\">2</span>..<span class=\"pl-kos\">)</span>\n<span class=\"pl-en\">RangeError</span>: <span class=\"pl-en\">cannot</span> <span class=\"pl-en\">get</span> <span class=\"pl-en\">the</span> <span class=\"pl-en\">last</span> <span class=\"pl-en\">element</span> <span class=\"pl-en\">of</span> <span class=\"pl-en\">endless</span> <span class=\"pl-en\">range</span>\n<span class=\"pl-en\">from</span> <span class=\"pl-en\">‚Ä¶</span>/<span class=\"pl-en\">activesupport</span>-<span class=\"pl-c1\">7.1</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">3</span>/<span class=\"pl-en\">lib</span>/<span class=\"pl-en\">active_support</span>/<span class=\"pl-en\">core_ext</span>/<span class=\"pl-en\">range</span>/<span class=\"pl-en\">compare_range</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">rb</span>:<span class=\"pl-c1\">23</span><span class=\"pl-pds\">:in</span> <span class=\"pl-s\">`last'</span>\n<span class=\"pl-s\">&gt; (..1) === (..2)</span>\n<span class=\"pl-s\">RangeError: cannot get the first element of beginless range</span>\n<span class=\"pl-s\">from ‚Ä¶/activesupport-7.1.3/lib/active_support/core_ext/range/compare_range.rb:24:in `</span><span class=\"pl-en\">first</span><span class=\"pl-s\">'</span></pre></div>\n<p dir=\"auto\">This PR:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&gt; (1..) === (2..)\n=&gt; true\n&gt; (2..) === (1..)\n=&gt; false\n&gt; (..1) === (..2)\n=&gt; false\n&gt; (..2) === (..1)\n=&gt; true\"><pre class=\"notranslate\">&gt; <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span><span class=\"pl-c1\">2</span>..<span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">true</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-kos\">(</span><span class=\"pl-c1\">2</span>..<span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">false</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">2</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">false</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">2</span><span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">true</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51159",
            "title": "Fix beginless and endless range comparisons",
            "date_modified": "2024-02-27T23:55:11.000Z",
            "date_published": "2024-02-22T01:23:49.000Z",
            "author": {
                "name": "AlexMooney",
                "url": "https://github.com/AlexMooney"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/90490?u=759a58d59fb3604e02b9f62a8bd1e4978be7cffd&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">A non-array column can be queried via <code class=\"notranslate\">where(name: [value1, value2])</code> which is automatically converted to <code class=\"notranslate\">name IN (value1, value2)</code> in SQL. An array column would treat that array as the value to search for, so it'd be natural to expect an array of arrays would result in an <code class=\"notranslate\">IN</code> query. Unfortunately, that wasn't the case as <code class=\"notranslate\">where(name: [[value1], [value2]])</code> would return <code class=\"notranslate\">name = {{value1}, {value2}}</code> in SQL, instead of <code class=\"notranslate\">name IN ({value1}, {value2})</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">That behavior stemmed from the fact that Active Record would force equality comparison for array columns if the value was an array. In order to allow <code class=\"notranslate\">IN</code> queries this check was change to check whether it's a <strong>one-dimensional</strong> array by checking that the first item of is not an array.</p>\n<p dir=\"auto\">After these changes the following logic applies for querying array columns:</p>\n<ol dir=\"auto\">\n<li>Using a one-dimensional array results in an ordinary equality query.</li>\n<li>Using a two-dimensional array produces an <code class=\"notranslate\">IN</code> query.</li>\n</ol>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51137",
            "title": "Support IN queries on array columns",
            "date_modified": "2024-02-20T15:02:04.000Z",
            "date_published": "2024-02-20T12:01:26.000Z",
            "author": {
                "name": "gregnavis",
                "url": "https://github.com/gregnavis"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/40373?u=97283b5a00bd596840c2024f7e430ac9e41ca503&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The new AllowBrowser feature was added in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2061123087\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50505\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50505/hovercard\" href=\"https://github.com/rails/rails/pull/50505\">#50505</a> . It permits setting minimum browser versions for an application, defines and documents a <code class=\"notranslate\">:modern</code> version-set as requiring a list of certain features, and adds that option to the default config for new apps.</p>\n<p dir=\"auto\">This PR has been created to make two minor corrections to <code class=\"notranslate\">:modern</code>, one to its versions, one to its documentation.</p>\n<h3 dir=\"auto\">Detail</h3>\n<ol dir=\"auto\">\n<li>In <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/24264baeae1d57743aa87b4fcb88e55a42cc850a/hovercard\" href=\"https://github.com/rails/rails/commit/24264baeae1d57743aa87b4fcb88e55a42cc850a\"><tt>24264ba</tt></a>, adjust the <code class=\"notranslate\">:modern</code> browser versions to match the description of required features. Specifically, CSS nesting isn't supported by Chrome until 120, Opera until 106 (<a href=\"https://caniuse.com/css-nesting\" rel=\"nofollow\">1</a>, <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Nesting_selector#browser_compatibility\" rel=\"nofollow\">2</a>).</li>\n<li>In <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/ff0291291a2c93f40c92a306f4fc3025bd8bdbc0/hovercard\" href=\"https://github.com/rails/rails/commit/ff0291291a2c93f40c92a306f4fc3025bd8bdbc0\"><tt>ff02912</tt></a>, remove badging from the documentation's list of required features, because it's still a <a href=\"https://www.w3.org/TR/badging/\" rel=\"nofollow\">spec</a> that isn't fully implemented by any current browser (<a href=\"https://caniuse.com/mdn-api_notification_badge\" rel=\"nofollow\">1</a>, <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Badging_API#browser_compatibility\" rel=\"nofollow\">2</a>).</li>\n</ol>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Personally I'm not convinced this feature will be a good default for new apps, but if it's going to be offered, it should be correct for its stated purpose.</p>\n<p dir=\"auto\">For fun, I benchmarked <code class=\"notranslate\">UserAgent.parse.browser</code> on my laptop and it runs in about 40 microseconds, which is faster than I'd expected. But the runtime <code class=\"notranslate\">require \"useragent\"</code> added 30 milliseconds to the first request.</p>\n<p dir=\"auto\">The <code class=\"notranslate\">useragent</code> gem was <a href=\"https://github.com/gshutler/useragent\">last updated</a> five years ago, and its browser recognition code is all <a href=\"https://github.com/gshutler/useragent/tree/master/lib/user_agent/browsers\">7 to 9 years old</a>. It seems inappropriate to have a <code class=\"notranslate\">:modern</code> default that doesn't recognize Edge (2015). There's a <a href=\"https://github.com/art19/useragent\">fork by art19</a> that recognizes Edge, but it adds 54 other browsers too, so it has 4x the LoC, and its <code class=\"notranslate\">require</code> is 90 milliseconds. Something in-between might be nice.</p>\n<p dir=\"auto\">I made a <a href=\"https://docs.google.com/spreadsheets/d/13hz5ndUBDeTqAKwYCv5CyAMGpcCVkc5hwJ7Is7BG0qo/edit#gid=0\" rel=\"nofollow\">google spreadsheet</a> listing browser versions that support each of the <code class=\"notranslate\">:modern</code> features listed. The tl;dr is that badges and css nesting are the most-restrictive requirement for every major browser except Firefox (which was late to support css :has).</p>",
            "url": "https://github.com/rails/rails/pull/51121",
            "title": "Fix AllowBrowser versions",
            "date_modified": "2024-02-20T17:39:15.000Z",
            "date_published": "2024-02-18T18:08:50.000Z",
            "author": {
                "name": "jamiemccarthy",
                "url": "https://github.com/jamiemccarthy"
            }
        }
    ]
}