{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/19192189?u=dd60737844a9db7f1475bab21fc3e5258a405e15&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><code class=\"notranslate\">ActiveRecord::Base#id</code> became <code class=\"notranslate\">~10%</code> slower in 7.1 following the introduction of composite primary keys.</p>\n<p dir=\"auto\">Some production profile revealed a significant amount of time spent in <code class=\"notranslate\">@primary_key.is_a?(Array)</code>. Some of it may be the common StackProf bias, but it's still significant.</p>\n<p dir=\"auto\">By storing whether the primary key is composite as a boolean we can reclaim about half of the overhead:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ruby 3.2.2 (2023-03-30 revision e51014f9c0) [arm64-darwin22]\nWarming up --------------------------------------\n       User#id (7.0)   507.375k i/100ms\n       User#id (7.1)   460.049k i/100ms\n       User#id (opt)   486.487k i/100ms\nCalculating -------------------------------------\n       User#id (7.0)      5.058M (Â± 1.1%) i/s -     25.369M in   5.016103s\n       User#id (7.1)      4.592M (Â± 0.8%) i/s -     23.002M in   5.009319s\n       User#id (opt)      4.872M (Â± 0.9%) i/s -     24.811M in   5.093091s\n\nComparison:\n       User#id (7.0):  5058058.8 i/s\n       User#id (opt):  4871876.3 i/s - 1.04x  slower\n       User#id (7.1):  4592198.3 i/s - 1.10x  slower\"><pre class=\"notranslate\"><code class=\"notranslate\">ruby 3.2.2 (2023-03-30 revision e51014f9c0) [arm64-darwin22]\nWarming up --------------------------------------\n       User#id (7.0)   507.375k i/100ms\n       User#id (7.1)   460.049k i/100ms\n       User#id (opt)   486.487k i/100ms\nCalculating -------------------------------------\n       User#id (7.0)      5.058M (Â± 1.1%) i/s -     25.369M in   5.016103s\n       User#id (7.1)      4.592M (Â± 0.8%) i/s -     23.002M in   5.009319s\n       User#id (opt)      4.872M (Â± 0.9%) i/s -     24.811M in   5.093091s\n\nComparison:\n       User#id (7.0):  5058058.8 i/s\n       User#id (opt):  4871876.3 i/s - 1.04x  slower\n       User#id (7.1):  4592198.3 i/s - 1.10x  slower\n</code></pre></div>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ruby 3.1.4p223 (2023-03-30 revision 957bb7cb81) [arm64-darwin22]\nWarming up --------------------------------------\n       User#id (7.0)   502.562k i/100ms\n       User#id (7.1)   430.043k i/100ms\n       User#id (opt)   482.961k i/100ms\nCalculating -------------------------------------\n       User#id (7.0)      5.060M (Â± 0.9%) i/s -     25.631M in   5.065498s\n       User#id (7.1)      4.325M (Â± 0.8%) i/s -     21.932M in   5.071700s\n       User#id (opt)      4.804M (Â± 0.8%) i/s -     24.148M in   5.027168s\n\nComparison:\n       User#id (7.0):  5060312.9 i/s\n       User#id (opt):  4803851.1 i/s - 1.05x  slower\n       User#id (7.1):  4324672.3 i/s - 1.17x  slower\"><pre class=\"notranslate\"><code class=\"notranslate\">ruby 3.1.4p223 (2023-03-30 revision 957bb7cb81) [arm64-darwin22]\nWarming up --------------------------------------\n       User#id (7.0)   502.562k i/100ms\n       User#id (7.1)   430.043k i/100ms\n       User#id (opt)   482.961k i/100ms\nCalculating -------------------------------------\n       User#id (7.0)      5.060M (Â± 0.9%) i/s -     25.631M in   5.065498s\n       User#id (7.1)      4.325M (Â± 0.8%) i/s -     21.932M in   5.071700s\n       User#id (opt)      4.804M (Â± 0.8%) i/s -     24.148M in   5.027168s\n\nComparison:\n       User#id (7.0):  5060312.9 i/s\n       User#id (opt):  4803851.1 i/s - 1.05x  slower\n       User#id (7.1):  4324672.3 i/s - 1.17x  slower\n</code></pre></div>\n<details><summary>Benchmark</summary>\n```ruby\nbegin\n  require \"bundler/inline\"\nrescue LoadError =&gt; e\n  $stderr.puts \"Bundler version 1.10 or later is required. Please update your Bundler\"\n  raise e\nend\n<p dir=\"auto\">gemfile(true) do<br>\nsource \"<a href=\"https://rubygems.org\" rel=\"nofollow\">https://rubygems.org</a>\"<br>\ngem \"rails\", path: \"/Users/byroot/src/github.com/Shopify/rails\"<br>\ngem \"sqlite3\"<br>\ngem \"benchmark-ips\"<br>\nend</p>\n<p dir=\"auto\">require \"active_record\"</p>\n<p dir=\"auto\">ActiveRecord::Base.establish_connection(adapter: \"sqlite3\", database: \":memory:\")<br>\nActiveRecord::Base.logger = Logger.new(STDOUT)</p>\n<p dir=\"auto\">ActiveRecord::Schema.define do<br>\ncreate_table :users do |t|<br>\nt.string :first_name<br>\nt.string :last_name<br>\nend<br>\nend</p>\n<p dir=\"auto\">class User &lt; ActiveRecord::Base<br>\nend</p>\n<p dir=\"auto\">module ActiveRecord<br>\nmodule AttributeMethods<br>\n# = Active Record Attribute Methods Primary Key<br>\nmodule PrimaryKey<br>\ndef initialize(...)<br>\n@composite_primary_key = self.class.composite_primary_key?<br>\nsuper<br>\nend</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  def rails_71_id\n    return _read_attribute(@primary_key) unless @primary_key.is_a?(Array)\n\n    @primary_key.map { |pk| _read_attribute(pk) }\n  end\n\n  def rails_70_id\n    _read_attribute(@primary_key)\n  end\n\n  def optimized_id\n    if @composite_primary_key\n      @primary_key.map { |pk| _read_attribute(pk) }\n    else\n      _read_attribute(@primary_key)\n    end\n  end\nend\"><pre class=\"notranslate\"><code class=\"notranslate\">  def rails_71_id\n    return _read_attribute(@primary_key) unless @primary_key.is_a?(Array)\n\n    @primary_key.map { |pk| _read_attribute(pk) }\n  end\n\n  def rails_70_id\n    _read_attribute(@primary_key)\n  end\n\n  def optimized_id\n    if @composite_primary_key\n      @primary_key.map { |pk| _read_attribute(pk) }\n    else\n      _read_attribute(@primary_key)\n    end\n  end\nend\n</code></pre></div>\n<p dir=\"auto\">end<br>\nend</p>\n<p dir=\"auto\">user = User.new</p>\n<p dir=\"auto\">puts RUBY_DESCRIPTION</p>\n<p dir=\"auto\">Benchmark.ips do |x|<br>\nx.report(\"User#id (7.0)\") do<br>\nuser.rails_70_id<br>\nend</p>\n<p dir=\"auto\">x.report(\"User#id (7.1)\") do<br>\nuser.rails_71_id<br>\nend</p>\n<p dir=\"auto\">x.report(\"User#id (opt)\") do<br>\nuser.optimized_id<br>\nend</p>\n<p dir=\"auto\">x.compare!(order: :baseline)<br>\nend</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"&lt;/details&gt;\n\nAnother avenue could be to swap the method entirely. e.g. include a module when you activate composite primary keys on a model. But then it would make it tricky to undo it in a child class. So I'm still on the fence, I'll sleep on it.\n\ncc @ptolts you reported the profiling.\ncc @nvasilevski because CPK.\"><pre class=\"notranslate\"><code class=\"notranslate\">&lt;/details&gt;\n\nAnother avenue could be to swap the method entirely. e.g. include a module when you activate composite primary keys on a model. But then it would make it tricky to undo it in a child class. So I'm still on the fence, I'll sleep on it.\n\ncc @ptolts you reported the profiling.\ncc @nvasilevski because CPK.\n</code></pre></div></details>",
            "url": "https://github.com/rails/rails/pull/49798",
            "title": "Optimize Active Record primary key methods",
            "date_modified": "2023-10-26T14:54:32.000Z",
            "date_published": "2023-10-26T14:46:55.000Z",
            "author": {
                "name": "casperisfine",
                "url": "https://github.com/casperisfine"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/111346?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><code class=\"notranslate\">ActionMailer::InlinePreviewInterceptor</code> is useful not only for previewing the template but also for displaying actual emails loaded from a string. For example, you might want to archive all outgoing emails to the database/filesystem and display these emails in a browser.</p>\n<p dir=\"auto\">The interceptor assumes that attachments are represented as binary data. But if an email is loaded from string, the attachments have already been encoded as base64, so they end up being encoded twice.</p>",
            "url": "https://github.com/rails/rails/pull/49797",
            "title": "Fix `InlinePreviewInterceptor` so it does not double-encode",
            "date_modified": "2023-10-26T13:45:32.000Z",
            "date_published": "2023-10-26T13:43:42.000Z",
            "author": {
                "name": "c960657",
                "url": "https://github.com/c960657"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14981592?u=11406fb0121b15a93b3305388377a57b4d9c96f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">In practise have not seen any changelog entries where the name of the contributor was inline with the change description.</p>\n<p dir=\"auto\">See for example <a href=\"https://github.com/rails/rails/releases/tag/v7.1.1\">https://github.com/rails/rails/releases/tag/v7.1.1</a> or <a href=\"https://github.com/rails/rails/releases/tag/v7.1.0\">https://github.com/rails/rails/releases/tag/v7.1.0</a></p>",
            "url": "https://github.com/rails/rails/pull/49795",
            "title": "Remove note about inline changelog credit in contributing guide",
            "date_modified": "2023-10-26T12:52:23.000Z",
            "date_published": "2023-10-26T12:52:19.000Z",
            "author": {
                "name": "Earlopain",
                "url": "https://github.com/Earlopain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/46014?u=ada22f75c3a41f5a766cb474addae9bc54a67052&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because there is a bug in the deprecation notices on the tasks <code class=\"notranslate\">secrets:edit</code> and <code class=\"notranslate\">secrets:show</code> which means they can raise <code class=\"notranslate\">undefined method 'squish'</code></p>\n<h3 dir=\"auto\">Reproduction</h3>\n<p dir=\"auto\">Create a new rails 7.1.1 app using <code class=\"notranslate\">rails new</code>.</p>\n<p dir=\"auto\"><code class=\"notranslate\">cd</code> into the new app and run <code class=\"notranslate\">bin/rails secrets:edit</code> or <code class=\"notranslate\">bin/rails secrets:show</code>.</p>\n<p dir=\"auto\">For example:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ bin/rails secrets:show\n...gems/3.2.0/gems/railties-7.1.1/lib/rails/commands/secrets/secrets_command.rb:37:in `show': undefined method `squish' for &quot;`bin/rails secrets:show` is deprecated in favor of credentials and will be removed in Rails 7.2.\\nRun `bin/rails credentials:help` for more information.\\n&quot;:String (NoMethodError)\n\n        Rails.deprecator.warn(&lt;&lt;~MSG.squish)\n                                    ^^^^^^^\n\tfrom ...gems/3.2.0/gems/thor-1.3.0/lib/thor/command.rb:28:in `run'\n        ...\"><pre class=\"notranslate\"><code class=\"notranslate\">$ bin/rails secrets:show\n...gems/3.2.0/gems/railties-7.1.1/lib/rails/commands/secrets/secrets_command.rb:37:in `show': undefined method `squish' for \"`bin/rails secrets:show` is deprecated in favor of credentials and will be removed in Rails 7.2.\\nRun `bin/rails credentials:help` for more information.\\n\":String (NoMethodError)\n\n        Rails.deprecator.warn(&lt;&lt;~MSG.squish)\n                                    ^^^^^^^\n\tfrom ...gems/3.2.0/gems/thor-1.3.0/lib/thor/command.rb:28:in `run'\n        ...\n</code></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">The warning string is <code class=\"notranslate\">#squish</code>ed however <code class=\"notranslate\">active_support/core_ext/string/filters</code> is not being required.</p>\n<p dir=\"auto\">The tests are passing because the dummy test application does a <code class=\"notranslate\">require 'rails/all'</code> on boot which requires the String extensions. <a href=\"https://github.com/rails/rails/blob/main/railties/test/isolation/abstract_unit.rb#L605\">https://github.com/rails/rails/blob/main/railties/test/isolation/abstract_unit.rb#L605</a></p>\n<p dir=\"auto\">This is not necessarily the case for other applications, eg ones freshly created with <code class=\"notranslate\">rails new</code> so in this case an error is raised.</p>\n<p dir=\"auto\">The fix is to just require the necessary String extensions.</p>\n<p dir=\"auto\">I am not sure if there is anything that could be done to the tests to have caught this.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49792",
            "title": "Fix deprecation warnings for `secrets:edit/show`",
            "date_modified": "2023-10-26T08:55:49.000Z",
            "date_published": "2023-10-26T08:55:44.000Z",
            "author": {
                "name": "stevegeek",
                "url": "https://github.com/stevegeek"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14981592?u=11406fb0121b15a93b3305388377a57b4d9c96f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because <code class=\"notranslate\">number_to_human_size</code> doesn't handle negative numbers.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Old behaviour\nhelper.number_to_human_size(-1234567)\n# =&gt; &quot;-1234567 Bytes&quot;\n\n# New behaviour\nhelper.number_to_human_size(-1234567)\n# =&gt; &quot;-1.18 MB&quot;\"><pre class=\"notranslate\"><span class=\"pl-c\"># Old behaviour</span>\n<span class=\"pl-en\">helper</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">number_to_human_size</span><span class=\"pl-kos\">(</span>-<span class=\"pl-c1\">1234567</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># =&gt; \"-1234567 Bytes\"</span>\n\n<span class=\"pl-c\"># New behaviour</span>\n<span class=\"pl-en\">helper</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">number_to_human_size</span><span class=\"pl-kos\">(</span>-<span class=\"pl-c1\">1234567</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># =&gt; \"-1.18 MB\"</span></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\"><code class=\"notranslate\">number_to_human</code> already supports negative numbers, this aligns the two methods.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49791",
            "title": "Handle negative numbers in `NumberToHumanSizeConverter`",
            "date_modified": "2023-10-26T08:32:27.000Z",
            "date_published": "2023-10-26T07:31:25.000Z",
            "author": {
                "name": "Earlopain",
                "url": "https://github.com/Earlopain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5279284?u=40cbc3d0cb818159797fa8856c88c9e87fd8bd49&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">ActionMailer Email Preview - show date header when present or fallback to Time.current.rfc2822</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49788.\">Resolves</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1962469818\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49788\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49788/hovercard\" href=\"https://github.com/rails/rails/issues/49788\">#49788</a></p>\n<p dir=\"auto\">Co-authored-by: <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/allisonphillips/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/allisonphillips\">@allisonphillips</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49790",
            "title": "ActionMailer Email Preview - show date header when present ",
            "date_modified": "2023-10-26T13:03:28.000Z",
            "date_published": "2023-10-26T01:42:47.000Z",
            "author": {
                "name": "sampatbadhe",
                "url": "https://github.com/sampatbadhe"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/18366969?u=e6919af135d360a17f71ab7380f0d57fe08be21a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because there is already <code class=\"notranslate\">destroy_all</code>, but there are cases where you want to raise an exception if it fails. It is useful to have <code class=\"notranslate\">destroy_all!</code>.<br>\nThis change was previously implemented at <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"527539837\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/37782\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/37782/hovercard\" href=\"https://github.com/rails/rails/pull/37782\">#37782</a>, but it was closed. I've re-opened this PR because it was recently mentioned by <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes add <code class=\"notranslate\">#destroy_all!</code> method to <code class=\"notranslate\">ActiveRecord::Relation</code></p>\n<p dir=\"auto\">If the <code class=\"notranslate\">before_destroy</code> callback throws abort the action is cancelled and <code class=\"notranslate\">destroy_all!</code> raises <code class=\"notranslate\">ActiveRecord::RecordNotDestroyed</code>.</p>\n<p dir=\"auto\">If there is more than one target record and you want to ensure that all records are deleted, you should realize this by explicitly using transaction to cause rollback.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class User &lt; ApplicationRecord\n  before_destroy do\n     throw :abort if id == 3\n   end\nend\n\nActiveRecord::Base.transaction do \n  User.where(id: 1..3).destroy_all!  \nend  \n \n=&gt;  TRANSACTION (1.5ms)  BEGIN\n  user Load (1.5ms)  SELECT `users`.* FROM `users` WHERE `users`.`id` BETWEEN 1 AND 3\n  user Destroy (1.2ms)  DELETE FROM `users` WHERE `users`.`id` = 1\n  user Destroy (1.1ms)  DELETE FROM `users` WHERE `users`.`id` = 2\n  TRANSACTION (4.4ms)  ROLLBACK\nActiveRecord::RecordNotDestroyed: Failed to destroy the record\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">before_destroy</span> <span class=\"pl-k\">do</span>\n     <span class=\"pl-en\">throw</span> <span class=\"pl-pds\">:abort</span> <span class=\"pl-k\">if</span> <span class=\"pl-en\">id</span> == <span class=\"pl-c1\">3</span>\n   <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">transaction</span> <span class=\"pl-k\">do</span> \n  <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">id</span>: <span class=\"pl-c1\">1</span>..<span class=\"pl-c1\">3</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">destroy_all!</span>  \n<span class=\"pl-k\">end</span>  \n \n<span class=\"pl-c1\">=&gt;</span>  <span class=\"pl-c1\">TRANSACTION</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1.5</span><span class=\"pl-en\">ms</span><span class=\"pl-kos\">)</span>  BEGIN\n  <span class=\"pl-en\">user</span> <span class=\"pl-en\">Load</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1.5</span><span class=\"pl-en\">ms</span><span class=\"pl-kos\">)</span>  <span class=\"pl-en\">SELECT</span> <span class=\"pl-s\">`users`</span><span class=\"pl-kos\">.</span>* <span class=\"pl-en\">FROM</span> <span class=\"pl-s\">`users`</span> <span class=\"pl-en\">WHERE</span> <span class=\"pl-s\">`users`</span><span class=\"pl-kos\">.</span>`<span class=\"pl-en\">id</span><span class=\"pl-s\">` BETWEEN 1 AND 3</span>\n<span class=\"pl-s\">  user Destroy (1.2ms)  DELETE FROM `</span><span class=\"pl-en\">users</span><span class=\"pl-s\">` WHERE `</span><span class=\"pl-en\">users</span><span class=\"pl-s\">`.`</span><span class=\"pl-en\">id</span><span class=\"pl-s\">` = 1</span>\n<span class=\"pl-s\">  user Destroy (1.1ms)  DELETE FROM `</span><span class=\"pl-en\">users</span><span class=\"pl-s\">` WHERE `</span><span class=\"pl-en\">users</span><span class=\"pl-s\">`.`</span><span class=\"pl-s1\">id</span>` <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">2</span>\n  <span class=\"pl-en\">TRANSACTION</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">4.4</span><span class=\"pl-en\">ms</span><span class=\"pl-kos\">)</span>  <span class=\"pl-c1\">ROLLBACK</span>\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-en\">RecordNotDestroyed</span>: <span class=\"pl-en\">Failed</span> <span class=\"pl-en\">to</span> <span class=\"pl-en\">destroy</span> <span class=\"pl-en\">the</span> <span class=\"pl-en\">record</span></pre></div>\n<p dir=\"auto\">Also, if the deletion is successful, an Array containing the target object that was successfully deleted is returned.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<ul dir=\"auto\">\n<li><a href=\"https://github.com/rails/rails/pull/37782\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/37782/hovercard\">Previously opened PR</a></li>\n<li><a href=\"https://discuss.rubyonrails.org/t/proposal-add-destroy-all-method-to-activerecord-relation/80959\" rel=\"nofollow\">proposal</a></li>\n</ul>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49789",
            "title": "Add `#destroy_all!` method to `ActiveRecord::Relation`",
            "date_modified": "2023-10-26T04:26:16.000Z",
            "date_published": "2023-10-26T01:32:51.000Z",
            "author": {
                "name": "soartec-lab",
                "url": "https://github.com/soartec-lab"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49273.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1896689507\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49273\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49273/hovercard\" href=\"https://github.com/rails/rails/issues/49273\">#49273</a>.</p>\n<p dir=\"auto\">We can remove some code by refactoring <code class=\"notranslate\">db:migrate</code> for multiple dbs to use individual database rake tasks.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/sobrinho/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/sobrinho\">@sobrinho</a></p>",
            "url": "https://github.com/rails/rails/pull/49787",
            "title": "Refactor `db:migrate` task for multiple dbs to use per-database rake tasks",
            "date_modified": "2023-10-26T13:19:11.000Z",
            "date_published": "2023-10-25T22:28:41.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/131752?u=32ddf1119b1d189c9bd241a721b36ea01c29f61e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Previously in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1003663049\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/43282\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/43282/hovercard\" href=\"https://github.com/rails/rails/pull/43282\">#43282</a>, which shipped with Rails 7.0, we added the guarantee that if an exception occurred within an ActiveSupport::Notificaitons subscriber that the remaining subscribers would still be run.</p>\n<p dir=\"auto\">This was broken in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1141875314\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/44469\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/44469/hovercard\" href=\"https://github.com/rails/rails/pull/44469\">#44469</a> (oops ðŸ˜³), where the different types of subscribers were broken into groups by type for performance. Although we would guard exceptions and always run all (or none) of the same group, that didn't work cross-group with different types of subscriber.</p>",
            "url": "https://github.com/rails/rails/pull/49784",
            "title": "Fix exception guards on multiple subscriber types",
            "date_modified": "2023-10-25T21:01:08.000Z",
            "date_published": "2023-10-25T21:01:04.000Z",
            "author": {
                "name": "jhawthorn",
                "url": "https://github.com/jhawthorn"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When Trix was <a href=\"https://github.com/rails/rails/commit/fab1b522cd11696c7330028fcc7bf25a8a109f5f\">updated</a> from 1.3.1 to 2.0.4, the ESM bundle of 2.0.4 was used instead of the UMD bundle (the vendored 1.3.1 file used the UMD bundle). This leads to issues when trying to use Trix with sprockets because the ESM bundle declares variables like they are scoped to the file but sprockets will see them as scoped globally.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit fixes the issue by replacing the Trix ESM bundle with the UMD bundle (and upgrades it from 2.0.4 to 2.0.7). Additionally, a Rake task has been added similar to one previously <a href=\"https://github.com/rails/rails/commit/a42863f514e726b864f60ad10e79002fe2b39f5a\">added</a> to the guides for automatic vendoring using Importmap::Packager.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49599.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1939804222\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49599\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49599/hovercard\" href=\"https://github.com/rails/rails/issues/49599\">#49599</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes pull request #49615.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1940940514\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49615\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49615/hovercard\" href=\"https://github.com/rails/rails/pull/49615\">#49615</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49778",
            "title": "Fix using trix in sprockets",
            "date_modified": "2023-10-25T20:05:21.000Z",
            "date_published": "2023-10-25T04:26:06.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Any classes that don't implement #blank? will fall back to Object's implementation, which checks whether #empty? is defined before either using #empty? or implicit truthiness. Since checking whether #empty? is defined is expensive, some core classes (Array/Hash) alias #blank? directly to #empty? to skip the respond_to? check.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit applies the alias optimization to Symbol. #blank? is called on Symbols for many Active Record query methods (select, includes, group, order, joins, etc.) so it seems reasonable to define the #blank? alias on Symbol as well.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49776",
            "title": "Add Symbol#blank? to skip respond_to?(:empty?)",
            "date_modified": "2023-10-25T03:34:05.000Z",
            "date_published": "2023-10-25T03:34:00.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5122678?u=204301f9f9fe8930fd26fe3bfe65b6ffaffd8b59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because the current <a href=\"https://guides.rubyonrails.org/association_basics.html#single-table-inheritance-sti\" rel=\"nofollow\">STI Guides</a> don't document how to override or disable the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ModelSchema.html#method-c-inheritance_column\" rel=\"nofollow\">inheritance_column</a>.</p>\n<p dir=\"auto\"><del>Additionally, it's not clear that you can set <code class=\"notranslate\">inheritance_column = :disabled</code>. Initially, I had tried  <code class=\"notranslate\">inheritance_column = nil</code> which had the same behavior, but is not as clear as the former.</del></p>\n<p dir=\"auto\">Setting <code class=\"notranslate\">inheritance_column = nil</code> disabled STI.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Add new sections to <a href=\"https://guides.rubyonrails.org/association_basics.html#single-table-inheritance-sti\" rel=\"nofollow\">STI Guides</a> demonstrating how to override or disable the <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/ModelSchema.html#method-c-inheritance_column\" rel=\"nofollow\">inheritance_column</a>.</p>\n<p dir=\"auto\">Also improve error message when <code class=\"notranslate\">ActiveRecord::SubclassNotFound</code> is raised.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49774",
            "title": "Improve STI documentation",
            "date_modified": "2023-10-25T17:47:34.000Z",
            "date_published": "2023-10-25T00:49:57.000Z",
            "author": {
                "name": "stevepolitodesign",
                "url": "https://github.com/stevepolitodesign"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49767.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1959594919\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49767\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49767/hovercard\" href=\"https://github.com/rails/rails/issues/49767\">#49767</a>.</p>\n<p dir=\"auto\">All other enum-related methods are already reloading type map.<br>\nI am not sure are tests needed for this?</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/ghiculescu/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/ghiculescu\">@ghiculescu</a> (as implementor of the PostgreSQL <code class=\"notranslate\">enum</code>)</p>",
            "url": "https://github.com/rails/rails/pull/49772",
            "title": "Reload type map when creating or dropping PostgreSQL enums",
            "date_modified": "2023-10-25T09:19:35.000Z",
            "date_published": "2023-10-24T20:33:09.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/8122246?u=2dbe607a66a7616297b78647eeb4e0dbff657c3a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><ul dir=\"auto\">\n<li>\n<h3 dir=\"auto\">Context</h3>\n<p dir=\"auto\">The Tagged Logging functionality has been a source of a few issues over the years, especially when combined with the broadcasting feature. Initializating a Tagged Logger was also not very intuitive:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"logger = Logger.new(STDOUT)\ntagged_logger = ActiveSupport::TaggedLogging.new(logger)\n# Would expect the `tagged_logger` to be an instance of `AS::TaggedLogging` \n# but it's a clone of the `logger`.\n\ntagged_logger.formatter = -&gt;(_, _, _, message) do\n  { message: message }\nend\n# Modifies the formatter to output JSON formatted logs.\n# This breaks tagged logging.\"><pre class=\"notranslate\"><span class=\"pl-s1\">logger</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">STDOUT</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">tagged_logger</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">TaggedLogging</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">logger</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c\"># Would expect the `tagged_logger` to be an instance of `AS::TaggedLogging` </span>\n<span class=\"pl-c\"># but it's a clone of the `logger`.</span>\n\n<span class=\"pl-s1\">tagged_logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">formatter</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">-&gt;</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">_</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">_</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">_</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">message</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">message</span>: <span class=\"pl-s1\">message</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span>\n<span class=\"pl-c\"># Modifies the formatter to output JSON formatted logs.</span>\n<span class=\"pl-c\"># This breaks tagged logging.</span></pre></div>\n<p dir=\"auto\">I believe the main reason of those issues is because tagged logging is implemented at the wrong level.</p>\n<h3 dir=\"auto\">Solution</h3>\n<p dir=\"auto\">I made a proposal on the Ruby logger upstream in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1790019942\" data-permission-text=\"Title is private\" data-url=\"https://github.com/ruby/logger/issues/90\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/ruby/logger/pull/90/hovercard\" href=\"https://github.com/ruby/logger/pull/90\">ruby/logger#90</a> to help solve this but it hasn't been reviewed yet. So I thought about adding it here for now. The TL;DR is to decouple formatting and adding extra information to logs (which is what tagged logging does).</p>\n<h3 dir=\"auto\">Deprecation</h3>\n<p dir=\"auto\">Since TaggedLogging will no longer access the formatter, there is a few things I'd like to deprecate such as setting a default formatter </p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/d68e43922bc11829c52ad9f736ad5549fc97631b/activesupport/lib/active_support/tagged_logging.rb#L124\">rails/activesupport/lib/active_support/tagged_logging.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n         Line 124\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/rails/rails/commit/d68e43922bc11829c52ad9f736ad5549fc97631b\">d68e439</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L124\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"124\"></td>\n          <td id=\"LC124\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s1\">logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">formatter</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">Logger</span>::<span class=\"pl-v\">SimpleFormatter</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n but doing so in this PR would increase the size of the diff significantly and would maybe distract for PR reviews.<p></p>\n<p dir=\"auto\">Another thing that I believe should be deprecated is <code class=\"notranslate\">ActiveSupport::TaggedLogging.new</code>. Adding tagging functionality to a logger should be done using a more ruby approach such as <code class=\"notranslate\">logger.extend(AS::TaggedLogging)</code>.</p>\n</li>\n</ul>\n<hr>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49757.\">Fix</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1958722861\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49757\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49757/hovercard\" href=\"https://github.com/rails/rails/issues/49757\">#49757</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49745.\">Fix</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1956771268\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49745\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49745/hovercard\" href=\"https://github.com/rails/rails/issues/49745\">#49745</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #46084.\">Fix</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1379588419\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/46084\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/46084/hovercard\" href=\"https://github.com/rails/rails/issues/46084\">#46084</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #44668.\">Fix</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1167130613\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/44668\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/44668/hovercard\" href=\"https://github.com/rails/rails/issues/44668\">#44668</a></p>",
            "url": "https://github.com/rails/rails/pull/49771",
            "title": "Reimplement TaggedLogging:",
            "date_modified": "2023-10-25T11:40:11.000Z",
            "date_published": "2023-10-24T17:24:15.000Z",
            "author": {
                "name": "Edouard-chin",
                "url": "https://github.com/Edouard-chin"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/148003?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation</h3>\n<p dir=\"auto\">This Pull Request has been created since <code class=\"notranslate\">named_variants</code> can be <code class=\"notranslate\">nil</code> and some code doesn't respect it.</p>\n<p dir=\"auto\">Admittedly I can only trigger the code path with a somewhat contrived example, namely creating an <code class=\"notranslate\">ActiveRecord::Attachment</code> manually without declaring a <code class=\"notranslate\">has_one_attached</code> or similar:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class User &lt; ActiveRecord::Base; end\n\nuser = User.create!\n\nblob = ActiveStorage::Blob.create_and_upload!(\n  io: StringIO.new('xxx'),\n  filename: 'some_filename'\n)\n\nActiveStorage::Attachment.create(\n  name: 'test',\n  blob: blob,\n  record: user\n)\n\n# =&gt; NoMethodError: undefined method `each' for nil:NilClass\n# /.../activestorage/app/models/active_storage/attachment.rb:134:in `transform_variants_later'\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">;</span> <span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">user</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span>\n\n<span class=\"pl-s1\">blob</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">ActiveStorage</span>::<span class=\"pl-v\">Blob</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create_and_upload!</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-pds\">io</span>: <span class=\"pl-v\">StringIO</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'xxx'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">filename</span>: <span class=\"pl-s\">'some_filename'</span>\n<span class=\"pl-kos\">)</span>\n\n<span class=\"pl-v\">ActiveStorage</span>::<span class=\"pl-v\">Attachment</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">'test'</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">blob</span>: <span class=\"pl-s1\">blob</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">record</span>: <span class=\"pl-s1\">user</span>\n<span class=\"pl-kos\">)</span>\n\n<span class=\"pl-c\"># =&gt; NoMethodError: undefined method `each' for nil:NilClass</span>\n<span class=\"pl-c\"># /.../activestorage/app/models/active_storage/attachment.rb:134:in `transform_variants_later'</span></pre></div>\n<h3 dir=\"auto\">Reproduction template</h3>\n<p dir=\"auto\">You can reproduce it yourself with this template:</p>\n<details><summary>Full reproduction template</summary>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# frozen_string_literal: true\n\nrequire 'bundler/inline'\n\ngemfile(true) do\n  source 'https://rubygems.org'\n\n  git_source(:github) { |repo| &quot;https://github.com/#{repo}.git&quot; }\n\n  gem 'rails', github: 'rails/rails', branch: 'main'\n  gem 'sqlite3'\nend\n\nrequire 'active_record/railtie'\nrequire 'active_storage/engine'\nrequire 'tmpdir'\n\nclass TestApp &lt; Rails::Application\n  config.root = __dir__\n  config.hosts &lt;&lt; 'example.org'\n  config.eager_load = false\n  config.session_store :cookie_store, key: 'cookie_store_key'\n  config.secret_key_base = 'secret_key_base'\n\n  config.logger = Logger.new($stdout)\n  Rails.logger  = config.logger\n\n  config.active_storage.service = :local\n  config.active_storage.service_configurations = {\n    local: {\n      root: Dir.tmpdir,\n      service: 'Disk'\n    }\n  }\nend\n\nENV['DATABASE_URL'] = 'sqlite3::memory:'\n\nRails.application.initialize!\n\nrequire ActiveStorage::Engine.root.join('db/migrate/20170806125915_create_active_storage_tables.rb').to_s\n\nActiveRecord::Schema.define do\n  CreateActiveStorageTables.new.change\n\n  create_table :users, force: true\nend\n\nclass User &lt; ActiveRecord::Base\n  has_one_attached :profile\nend\n\nrequire 'minitest/autorun'\n\nclass BugTest &lt; Minitest::Test\n  def test_upload_and_download\n    user = User.create!\n\n    blob = ActiveStorage::Blob.create_and_upload!(\n      io: StringIO.new('xxx'),\n      filename: 'some_filename'\n    )\n\n    ActiveStorage::Attachment.create(\n      name: 'test',\n      blob: blob,\n      record: user\n    )\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># frozen_string_literal: true</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'bundler/inline'</span>\n\n<span class=\"pl-en\">gemfile</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">source</span> <span class=\"pl-s\">'https://rubygems.org'</span>\n\n  <span class=\"pl-en\">git_source</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:github</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> |<span class=\"pl-s1\">repo</span>| <span class=\"pl-s\">\"https://github.com/<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">repo</span><span class=\"pl-kos\">}</span></span>.git\"</span> <span class=\"pl-kos\">}</span>\n\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'rails'</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">github</span>: <span class=\"pl-s\">'rails/rails'</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">branch</span>: <span class=\"pl-s\">'main'</span>\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'sqlite3'</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'active_record/railtie'</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'active_storage/engine'</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'tmpdir'</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">TestApp</span> &lt; <span class=\"pl-v\">Rails</span>::<span class=\"pl-v\">Application</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">root</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">__dir__</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">hosts</span> &lt;&lt; <span class=\"pl-s\">'example.org'</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">eager_load</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">false</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">session_store</span> <span class=\"pl-pds\">:cookie_store</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">key</span>: <span class=\"pl-s\">'cookie_store_key'</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">secret_key_base</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">'secret_key_base'</span>\n\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">logger</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span>$stdout<span class=\"pl-kos\">)</span>\n  <span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">logger</span>  <span class=\"pl-c1\">=</span> <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">logger</span>\n\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">active_storage</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">service</span> <span class=\"pl-c1\">=</span> <span class=\"pl-pds\">:local</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">active_storage</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">service_configurations</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-pds\">local</span>: <span class=\"pl-kos\">{</span>\n      <span class=\"pl-pds\">root</span>: <span class=\"pl-v\">Dir</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">tmpdir</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">service</span>: <span class=\"pl-s\">'Disk'</span>\n    <span class=\"pl-kos\">}</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-c1\">ENV</span><span class=\"pl-kos\">[</span><span class=\"pl-s\">'DATABASE_URL'</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">'sqlite3::memory:'</span>\n\n<span class=\"pl-v\">Rails</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">application</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">initialize!</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-v\">ActiveStorage</span>::<span class=\"pl-v\">Engine</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">root</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'db/migrate/20170806125915_create_active_storage_tables.rb'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_s</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Schema</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">define</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-v\">CreateActiveStorageTables</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">change</span>\n\n  <span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:users</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">has_one_attached</span> <span class=\"pl-pds\">:profile</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'minitest/autorun'</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">BugTest</span> &lt; <span class=\"pl-v\">Minitest</span>::<span class=\"pl-v\">Test</span>\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">test_upload_and_download</span>\n    <span class=\"pl-s1\">user</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span>\n\n    <span class=\"pl-s1\">blob</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">ActiveStorage</span>::<span class=\"pl-v\">Blob</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create_and_upload!</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-pds\">io</span>: <span class=\"pl-v\">StringIO</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'xxx'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">filename</span>: <span class=\"pl-s\">'some_filename'</span>\n    <span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-v\">ActiveStorage</span>::<span class=\"pl-v\">Attachment</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">'test'</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">blob</span>: <span class=\"pl-s1\">blob</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">record</span>: <span class=\"pl-s1\">user</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n</details>\n<h3 dir=\"auto\">Background</h3>\n<p dir=\"auto\">I'm doing something like above in an app and I'm not sure if this is even an intended use case.</p>\n<p dir=\"auto\">Though even if not, maybe it could still be merged since <code class=\"notranslate\">#named_variants</code> itself already considers the case where the reflection is <code class=\"notranslate\">nil</code>:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"    # app/models/active_storage/attachment.rb:147\n    def named_variants\n      record.attachment_reflections[name]&amp;.named_variants\n    end\"><pre class=\"notranslate\">    <span class=\"pl-c\"># app/models/active_storage/attachment.rb:147</span>\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">named_variants</span>\n      <span class=\"pl-en\">record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">attachment_reflections</span><span class=\"pl-kos\">[</span><span class=\"pl-en\">name</span><span class=\"pl-kos\">]</span>&amp;.<span class=\"pl-en\">named_variants</span>\n    <span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">So at least it is consistent that other methods using <code class=\"notranslate\">#named_variants</code> can now deal with that possible <code class=\"notranslate\">nil</code>.</p>\n<p dir=\"auto\">For reference: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1596229744\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47473\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47473/hovercard\" href=\"https://github.com/rails/rails/pull/47473\">#47473</a> introduced the code that fails in this example.</p>\n<h3 dir=\"auto\">Test</h3>\n<p dir=\"auto\">I didn't add any test for this. If you think this is merge-worthy and needs tests I can do so, please give me a ping. Thanks!</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49770",
            "title": "respect that `named_variants` can be `nil`",
            "date_modified": "2023-10-25T15:34:56.000Z",
            "date_published": "2023-10-24T16:59:24.000Z",
            "author": {
                "name": "doits",
                "url": "https://github.com/doits"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39735028?u=91330295c614cf3cec0b64bf242a14fc2ceb358f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49707.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1953127535\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49707\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49707/hovercard\" href=\"https://github.com/rails/rails/issues/49707\">#49707</a></p>\n<p dir=\"auto\">This Pull Request has been created because we noticed that <code class=\"notranslate\">ActiveRecord::Core#inspect</code> was taking &gt;9s to run for some large objects in production. This is because the parameter filter is be executed for every attribute.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request introduces configuration for <code class=\"notranslate\">ActiveRecord::Core#inspect</code>. By default, <code class=\"notranslate\">inspect</code> just returns the object with its id (eg <code class=\"notranslate\">#&lt;Post id: 1&gt;</code>. The attributes to include can be configured with <code class=\"notranslate\">Post.attributes_to_inspect=</code>. If you want to full output with all the attributes you can call <code class=\"notranslate\">Post.full_inspect</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">In my first draft I had a config to disable this, if you just always want to use <code class=\"notranslate\">full_inspect</code>. But it seems easy enough just to do <code class=\"notranslate\">alias_method :inspect, :full_inspect</code> on the model, or in <code class=\"notranslate\">ApplicationRecord</code> if you want to disable it globally. So the config didn't seem worth it to me.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49765",
            "title": "Make the output of `ActiveRecord::Core#inspect` configurable.",
            "date_modified": "2023-10-25T21:02:00.000Z",
            "date_published": "2023-10-24T14:20:10.000Z",
            "author": {
                "name": "andrewn617",
                "url": "https://github.com/andrewn617"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1100970?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background + Detail</h3>\n<p dir=\"auto\">Currently, the default option for <code class=\"notranslate\">order</code> is <code class=\"notranslate\">asc</code> and can also be set to <code class=\"notranslate\">desc</code> or passed an array with those values. This works great in most cases, however sometimes forcing the <code class=\"notranslate\">ORDER</code> clause for the primary key can result into a sort + heap scan in Postgresql, by passing an index lookup and may cause a performance tax and in those situations where we don't care about order, it'd be lovely to continue using <code class=\"notranslate\">in_batches</code> with no order instead of having to write custom SQL. Example usage</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Event\n  .where(story_run_id: ids)\n  .lock(&quot;FOR UPDATE SKIP LOCKED&quot;)\n  .in_batches(of: 1000, order: nil, &amp;:delete_all)\"><pre class=\"notranslate\"><span class=\"pl-v\">Event</span>\n  <span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">story_run_id</span>: <span class=\"pl-en\">ids</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">.</span><span class=\"pl-en\">lock</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"FOR UPDATE SKIP LOCKED\"</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-kos\">.</span><span class=\"pl-en\">in_batches</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">of</span>: <span class=\"pl-c1\">1000</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">order</span>: <span class=\"pl-c1\">nil</span><span class=\"pl-kos\">,</span> &amp;<span class=\"pl-pds\">:delete_all</span><span class=\"pl-kos\">)</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Chose to support <code class=\"notranslate\">nil</code> for the <code class=\"notranslate\">order</code> option over coming up with a new function like <code class=\"notranslate\">find_in_unordered_batches</code> or similar.</p>\n<p dir=\"auto\">Curious to hear more. For instance, this works for when <code class=\"notranslate\">delete_all</code> is passed, but may not work as expected if <code class=\"notranslate\">order: nil</code>, in any other case because the offset would be off?</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49764",
            "title": "Support the ability to run find_each/find_in_batches queries without order",
            "date_modified": "2023-10-24T15:16:51.000Z",
            "date_published": "2023-10-24T13:28:48.000Z",
            "author": {
                "name": "shayonj",
                "url": "https://github.com/shayonj"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22231095?u=fc75f9764434943effe06d6c1dc48d40a5003b0c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">The translation references cited in the documentation are no longer actively maintained, and some of them no longer exist. Therefore, it is not worthwhile to include these guides as references in our documentation.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request removes rails guides translation references from the guide.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49760",
            "title": "Remove rails guides translation references [ci skip]",
            "date_modified": "2023-10-25T22:47:01.000Z",
            "date_published": "2023-10-24T10:55:17.000Z",
            "author": {
                "name": "akhilgkrishnan",
                "url": "https://github.com/akhilgkrishnan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/28561?u=095779352a57f75e734987829f3f67a10e5780ed&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><code class=\"notranslate\">STATS_DIRECTORIES</code> is used by third parties to add directories to the statistics output. It's a global constant defined in a Rake file, that gets loaded anytime a rails command is executed.</p>\n<p dir=\"auto\">To remove the dependency on Rake and avoid a global constant we can move<br>\nthe constant to the Rails.application.configuration.</p>\n<p dir=\"auto\"><code class=\"notranslate\">deprecate_constant</code> couldn't be used here as that doesn't seem to work for the root namespace.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49759",
            "title": "Deprecate `STATS_DIRECTORIES` in favor of `config.code_statistics.directories`",
            "date_modified": "2023-10-25T09:16:35.000Z",
            "date_published": "2023-10-24T08:59:21.000Z",
            "author": {
                "name": "p8",
                "url": "https://github.com/p8"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/15084146?u=a691f2bcbb0260c6796bac4880c3035b08231ce8&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because the action-mailbox incineration feature's description is a little vague.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the description of how the incineration is invoked to be more clearly.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49743",
            "title": "Improve docs for the action-mail box incineration",
            "date_modified": "2023-10-23T00:09:33.000Z",
            "date_published": "2023-10-22T14:15:19.000Z",
            "author": {
                "name": "yoshixi",
                "url": "https://github.com/yoshixi"
            }
        }
    ]
}