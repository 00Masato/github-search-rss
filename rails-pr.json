{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/67181453?u=afd083d46441d8e8c2f420552d39c5248ed1afff&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Description</h3>\n<p dir=\"auto\">This pull request introduces a new ParallelQuery module to the ActiveRecord library, specifically designed to enhance query performance for PostgreSQL databases by leveraging parallel execution capabilities.</p>\n<h3 dir=\"auto\">Motivation</h3>\n<p dir=\"auto\">Modern databases, including PostgreSQL, support parallel query execution to utilize multiple CPU cores for faster data retrieval. However, Rails' ActiveRecord does not natively configure these parallel settings, potentially missing out on significant performance improvements for complex queries. This module aims to bridge that gap by dynamically configuring PostgreSQL settings to enable and optimize parallel execution.</p>\n<h4 dir=\"auto\">Why This Feature Is Important</h4>\n<p dir=\"auto\"><strong>Performance Improvement:</strong> Parallel queries can drastically reduce execution times for large and complex queries, especially those involving heavy computational operations or large datasets.<br>\n<strong>Resource Utilization:</strong> Makes better use of modern multi-core processors by distributing query execution across multiple CPU cores.<br>\n<strong>Scalability:</strong> Enhances the scalability of Rails applications by improving the database layer's efficiency, which is often a bottleneck in high-load scenarios.</p>\n<h3 dir=\"auto\">Key Changes</h3>\n<h4 dir=\"auto\">Introduction of ParallelQuery Module:</h4>\n<p dir=\"auto\">A new module, ActiveRecord::ParallelQuery, is added. This module provides a parallel_query method that configures the PostgreSQL settings for parallel execution before executing the provided block of code.<br>\nDynamic Configuration of PostgreSQL Settings:</p>\n<p dir=\"auto\">The parallel_query method sets several PostgreSQL parameters to optimize parallel execution:<br>\n<strong>max_parallel_workers_per_gather</strong>: Sets the maximum number of workers that can be used for parallel execution.<br>\n<strong>work_mem</strong>: Increases the memory available for internal operations to avoid disk I/O.<br>\n<strong>parallel_setup_cost</strong> and <strong>parallel_tuple_cost</strong>: Lowers the costs to make parallel execution more attractive to the query planner.<br>\n<strong>min_parallel_table_scan_size</strong> and <strong>min_parallel_index_scan_size</strong>: Ensures even small scans are considered for parallel execution.<br>\n<strong>Resetting Settings Post-Execution:</strong></p>\n<p dir=\"auto\">After executing the query block, the method ensures that all PostgreSQL settings are reset to their original values to avoid unintended side effects on subsequent queries.</p>\n<p dir=\"auto\"><strong>Compatibility with Other Adapters:</strong></p>\n<p dir=\"auto\">The module includes a conditional check to ensure that it only applies these settings to PostgreSQL adapters. For other adapters (e.g., MySQL, SQLite, SQL Server), the query block is executed without modification, there we can add the changes if in future those adapters supports this functionalities.</p>\n<h4 dir=\"auto\">Detailed Code Changes</h4>\n<p dir=\"auto\"><strong>Module Definition:</strong><br>\nAdded lib/active_record/parallel_query.rb with the new ParallelQuery module.<br>\nIntegration with ActiveRecord:<br>\nIncluded the ParallelQuery module in ActiveRecord::Base to make the parallel_query method available to all models.</p>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52134",
            "title": "Add ParallelQuery module to support parallel query execution in Postg…",
            "date_modified": "2024-06-16T05:25:08.000Z",
            "date_published": "2024-06-16T05:22:08.000Z",
            "author": {
                "name": "janarthanan-shanmugam",
                "url": "https://github.com/janarthanan-shanmugam"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The Logger severity predicates have existed since the <a href=\"https://github.com/ruby/logger/commit/525b58d97eb7dd1375f59dec6e4f34ebff0c0ecb\">introduction of Logger</a>. However, these methods only looked at the <code class=\"notranslate\">level</code> instance variable, so they did not work with the <a href=\"https://github.com/rails/rails/commit/629efb605728b31ad9644f6f0acaf3760b641a29\">thread safe implementation</a> of temporary log levels in Rails.</p>\n<p dir=\"auto\">Since then, the Logger severity predicates were <a href=\"https://github.com/ruby/logger/commit/7365c995bfde6cc52ad6c481e4c6fff32780025c\">updated</a> to use the <code class=\"notranslate\">level</code> method instead of the instance variable, making Rails' severity predicate overrides obsolete.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit removes Rails' custom severity predicates in favor of Logger's implementation, since the new implementation was released in Logger 1.4.2 and came bundled with Ruby 2.7.0.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>\n<p dir=\"auto\">This change only touches undocumented, internal methods so a CHANGELOG entry doesn't seem necessary.</p>",
            "url": "https://github.com/rails/rails/pull/52132",
            "title": "Remove obsolete Logger severity predicates",
            "date_modified": "2024-06-15T19:18:53.000Z",
            "date_published": "2024-06-15T19:18:49.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Follow up to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2194633942\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51349\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51349/hovercard\" href=\"https://github.com/rails/rails/pull/51349\">#51349</a>.</p>\n<p dir=\"auto\">In 2 places the call <code class=\"notranslate\">with_connection</code> is not needed, in another - just <code class=\"notranslate\">connection</code> is used.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a></p>",
            "url": "https://github.com/rails/rails/pull/52131",
            "title": "Fix more `with_connection` offences inside Active Record",
            "date_modified": "2024-06-16T08:37:56.000Z",
            "date_published": "2024-06-15T12:53:33.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/17757590?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><span class=\"issue-keyword\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1987597183\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49999\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49999/hovercard\" href=\"https://github.com/rails/rails/issues/49999\">#49999</a> for 7-1-stable branch</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">ActiveRecord::Relation#order now properly references Arel::Attribute arguments</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52128",
            "title": "[Fix #49999] properly reference from Arel::Attribute args [7-1-stable]",
            "date_modified": "2024-06-14T21:34:24.000Z",
            "date_published": "2024-06-14T21:28:17.000Z",
            "author": {
                "name": "mylesboone",
                "url": "https://github.com/mylesboone"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/816901?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">What this fixes</h2>\n<p dir=\"auto\">Here's the scenario I'd like to fix:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class MyTest &lt; ActiveSupport::TestCase\n  test &quot;there is a / in here&quot; do\n    assert true\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">MyTest</span> &lt; <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">TestCase</span>\n  <span class=\"pl-en\">test</span> <span class=\"pl-s\">\"there is a / in here\"</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-en\">assert</span> <span class=\"pl-c1\">true</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"bin/rails test test/my_test.rb --name test_there_is_a_/_in_here\"><pre class=\"notranslate\">bin/rails <span class=\"pl-c1\">test</span> test/my_test.rb --name test_there_is_a_/_in_here</pre></div>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"`require': cannot load such file -- /tmp/testapp/test_there_is_a_/_in_here (LoadError)\"><pre class=\"notranslate\"><code class=\"notranslate\">`require': cannot load such file -- /tmp/testapp/test_there_is_a_/_in_here (LoadError)\n</code></pre></div>\n<h2 dir=\"auto\">What the problem is</h2>\n<p dir=\"auto\">The main problem is that the code currently considers that any arg that contains at least one slash, no spaces, and is not surrounded with slashes has to be a file path, whereas in practice, arguments that follow <code class=\"notranslate\">--name</code> and <code class=\"notranslate\">-n</code> will never be a file path, <em>even</em> if they contain a <code class=\"notranslate\">/</code>.</p>\n<h2 dir=\"auto\">Reproducing</h2>\n<p dir=\"auto\">I've added some tests that prove the problem and fix, but here is another way to reproduce:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ cd /tmp\n$ rails new --minimal testapp\n$ cd testapp\n$ rails g scaffold Post title:string\"><pre class=\"notranslate\"><code class=\"notranslate\">$ cd /tmp\n$ rails new --minimal testapp\n$ cd testapp\n$ rails g scaffold Post title:string\n</code></pre></div>\n<p dir=\"auto\">Add a test to <code class=\"notranslate\">test/models/post_test.rb</code> with a slash in its label:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"test &quot;dummy test with a / slash&quot; do\n  assert true\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">test</span> <span class=\"pl-s\">\"dummy test with a / slash\"</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">assert</span> <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Failure pattern 1</h3>\n<p dir=\"auto\">The following command should only run that single test, but instead it crashes on \"cannot load such file\":</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ bin/rails test test/models/post_test.rb -n test_dummy_test_with_a_/_slash\n/opt/rubies/ruby-3.3.0/lib/ruby/3.3.0/bundled_gems.rb:74:in `require': cannot load such file -- /tmp/testapp/test_dummy_test_with_a_/_slash (LoadError)\"><pre class=\"notranslate\"><code class=\"notranslate\">$ bin/rails test test/models/post_test.rb -n test_dummy_test_with_a_/_slash\n/opt/rubies/ruby-3.3.0/lib/ruby/3.3.0/bundled_gems.rb:74:in `require': cannot load such file -- /tmp/testapp/test_dummy_test_with_a_/_slash (LoadError)\n</code></pre></div>\n<p dir=\"auto\"><code class=\"notranslate\">test_dummy_test_with_a_/_slash</code> was supposed to be a test name filter but was instead seen as a file path. Yet, the following command works:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ bin/rails test test/modes/post_test.rb -n /test_dummy_test_with_a_\\/_slash/\"><pre class=\"notranslate\"><code class=\"notranslate\">$ bin/rails test test/modes/post_test.rb -n /test_dummy_test_with_a_\\/_slash/\n</code></pre></div>\n<h3 dir=\"auto\">Failure pattern 2</h3>\n<p dir=\"auto\">Another failure, which is probably less important, but happens to get fixed by this PR, is when passing an absolute file path to a test directory in order to run all tests defined in that directory.</p>\n<p dir=\"auto\">Because the file path starts and ends with <code class=\"notranslate\">/</code>, it is seen as a regular expression instead.</p>\n<p dir=\"auto\">This next command should only run tests located in <code class=\"notranslate\">test/models</code> but it runs everything:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ bin/rails test --verbose /tmp/testapp/test/models/\nRunning 9 tests in a single process (parallelization threshold is 50)\nRun options: --verbose --seed 32902\n\nPostTest#test_the_truth = 0.02 s = .\nPostTest#test_dummy_test_with_a_/_slash = 0.00 s = .\nPostsControllerTest#test_should_show_post = 0.11 s = .\nPostsControllerTest#test_should_get_index = 0.00 s = .\nPostsControllerTest#test_should_get_edit = 0.01 s = .\nPostsControllerTest#test_should_update_post = 0.01 s = .\nPostsControllerTest#test_should_create_post = 0.01 s = .\nPostsControllerTest#test_should_destroy_post = 0.00 s = .\nPostsControllerTest#test_should_get_new = 0.00 s = .\n\nFinished in 0.168346s, 53.4614 runs/s, 77.2221 assertions/s.\n9 runs, 13 assertions, 0 failures, 0 errors, 0 skips\"><pre class=\"notranslate\"><code class=\"notranslate\">$ bin/rails test --verbose /tmp/testapp/test/models/\nRunning 9 tests in a single process (parallelization threshold is 50)\nRun options: --verbose --seed 32902\n\nPostTest#test_the_truth = 0.02 s = .\nPostTest#test_dummy_test_with_a_/_slash = 0.00 s = .\nPostsControllerTest#test_should_show_post = 0.11 s = .\nPostsControllerTest#test_should_get_index = 0.00 s = .\nPostsControllerTest#test_should_get_edit = 0.01 s = .\nPostsControllerTest#test_should_update_post = 0.01 s = .\nPostsControllerTest#test_should_create_post = 0.01 s = .\nPostsControllerTest#test_should_destroy_post = 0.00 s = .\nPostsControllerTest#test_should_get_new = 0.00 s = .\n\nFinished in 0.168346s, 53.4614 runs/s, 77.2221 assertions/s.\n9 runs, 13 assertions, 0 failures, 0 errors, 0 skips\n</code></pre></div>\n<h2 dir=\"auto\">Caveats</h2>\n<p dir=\"auto\">The code in <code class=\"notranslate\">railties/lib/rails/test_unit/runner.rb</code> is hard to adjust. It's attempting to parse arguments and change them before eventually forwarding them to Minitest. Not using <code class=\"notranslate\">OptionParser</code> means the code needs to somehow reinvent the wheel and handle multiple edge cases.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52126",
            "title": "Fix test runner when name contains a `/`",
            "date_modified": "2024-06-14T19:50:53.000Z",
            "date_published": "2024-06-14T16:25:26.000Z",
            "author": {
                "name": "davidstosik",
                "url": "https://github.com/davidstosik"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/54260?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">In <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2291492548\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51799\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51799/hovercard\" href=\"https://github.com/rails/rails/pull/51799\">#51799</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/dhh/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/dhh\">@dhh</a> changed asset pipeline default to Propshaft in Rails 8; specs assumed sprockets though so the new default isn't being tested.</p>\n<p dir=\"auto\"><a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/fedesapuppo/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/fedesapuppo\">@fedesapuppo</a> and I reconvert <code class=\"notranslate\">test/application/assets_test.rb</code> to test the propshaft default (dropping several sprockets-specific tests now unneeded), and duplicated the original file into a <code class=\"notranslate\">test/application/sprockets_assets_test.rb</code> to continue testing that option. Both run fine independently, but loading them together leaves the propshaft railtie loaded for both versions, messing with the sprockets configuration and tests. How could we decouple them properly?</p>\n<p dir=\"auto\">Thanks to <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a> for helping us get started generating a template app for each asset pipeline option.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> [doesn't apply] Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> [doesn't apply] CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52122",
            "title": "Add propshaft specs for railties new default",
            "date_modified": "2024-06-13T22:47:19.000Z",
            "date_published": "2024-06-13T22:47:15.000Z",
            "author": {
                "name": "tute",
                "url": "https://github.com/tute"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/803765?u=1068ad3fe7323acb63e9fe65e558ba0aabe5d3fe&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">I realized that retrying a job from GoodJob would enqueue it in the current locale of the GoodJob dashboard, even if the job was originally enqueued in a different locale.</p>\n<p dir=\"auto\">For instance, it was enqueued in <code class=\"notranslate\">:fr</code>, and failed. When I retried it from the dashboard that was in <code class=\"notranslate\">:en</code>, it was enqueued with an <code class=\"notranslate\">:en</code> locale ( I noticed it because it failed again with a missing translation error)</p>\n<p dir=\"auto\">I tracked it down to the <code class=\"notranslate\">serialize</code> method of <code class=\"notranslate\">ActiveJob</code> who always sets <code class=\"notranslate\">locale</code> from <code class=\"notranslate\">I18n.locale</code></p>\n<p dir=\"auto\">This PR changes the serialize method to actually return the original local from the job if it is set, and default to the current locale if not.</p>",
            "url": "https://github.com/rails/rails/pull/52121",
            "title": "Include the actual ActiveJob locale when serializing rather than I18n locale",
            "date_modified": "2024-06-14T00:53:57.000Z",
            "date_published": "2024-06-13T20:17:11.000Z",
            "author": {
                "name": "Intrepidd",
                "url": "https://github.com/Intrepidd"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/289727?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">Rails was not behaving as expected when sending invalid UTF-8 query string.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52114.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2350614733\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52114\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52114/hovercard\" href=\"https://github.com/rails/rails/issues/52114\">#52114</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">The <code class=\"notranslate\">check_param_encoding</code> only checked the values in the params hash resulting in a crash when sending query like <code class=\"notranslate\">?%ADf</code></p>\n<p dir=\"auto\">Changed the method so it also validates the encoding for keys in the params hash.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52116",
            "title": "Also check params key for valid encoding",
            "date_modified": "2024-06-14T08:49:59.000Z",
            "date_published": "2024-06-13T11:51:28.000Z",
            "author": {
                "name": "chrisdebruin",
                "url": "https://github.com/chrisdebruin"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/3124?u=6ece6a5a8b8ea32c5fa94c325d151bc01d1e44e8&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This PR uses the <a href=\"https://github.com/minitest/minitest/pull/1002\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/minitest/minitest/pull/1002/hovercard\">possible Minitest manual plugin API</a> to manually register the Rails minitest plugin.</p>\n<p dir=\"auto\">First, it renames the minitest plugin so that Minitest will never try to automatically load the Rails minitest plugin <em>outside</em> of Rails applications.</p>\n<p dir=\"auto\">Second, it changes our test helper to require the Minitest plugin and manually register it.  This allows the Rails plugin to participate in Minitests' plugin lifecycle, but <em>only</em> within the context of a Rails application.  Other non-Rails applications<br>\nwill never inadvertently load this plugin.</p>\n<p dir=\"auto\">I think I'll have to do some refactoring to get our CI to pass, but if the Minitest PR lands, we can merge this.</p>\n<p dir=\"auto\">Here is the manual registration in action:</p>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/3124/339146591-87509f06-d4c4-4187-8a81-d2bbb7a4acd1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTg1MzI0MDUsIm5iZiI6MTcxODUzMjEwNSwicGF0aCI6Ii8zMTI0LzMzOTE0NjU5MS04NzUwOWYwNi1kNGM0LTQxODctOGE4MS1kMmJiYjdhNGFjZDEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MDYxNiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDA2MTZUMTAwMTQ1WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NGU0YmMyNjE2MzA2NTUzNDcwNGIxZWZhMDMzOGExMzZiZWIxNWM3YjFlYzEwMzJhYzQ3ZjhkODkyOWYxNjc3MyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.mGE_63voeEDcKRWx5IcDw36cuZ4eFUS3M8YpuTelTZE\"><img width=\"1593\" alt=\"Screenshot 2024-06-12 at 3 06 59 PM\" src=\"https://private-user-images.githubusercontent.com/3124/339146591-87509f06-d4c4-4187-8a81-d2bbb7a4acd1.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTg1MzI0MDUsIm5iZiI6MTcxODUzMjEwNSwicGF0aCI6Ii8zMTI0LzMzOTE0NjU5MS04NzUwOWYwNi1kNGM0LTQxODctOGE4MS1kMmJiYjdhNGFjZDEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MDYxNiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDA2MTZUMTAwMTQ1WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NGU0YmMyNjE2MzA2NTUzNDcwNGIxZWZhMDMzOGExMzZiZWIxNWM3YjFlYzEwMzJhYzQ3ZjhkODkyOWYxNjc3MyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.mGE_63voeEDcKRWx5IcDw36cuZ4eFUS3M8YpuTelTZE\" style=\"max-width: 100%;\"></a>\n<p dir=\"auto\">Rails specific help text is still shown:</p>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/3124/339146496-22719bfc-c0b9-4294-8e1f-eec3f080b41a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTg1MzI0MDUsIm5iZiI6MTcxODUzMjEwNSwicGF0aCI6Ii8zMTI0LzMzOTE0NjQ5Ni0yMjcxOWJmYy1jMGI5LTQyOTQtOGUxZi1lZWMzZjA4MGI0MWEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MDYxNiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDA2MTZUMTAwMTQ1WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YTNiMDgwNDU2MTE3ZmJjZjAwMmUyMWUxNDNhMDdiZDUxNDNkMDg0NGZmODdmMTQyNTEwZDZiZDIzNzkzOTgwMyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.5Qa2IZ4egiufdNuJy8n8uxTkSSbU5jQYnhabnmg2z4I\"><img width=\"1593\" alt=\"Screenshot 2024-06-12 at 3 08 22 PM\" src=\"https://private-user-images.githubusercontent.com/3124/339146496-22719bfc-c0b9-4294-8e1f-eec3f080b41a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTg1MzI0MDUsIm5iZiI6MTcxODUzMjEwNSwicGF0aCI6Ii8zMTI0LzMzOTE0NjQ5Ni0yMjcxOWJmYy1jMGI5LTQyOTQtOGUxZi1lZWMzZjA4MGI0MWEucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MDYxNiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDA2MTZUMTAwMTQ1WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YTNiMDgwNDU2MTE3ZmJjZjAwMmUyMWUxNDNhMDdiZDUxNDNkMDg0NGZmODdmMTQyNTEwZDZiZDIzNzkzOTgwMyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.5Qa2IZ4egiufdNuJy8n8uxTkSSbU5jQYnhabnmg2z4I\" style=\"max-width: 100%;\"></a>",
            "url": "https://github.com/rails/rails/pull/52109",
            "title": "[WIP] Manually register the Rails Minitest plugin",
            "date_modified": "2024-06-12T22:26:48.000Z",
            "date_published": "2024-06-12T22:08:43.000Z",
            "author": {
                "name": "tenderlove",
                "url": "https://github.com/tenderlove"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/30030?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">See <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2341930906\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52066\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52066/hovercard\" href=\"https://github.com/rails/rails/issues/52066\">#52066</a> for context.</p>\n<p dir=\"auto\">Rack 3 introduced several features to enhance how \"streaming\" responses are handled.</p>\n<ul dir=\"auto\">\n<li>The presence of <code class=\"notranslate\">body#to_ary</code> indicates that a response can be buffered (i.e. converted to an Array of String instances, without affecting the application behaviour).</li>\n<li><code class=\"notranslate\">#each</code> consumes the body, i.e. yields successive chunks that can be sent incrementally using chunked encoding. This is also somewhat valid for Rack 2.</li>\n<li>Instead of responding to <code class=\"notranslate\">#each</code>, a body can respond to <code class=\"notranslate\">#call</code>, which gets invoked like a partial hijack and has identical semantics.</li>\n</ul>\n<p dir=\"auto\">Rails is still generating <code class=\"notranslate\">transfer-encoding: chunked</code> encoded responses as a Rack body, which can cause problems:</p>\n<ul dir=\"auto\">\n<li>Other Rack middleware may not be able to correctly manipulate the response body because it is encoded.\n<ul dir=\"auto\">\n<li>e.g. <code class=\"notranslate\">rack-cache</code> has been mentioned. However, it's <a href=\"https://github.com/socketry/async-http-cache/blob/main/lib/async/http/cache/general.rb#L171-L178\">absolutely possible to cache streaming responses</a> and this is just a limitation of the current implementation of Rails.</li>\n</ul>\n</li>\n<li><code class=\"notranslate\">transfer-encoding</code> is not supported by HTTP/2 as every response is effectively considered chunked and the wire format uses binary framing rather than length-prefixed chunked encoding. The Rails implementation is more limited than necessary in this regard.</li>\n<li>The complexity of the implementation is unnecessarily high and specific to HTTP/1. In addition, this complexity is already handled by the servers in a protocol-appropriate way.</li>\n</ul>\n<p dir=\"auto\">This change removes the explicit transfer encoding and instead relies on servers to correctly encode the response.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52094",
            "title": "Utilize Rack 3 streaming.",
            "date_modified": "2024-06-14T03:18:39.000Z",
            "date_published": "2024-06-12T00:49:50.000Z",
            "author": {
                "name": "ioquatix",
                "url": "https://github.com/ioquatix"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/474442?u=d5b5e080bdb67e9d1402d3f2490398c4015555c1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because <code class=\"notranslate\">to_time</code> on TimeWithZone object does not preserve timezone information. This PR adds a config to preserve timezone information when calling <code class=\"notranslate\">to_time</code> on TimeWithZone object.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds a new config value <code class=\"notranslate\">:zone</code> for <code class=\"notranslate\">ActiveSupport.to_time_preserves_timezone</code>. In addition, the existing <code class=\"notranslate\">true</code> value for <code class=\"notranslate\">ActiveSupport.to_time_preserves_timezone</code> has been changed to <code class=\"notranslate\">:offset</code> and preserves the previous behavior of using UTC offset.<br>\nWhen it's set to <code class=\"notranslate\">:zone</code>, <code class=\"notranslate\">to_time</code> will return a Time object with the same timezone as the TimeWithZone object.<br>\nDefault value for <code class=\"notranslate\">ActiveSupport.to_time_preserves_timezone</code> is now <code class=\"notranslate\">:zone</code> in 8.0.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">cc: <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/jhawthorn/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jhawthorn\">@jhawthorn</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52091",
            "title": "Add a config for preserving timezone information when calling `to_time` on TimeWithZone object",
            "date_modified": "2024-06-13T21:56:56.000Z",
            "date_published": "2024-06-11T19:09:34.000Z",
            "author": {
                "name": "jasonkim",
                "url": "https://github.com/jasonkim"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/131752?u=32ddf1119b1d189c9bd241a721b36ea01c29f61e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">At one point (I believe ruby 1.9.2) Time could only represent values between 1970 and the integer overflow in 2038. On modern Ruby there does not seem to be a limit.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"&gt;&gt; Time.at(2**128)\n=&gt; 10783118943836478994022445751222-08-06 01:04:16 -0700\"><pre class=\"notranslate\"><code class=\"notranslate\">&gt;&gt; Time.at(2**128)\n=&gt; 10783118943836478994022445751222-08-06 01:04:16 -0700\n</code></pre></div>\n<p dir=\"auto\"><code class=\"notranslate\">TimeWithZone</code> will also convert a <code class=\"notranslate\">DateTime</code> to a <code class=\"notranslate\">Time</code> when initialized with one, so the code we had to catch this overflow and to deal with <code class=\"notranslate\">DateTime</code> is dead. This commit removes this code and adjusts the test to be more general (the old test passed but we might as well keep a better version of the test to check that we have a large both negative and positive range).</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ docker run -e 'ALL_RUBY_SINCE=ruby-1.8' --rm rubylang/all-ruby ./all-ruby -e 'puts Time.at(2**64)'\nruby-1.8.0            -e:1:in `at': bignum too big to convert into `int' (RangeError)\n                      \tfrom -e:1\n                  exit 1\nruby-1.8.1            -e:1:in `at': bignum too big to convert into `int' (RangeError)\n                      \tfrom -e:1\n                  exit 1\nruby-1.8.2-preview1   -e:1:in `at': bignum too big to convert into `long' (RangeError)\n                      \tfrom -e:1\n                  exit 1\n...\nruby-1.8.6-p420       -e:1:in `at': bignum too big to convert into `long' (RangeError)\n                      \tfrom -e:1\n                  exit 1\nruby-1.8.7-preview1   Thu Jan 01 00:00:00 +0000 1970\n...\nruby-1.8.7-p374       Thu Jan 01 00:00:00 +0000 1970\nruby-1.9.0-0          -e:1:in `at': bignum too big to convert into `long' (RangeError)\n                      \tfrom -e:1:in `&lt;main&gt;'\n                  exit 1\n...\nruby-1.9.1-p431       -e:1:in `at': bignum too big to convert into `long' (RangeError)\n                      \tfrom -e:1:in `&lt;main&gt;'\n                  exit 1\nruby-1.9.2-preview1   584554051223-11-09 07:00:16 +0000\n...\nruby-3.4.0-preview1   584554051223-11-09 07:00:16 +0000\"><pre class=\"notranslate\"><code class=\"notranslate\">$ docker run -e 'ALL_RUBY_SINCE=ruby-1.8' --rm rubylang/all-ruby ./all-ruby -e 'puts Time.at(2**64)'\nruby-1.8.0            -e:1:in `at': bignum too big to convert into `int' (RangeError)\n                      \tfrom -e:1\n                  exit 1\nruby-1.8.1            -e:1:in `at': bignum too big to convert into `int' (RangeError)\n                      \tfrom -e:1\n                  exit 1\nruby-1.8.2-preview1   -e:1:in `at': bignum too big to convert into `long' (RangeError)\n                      \tfrom -e:1\n                  exit 1\n...\nruby-1.8.6-p420       -e:1:in `at': bignum too big to convert into `long' (RangeError)\n                      \tfrom -e:1\n                  exit 1\nruby-1.8.7-preview1   Thu Jan 01 00:00:00 +0000 1970\n...\nruby-1.8.7-p374       Thu Jan 01 00:00:00 +0000 1970\nruby-1.9.0-0          -e:1:in `at': bignum too big to convert into `long' (RangeError)\n                      \tfrom -e:1:in `&lt;main&gt;'\n                  exit 1\n...\nruby-1.9.1-p431       -e:1:in `at': bignum too big to convert into `long' (RangeError)\n                      \tfrom -e:1:in `&lt;main&gt;'\n                  exit 1\nruby-1.9.2-preview1   584554051223-11-09 07:00:16 +0000\n...\nruby-3.4.0-preview1   584554051223-11-09 07:00:16 +0000\n</code></pre></div>",
            "url": "https://github.com/rails/rails/pull/52084",
            "title": "Remove dead code for DateTime-backed TimeWithZone",
            "date_modified": "2024-06-12T18:48:49.000Z",
            "date_published": "2024-06-11T00:38:12.000Z",
            "author": {
                "name": "jhawthorn",
                "url": "https://github.com/jhawthorn"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52074.\">Fixes</span>  <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2343095558\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52074\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52074/hovercard\" href=\"https://github.com/rails/rails/issues/52074\">#52074</a>.</p>\n<p dir=\"auto\">Previously, when the record was created with an enum value not in the list and then retrieved from the database, it had <code class=\"notranslate\">nil</code> as the enum's value. Now, it will have the actual value.</p>\n<p dir=\"auto\">I am not sure if this will be expected for users or not. But other methods in the <code class=\"notranslate\">EnumType</code> class seems like doing similar things, like, for example, storing the original value if there is no a match in the enum definition. </p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/0733ab511877d6b61932615ca7d51b069fbe5cb3/activerecord/lib/active_record/enum.rb#L180-L200\">rails/activerecord/lib/active_record/enum.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 180 to 200\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/0733ab511877d6b61932615ca7d51b069fbe5cb3\">0733ab5</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L180\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"180\"></td>\n          <td id=\"LC180\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">cast</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L181\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"181\"></td>\n          <td id=\"LC181\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">if</span> <span class=\"pl-en\">mapping</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">has_key?</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L182\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"182\"></td>\n          <td id=\"LC182\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-s1\">value</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_s</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L183\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"183\"></td>\n          <td id=\"LC183\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">elsif</span> <span class=\"pl-en\">mapping</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">has_value?</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L184\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"184\"></td>\n          <td id=\"LC184\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">mapping</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">key</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L185\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"185\"></td>\n          <td id=\"LC185\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">else</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L186\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"186\"></td>\n          <td id=\"LC186\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-s1\">value</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">presence</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L187\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"187\"></td>\n          <td id=\"LC187\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L188\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"188\"></td>\n          <td id=\"LC188\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L189\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"189\"></td>\n          <td id=\"LC189\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L190\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"190\"></td>\n          <td id=\"LC190\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">deserialize</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L191\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"191\"></td>\n          <td id=\"LC191\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-en\">mapping</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">key</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">subtype</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">deserialize</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L192\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"192\"></td>\n          <td id=\"LC192\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L193\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"193\"></td>\n          <td id=\"LC193\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L194\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"194\"></td>\n          <td id=\"LC194\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">serialize</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L195\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"195\"></td>\n          <td id=\"LC195\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-en\">subtype</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">serialize</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">mapping</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">fetch</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L196\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"196\"></td>\n          <td id=\"LC196\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L197\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"197\"></td>\n          <td id=\"LC197\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L198\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"198\"></td>\n          <td id=\"LC198\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">serializable?</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">,</span> &amp;<span class=\"pl-s1\">block</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L199\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"199\"></td>\n          <td id=\"LC199\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-en\">subtype</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">serializable?</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">mapping</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">fetch</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span> &amp;<span class=\"pl-s1\">block</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L200\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"200\"></td>\n          <td id=\"LC200\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>",
            "url": "https://github.com/rails/rails/pull/52078",
            "title": "Fix creating records without partial inserts and enum with database default not in the definition",
            "date_modified": "2024-06-10T11:08:31.000Z",
            "date_published": "2024-06-10T11:08:27.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/12777550?u=415303ec1c626279c440cf729435fc0ee833d1c9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51817.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2295142022\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51817\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51817/hovercard\" href=\"https://github.com/rails/rails/issues/51817\">#51817</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Currently, Rails doesn't have a mechanism to allow the main record to efficiently access its <code class=\"notranslate\">has_one :through</code> associations via the middle record.</p>\n<p dir=\"auto\">When we define a <code class=\"notranslate\">has_one :through</code> association, Rails creates a <code class=\"notranslate\">HasOneThroughAssociation</code> object within that record. Like all other Association objects, <code class=\"notranslate\">HasOneThroughAssociation</code> works independently and doesn't check the loading status of other associations. If it doesn't find the record within the object itself, it simply queries the database. And this triggers an additional query even when all associated records are preloaded.</p>\n<p dir=\"auto\">On top of that, making another query for an already loaded association results in having two identical records in memory. This can confuse developers about which record is the single source of truth. When one record is updated, the other remains unchanged. Here is an example:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"member.membership.club.name = 'New Club'\n\nmember.membership.club.name # =&gt; 'New Club'\nmember.club.name            # =&gt; 'Old Club'\"><pre class=\"notranslate\"><span class=\"pl-en\">member</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">membership</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">club</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">'New Club'</span>\n\n<span class=\"pl-en\">member</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">membership</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">club</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span> <span class=\"pl-c\"># =&gt; 'New Club'</span>\n<span class=\"pl-en\">member</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">club</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">name</span>            <span class=\"pl-c\"># =&gt; 'Old Club'</span></pre></div>\n<p dir=\"auto\">The changes prevent the additional query and ensure there is a single source of truth.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">I tried to apply the same approach to the <code class=\"notranslate\">has_many :through</code> association, but it is not as straightforward as the <code class=\"notranslate\">has_one :through</code> association. All the final records are stored in each middle record's association object. So, we need to find a better way to implement this. I will look into this more and create another PR if I find a solution.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52060",
            "title": "[Fix #51817] Allow Preloaded `has_one :through` Associations to be Accessed Without Additional Database Queries",
            "date_modified": "2024-06-15T11:55:03.000Z",
            "date_published": "2024-06-08T11:11:29.000Z",
            "author": {
                "name": "Jay0921",
                "url": "https://github.com/Jay0921"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/83998?u=8bb33de7a19d113d9f589689f6d15bb622b132bd&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">There are many cases when using double quotes is necessary to properly identify type &amp; column names in PostgreSQL. This PR aims to address one subset of cases relating to Rails's support of PG Enums in <code class=\"notranslate\">schema.rb</code>.</p>\n<p dir=\"auto\">As it stands, PG Enums that require quote identifiers can be successfully created with the migration DSL, but these type names do not currently survive the round-trip to <code class=\"notranslate\">schema.rb</code>, breaking subsequent <code class=\"notranslate\">schema:load</code> calls.</p>\n<p dir=\"auto\">(If this change is accepted, I have additional cases I would propose in follow-up PRs, but I am focusing on one change at a time.)</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Note that I'm using <code class=\"notranslate\">.</code> here as an example, but there are other reasons why quote identifiers can be necessary, including case sensitivity.</p>\n<h4 dir=\"auto\">Before:</h4>\n<p dir=\"auto\"><em>Without</em> this PR's changes, the following migration:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create_enum '&quot;my.status&quot;', %w[complete in_progress]\ncreate_table :things do |t|\n  t.enum :status, enum_type: '&quot;my.status&quot;', default: &quot;in_progress&quot;, null: false\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">create_enum</span> <span class=\"pl-s\">'\"my.status\"'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">complete</span> <span class=\"pl-s\">in_progress</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:things</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enum</span> <span class=\"pl-pds\">:status</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">enum_type</span>: <span class=\"pl-s\">'\"my.status\"'</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">Produces the following in the <code class=\"notranslate\">schema.rb</code> file:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create_enum &quot;my.status&quot;, [&quot;complete&quot;, &quot;in_progress&quot;]\n\ncreate_table &quot;things&quot;, force: :cascade do |t|\n  t.enum &quot;status&quot;, default: &quot;in_progress&quot;, null: false, enum_type: &quot;&quot;my.status&quot;&quot;\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">create_enum</span> <span class=\"pl-s\">\"my.status\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"complete\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">]</span>\n\n<span class=\"pl-en\">create_table</span> <span class=\"pl-s\">\"things\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-pds\">:cascade</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enum</span> <span class=\"pl-s\">\"status\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">enum_type</span>: <span class=\"pl-s\">\"\"</span><span class=\"pl-en\">my</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">status</span><span class=\"pl-s\">\"\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">🐛 Both the <code class=\"notranslate\">create_enum</code> statement and the <code class=\"notranslate\">:enum_type</code> option do not function as expected. The former produces a <code class=\"notranslate\">PG::InvalidSchemaName</code> error (because it assumes <code class=\"notranslate\">my.</code> is a PG schema), and the latter is not even valid Ruby.</p>\n<h4 dir=\"auto\">After:</h4>\n<p dir=\"auto\"><em>With</em> this PR's changes, <code class=\"notranslate\">schema.rb</code> contains the following:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create_enum &quot;\\&quot;my.status\\&quot;&quot;, [&quot;complete&quot;, &quot;in_progress&quot;]\n\ncreate_table &quot;things&quot;, force: :cascade do |t|\n  t.enum &quot;status&quot;, default: &quot;in_progress&quot;, null: false, enum_type: &quot;\\&quot;my.status\\&quot;&quot;\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">create_enum</span> <span class=\"pl-s\">\"<span class=\"pl-cce\">\\\"</span>my.status<span class=\"pl-cce\">\\\"</span>\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">[</span><span class=\"pl-s\">\"complete\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">]</span>\n\n<span class=\"pl-en\">create_table</span> <span class=\"pl-s\">\"things\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-pds\">:cascade</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">enum</span> <span class=\"pl-s\">\"status\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">default</span>: <span class=\"pl-s\">\"in_progress\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">enum_type</span>: <span class=\"pl-s\">\"<span class=\"pl-cce\">\\\"</span>my.status<span class=\"pl-cce\">\\\"</span>\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">This should resolve cases where quote identifiers are necessary, without impacting cases where they are not <em>strictly</em> necessary.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52049",
            "title": "[ActiveRecord] Support PG enums with names that require quote-ident",
            "date_modified": "2024-06-10T16:33:11.000Z",
            "date_published": "2024-06-07T19:03:28.000Z",
            "author": {
                "name": "smudge",
                "url": "https://github.com/smudge"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This commit aims to clarify the types of arguments mentioned by the Association Callback documentation. In some cases, <code class=\"notranslate\">firm</code> arguments implied the object was a <code class=\"notranslate\">Firm</code>, but <code class=\"notranslate\">record</code> arguments did not imply any particular class.</p>\n<p dir=\"auto\">Similarly, the <code class=\"notranslate\">has_many</code> method documentation did not mention any of the Association Callback arguments (i.e. <code class=\"notranslate\">before_add</code>, <code class=\"notranslate\">after_add</code>, <code class=\"notranslate\">before_remove</code>, <code class=\"notranslate\">after_remove</code>). This commit includes those options in the list and links to the more thorough documentation under the Association Callbacks heading.</p>",
            "url": "https://github.com/rails/rails/pull/52047",
            "title": "Improve Active Record Association Callbacks docs [ci skip]",
            "date_modified": "2024-06-14T09:16:08.000Z",
            "date_published": "2024-06-07T17:51:03.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Based off the IRB tests: <a href=\"https://github.com/ruby/irb/blob/master/test/irb/helper.rb#L112-L120\">https://github.com/ruby/irb/blob/master/test/irb/helper.rb#L112-L120</a></p>\n<p dir=\"auto\">For example if you add this to your <code class=\"notranslate\">~/.irbrc</code>:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"IRB.conf[:PROMPT_MODE] = :SIMPLE\"><pre class=\"notranslate\"><code class=\"notranslate\">IRB.conf[:PROMPT_MODE] = :SIMPLE\n</code></pre></div>\n<p dir=\"auto\">This will result in the following test failures:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"F\n\nFailure:\nFullStackConsoleTest#test_prompt_allows_changing_irb_name [test/application/console_test.rb:32]:\n&quot;foo(test)&gt;&quot; expected, but got:\n\n&gt;&gt; a = 1\na = 1\n=&gt; ...\n&gt;&gt; .\nExpected &quot;&gt;&gt; a = 1\\r\\r\\na = 1\\r\\n=&gt; ...\\r\\n&gt;&gt; &quot; to include &quot;foo(test)&gt;&quot;.\n\nbin/test test/application/console_test.rb:120\n\n.............F\n\nFailure:\nFullStackConsoleTest#test_test_console_prompt [test/application/console_test.rb:32]:\n&quot;app-template(test)&gt; &quot; expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected &quot;\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; &quot; to include &quot;app-template(test)&gt; &quot;.\n\nbin/test test/application/console_test.rb:152\n\n...F\n\nFailure:\nFullStackConsoleTest#test_prompt_is_properly_set [test/application/console_test.rb:32]:\n&quot;app-template(test)&gt;&quot; expected, but got:\n\n&gt;&gt; a = 1\na = 1\n=&gt; ...\n&gt;&gt; .\nExpected &quot;&gt;&gt; a = 1\\r\\r\\na = 1\\r\\n=&gt; ...\\r\\n&gt;&gt; &quot; to include &quot;app-template(test)&gt;&quot;.\n\nbin/test test/application/console_test.rb:113\n\nF\n\nFailure:\nFullStackConsoleTest#test_production_console_prompt [test/application/console_test.rb:32]:\n&quot;app-template(prod)&gt;&quot; expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected &quot;\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; &quot; to include &quot;app-template(prod)&gt;&quot;.\n\nbin/test test/application/console_test.rb:138\n\n...F\n\nFailure:\nFullStackConsoleTest#test_development_console_prompt [test/application/console_test.rb:32]:\n&quot;app-template(dev)&gt; &quot; expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected &quot;\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; &quot; to include &quot;app-template(dev)&gt; &quot;.\n\nbin/test test/application/console_test.rb:145\n\nFinished in 137.655994s, 0.1743 runs/s, 1.8815 assertions/s.\n24 runs, 259 assertions, 5 failures, 0 errors, 0 skips\"><pre class=\"notranslate\"><code class=\"notranslate\">F\n\nFailure:\nFullStackConsoleTest#test_prompt_allows_changing_irb_name [test/application/console_test.rb:32]:\n\"foo(test)&gt;\" expected, but got:\n\n&gt;&gt; a = 1\na = 1\n=&gt; ...\n&gt;&gt; .\nExpected \"&gt;&gt; a = 1\\r\\r\\na = 1\\r\\n=&gt; ...\\r\\n&gt;&gt; \" to include \"foo(test)&gt;\".\n\nbin/test test/application/console_test.rb:120\n\n.............F\n\nFailure:\nFullStackConsoleTest#test_test_console_prompt [test/application/console_test.rb:32]:\n\"app-template(test)&gt; \" expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected \"\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; \" to include \"app-template(test)&gt; \".\n\nbin/test test/application/console_test.rb:152\n\n...F\n\nFailure:\nFullStackConsoleTest#test_prompt_is_properly_set [test/application/console_test.rb:32]:\n\"app-template(test)&gt;\" expected, but got:\n\n&gt;&gt; a = 1\na = 1\n=&gt; ...\n&gt;&gt; .\nExpected \"&gt;&gt; a = 1\\r\\r\\na = 1\\r\\n=&gt; ...\\r\\n&gt;&gt; \" to include \"app-template(test)&gt;\".\n\nbin/test test/application/console_test.rb:113\n\nF\n\nFailure:\nFullStackConsoleTest#test_production_console_prompt [test/application/console_test.rb:32]:\n\"app-template(prod)&gt;\" expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected \"\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; \" to include \"app-template(prod)&gt;\".\n\nbin/test test/application/console_test.rb:138\n\n...F\n\nFailure:\nFullStackConsoleTest#test_development_console_prompt [test/application/console_test.rb:32]:\n\"app-template(dev)&gt; \" expected, but got:\n\n112123&gt;&gt; 123\n=&gt; 123\n&gt;&gt; .\nExpected \"\\r\\n112123&gt;&gt; 123\\r\\r\\n=&gt; 123\\r\\n&gt;&gt; \" to include \"app-template(dev)&gt; \".\n\nbin/test test/application/console_test.rb:145\n\nFinished in 137.655994s, 0.1743 runs/s, 1.8815 assertions/s.\n24 runs, 259 assertions, 5 failures, 0 errors, 0 skips\n</code></pre></div>",
            "url": "https://github.com/rails/rails/pull/52045",
            "title": "Avoid running console tests against users IRB config",
            "date_modified": "2024-06-08T10:48:48.000Z",
            "date_published": "2024-06-07T11:21:08.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1034?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">I realised that <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2329736976\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51994\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51994/hovercard\" href=\"https://github.com/rails/rails/pull/51994\">#51994</a> was producing a deprecation warning while running the Active Record tests (I actually thought we'd made that fail CI, but I must be mis-remembering).</p>\n<p dir=\"auto\">While we could just explicitly opt in to the new setting within our test suite(s), I wanted to see if we could save similar callers [i.e. those that aren't particularly concerned with time zones] from having to know about / act upon the change at all.</p>\n<p dir=\"auto\">Mostly that comes down to the fact that for <code class=\"notranslate\">Time#to_time</code>, if the value is already a local time, there's no difference in behaviour, and so no need to warn.</p>\n<p dir=\"auto\">Correspondingly, I've avoided calling <code class=\"notranslate\">to_time</code> in the handful of places we were using it internally: it's easy to do, and we know we don't care about the zone, so again won't be affected by the change.</p>\n<p dir=\"auto\">I'm hoping this will mean that people who do see the deprecation are likely to actually be affected [or at least be genuinely at risk of being affected] by the change, thus justifying the disruption.</p>\n<p dir=\"auto\">It's worth noting that I currently have <em>not</em> changed <code class=\"notranslate\">ActiveSupport::TimeWithZone#to_time</code>: even when its zone matches local (including the most common case where both are UTC), we will still warn. That felt like the right choice at the time, though I'm now less sure... <code class=\"notranslate\">3.days.ago.to_time</code> seems like a pretty reasonable and ordinary thing to be doing, and (in the absence of any zone-related configuration) I believe it should be perfectly safe. 🤔</p>",
            "url": "https://github.com/rails/rails/pull/52031",
            "title": "Don't emit to_time deprecations in known-safe contexts",
            "date_modified": "2024-06-13T19:38:35.000Z",
            "date_published": "2024-06-06T09:16:27.000Z",
            "author": {
                "name": "matthewd",
                "url": "https://github.com/matthewd"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14981592?u=11406fb0121b15a93b3305388377a57b4d9c96f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Followup to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2326434456\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51959\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51959/hovercard\" href=\"https://github.com/rails/rails/pull/51959\">#51959</a>. The test I added in that PR can be improved by actually checking that the runner does what the expected behaviour is.</p>\n<p dir=\"auto\">Since support for minitest/spec should not be implied (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2326434456\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51959\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51959/hovercard?comment_id=1621385796&amp;comment_type=review_comment\" href=\"https://github.com/rails/rails/pull/51959#discussion_r1621385796\">#51959 (comment)</a>) I also slightly modified the test above</p>",
            "url": "https://github.com/rails/rails/pull/52002",
            "title": "Add a proper test for running tests by line with custom method",
            "date_modified": "2024-06-03T10:28:09.000Z",
            "date_published": "2024-06-03T10:28:04.000Z",
            "author": {
                "name": "Earlopain",
                "url": "https://github.com/Earlopain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2853450?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51995.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2329813988\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51995\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51995/hovercard\" href=\"https://github.com/rails/rails/issues/51995\">#51995</a></p>\n<p dir=\"auto\">Calling <code class=\"notranslate\">exists?</code> does not work with composite keys (<a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2179081656\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51295\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51295/hovercard\" href=\"https://github.com/rails/rails/issues/51295\">#51295</a>) which is used internally for <code class=\"notranslate\">include?</code> here it zips the primary key values into a hash with the primary key keys, a format that is supported by <code class=\"notranslate\">exists?</code> so it does not raise and returns the expected result.</p>",
            "url": "https://github.com/rails/rails/pull/51996",
            "title": "Fix `include?` on composite key relations",
            "date_modified": "2024-06-11T06:27:57.000Z",
            "date_published": "2024-06-02T18:54:30.000Z",
            "author": {
                "name": "jackozi",
                "url": "https://github.com/jackozi"
            }
        }
    ]
}