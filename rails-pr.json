{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7348?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">After updating to Rails 7.2, we noticed that attributes were missing when inspecting AR objects in a production-like console. We found <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1959373528\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49765\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49765/hovercard\" href=\"https://github.com/rails/rails/pull/49765\">#49765</a>. After discussing this with <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a> and the author of the PR, <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/andrewn617/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/andrewn617\">@andrewn617</a>, we came to the conclusion that this should default to <code class=\"notranslate\">:all</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR changes the default of <code class=\"notranslate\">attributes_for_inspect</code> to <code class=\"notranslate\">:all</code>. There's a commit on this branch that also updated the Rails 7.2 new defaults initializer, but I removed that as it's not on main and I'm unsure how to handle that.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">This PR is going off of a discussion with <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a>. It's possible there is more to change here to make this work properly, and I apologize if thats the case. Happy to make more updates. I'm curious if, since we want new Rails applications to have this default set to true, if the <code class=\"notranslate\">production.rb</code> environment file should be updated to include the configuration change.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52753",
            "title": "`ActiveRecord::Base.attributes_for_inspect` should default to `:all`",
            "date_modified": "2024-08-31T07:55:41.000Z",
            "date_published": "2024-08-30T20:35:24.000Z",
            "author": {
                "name": "levicole",
                "url": "https://github.com/levicole"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/28872849?u=49f9c9767971ca366205c6c25f79960f2ddf8cba&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This PR adds tests for the devcontainer generator.</p>\n<p dir=\"auto\">During discussion with <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/andrewn617/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/andrewn617\">@andrewn617</a>  in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2485076268\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52704\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52704/hovercard\" href=\"https://github.com/rails/rails/issues/52704\">#52704</a>, we decided that although the generator is tested via the app generator, and now hidden from the generator list in favor of the devcontainer command, it would still be beneficial to test it directly.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">I took the devcontainer tests from <code class=\"notranslate\">railties/test/generators/app_generator_test.rb</code>, copied them over, and split them up by option, and tidied up.</p>\n<p dir=\"auto\">Tests for all of the possible option values, plus a shared test for configuration that should not vary due to options. The common test is run against the default generator, and then every time an argument is used. May be overkill, but I don't think these tests are expensive</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated <del>if you fix a bug or add a feature</del>.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> <del>CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</del></li>\n</ul>\n<h3 dir=\"auto\">Additional Notes</h3>\n<p dir=\"auto\">I have found one issue with <code class=\"notranslate\">application_system_test_case</code> modification. The generator uses <code class=\"notranslate\">gsub_file</code> in such a way that it is not idempotent, and gets <strong>pretty messed up</strong> on the second run.  I started to add a test for it, but didn't want to get stuck on that here. I can add a separate issue if need be. Here was the start of my test for that, if anyone wants to try it out:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"def test_system_test_option_idempotent\n  copy_application_system_test_case\n\n  run_generator\n\n  assert_file(&quot;test/application_system_test_case.rb&quot;) do |system_test_case|\n    assert_match(/^  if ENV\\[&quot;CAPYBARA_SERVER_PORT&quot;\\]/, system_test_case)\n    assert_match(/^    served_by host: &quot;rails-app&quot;, port: ENV\\[&quot;CAPYBARA_SERVER_PORT&quot;\\]/, system_test_case)\n    assert_match(/^    driven_by :selenium, using: :headless_chrome, screen_size: \\[ 1400, 1400 \\], options: {$/, system_test_case)\n    assert_match(/^      browser: :remote,$/, system_test_case)\n    assert_match(/^      url: &quot;http:\\/\\/\\#{ENV\\[&quot;SELENIUM_HOST&quot;\\]}:4444&quot;$/, system_test_case)\n  end\n\n  run_generator\n  assert_file(&quot;test/application_system_test_case.rb&quot;) do |system_test_case|\n    # TODO: assert only one\n    # assert_match(/^  if ENV\\[&quot;CAPYBARA_SERVER_PORT&quot;\\]/, system_test_case)\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">def</span> <span class=\"pl-en\">test_system_test_option_idempotent</span>\n  <span class=\"pl-en\">copy_application_system_test_case</span>\n\n  <span class=\"pl-en\">run_generator</span>\n\n  <span class=\"pl-en\">assert_file</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"test/application_system_test_case.rb\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">system_test_case</span>|\n    <span class=\"pl-en\">assert_match</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/^  if ENV<span class=\"pl-cce\">\\[</span>\"CAPYBARA_SERVER_PORT\"<span class=\"pl-cce\">\\]</span>/</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">system_test_case</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-en\">assert_match</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/^    served_by host: \"rails-app\", port: ENV<span class=\"pl-cce\">\\[</span>\"CAPYBARA_SERVER_PORT\"<span class=\"pl-cce\">\\]</span>/</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">system_test_case</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-en\">assert_match</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/^    driven_by :selenium, using: :headless_chrome, screen_size: <span class=\"pl-cce\">\\[</span> 1400, 1400 <span class=\"pl-cce\">\\]</span>, options: {$/</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">system_test_case</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-en\">assert_match</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/^      browser: :remote,$/</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">system_test_case</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-en\">assert_match</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/^      url: \"http:<span class=\"pl-cce\">\\/</span><span class=\"pl-cce\">\\/</span><span class=\"pl-cce\">\\#</span>{ENV<span class=\"pl-cce\">\\[</span>\"SELENIUM_HOST\"<span class=\"pl-cce\">\\]</span>}:4444\"$/</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">system_test_case</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-en\">run_generator</span>\n  <span class=\"pl-en\">assert_file</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"test/application_system_test_case.rb\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">system_test_case</span>|\n    <span class=\"pl-c\"># TODO: assert only one</span>\n    <span class=\"pl-c\"># assert_match(/^  if ENV\\[\"CAPYBARA_SERVER_PORT\"\\]/, system_test_case)</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>",
            "url": "https://github.com/rails/rails/pull/52752",
            "title": "Test DevcontainerGenerator",
            "date_modified": "2024-08-30T19:50:57.000Z",
            "date_published": "2024-08-30T19:41:51.000Z",
            "author": {
                "name": "thejonroberts",
                "url": "https://github.com/thejonroberts"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/824254?u=d635bbe022541838b9319dfe9c78907dec0ed401&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because when <strong>reverting</strong> a migration I was getting the message <code class=\"notranslate\">Migrating to AddUsernameColumnToUser (20240827174134)</code>, which doesn't seem like an accurate description of the operation.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the message based on the operation.</p>\n<ul dir=\"auto\">\n<li><code class=\"notranslate\">up</code> operation: message keeps being the same (<code class=\"notranslate\">Migrating to AddUsernameColumnToUser (20240827174134)</code>)</li>\n<li><code class=\"notranslate\">down</code> operation: message change (<code class=\"notranslate\">Rolling back AddUsernameColumnToUser (20240827174134)</code>)</li>\n</ul>\n<p dir=\"auto\"><code class=\"notranslate\">AddUsernameColumnToUser</code> is just an example of a migration name<br>\n<code class=\"notranslate\">20240827174134</code> is the timestamp</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">I thought <code class=\"notranslate\">Rolling back</code> would be accurate since we use the command <code class=\"notranslate\">rake db:rollback</code>. But <code class=\"notranslate\">Reverting</code> or another similar set of words might be best.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52749",
            "title": "Fix migration log message for down operations",
            "date_modified": "2024-08-30T17:28:28.000Z",
            "date_published": "2024-08-30T15:44:21.000Z",
            "author": {
                "name": "bernardobarreto",
                "url": "https://github.com/bernardobarreto"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/28561?u=095779352a57f75e734987829f3f67a10e5780ed&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Make it easier for third party gems, to register test directories.</p>\n<p dir=\"auto\">For example <code class=\"notranslate\">rspec-rails</code> currently appends to the TEST_TYPES constant:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"  ::STATS_DIRECTORIES &lt;&lt; [&quot;#{name} specs&quot;, dir]\n  ::CodeStatistics::TEST_TYPES &lt;&lt; &quot;#{name} specs&quot;\"><pre class=\"notranslate\"><code class=\"notranslate\">  ::STATS_DIRECTORIES &lt;&lt; [\"#{name} specs\", dir]\n  ::CodeStatistics::TEST_TYPES &lt;&lt; \"#{name} specs\"\n</code></pre></div>\n<p dir=\"auto\"><a href=\"https://github.com/rspec/rspec-rails/blob/418daeb0f492e693b7bd2c6bba1c2c1aee3a4d37/lib/rspec/rails/tasks/rspec.rake#L44\">https://github.com/rspec/rspec-rails/blob/418daeb0f492e693b7bd2c6bba1c2c1aee3a4d37/lib/rspec/rails/tasks/rspec.rake#L44</a></p>\n<p dir=\"auto\">With this change it can be simplified to:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"::Rails::CodeStatistics.register_directory &quot;#{name} specs&quot;, dir, test_directory: true\"><pre class=\"notranslate\"><code class=\"notranslate\">::Rails::CodeStatistics.register_directory \"#{name} specs\", dir, test_directory: true\n</code></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52747",
            "title": "Allow registering test directories for CodeStatistics",
            "date_modified": "2024-08-30T17:49:46.000Z",
            "date_published": "2024-08-30T09:09:04.000Z",
            "author": {
                "name": "p8",
                "url": "https://github.com/p8"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14981592?u=11406fb0121b15a93b3305388377a57b4d9c96f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Ruby plans to make <code class=\"notranslate\">benchmark</code> a bundled gem: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2493901747\" data-permission-text=\"Title is private\" data-url=\"https://github.com/ruby/ruby/issues/11492\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/ruby/ruby/pull/11492/hovercard\" href=\"https://github.com/ruby/ruby/pull/11492\">ruby/ruby#11492</a></p>\n<p dir=\"auto\">It doesn't make much sense to keep this core extension since rails would need to add it to its gemspec to continue offering it for what basically amounts to <code class=\"notranslate\">1000 * x</code>.</p>\n<p dir=\"auto\">Since requiring it could emit a warning, add it to the gemspec until it can later be removed again with Rails 8.1</p>\n<p dir=\"auto\">The benchmark generator will continue to work as usual: It adds <code class=\"notranslate\">benchmark-ips</code> to the users Gemfile, which in turn should depend on <code class=\"notranslate\">benchmark</code>: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2494796252\" data-permission-text=\"Title is private\" data-url=\"https://github.com/evanphx/benchmark-ips/issues/141\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/evanphx/benchmark-ips/pull/141/hovercard\" href=\"https://github.com/evanphx/benchmark-ips/pull/141\">evanphx/benchmark-ips#141</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52746",
            "title": "Deprecate `Benchmark.ms` and add `benchmark` to the gemspec",
            "date_modified": "2024-08-29T18:15:19.000Z",
            "date_published": "2024-08-29T16:16:49.000Z",
            "author": {
                "name": "Earlopain",
                "url": "https://github.com/Earlopain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Currently, this works across all database adapters:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"SomeModel.select(arel_table[:some_column]).count\"><pre class=\"notranslate\"><span class=\"pl-v\">SomeModel</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">select</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">arel_table</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:some_column</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">count</span></pre></div>\n<p dir=\"auto\">MySQL also support <code class=\"notranslate\">COUNT DISTINCT</code> over multiple columns, but this is not working and produces invalid SQL:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"SomeModel.select(arel_table[:column1], arel_table[:column2]).distinct.count\"><pre class=\"notranslate\"><span class=\"pl-v\">SomeModel</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">select</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">arel_table</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:column1</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-en\">arel_table</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:column2</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">distinct</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">count</span></pre></div>\n<p dir=\"auto\">So this PR fixes that case.</p>",
            "url": "https://github.com/rails/rails/pull/52744",
            "title": "Fix `distinct.count` when using `select` with multiple arel expressions",
            "date_modified": "2024-08-29T12:05:03.000Z",
            "date_published": "2024-08-29T12:04:58.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/92010?u=64492eb10f8d22c3f9c7766b9b16d4d6ba1384cc&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">The preferred web app tag has changed and Chrome is reporting the old one as deprecated.</p>\n<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/92010/362467273-942ed7ed-3c50-4407-b3e0-64f752f421a5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjUxMDYwMjEsIm5iZiI6MTcyNTEwNTcyMSwicGF0aCI6Ii85MjAxMC8zNjI0NjcyNzMtOTQyZWQ3ZWQtM2M1MC00NDA3LWIzZTAtNjRmNzUyZjQyMWE1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA4MzElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwODMxVDEyMDIwMVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRkNTViOWY5NmZlOTc2YWFkYThiYWU1ZTFhNzZkOGRhOGE5ODAyMTNhYTEwNjM4YzY0Y2ZiMDQ5YzJiMTY5YmEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.2Cr2wVETWvGiXuNCOH_xn3ROElu7TmbvskUH4mLn5i4\"><img src=\"https://private-user-images.githubusercontent.com/92010/362467273-942ed7ed-3c50-4407-b3e0-64f752f421a5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjUxMDYwMjEsIm5iZiI6MTcyNTEwNTcyMSwicGF0aCI6Ii85MjAxMC8zNjI0NjcyNzMtOTQyZWQ3ZWQtM2M1MC00NDA3LWIzZTAtNjRmNzUyZjQyMWE1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA4MzElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwODMxVDEyMDIwMVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRkNTViOWY5NmZlOTc2YWFkYThiYWU1ZTFhNzZkOGRhOGE5ODAyMTNhYTEwNjM4YzY0Y2ZiMDQ5YzJiMTY5YmEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.2Cr2wVETWvGiXuNCOH_xn3ROElu7TmbvskUH4mLn5i4\" alt=\"Screenshot 2024-08-28 at 3 11 23 PM\" style=\"max-width: 100%;\"></a></p>\n<p dir=\"auto\">This PR updates the template to use the newer tag based on the current PWA standard.</p>",
            "url": "https://github.com/rails/rails/pull/52738",
            "title": "Replace deprecated PWA tag with newer one",
            "date_modified": "2024-08-29T03:56:05.000Z",
            "date_published": "2024-08-28T22:16:49.000Z",
            "author": {
                "name": "pas256",
                "url": "https://github.com/pas256"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/660706?u=19410c942e0efecfa563a274074ddcc521846fde&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">Currently, all controllers that use <code class=\"notranslate\">ActionController::Live</code> create a new thread to process every request. Creating threads is somewhat expensive. We can avoid that by using a thread pool, which we do already elsewhere in rails.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR introduces <code class=\"notranslate\">ActionController::Live.live_thread_pool_executor</code>, which can contain any number of threads, keeping them around for a while (60s is the default in concurrent-ruby).</p>\n<p dir=\"auto\">I also clean up the thread locals we copy over from the parent thread. This is a bit messy. There are probably some tests required, though I'm not entirely sure where to put them.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52731",
            "title": "Use thread pool for ActionController::Live",
            "date_modified": "2024-08-29T08:28:56.000Z",
            "date_published": "2024-08-28T11:16:06.000Z",
            "author": {
                "name": "tgwizard",
                "url": "https://github.com/tgwizard"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/67046614?u=4f71a9eb45e037bbff1deb7a3049ed030cbb7d75&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">To filter parent model records, with any one child associated with it by semi-joins between parent and children</p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">To optimize the performance when filtering parent model records based on the presence of associated records, we propose using semi-joins instead of full joins. Typically, we rely on methods like <code class=\"notranslate\">where.associated</code> and <code class=\"notranslate\">where.missing</code>, which utilize <code class=\"notranslate\">JOIN</code> clauses. However, in scenarios where we don't need the associated records joins in the result set, semi-joins offer a more efficient alternative. They help avoid the overhead of returning duplicate rows when there are multiple matches.</p>\n<p dir=\"auto\">For example, to retrieve posts with at least one comment, we can now write:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Post.where.exists_with(:comments)\"><pre class=\"notranslate\"><span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">exists_with</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span></pre></div>",
            "url": "https://github.com/rails/rails/pull/52707",
            "title": "feat: Add `where.exists_with` methods",
            "date_modified": "2024-08-28T12:05:46.000Z",
            "date_published": "2024-08-25T10:58:58.000Z",
            "author": {
                "name": "InbaKrish",
                "url": "https://github.com/InbaKrish"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/23489664?u=b1bdada244b23f2cfef6b21063647c24416705ed&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because there are inconsistencies with touch when <code class=\"notranslate\">counter_cache</code> is used. <span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52646.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2472921317\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52646\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52646/hovercard\" href=\"https://github.com/rails/rails/issues/52646\">#52646</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes how we run touch callbacks when <code class=\"notranslate\">counter_cache</code> is used. Currently there is lots of inconsistency in how <code class=\"notranslate\">after_touch</code> works when a model uses <code class=\"notranslate\">counter_cache</code> as noted in the issue script. Example: <code class=\"notranslate\">ProjectItem.first.destroy!</code> does not work but <code class=\"notranslate\">project.project_items.first.destroy!</code> works.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">As mentioned on the issue, there has been a few attempts to cover this, it looks like the preferred way is to use <code class=\"notranslate\">increment!</code> based on this <a href=\"https://github.com/rails/rails/commit/17bf62033edd4f0934c9f4a9e0c7a5f0f765975b\">commit</a>. This was reverted due to the additional queries <a href=\"https://github.com/rails/rails/commit/52e11e462f6114a4d12225c639c5f501f0ffec7a\">here</a> but i don't think we're able to avoid the additional queries.</p>\n<p dir=\"auto\">Alternative solution could be to change <code class=\"notranslate\">update_counters</code> to <code class=\"notranslate\">load_target if reflection.options[:touch]</code> as it appears target is nil when using <code class=\"notranslate\">counter_cache</code>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52692",
            "title": "Ensure callbacks run on counter_cache increment",
            "date_modified": "2024-08-23T14:23:41.000Z",
            "date_published": "2024-08-23T14:19:39.000Z",
            "author": {
                "name": "alexanderholder",
                "url": "https://github.com/alexanderholder"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/55164724?u=c6537070bc166ac2ce4c6e8e8aa439b91fff5af1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>",
            "url": "https://github.com/rails/rails/pull/52671",
            "title": "Allow passing validation options to update",
            "date_modified": "2024-08-31T01:42:45.000Z",
            "date_published": "2024-08-21T15:36:38.000Z",
            "author": {
                "name": "northeastprince",
                "url": "https://github.com/northeastprince"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1734607?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">The defaults for the cache are pulled in from the <a href=\"https://github.com/rails/solid_cache/blob/87fd0e9611237b5608b5e0f4197aec74fe333ca4/lib/generators/solid_cache/install/templates/config/solid_cache.yml.tt\">template</a> in Solid Cache. Currently 1 week max age and 256MB max size.</p>\n<p dir=\"auto\">Right now this sets up Solid Cache to be used in development and production - maybe we'd want to stick with a memory cache in development?</p>\n<p dir=\"auto\">When using Sqlite, we'll use a separate database for the cache, with the migrations for that db going into <code class=\"notranslate\">db/cache/migrate</code>. We then need to adjust the db change task to move the migrations if required.</p>\n<p dir=\"auto\">For all databases we'll use a separate connection pool for the database even if it points to the primary database. This stops cache queries from being affected by primary database transactions.</p>\n<p dir=\"auto\">As a result the <code class=\"notranslate\">config/database.yml</code> templates have been converted to the three-tier format. We could keep the two-tier format when not using Solid Cache, but the templates would start to get messy.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50443.\">Resolves</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2056734792\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50443\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50443/hovercard\" href=\"https://github.com/rails/rails/issues/50443\">#50443</a> cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/dhh/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/dhh\">@dhh</a></p>",
            "url": "https://github.com/rails/rails/pull/52670",
            "title": "Make Solid Cache the default for new Rails apps",
            "date_modified": "2024-08-27T14:22:14.000Z",
            "date_published": "2024-08-21T14:11:37.000Z",
            "author": {
                "name": "djmb",
                "url": "https://github.com/djmb"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/64558?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because there is unnecessary HTTP access in ActiveStorage, which is affecting performance, so I want to stop it.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Change it to use the <code class=\"notranslate\">Google::Cloud::Storage.anonymous</code> object to avoid obtaining an OAuth token when dealing with public buckets.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52655",
            "title": "Stopped getting an extra oauth access token when retrieving public_url l in GCS.",
            "date_modified": "2024-08-20T10:01:11.000Z",
            "date_published": "2024-08-20T10:01:07.000Z",
            "author": {
                "name": "yalab",
                "url": "https://github.com/yalab"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/347634?u=8fac9ccfaca4841463c2e688e3f8e6e3301f089d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">The acronym SSL is considered deprecated by the security community and has been replaced by TLS. While both are understood and can usually be used interchangeably, Rails might as well use the modern terminology.</p>\n<p dir=\"auto\">For an example on this preference, see Wikipedia article <a href=\"https://en.wikipedia.org/wiki/Transport_Layer_Security\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Transport_Layer_Security</a></p>\n<blockquote>\n<p dir=\"auto\">TLS builds on the now-deprecated SSL (Secure Sockets Layer)<br>\nspecifications ...</p>\n</blockquote>\n<p dir=\"auto\">In the interest of back compatibility, this change only changes documentation and code comments. It does not alter configuration option names, class names, or other code. If it is preferable to make this change in code as well, followup work can be submitted for this.</p>\n<p dir=\"auto\">Some text uses the phrase \"SSL/TLS\". These instances were not altered. If it is preferable to use this everywhere, followup work can be submitted for this.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52638",
            "title": "[ci skip] Update docs and comments to prefer TLS instead of SSL",
            "date_modified": "2024-08-17T22:40:38.000Z",
            "date_published": "2024-08-17T16:57:55.000Z",
            "author": {
                "name": "jdufresne",
                "url": "https://github.com/jdufresne"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/44640?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">The reaper was introduced back in <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/cde7692d4e3e0e67e480cc6172f6e2bacaceeb5e/hovercard\" href=\"https://github.com/rails/rails/commit/cde7692d4e3e0e67e480cc6172f6e2bacaceeb5e\"><tt>cde7692</tt></a> The goal is to detect checked out connections owned by dead threads, and make them available again.</p>\n<p dir=\"auto\">To do this, a thread check connections every 60 seconds, which IMO isn't nearly enough. But more importabtly since <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"29269347\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/14360\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/14360/hovercard\" href=\"https://github.com/rails/rails/pull/14360\">#14360</a> the reaper isn't really useful because in the checkout path, if we can't immediately checkout a connection, we execute the reaping routine, so IMO it's not really justified to have a background thread for this.</p>\n<p dir=\"auto\"><a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/tenderlove/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/tenderlove\">@tenderlove</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a> any opinion?</p>",
            "url": "https://github.com/rails/rails/pull/52627",
            "title": "Get rid of Active Record connection reaper",
            "date_modified": "2024-08-28T05:53:50.000Z",
            "date_published": "2024-08-16T15:14:28.000Z",
            "author": {
                "name": "byroot",
                "url": "https://github.com/byroot"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/4910785?u=bb262553df264faad2f515f6ea75067266e0d129&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The \"Suppressing Callbacks\" section of the ActiveRecord Suppressing Callback guide is incorrect.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">The <a href=\"https://edgeguides.rubyonrails.org/active_record_callbacks.html#suppressing-callbacks\" rel=\"nofollow\">https://edgeguides.rubyonrails.org/active_record_callbacks.html#suppressing-callbacks</a> section describes the <code class=\"notranslate\">ActiveRecord::Suppressor</code> as a way to suppress callbacks. This is only partially true. It does not suppress callbacks per se, but disables saving the receiving class. This skips all callbacks that are related to a successful save.</p>\n<p dir=\"auto\">The given example and the given explanation is incorrect:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class User &lt; ApplicationRecord\n  after_create :send_welcome_email\n\n  def send_welcome_email\n    puts &quot;Welcome email sent to #{self.email}&quot;\n  end\nend\n\nUser.suppress do\n  User.create(name: &quot;Jane&quot;, email: &quot;jane@example.com&quot;)\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">User</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">after_create</span> <span class=\"pl-pds\">:send_welcome_email</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">send_welcome_email</span>\n    <span class=\"pl-en\">puts</span> <span class=\"pl-s\">\"Welcome email sent to <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-smi\">self</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">email</span><span class=\"pl-kos\">}</span></span>\"</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">suppress</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-v\">User</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"Jane\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">email</span>: <span class=\"pl-s\">\"jane@example.com\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">This would suppress the callback, but it will also <strong>not</strong> save the user.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Some additional thoughts:</p>\n<ul dir=\"auto\">\n<li>Maybe the suppressor should not be part of the callback guide at all, but rather a more general ActiveRecord one</li>\n<li>I think an official api that would actually suppress specific callbacks during a block, as described in the original example, would be nice :)</li>\n</ul>\n<p dir=\"auto\">I'd be happy to adapt/improve the section 👍</p>",
            "url": "https://github.com/rails/rails/pull/52596",
            "title": "Adapt the incorrect \"Supressing Callbacks\" guide section [ci skip]",
            "date_modified": "2024-08-15T22:08:06.000Z",
            "date_published": "2024-08-13T17:32:04.000Z",
            "author": {
                "name": "codergeek121",
                "url": "https://github.com/codergeek121"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/617116?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #38755.\">Fixes</span>: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"582941692\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/38755\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/38755/hovercard\" href=\"https://github.com/rails/rails/issues/38755\">#38755</a></p>\n<p dir=\"auto\">Similar to how Solid Queue and Solid Cache are configured:<br>\n<a href=\"https://github.com/rails/solid_queue/blob/main/app/models/solid_queue/record.rb\">https://github.com/rails/solid_queue/blob/main/app/models/solid_queue/record.rb</a><br>\n<a href=\"https://github.com/rails/solid_cache/blob/main/app/models/solid_cache/record.rb\">https://github.com/rails/solid_cache/blob/main/app/models/solid_cache/record.rb</a></p>",
            "url": "https://github.com/rails/rails/pull/52569",
            "title": "Add support for multiple databases for Active Storage/Action Text/Action Mailbox",
            "date_modified": "2024-08-31T02:52:54.000Z",
            "date_published": "2024-08-11T21:56:14.000Z",
            "author": {
                "name": "n-studio",
                "url": "https://github.com/n-studio"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/30030?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">There are three cases for error handling:</p>\n<p dir=\"auto\">1/ Normal job submission, and the job executes successfully.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"::ActiveJob::Base.execute(GoodJob.new.serialize)\"><pre class=\"notranslate\">::<span class=\"pl-v\">ActiveJob</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">GoodJob</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">serialize</span><span class=\"pl-kos\">)</span></pre></div>\n<p dir=\"auto\">2/ Normal job submission, but the job fails, and there is no appropriate error handler (<code class=\"notranslate\">retry_on</code>). The job is discarded as expected, and the error is logged, but this method still raises an exception.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"::ActiveJob::Base.execute(BadJob.new.serialize)\"><pre class=\"notranslate\">::<span class=\"pl-v\">ActiveJob</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">BadJob</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">serialize</span><span class=\"pl-kos\">)</span></pre></div>\n<p dir=\"auto\">3/ Bad job submission (or other internal error). The job is not processed, an error is raised, but there is no log.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"::ActiveJob::Base.execute({})\"><pre class=\"notranslate\">::<span class=\"pl-v\">ActiveJob</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span></pre></div>\n<p dir=\"auto\">The problem is, the error raised by (2) is logged, but the error raised by (3) is not.</p>\n<p dir=\"auto\">A job server may wrap <code class=\"notranslate\">ActiveJob::Base.execute</code> like so:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Execute the given job.\nwhile job = read_job\n\tbegin\n\t\t::ActiveJob::Base.execute(job)\n\trescue =&gt; error\n\t\tlog_error(error)\n\tend\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># Execute the given job.</span>\n<span class=\"pl-k\">while</span> <span class=\"pl-s1\">job</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">read_job</span>\n\t<span class=\"pl-k\">begin</span>\n\t\t::<span class=\"pl-v\">ActiveJob</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">job</span><span class=\"pl-kos\">)</span>\n\t<span class=\"pl-k\">rescue</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-en\">error</span>\n\t\t<span class=\"pl-en\">log_error</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">error</span><span class=\"pl-kos\">)</span>\n\t<span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">In case (2) above, this will lead to two log messages being emitted for the failure, one from ActiveJob and one from the Job runner. This is not ideal from a usability point of view, ideally only one log message should be emitted.</p>\n<p dir=\"auto\">One way to solve the problem is this:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Execute the given job.\nwhile job = read_job\n\tbegin\n\t\t::ActiveJob::Base.execute(job)\n\trescue =&gt; error\n\t\t# Ignore errors, logged by ActiveJob.\n\tend\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># Execute the given job.</span>\n<span class=\"pl-k\">while</span> <span class=\"pl-s1\">job</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">read_job</span>\n\t<span class=\"pl-k\">begin</span>\n\t\t::<span class=\"pl-v\">ActiveJob</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">job</span><span class=\"pl-kos\">)</span>\n\t<span class=\"pl-k\">rescue</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-en\">error</span>\n\t\t<span class=\"pl-c\"># Ignore errors, logged by ActiveJob.</span>\n\t<span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">Now ActiveJob is fully responsible for logging. However, there are some situations as shown in case (3) where <code class=\"notranslate\">ActiveJob::Base.execute</code> can raise errors which are not logged. That is problematic as that would result in a silent failure which is a very bad user experience.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This proposal changes case (2) to not re-raise the exception if the job is not retried. The error is still logged by ActiveJob, but the error is not propagated up, as it's normal and expected that the job is discarded in that case.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52557",
            "title": "If a job fails due to an error, it is discarded, and don't re-raise.",
            "date_modified": "2024-08-12T15:35:42.000Z",
            "date_published": "2024-08-09T23:29:35.000Z",
            "author": {
                "name": "ioquatix",
                "url": "https://github.com/ioquatix"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/142498048?u=ef62fa9962bb2e26413478ff05f28a98a59d9b9d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52530.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2453364344\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52530\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52530/hovercard\" href=\"https://github.com/rails/rails/issues/52530\">#52530</a></p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request addresses an issue where adding a merge with an <code class=\"notranslate\">or</code> condition to a scope in ActiveRecord could unintentionally widen the scope if the scope contains raw SQL strings. The fix ensures that scopes behave as expected, returning only the records that match the intended query criteria.</p>\n<h3 dir=\"auto\">Details</h3>\n<p dir=\"auto\">This Pull Request includes changes to the <code class=\"notranslate\">merger.rb</code> file to properly handle the merging of scopes that involve raw SQL strings. Specifically, the logic was updated as follows:</p>\n<ul dir=\"auto\">\n<li><strong>Conditional Check for Raw SQL</strong>:\n<ul dir=\"auto\">\n<li>Added a check to determine if either of the <code class=\"notranslate\">where</code> clauses being merged contains raw SQL using the <code class=\"notranslate\">raw_sql_involved?</code> method.</li>\n</ul>\n</li>\n<li><strong>Proper Handling of <code class=\"notranslate\">or</code> Merging</strong>:\n<ul dir=\"auto\">\n<li>When raw SQL is involved, the merge is handled with the <code class=\"notranslate\">merge_with_proper_or_handling</code> method, which ensures that the conditions are grouped correctly and the scope is not widened unintentionally.</li>\n</ul>\n</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52550",
            "title": "Added changes in the merger.rb file for merge logic",
            "date_modified": "2024-08-12T06:46:42.000Z",
            "date_published": "2024-08-08T19:26:59.000Z",
            "author": {
                "name": "Demon-Sheriff",
                "url": "https://github.com/Demon-Sheriff"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/97030518?u=44f65a79575affbfae38d5a4e75393694efa9d6c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because the documentation for the <code class=\"notranslate\">config.assets.debug</code> configuration option is incorrect.</p>\n<p dir=\"auto\">Fixes issue <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2280577750\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51747\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51747/hovercard\" href=\"https://github.com/rails/rails/issues/51747\">#51747</a> and closes PR <a href=\"https://github.com/rails/rails/pull/51845\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51845/hovercard\">#51845</a>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request fixes the <code class=\"notranslate\">config.assets.debug</code> documentation and makes it correct.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52544",
            "title": "Fix wrong `config.assets.debug` documentation [ci skip]",
            "date_modified": "2024-08-12T08:23:51.000Z",
            "date_published": "2024-08-08T12:25:42.000Z",
            "author": {
                "name": "Uaitt",
                "url": "https://github.com/Uaitt"
            }
        }
    ]
}