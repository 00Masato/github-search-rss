{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/96156234?u=9ced8d6ac6128a8dea78e7f0d9233669ff0ffecf&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Just the bun installation process and gives people insturctions what to do if it didn't install correctly.</p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because [REPLACE ME]</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Address 49608 by adding a little more helpful info for new users of <code class=\"notranslate\">bun</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul dir=\"auto\">\n<li>[ X] This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li>[X ] Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li>[ X] Tests are added or updated if you fix a bug or add a feature.</li>\n<li>[ X] CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49613",
            "title": "[ci skip] Bun docs troubleshooting",
            "date_modified": "2023-10-12T22:01:51.000Z",
            "date_published": "2023-10-12T22:00:09.000Z",
            "author": {
                "name": "paulreece",
                "url": "https://github.com/paulreece"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/19192189?u=dd60737844a9db7f1475bab21fc3e5258a405e15&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Ref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1563387994\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47194\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47194/hovercard?comment_id=1760334146&amp;comment_type=issue_comment\" href=\"https://github.com/rails/rails/pull/47194#issuecomment-1760334146\">#47194 (comment)</a></p>\n<p dir=\"auto\">They both give the buffer as return value of the capture block which confuses the <code class=\"notranslate\">capture</code> helper.</p>\n<p dir=\"auto\">Ideally we wouldn't have to check for that, but it's an acceptable tradeoff for backward compatibility.</p>",
            "url": "https://github.com/rails/rails/pull/49612",
            "title": "Fix `capture` view helper for HAML and Slim",
            "date_modified": "2023-10-12T21:30:48.000Z",
            "date_published": "2023-10-12T21:19:30.000Z",
            "author": {
                "name": "casperisfine",
                "url": "https://github.com/casperisfine"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6979737?u=e5fc89c5f1b12b1fb83f942c742af204df2d1ca1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Follow up to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1938239433\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49587\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49587/hovercard\" href=\"https://github.com/rails/rails/pull/49587\">#49587</a>. Please let me know if anything is incorrect here. I'm still piecing together the situation discussed in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"957126926\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/42922\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/42922/hovercard\" href=\"https://github.com/rails/rails/issues/42922\">#42922</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1707228995\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48204\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48204/hovercard\" href=\"https://github.com/rails/rails/issues/48204\">#48204</a>, so if <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/boomer196/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/boomer196\">@boomer196</a> and <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/jorgemanrubia/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jorgemanrubia\">@jorgemanrubia</a> could review as well, that'd be great. I want to make sure the information here is as accurate as possible since this could cause a production outage if not handled correctly.</p>",
            "url": "https://github.com/rails/rails/pull/49610",
            "title": "Add note on active_record.encryption.support_sha1_for_non_deterministic_encryption",
            "date_modified": "2023-10-12T19:37:47.000Z",
            "date_published": "2023-10-12T19:20:42.000Z",
            "author": {
                "name": "ezekg",
                "url": "https://github.com/ezekg"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/290782?u=457c89a040827a608bb8609d03d39a17adb6d04a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1928198301\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49499\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49499/hovercard\" href=\"https://github.com/rails/rails/issues/49499\">#49499</a> should be fixed in Rails 7.1.2.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes auto start logic for <code class=\"notranslate\">@rails/ujs</code> as ESM.<br>\nThis start logic has been changed since <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1298361773\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45546\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/45546/hovercard\" href=\"https://github.com/rails/rails/pull/45546\">#45546</a> unexpectedly.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">In the spec of ECMAScript, <code class=\"notranslate\">this</code> should be <code class=\"notranslate\">undefined</code>.</p>\n<blockquote>\n<p dir=\"auto\">8.1.1.5 Module Environment Records<br>\n8.1.1.5.4 <code class=\"notranslate\">GetThisBinding</code> ()</p>\n<ol dir=\"auto\">\n<li>Return <code class=\"notranslate\">undefined</code>.</li>\n</ol>\n</blockquote>\n<p dir=\"auto\">Ref: <a href=\"https://262.ecma-international.org/8.0/#sec-module-environment-records-getthisbinding\" rel=\"nofollow\">https://262.ecma-international.org/8.0/#sec-module-environment-records-getthisbinding</a></p>\n<p dir=\"auto\">Since some of build tools (e.g. esbuild) don't have <code class=\"notranslate\">exports</code> nor <code class=\"notranslate\">module</code> object, adding <code class=\"notranslate\">this</code> checking is required whether this file is imported as esm or not.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49499.\">Close</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1928198301\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49499\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49499/hovercard\" href=\"https://github.com/rails/rails/issues/49499\">#49499</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49606",
            "title": "Don't call `Rails.start()` in automatically when `@rails/ujs` is imported as ESM",
            "date_modified": "2023-10-12T17:20:47.000Z",
            "date_published": "2023-10-12T15:11:27.000Z",
            "author": {
                "name": "tricknotes",
                "url": "https://github.com/tricknotes"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49567.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1935697674\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49567\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49567/hovercard\" href=\"https://github.com/rails/rails/issues/49567\">#49567</a>.</p>\n<p dir=\"auto\">Instead of previously changed enforced maximum table name length from 63 to <code class=\"notranslate\">63 - \"_pkey\".size</code>, I returned it back to 63 and now manually constructing the pkey and sequence names (that PostgreSQL generates when creating a table) when renaming a table.</p>\n<p dir=\"auto\">Haven't added new tests, because it is already covered by tests from <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1242128971\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45136\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/45136/hovercard\" href=\"https://github.com/rails/rails/pull/45136\">#45136</a>.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a></p>",
            "url": "https://github.com/rails/rails/pull/49592",
            "title": "Return back maximum allowed PostgreSQL table name to 63 characters",
            "date_modified": "2023-10-12T17:02:39.000Z",
            "date_published": "2023-10-11T23:07:10.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/149785?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When you use <code class=\"notranslate\">ActiveSupport::Notifications</code> to instrument <code class=\"notranslate\">process_middleware.action_dispatch</code>, certain errors may cause a very large error message to be generated. This can exhaust resources and make the application unresponsive</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This problem happens if the object that caused the exception has direct or indirect reference back to the application middleware stack and the error's exception message includes a representation of the object that raised. For example, a <code class=\"notranslate\">NoMethod</code> error on an instance of <code class=\"notranslate\">ActionDispatch::Request::Session</code> causes this as this has a reference to <code class=\"notranslate\">ActionDispatch::Session::CookieStore</code> which contains a reference to the middleware stack through <code class=\"notranslate\">@app</code>.</p>\n<p dir=\"auto\">The error message grows incredibly large because the instrumenter runs around each middleware and handles an error by saving the error message to the <code class=\"notranslate\">@payload</code> instance variable. When the next middleware runs, the it error message will include the string of the previously generated error message. This causes the length of the error to more than double for each middleware in the stack.</p>\n<p dir=\"auto\">This effected a real application that I work on, and caused an error to be generated that was an estimated <strong>61,000,000 characters long</strong>.</p>\n<p dir=\"auto\">This change prevents this problem by stopping the <code class=\"notranslate\">@payload</code> instance variable from being inspected. <code class=\"notranslate\">@payload</code> contains the <code class=\"notranslate\">:exception_object</code> and <code class=\"notranslate\">:exception</code> keys that cause the error message to grow and grow. The change makes sure <code class=\"notranslate\">@middleware</code> is still inspected to match current behavior as much as possible.</p>\n<p dir=\"auto\">This is reproducible in Rails 6.1.7.6, 7.0.8 and 7.1.0. Note that this is no longer an issue for <code class=\"notranslate\">NoMethodError</code> in Ruby 3.3.0 preview 1, <a href=\"https://github.com/ruby/ruby/pull/6950\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/ruby/ruby/pull/6950/hovercard\">as the exception message no longer includes the printed representation of the object</a>. I haven't investigated if other standard library errors trigger this behavior.</p>\n<p dir=\"auto\">I originally reported this to the Rails security team as it could be use to perform denial of service attacks on applications, but we decided that this is unlikely because of the very specific error that needs to be raised to trigger this issue.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Here's a minimal reproduction of the issue:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# frozen_string_literal: true\nrequire 'bundler/inline'\n\ngemfile(true) do\n  source 'https://rubygems.org'\n\n  gem 'rails', '7.0.8'\n  gem 'puma'\nend\n\nrequire &quot;rails&quot;\nrequire &quot;action_controller/railtie&quot;\nrequire &quot;action_view/railtie&quot;\n\nclass App &lt; Rails::Application\n  config.root = __dir__\n  config.consider_all_requests_local = true\n  config.secret_key_base = 'i_am_a_secret'\n  config.eager_load = false\n\n  routes.append do\n    root to: 'welcome#index'\n  end\nend\n\nActiveSupport::Notifications.subscribe('process_middleware.action_dispatch') do |x|\n  # just subscribing is enough to trigger this issue\nend\n\nclass WelcomeController &lt; ActionController::Base\n  def index\n    session[:key] = 'initialize-session'\n    session.non_existant_method\n    render inline: 'never reached'\n  end\nend\n\nApp.initialize!\n\nRack::Server.start(app: App)\n\n# see error message by visiting / on app\"><pre class=\"notranslate\"><span class=\"pl-c\"># frozen_string_literal: true</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'bundler/inline'</span>\n\n<span class=\"pl-en\">gemfile</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">source</span> <span class=\"pl-s\">'https://rubygems.org'</span>\n\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'rails'</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">'7.0.8'</span>\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'puma'</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"rails\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"action_controller/railtie\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"action_view/railtie\"</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">App</span> &lt; <span class=\"pl-v\">Rails</span>::<span class=\"pl-v\">Application</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">root</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">__dir__</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">consider_all_requests_local</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">true</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">secret_key_base</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">'i_am_a_secret'</span>\n  <span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">eager_load</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">false</span>\n\n  <span class=\"pl-en\">routes</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">append</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-en\">root</span> <span class=\"pl-pds\">to</span>: <span class=\"pl-s\">'welcome#index'</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">Notifications</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">subscribe</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'process_middleware.action_dispatch'</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">x</span>|\n  <span class=\"pl-c\"># just subscribing is enough to trigger this issue</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">WelcomeController</span> &lt; <span class=\"pl-v\">ActionController</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">index</span>\n    <span class=\"pl-en\">session</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:key</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">'initialize-session'</span>\n    <span class=\"pl-en\">session</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">non_existant_method</span>\n    <span class=\"pl-en\">render</span> <span class=\"pl-pds\">inline</span>: <span class=\"pl-s\">'never reached'</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">App</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">initialize!</span>\n\n<span class=\"pl-v\">Rack</span>::<span class=\"pl-v\">Server</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">start</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">app</span>: <span class=\"pl-v\">App</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-c\"># see error message by visiting / on app</span></pre></div>\n<p dir=\"auto\">Here's the <a href=\"https://github.com/rails/rails/files/12871979/example_error_before_patch.txt\">error the example produces before</a> and <a href=\"https://github.com/rails/rails/files/12871978/example_error_after_patch.txt\">after</a> the change.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49586",
            "title": "Prevent large error messages when using middleware instrumentation",
            "date_modified": "2023-10-12T16:55:15.000Z",
            "date_published": "2023-10-11T15:49:49.000Z",
            "author": {
                "name": "zetter",
                "url": "https://github.com/zetter"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1080678?u=b6e211b7766e6aa01e794067f67dd65d419c0150&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Don't change conn spec name if there are more connections</p>\n<p dir=\"auto\">Previously we were setting <code class=\"notranslate\">connection_specification_name</code> to <code class=\"notranslate\">nil</code><br>\nwhich would cause connection calls to fall back to the parent,<br>\n<code class=\"notranslate\">ActiveRecord::Base</code>. This is fine in a single db app, but in a multi-db<br>\napp we should not do this unless it is the last remaining connection on<br>\nthat class. So now we check the pool list size before setting the name<br>\nto <code class=\"notranslate\">nil</code>. I move the <code class=\"notranslate\">remove_connection_pool</code> call inside<br>\n<code class=\"notranslate\">retrieve_connection</code> because you literally can't remove a connection<br>\nthat does not exist, so it doesn't change behavior and is just more<br>\naccurate.</p>\n<p dir=\"auto\">This also undoes the changes in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1915139173\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49403\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49403/hovercard\" href=\"https://github.com/rails/rails/pull/49403\">#49403</a> that are no longer necessary<br>\nwhich requires us to remove the <code class=\"notranslate\">not_default</code> shard connection in<br>\nanother test since we don't want that one sticking around.</p>\n<p dir=\"auto\">Related: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1912469952\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49382\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49382/hovercard\" href=\"https://github.com/rails/rails/pull/49382\">#49382</a>, <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1915139173\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49403\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49403/hovercard\" href=\"https://github.com/rails/rails/pull/49403\">#49403</a><br>\n<span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #49373.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1910682345\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49373\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/49373/hovercard\" href=\"https://github.com/rails/rails/issues/49373\">#49373</a></p>\n<p dir=\"auto\">cc/ <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/fractaledmind/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/fractaledmind\">@fractaledmind</a></p>",
            "url": "https://github.com/rails/rails/pull/49584",
            "title": "Fix remove connection for shards",
            "date_modified": "2023-10-12T21:37:30.000Z",
            "date_published": "2023-10-11T14:47:34.000Z",
            "author": {
                "name": "eileencodes",
                "url": "https://github.com/eileencodes"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Prior to this commit, passing an <code class=\"notranslate\">ActiveRecord::Relation</code> <strong>was</strong> supported, but it was effective only because its records would be coerced into an <code class=\"notranslate\">Array</code> through the splatting, <code class=\"notranslate\">flatten!</code>-ing, and <code class=\"notranslate\">compact!</code>-ing.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit adds explicit support, and optimizes the underlying query by omitting all fields that aren't the table's primary key.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49570",
            "title": "Optimize `ActiveRecord::QueryMethods.excluding`",
            "date_modified": "2023-10-12T19:12:25.000Z",
            "date_published": "2023-10-10T20:44:52.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/347921?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">When reading documentation I was confused about 2 things:</p>\n<ul dir=\"auto\">\n<li>\n<p dir=\"auto\">What order directions are actually supported? There was no mention of ascending order. While playing with my code I also discovered that it allows a few variations (uppercase and string variants).</p>\n</li>\n<li>\n<p dir=\"auto\">How do you swap columns in this example: <code class=\"notranslate\">User.order(:name, email: :desc)</code>. I forgot you can chain multiple <code class=\"notranslate\">order</code> calls, not mentioned in the docs.</p>\n</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49566",
            "title": "Improve docs for `order` (ActiveRecord)",
            "date_modified": "2023-10-11T18:37:51.000Z",
            "date_published": "2023-10-10T14:01:19.000Z",
            "author": {
                "name": "semaperepelitsa",
                "url": "https://github.com/semaperepelitsa"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/153388?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Numeric values for <code class=\"notranslate\">Logger#level</code> is an implementation detail and other logger implementations (for example <code class=\"notranslate\">semantic_logger</code>) have <code class=\"notranslate\">Symbol</code>s instead. Current implementation doesn't allow that because it's comparing log level to <code class=\"notranslate\">Float::Infinity</code>.</p>\n<p dir=\"auto\">Use proper methods like <code class=\"notranslate\">#debug?</code> to check if message should be logged.</p>\n<p dir=\"auto\">Fixes <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/bd19d1baf1cb006f3e9f16afac1c7b4e693f111c/hovercard\" href=\"https://github.com/rails/rails/commit/bd19d1baf1cb006f3e9f16afac1c7b4e693f111c\"><tt>bd19d1b</tt></a><br>\nCC <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a></p>\n<p dir=\"auto\">No idea if/how it should be tested, please advise. Probably I could add a test with some hand-made logger into <code class=\"notranslate\">log_subscriber_test.rb</code>, but not sure if it's worth it.</p>\n<p dir=\"auto\"><code class=\"notranslate\">rails_semantic_logger</code> CI run with the failure: <a href=\"https://github.com/ojab/rails_semantic_logger/actions/runs/6461173004/job/17540325867\">https://github.com/ojab/rails_semantic_logger/actions/runs/6461173004/job/17540325867</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Method name is saved in <code class=\"notranslate\">#subscribe_log_level</code> instead of log level, so it could be fetched directly in the runtime. Benchmark from <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1333232195\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45796\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/45796/hovercard?comment_id=1211791483&amp;comment_type=issue_comment\" href=\"https://github.com/rails/rails/pull/45796#issuecomment-1211791483\">#45796 (comment)</a> says that performance is not affected</p>\n<details>\n  <summary>Results</summary>\n=== timed ===\nWarming up --------------------------------------\n            test_run     7.150k i/100ms\nCalculating -------------------------------------\n            test_run     71.278k (± 3.1%) i/s -    357.500k in   5.020450s\n<p dir=\"auto\">Comparison:<br>\ntest_run:    71278.4 i/s<br>\nmain:    71042.9 i/s - same-ish: difference falls within error</p>\n<p dir=\"auto\">=== timed_monotonic ===<br>\nWarming up --------------------------------------<br>\ntest_run     6.999k i/100ms<br>\nCalculating -------------------------------------<br>\ntest_run     72.491k (± 3.2%) i/s -    363.948k in   5.025969s</p>\n<p dir=\"auto\">Comparison:<br>\nmain:    72596.2 i/s<br>\ntest_run:    72490.7 i/s - same-ish: difference falls within error</p>\n<p dir=\"auto\">=== event_object ===<br>\nWarming up --------------------------------------<br>\ntest_run     6.497k i/100ms<br>\nCalculating -------------------------------------<br>\ntest_run     64.583k (± 2.1%) i/s -    324.850k in   5.032327s</p>\n<p dir=\"auto\">Comparison:<br>\ntest_run:    64583.3 i/s<br>\nmain:    61634.7 i/s - same-ish: difference falls within error</p>\n<p dir=\"auto\">=== evented ===<br>\nWarming up --------------------------------------<br>\ntest_run    14.749k i/100ms<br>\nCalculating -------------------------------------<br>\ntest_run    147.907k (± 3.0%) i/s -    752.199k in   5.090467s</p>\n<p dir=\"auto\">Comparison:<br>\ntest_run:   147906.6 i/s<br>\nmain:   146826.6 i/s - same-ish: difference falls within error</p>\n<p dir=\"auto\">=== unsubscribed ===<br>\nWarming up --------------------------------------<br>\ntest_run   235.546k i/100ms<br>\nCalculating -------------------------------------<br>\ntest_run      2.391M (± 1.8%) i/s -     12.013M in   5.026842s</p>\n<p dir=\"auto\">Comparison:<br>\ntest_run:  2390513.9 i/s<br>\nmain:  2354867.3 i/s - same-ish: difference falls within error</p>\n<p dir=\"auto\">=== silenced ===<br>\nWarming up --------------------------------------<br>\ntest_run    55.213k i/100ms<br>\nCalculating -------------------------------------<br>\ntest_run    552.049k (± 4.7%) i/s -      2.761M in   5.013021s</p>\n<p dir=\"auto\">Comparison:<br>\nmain:   575708.8 i/s<br>\ntest_run:   552048.6 i/s - same-ish: difference falls within error</p>\n</details>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\"><code class=\"notranslate\">semantic_logger</code> could be changed to provide Numeric <code class=\"notranslate\">#level</code>, but I don't think it's a proper solution.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49563",
            "title": "Fixup `LogSubscriber` for non-Numeric `logger.level`",
            "date_modified": "2023-10-10T18:26:28.000Z",
            "date_published": "2023-10-10T08:31:19.000Z",
            "author": {
                "name": "ojab",
                "url": "https://github.com/ojab"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1154398?u=af916b5e6cceb496489b4011a8e805f72614d6f5&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When generating the schema file, SchemaDumper can be instructed to ignore tables based on the name or a Regex. This PR adds the same functionality applied to schemas using the <code class=\"notranslate\">ignored_schemas</code> attribute.</p>\n<p dir=\"auto\">This can be used to ignore schemas that are automatically generated by extensions and cannot be re-created. For example, TimescaleDB creates several schemas to track it's internal configuration and metadata. These schemas are not created as part of loading the schema and will cause Rails database setup to fail.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request add functionality to <code class=\"notranslate\">SchemaDumper</code> to allow patterns to be specified that will be compared against the detected schema names and will keep <code class=\"notranslate\">SchemaDumper</code> from outputting a <code class=\"notranslate\">create_schema</code> call in the generated <code class=\"notranslate\">schema.rb</code></p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">None</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49555",
            "title": "Allow SchemaDumper to ignore schemas",
            "date_modified": "2023-10-12T14:31:51.000Z",
            "date_published": "2023-10-09T17:30:03.000Z",
            "author": {
                "name": "cbisnett",
                "url": "https://github.com/cbisnett"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/36794420?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Currently, activestorage S3 service supports additional upload options, for example <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Object.html#put-instance_method\" rel=\"nofollow\">customer-provided server-side encryption keys</a>:</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# config/storage.yml\ns3:\n  service: S3\n  # ...\n  upload:\n    sse_customer_algorithm: AES256\n    sse_customer_key: KEY\n    sse_customer_key_md5: KEY_MD5\"><pre class=\"notranslate\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> config/storage.yml</span>\n<span class=\"pl-ent\">s3</span>:\n  <span class=\"pl-ent\">service</span>: <span class=\"pl-c1\">S3</span>\n  <span class=\"pl-c\"><span class=\"pl-c\">#</span> ...</span>\n  <span class=\"pl-ent\">upload</span>:\n    <span class=\"pl-ent\">sse_customer_algorithm</span>: <span class=\"pl-s\">AES256</span>\n    <span class=\"pl-ent\">sse_customer_key</span>: <span class=\"pl-s\">KEY</span>\n    <span class=\"pl-ent\">sse_customer_key_md5</span>: <span class=\"pl-s\">KEY_MD5</span></pre></div>\n<p dir=\"auto\">Files uploaded with customer-provided keys can only be fetched using those same options again (<a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerSideEncryptionCustomerKeys.html\" rel=\"nofollow\">ref</a>), and they have to be passed to e.g. <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Object.html#get-instance_method\" rel=\"nofollow\">Aws::S3::Object#get</a>.</p>\n<p dir=\"auto\">Because activestorage supports these options only for upload, and not for download as well, calling <code class=\"notranslate\">Attachment#download</code> results in the following error if you uploaded the file with your own keys:</p>\n<blockquote>\n<p dir=\"auto\">Aws::S3::Errors::InvalidRequest: The object was stored using a form of Server Side Encryption. The correct parameters must be provided to retrieve the object</p>\n</blockquote>\n<p dir=\"auto\">Similarily, <code class=\"notranslate\">S3Service#exist?</code> fails as well if the keys aren't provided, though the error is a bit more ambiguous:</p>\n<blockquote>\n<p dir=\"auto\">Caused by Aws::Waiters::Errors::UnexpectedError: stopped waiting due to an unexpected error: Aws::S3::Errors::BadRequest</p>\n</blockquote>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR adds <code class=\"notranslate\">download</code> key to S3 service configuration, allowing you specify options for downloading files which are passed to relevant S3 methods:</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# config/storage.yml\ns3:\n  service: S3\n  # ...\n  upload:\n    sse_customer_algorithm: AES256\n    sse_customer_key: KEY\n    sse_customer_key_md5: KEY_MD5\n  download:\n    sse_customer_algorithm: AES256\n    sse_customer_key: KEY\n    sse_customer_key_md5: KEY_MD5\"><pre class=\"notranslate\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> config/storage.yml</span>\n<span class=\"pl-ent\">s3</span>:\n  <span class=\"pl-ent\">service</span>: <span class=\"pl-c1\">S3</span>\n  <span class=\"pl-c\"><span class=\"pl-c\">#</span> ...</span>\n  <span class=\"pl-ent\">upload</span>:\n    <span class=\"pl-ent\">sse_customer_algorithm</span>: <span class=\"pl-s\">AES256</span>\n    <span class=\"pl-ent\">sse_customer_key</span>: <span class=\"pl-s\">KEY</span>\n    <span class=\"pl-ent\">sse_customer_key_md5</span>: <span class=\"pl-s\">KEY_MD5</span>\n  <span class=\"pl-ent\">download</span>:\n    <span class=\"pl-ent\">sse_customer_algorithm</span>: <span class=\"pl-s\">AES256</span>\n    <span class=\"pl-ent\">sse_customer_key</span>: <span class=\"pl-s\">KEY</span>\n    <span class=\"pl-ent\">sse_customer_key_md5</span>: <span class=\"pl-s\">KEY_MD5</span></pre></div>\n<p dir=\"auto\">With these options, <code class=\"notranslate\">Attachment#download</code> (and <code class=\"notranslate\">Attachment#download_chunk</code>) and <code class=\"notranslate\">S3Service#exist?</code> return expected results for objects uploaded with customer-provided SSE keys.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\"><code class=\"notranslate\">download</code> options are passed to <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Object.html#get-instance_method\" rel=\"nofollow\"><code class=\"notranslate\">Aws::S3::Object#get</code></a>, <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Object.html#exists%3F-instance_method\" rel=\"nofollow\"><code class=\"notranslate\">Aws::S3::Object#exists?</code></a> and <a href=\"https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/S3/Object.html#head-instance_method\" rel=\"nofollow\"><code class=\"notranslate\">Aws::S3::Object#head</code></a> methods, so the options used must be supported by all three methods.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49540",
            "title": "Add download options to S3 service configuration",
            "date_modified": "2023-10-09T09:13:39.000Z",
            "date_published": "2023-10-08T11:15:00.000Z",
            "author": {
                "name": "lovro-bikic",
                "url": "https://github.com/lovro-bikic"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/20938712?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">Using <code class=\"notranslate\">ActiveModel::Model</code> is <a href=\"https://thoughtbot.com/blog/activemodel-form-objects\" rel=\"nofollow\">very useful to create form objects</a> that have custom logic, while still preserving the Rails-way of building models, controllers, and views.</p>\n<p dir=\"auto\">They can be very handy to save multiple objects at once, for example. The problem is that there's not a good way to validate the associated objects. While Active Record has a <code class=\"notranslate\">AssociatedValidator</code>, ActiveModel lacks one, so have to manually write validations like:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class Registration\n  attr_accessor :account, :profile\n  validate :account_is_valid\n  validate :profile_is_valid\n\n  def save!\n    if valid?\n      # save objects\n    end\n  end\n\n  private\n\n  def account_is_valid\n    errors.add(:account, &quot;is invalid&quot;) if account.invalid?\n  end\n\n  def profile_is_valid\n    errors.add(:profile, &quot;is invalid&quot;) if profile.invalid?\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">Registration</span>\n  <span class=\"pl-en\">attr_accessor</span> <span class=\"pl-pds\">:account</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:profile</span>\n  <span class=\"pl-en\">validate</span> <span class=\"pl-pds\">:account_is_valid</span>\n  <span class=\"pl-en\">validate</span> <span class=\"pl-pds\">:profile_is_valid</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">save!</span>\n    <span class=\"pl-k\">if</span> <span class=\"pl-en\">valid?</span>\n      <span class=\"pl-c\"># save objects</span>\n    <span class=\"pl-k\">end</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-k\">private</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">account_is_valid</span>\n    <span class=\"pl-en\">errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">add</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:account</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"is invalid\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">if</span> <span class=\"pl-en\">account</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">invalid?</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">profile_is_valid</span>\n    <span class=\"pl-en\">errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">add</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:profile</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"is invalid\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">if</span> <span class=\"pl-en\">profile</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">invalid?</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR adds an <code class=\"notranslate\">ActiveModel::Validations::ModelValidator</code> validator, which is similar to the <code class=\"notranslate\">ActiveRecord::Validations::AssociatedValidator</code> but doesn't require the associated object to be an <code class=\"notranslate\">ActiveRecord</code> object.</p>\n<p dir=\"auto\">The example above could be rewritten as:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class Registration\n  attr_accessor :account, :profile\n  validates_model :account, :profile\n\n  def save!\n    if valid?\n      # save objects\n    end\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">Registration</span>\n  <span class=\"pl-en\">attr_accessor</span> <span class=\"pl-pds\">:account</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:profile</span>\n  <span class=\"pl-en\">validates_model</span> <span class=\"pl-pds\">:account</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:profile</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">save!</span>\n    <span class=\"pl-k\">if</span> <span class=\"pl-en\">valid?</span>\n      <span class=\"pl-c\"># save objects</span>\n    <span class=\"pl-k\">end</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49534",
            "title": "Add `ActiveModel::Validations::ModelValidator`",
            "date_modified": "2023-10-12T21:03:06.000Z",
            "date_published": "2023-10-07T19:11:42.000Z",
            "author": {
                "name": "MatheusRich",
                "url": "https://github.com/MatheusRich"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/54629302?u=be8de5137bf940532cddd05aff823129ab8a39db&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><code class=\"notranslate\">:required</code> for <code class=\"notranslate\">belongs_to</code> has been considered to be <a href=\"https://github.com/rails/rails/pull/18937\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/18937/hovercard\">'deprecated' since <code class=\"notranslate\">v5.0</code></a> but has never had a deprecation warning. My guess is that at the time, the framework didn't have a well established pattern / process for deprecating features as it does now, other than including this information in public documentation:<br>\n</p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/46857fb7f51e084e9b26edc80d152b700ec57c7d/activerecord/lib/active_record/associations.rb#L1855-L1856\">rails/activerecord/lib/active_record/associations.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 1855 to 1856\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/rails/rails/commit/46857fb7f51e084e9b26edc80d152b700ec57c7d\">46857fb</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L1855\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1855\"></td>\n          <td id=\"LC1855\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-c\">#   NOTE: &lt;tt&gt;required&lt;/tt&gt; is set to &lt;tt&gt;true&lt;/tt&gt; by default and is deprecated. If</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1856\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1856\"></td>\n          <td id=\"LC1856\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-c\">#   you don't want to have association presence validated, use &lt;tt&gt;optional: true&lt;/tt&gt;.</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\">Adding one now (probably in the <code class=\"notranslate\">v7.2</code> release) will allow us to completely remove this feature in <code class=\"notranslate\">v7.3</code> (I'm unsure if this is an actual planned release version).</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Adds a deprecation warning when:</p>\n<ul dir=\"auto\">\n<li>using the <code class=\"notranslate\">:required</code> option with <code class=\"notranslate\">belongs_to</code> associations</li>\n<li>setting the global <code class=\"notranslate\">config.active_record.belongs_to_required_by_default</code> configuration to <code class=\"notranslate\">false</code></li>\n<li>setting the per model <code class=\"notranslate\">#belongs_to_required_by_default</code> configuration attribute to <code class=\"notranslate\">false</code> (this is also set to <code class=\"notranslate\">false</code> when the global config is set to false but I think it's fine to show the warning regardless since both use the same naming convention)</li>\n</ul>\n<p dir=\"auto\">Also removes any public documentation encouraging the use of this feature and relevant config.</p>\n<p dir=\"auto\">I left the following documentation untouched as it's been written in the context of <code class=\"notranslate\">v5.0</code> where this is still available:<br>\n</p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/e5124aed3fdcacb05204391e236c4fd60a1e6e74/guides/source/upgrading_ruby_on_rails.md?plain=1#L1569-L1600\">rails/guides/source/upgrading_ruby_on_rails.md</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 1569 to 1600\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/rails/rails/commit/e5124aed3fdcacb05204391e236c4fd60a1e6e74\">e5124ae</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L1569\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1569\"></td>\n          <td id=\"LC1569\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-mh\">#### <span class=\"pl-en\">Active Record <span class=\"pl-s\">`</span><span class=\"pl-c1\">belongs_to</span><span class=\"pl-s\">`</span> Required by Default Option</span></span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1570\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1570\"></td>\n          <td id=\"LC1570\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1571\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1571\"></td>\n          <td id=\"LC1571\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s\">`</span><span class=\"pl-c1\">belongs_to</span><span class=\"pl-s\">`</span> will now trigger a validation error by default if the association is not present. </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1572\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1572\"></td>\n          <td id=\"LC1572\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1573\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1573\"></td>\n          <td id=\"LC1573\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> This can be turned off per-association with <span class=\"pl-s\">`</span><span class=\"pl-c1\">optional: true</span><span class=\"pl-s\">`</span>. </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1574\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1574\"></td>\n          <td id=\"LC1574\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1575\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1575\"></td>\n          <td id=\"LC1575\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> This default will be automatically configured in new applications. If an existing application </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1576\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1576\"></td>\n          <td id=\"LC1576\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> wants to add this feature it will need to be turned on in an initializer: </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1577\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1577\"></td>\n          <td id=\"LC1577\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1578\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1578\"></td>\n          <td id=\"LC1578\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s\">```</span><span class=\"pl-en\">ruby</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1579\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1579\"></td>\n          <td id=\"LC1579\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> config.active_record.belongs_to_required_by_default <span class=\"pl-k\">=</span> <span class=\"pl-c1\">true</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1580\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1580\"></td>\n          <td id=\"LC1580\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s\">```</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1581\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1581\"></td>\n          <td id=\"LC1581\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1582\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1582\"></td>\n          <td id=\"LC1582\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> The configuration is by default global for all your models, but you can </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1583\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1583\"></td>\n          <td id=\"LC1583\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> override it on a per model basis. This should help you migrate all your models to have their </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1584\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1584\"></td>\n          <td id=\"LC1584\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> associations required by default. </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1585\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1585\"></td>\n          <td id=\"LC1585\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1586\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1586\"></td>\n          <td id=\"LC1586\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s\">```</span><span class=\"pl-en\">ruby</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1587\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1587\"></td>\n          <td id=\"LC1587\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">class</span> <span class=\"pl-en\">Book</span> &lt; <span class=\"pl-e\"><span class=\"pl-en\">ApplicationRecord</span></span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1588\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1588\"></td>\n          <td id=\"LC1588\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-c\"><span class=\"pl-c\">#</span> model is not yet ready to have its association required by default</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1589\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1589\"></td>\n          <td id=\"LC1589\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1590\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1590\"></td>\n          <td id=\"LC1590\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-c1\">self</span>.belongs_to_required_by_default <span class=\"pl-k\">=</span> <span class=\"pl-c1\">false</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1591\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1591\"></td>\n          <td id=\"LC1591\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   belongs_to(<span class=\"pl-c1\">:author</span>) </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1592\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1592\"></td>\n          <td id=\"LC1592\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1593\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1593\"></td>\n          <td id=\"LC1593\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1594\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1594\"></td>\n          <td id=\"LC1594\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">class</span> <span class=\"pl-en\">Car</span> &lt; <span class=\"pl-e\"><span class=\"pl-en\">ApplicationRecord</span></span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1595\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1595\"></td>\n          <td id=\"LC1595\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-c\"><span class=\"pl-c\">#</span> model is ready to have its association required by default</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1596\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1596\"></td>\n          <td id=\"LC1596\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1597\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1597\"></td>\n          <td id=\"LC1597\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-c1\">self</span>.belongs_to_required_by_default <span class=\"pl-k\">=</span> <span class=\"pl-c1\">true</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1598\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1598\"></td>\n          <td id=\"LC1598\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   belongs_to(<span class=\"pl-c1\">:pilot</span>) </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1599\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1599\"></td>\n          <td id=\"LC1599\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L1600\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"1600\"></td>\n          <td id=\"LC1600\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-s\">```</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\"></p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/e5124aed3fdcacb05204391e236c4fd60a1e6e74/guides/source/configuring.md?plain=1#L156\">rails/guides/source/configuring.md</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n         Line 156\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha\" href=\"/rails/rails/commit/e5124aed3fdcacb05204391e236c4fd60a1e6e74\">e5124ae</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L156\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"156\"></td>\n          <td id=\"LC156\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-v\">-</span> <span class=\"pl-s\">[</span><span class=\"pl-s\">`</span><span class=\"pl-c1\">config.active_record.belongs_to_required_by_default</span><span class=\"pl-s\">`</span><span class=\"pl-s\">]</span><span class=\"pl-s\">(</span><span class=\"pl-corl\">#config-active-record-belongs-to-required-by-default</span><span class=\"pl-s\">)</span>: <span class=\"pl-s\">`</span><span class=\"pl-c1\">true</span><span class=\"pl-s\">`</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">I am happy to take ownership of this deprecation and follow up with a PR for the removal :)</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49530",
            "title": "Show deprecation warning when using `:required` on `belongs_to` associations",
            "date_modified": "2023-10-11T20:09:51.000Z",
            "date_published": "2023-10-07T16:40:24.000Z",
            "author": {
                "name": "joshuay03",
                "url": "https://github.com/joshuay03"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Blocks: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1555754427\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/buildkite-config/issues/33\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/buildkite-config/pull/33/hovercard\" href=\"https://github.com/rails/buildkite-config/pull/33\">rails/buildkite-config#33</a></p>\n<p dir=\"auto\">Previous works: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1536109405\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47030\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47030/hovercard\" href=\"https://github.com/rails/rails/pull/47030\">#47030</a>, <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1555754178\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47127\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47127/hovercard\" href=\"https://github.com/rails/rails/pull/47127\">#47127</a></p>\n<blockquote>\n<p dir=\"auto\">This is going to affect users' apps. What is the impact of having this option by default?</p>\n</blockquote>\n<p dir=\"auto\">RF was concerned this might impact users apps, but I'm not seeing how an actiontext test case would do so, if anyone has any ideas!</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/hahmed/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/hahmed\">@hahmed</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a></p>",
            "url": "https://github.com/rails/rails/pull/49527",
            "title": "Enable remote chrome selenium tests for actiontext",
            "date_modified": "2023-10-08T20:43:54.000Z",
            "date_published": "2023-10-07T09:04:28.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/771968?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><code class=\"notranslate\">attributes_of_type</code> returns the names of attributes that are of a specified type.  Using this method in conjunction with <code class=\"notranslate\">normalizes</code>, you can write something like:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class Post &lt; ActiveRecord::Base\n  normalizes attributes_of_type(:string), with: -&gt; { _1.strip }\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">Post</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">normalizes</span> <span class=\"pl-en\">attributes_of_type</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:string</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">with</span>: <span class=\"pl-c1\">-&gt;</span> <span class=\"pl-kos\">{</span> <span class=\"pl-en\">_1</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">strip</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">which will strip all string attributes.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes pull request #49314.\">Closes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1901813639\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49314\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49314/hovercard\" href=\"https://github.com/rails/rails/pull/49314\">#49314</a>.</p>",
            "url": "https://github.com/rails/rails/pull/49519",
            "title": "Add `ActiveRecord::Base::attributes_of_type`",
            "date_modified": "2023-10-10T07:48:35.000Z",
            "date_published": "2023-10-06T18:47:49.000Z",
            "author": {
                "name": "jonathanhefner",
                "url": "https://github.com/jonathanhefner"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">As of <a href=\"https://github.com/rails/rails/pull/47144\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47144/hovercard\">#47144</a>, <code class=\"notranslate\">response.parsed_body</code> supports parsing both <code class=\"notranslate\">format: :json</code> and <code class=\"notranslate\">format: :html</code> responses. This commit updates the documentation to reflect that.</p>\n<p dir=\"auto\">Additionally, it cribs the <code class=\"notranslate\">ActionDispatch::IntegrationTest</code> documentation that mentions <code class=\"notranslate\">register_encoder</code>, and copies it to the method definition so that the documentation entry for that method has descriptive information.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49513",
            "title": "Document `ActionDispatch::IntegrationTest#register_encoder` [ci skip]",
            "date_modified": "2023-10-07T15:17:28.000Z",
            "date_published": "2023-10-06T14:16:14.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5122678?u=204301f9f9fe8930fd26fe3bfe65b6ffaffd8b59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Prior to this commit, calls to <code class=\"notranslate\">gem_group</code> would amend the <code class=\"notranslate\">Gemfile</code> even if there was an existing <a href=\"https://bundler.io/guides/groups.html\" rel=\"nofollow\">gem group</a>, resulting in duplication.</p>\n<p dir=\"auto\">This commit prepends existing gem groups with the added gem.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Because <code class=\"notranslate\">gem_group</code> invokes <code class=\"notranslate\">instance_eval(&amp;block)</code> via <code class=\"notranslate\">with_indentation</code>, a call to <code class=\"notranslate\">gem</code> is made. This means we needed to do the following:</p>\n<ol dir=\"auto\">\n<li>Check if the <code class=\"notranslate\">Gemfile</code> contains an existing gem group in <code class=\"notranslate\">gem_group</code>.</li>\n<li>Pass information about that  existing gem group to the <code class=\"notranslate\">gem</code> method.</li>\n</ol>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Because the <code class=\"notranslate\">Gemfile</code> used in existing tests has a <code class=\"notranslate\">:test</code> and <code class=\"notranslate\">:development, :test</code> groups, we modify the existing tests to use groups not used in the <code class=\"notranslate\">Gemfile</code>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49512",
            "title": "`Rails::Generators::Actions#gem_group`: Prepend existing gem groups",
            "date_modified": "2023-10-06T13:21:46.000Z",
            "date_published": "2023-10-06T12:55:22.000Z",
            "author": {
                "name": "stevepolitodesign",
                "url": "https://github.com/stevepolitodesign"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5122678?u=204301f9f9fe8930fd26fe3bfe65b6ffaffd8b59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This commit is a follow-up to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1921037200\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49448\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49448/hovercard\" href=\"https://github.com/rails/rails/pull/49448\">#49448</a>, with regards to <a href=\"https://github.com/rails/rails/pull/49448#issuecomment-1743061538\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49448/hovercard\">this comment</a>.</p>\n<p dir=\"auto\">Prior to this commit, logging and debugging for<br>\n<a href=\"https://api.rubyonrails.org/v7.0.8/classes/Rails/Generators/Actions.html\" rel=\"nofollow\">Rails::Generators::Actions</a> was limited even when enabling <code class=\"notranslate\">RAILS_LOG_TO_STDOUT</code>. This was because the private <code class=\"notranslate\">action</code> method in the corresponding test was capturing <code class=\"notranslate\">$stdout</code>.</p>\n<h4 dir=\"auto\">Before</h4>\n<details open=\"\" class=\"details-reset border rounded-2\">\n  <summary class=\"px-3 py-2\">\n    <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-device-camera-video\">\n    <path d=\"M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z\"></path>\n</svg>\n    <span aria-label=\"Video description CleanShot.2023-10-04.at.19.49.42.mp4\" class=\"m-1\">CleanShot.2023-10-04.at.19.49.42.mp4</span>\n    <span class=\"dropdown-caret\"></span>\n  </summary>\n\n  <video src=\"https://user-images.githubusercontent.com/5122678/272740937-caa0dbb9-2664-41cf-83fd-e130effa87be.mp4\" data-canonical-src=\"https://user-images.githubusercontent.com/5122678/272740937-caa0dbb9-2664-41cf-83fd-e130effa87be.mp4\" controls=\"controls\" muted=\"muted\" class=\"d-block rounded-bottom-2 border-top width-fit\" style=\"max-height:640px; min-height: 200px\">\n\n  </video>\n</details>\n\n<h4 dir=\"auto\">After</h4>\n<details open=\"\" class=\"details-reset border rounded-2\">\n  <summary class=\"px-3 py-2\">\n    <svg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-device-camera-video\">\n    <path d=\"M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z\"></path>\n</svg>\n    <span aria-label=\"Video description CleanShot.2023-10-04.at.19.50.14.mp4\" class=\"m-1\">CleanShot.2023-10-04.at.19.50.14.mp4</span>\n    <span class=\"dropdown-caret\"></span>\n  </summary>\n\n  <video src=\"https://user-images.githubusercontent.com/5122678/272740960-c5753449-f678-4486-b297-9be48a4e7619.mp4\" data-canonical-src=\"https://user-images.githubusercontent.com/5122678/272740960-c5753449-f678-4486-b297-9be48a4e7619.mp4\" controls=\"controls\" muted=\"muted\" class=\"d-block rounded-bottom-2 border-top width-fit\" style=\"max-height:640px; min-height: 200px\">\n\n  </video>\n</details>\n\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">We simply conditionally capture the <code class=\"notranslate\">stdout</code> like we did in  <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1921037200\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49448\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49448/hovercard\" href=\"https://github.com/rails/rails/pull/49448\">#49448</a>.</p>\n<div class=\"highlight highlight-source-diff notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"4220d82e93 Improve generator logging and debugging\ndiff --git a/railties/test/generators/actions_test.rb b/railties/test/generators/actions_test.rb\nindex 6b5cdcf781..51a006ca87 100644\n--- a/railties/test/generators/actions_test.rb\n+++ b/railties/test/generators/actions_test.rb\n@@ -720,7 +720,11 @@ def test_log_with_status_with_quiet\n \n   private\n     def action(...)\n-      capture(:stdout) { generator.send(...) }\n+      if ENV[&quot;RAILS_LOG_TO_STDOUT&quot;] == &quot;true&quot;\n+        generator.send(...)\n+      else\n+        capture(:stdout) { generator.send(...) }\n+      end\n     end\n \n     def revoke(...)\n\"><pre class=\"notranslate\">4220d82e93 Improve generator logging and debugging\n<span class=\"pl-c1\">diff --git a/railties/test/generators/actions_test.rb b/railties/test/generators/actions_test.rb</span>\nindex 6b5cdcf781..51a006ca87 100644\n<span class=\"pl-md\">--- a/railties/test/generators/actions_test.rb</span>\n<span class=\"pl-mi1\">+++ b/railties/test/generators/actions_test.rb</span>\n<span class=\"pl-mdr\">@@ -720,7 +720,11 @@</span> def test_log_with_status_with_quiet\n \n   private\n     def action(...)\n<span class=\"pl-md\"><span class=\"pl-md\">-</span>      capture(:stdout) { generator.send(...) }</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>      if ENV[\"RAILS_LOG_TO_STDOUT\"] == \"true\"</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>        generator.send(...)</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>      else</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>        capture(:stdout) { generator.send(...) }</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span>      end</span>\n     end\n \n     def revoke(...)\n</pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">It's possible other call sites in the test suite need to be updated, but I wanted to keep this commit focused.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49490",
            "title": "Improve `Rails::Generators::Actions` logging and debugging",
            "date_modified": "2023-10-12T20:17:04.000Z",
            "date_published": "2023-10-04T23:57:03.000Z",
            "author": {
                "name": "stevepolitodesign",
                "url": "https://github.com/stevepolitodesign"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Sometimes there are context-specific reasons to validate a particular field on an associated model. While it's possible to opt-into and opt-out of validation with contexts (the <code class=\"notranslate\">on:</code> option), this commit proposes an alternative that extends validations declared with <code class=\"notranslate\">validates_associated</code> and <code class=\"notranslate\">validates ..., associated: true</code>.</p>\n<p dir=\"auto\">For example, consider a <code class=\"notranslate\">User</code> model with an optional <code class=\"notranslate\">name</code> attribute. In most cases, the <code class=\"notranslate\">User#name</code> isn't required, but let's say that a name <em>is</em> required when the <code class=\"notranslate\">User</code> is related to a <code class=\"notranslate\">Book</code> as its <code class=\"notranslate\">Author</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">With the changes in this commit, the <code class=\"notranslate\">Book</code> can` pass a block to declare additional validations on the relationship:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class Book &lt; ActiveRecord::Base\n  belongs_to :author, class: User\n\n  validates_associated :author do |author|\n    author.validates_presence_of :name\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">Book</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">belongs_to</span> <span class=\"pl-pds\">:author</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">class</span>: <span class=\"pl-v\">User</span>\n\n  <span class=\"pl-en\">validates_associated</span> <span class=\"pl-pds\">:author</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">author</span>|\n    <span class=\"pl-s1\">author</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">validates_presence_of</span> <span class=\"pl-pds\">:name</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">The block's parameter is optional, and can be omitted:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"validates_associated :author do\n  validates_presence_of :name\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">validates_associated</span> <span class=\"pl-pds\">:author</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">validates_presence_of</span> <span class=\"pl-pds\">:name</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">When configuring the validation with options, pass a lambda as the +with:+ option:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"validates_associated :author,\n  with: -&gt; { validates_presence_of :name },\n  unless: :anonymous?\"><pre class=\"notranslate\"><span class=\"pl-en\">validates_associated</span> <span class=\"pl-pds\">:author</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">with</span>: <span class=\"pl-c1\">-&gt;</span> <span class=\"pl-kos\">{</span> <span class=\"pl-en\">validates_presence_of</span> <span class=\"pl-pds\">:name</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">unless</span>: <span class=\"pl-pds\">:anonymous?</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/49486",
            "title": "Extend `validates_associated` to accept a block",
            "date_modified": "2023-10-04T14:02:06.000Z",
            "date_published": "2023-10-04T13:56:45.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        }
    ]
}