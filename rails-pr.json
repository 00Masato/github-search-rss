{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/75765648?u=1dc3ffb2f347af44627baa665b1b2dff0abd7dd1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">Currently, when using the in_batches method on a model with composite primary keys (id_1, id_2), if :asc(:desc) is specified for the order argument, the values are returned with both id_1 and id_2 sorted in ascending (descending) order.<br>\nAllow selection of ascending or descending order for each key in composite primary key.</p>\n<p dir=\"auto\">EXAMPLE</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"class Order &lt; ActiveRecord::Base\n  self.primary_key = [:id_1, :id_2]\nend\nOrder.find_each(order: [:asc, :desc])\"><pre class=\"notranslate\"><code class=\"notranslate\">class Order &lt; ActiveRecord::Base\n  self.primary_key = [:id_1, :id_2]\nend\nOrder.find_each(order: [:asc, :desc])\n</code></pre></div>\n<p dir=\"auto\">In the above code, id_1 is sorted in ascending order, id_2 in descending</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes [REPLACE ME]</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48268",
            "title": "Support batching using composite primary keys and multiple column ordering",
            "date_modified": "2023-05-21T15:18:26.000Z",
            "date_published": "2023-05-21T08:49:23.000Z",
            "author": {
                "name": "TakuyaKurimoto",
                "url": "https://github.com/TakuyaKurimoto"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/75765648?u=1dc3ffb2f347af44627baa665b1b2dff0abd7dd1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Fixed incorrect sorting using order keyword in in_batches method</p>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">Fix incorrect sorting using order keyword in in_batches method.</p>\n<p dir=\"auto\">example (posts table has id as the primary key)</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"Post.in_batches(order: :desc, use_ranges: false).first.pluck(:id)\n:actual =&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]\n:expected  =&gt; [11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1]\"><pre class=\"notranslate\"><code class=\"notranslate\">Post.in_batches(order: :desc, use_ranges: false).first.pluck(:id)\n:actual =&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]\n:expected  =&gt; [11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1]\n</code></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">if use_ranges keyword is true, the sorting does not work either, but I am not sure if this is the expected behavior</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48267",
            "title": "FIX correctly sort records with the in_batches method",
            "date_modified": "2023-05-21T06:18:07.000Z",
            "date_published": "2023-05-21T06:17:51.000Z",
            "author": {
                "name": "TakuyaKurimoto",
                "url": "https://github.com/TakuyaKurimoto"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/8207?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This PR updates the behavior of <code class=\"notranslate\">ERB::Util.html_escape_once</code> to always return an <code class=\"notranslate\">html_safe</code> string.</p>\n<p dir=\"auto\">This method previously maintained the <code class=\"notranslate\">html_safe?</code> property of a string on the return value. Because this string has been escaped, however, not marking it as <code class=\"notranslate\">html_safe</code> causes entities to be double-escaped.</p>\n<p dir=\"auto\">As an example, take this view snippet:</p>\n<div class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&lt;p&gt;&lt;%= html_escape_once(&quot;this &amp; that &amp;amp; the other&quot;) %&gt;&lt;/p&gt;\"><pre class=\"notranslate\"><span class=\"pl-kos\">&lt;</span><span class=\"pl-ent\">p</span><span class=\"pl-kos\">&gt;</span><span class=\"pl-kos\">&lt;</span>%= html_escape_once(\"this &amp; that &amp;amp; the other\") %<span class=\"pl-kos\">&gt;</span><span class=\"pl-kos\">&lt;/</span><span class=\"pl-ent\">p</span><span class=\"pl-kos\">&gt;</span></pre></div>\n<p dir=\"auto\">Before this change, that would be double-escaped and render as:</p>\n<div class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&lt;p&gt;this &amp;amp;amp; that &amp;amp;amp; the other&lt;/p&gt;\"><pre class=\"notranslate\"><span class=\"pl-kos\">&lt;</span><span class=\"pl-ent\">p</span><span class=\"pl-kos\">&gt;</span>this &amp;amp;amp; that &amp;amp;amp; the other<span class=\"pl-kos\">&lt;/</span><span class=\"pl-ent\">p</span><span class=\"pl-kos\">&gt;</span></pre></div>\n<p dir=\"auto\">After this change, it renders correctly as:</p>\n<div class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&lt;p&gt;this &amp;amp; that &amp;amp; the other&lt;/p&gt;\"><pre class=\"notranslate\"><span class=\"pl-kos\">&lt;</span><span class=\"pl-ent\">p</span><span class=\"pl-kos\">&gt;</span>this &amp;amp; that &amp;amp; the other<span class=\"pl-kos\">&lt;/</span><span class=\"pl-ent\">p</span><span class=\"pl-kos\">&gt;</span></pre></div>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #48256.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1717796292\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48256\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48256/hovercard\" href=\"https://github.com/rails/rails/issues/48256\">#48256</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48265",
            "title": "`ERB::Util.html_escape_once` always returns an `html_safe` string",
            "date_modified": "2023-05-20T17:43:21.000Z",
            "date_published": "2023-05-20T17:35:10.000Z",
            "author": {
                "name": "flavorjones",
                "url": "https://github.com/flavorjones"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/419086?u=d0fe8d6b68a77ff6fc46bd57cbc2a37db85a6d34&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">In migrations, the <code class=\"notranslate\">up_only</code> helper and the <code class=\"notranslate\">reverting?</code> predicate allow constraining operations in either direction. Adding <code class=\"notranslate\">down_only</code> and <code class=\"notranslate\">migrating?</code> allows defining blocks that need to run when reverting, or running one-liners when migrating without using double negatives. Plus, you no longer need to remember which ones exist and which ones don't.</p>\n\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #48245.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1713995776\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48245\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48245/hovercard\" href=\"https://github.com/rails/rails/issues/48245\">#48245</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds <code class=\"notranslate\">down_only</code> and <code class=\"notranslate\">migrating?</code>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature. (Original methods are not tested)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48263",
            "title": "Add down only and migrating helpers to migration",
            "date_modified": "2023-05-20T12:27:04.000Z",
            "date_published": "2023-05-20T12:27:00.000Z",
            "author": {
                "name": "goulvench",
                "url": "https://github.com/goulvench"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/10023676?u=dd72d468ae9aa2e659cf4fcc71a9d51e7d044bd4&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because serialization of hashes seems to not handle Dirty tracking correctly in certain circumstances. I added a test that reproduces the exact issue, the column type seems to be important (:blob). The conditional that I'm adding seems <em>very</em> specific, and I'd love to have a more general way to do the check, but it's also made with avoiding any side effects in mind as well.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #48255.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1717771741\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48255\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48255/hovercard\" href=\"https://github.com/rails/rails/issues/48255\">#48255</a> .</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the <a href=\"https://github.com/rails/rails/blob/fc9470aa973a8b6f1a5693bae4edec4c2b4e61aa/activerecord/lib/active_record/type/serialized.rb#LL37C11-L37C27\"><code class=\"notranslate\">changed_in_place?</code></a> method found in serialized.rb to support aligning encoding of binary data more appropriately in the specific circumstance that we get a value we are forcing encoding and comparing it to an old value which, today, is unencoded.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48262",
            "title": "Add conditional for serialized to handle the odd Blob serialization case",
            "date_modified": "2023-05-20T03:18:47.000Z",
            "date_published": "2023-05-19T23:29:54.000Z",
            "author": {
                "name": "brphelps",
                "url": "https://github.com/brphelps"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/984854?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Postgres and SQLite both support a non-standard extension to the CTE syntax to indicate that a CTE subquery should be materialized, i.e., not folded into the main query but evaluated separately. This can be useful in cases where the query planner would otherwise make poor decisions.</p>\n<p dir=\"auto\">The syntax, in both databases, is:<br>\n<code class=\"notranslate\">WITH foo AS MATERIALIZED (...) ...</code></p>\n<p dir=\"auto\">Similarly, they support an explicit hint that a CTE should <em>not</em> be materialized:<br>\n<code class=\"notranslate\">WITH foo AS NOT MATERIALIZED (...) ...</code></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds <code class=\"notranslate\">Arel::Nodes::Cte</code>, which represents a CTE query and contains an alias, a relation, and a materialization flag. The latter is either <code class=\"notranslate\">true</code> to request materialization, <code class=\"notranslate\">false</code> to request no materialization, or <code class=\"notranslate\">nil</code> which omits any materialization hint. The node can be used like so:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"    posts = Arel::Table.new(:posts)\n    comments = Arel::Table.new(:comments)\n\n    good_comments_query = comments.project(Arel.star).where(comments[:rating].gt(7))\n    cte = Arel::Nodes::Cte.new(:good_comments, good_comments_query, materialized: true)\n\n    query = posts.\n      project(Arel.star).\n      with(cte).\n      where(posts[:id].in(cte.to_table.project(:post_id))).\n\n    puts query.to_sql\n\n    # WITH &quot;good_comments&quot; AS MATERIALIZED (SELECT * FROM &quot;comments&quot; WHERE &quot;comments&quot;.&quot;rating&quot; &gt; 7) SELECT * FROM &quot;posts&quot; WHERE &quot;posts&quot;.&quot;id&quot; IN (SELECT post_id FROM &quot;good_comments&quot;)\"><pre class=\"notranslate\">    <span class=\"pl-s1\">posts</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Arel</span>::<span class=\"pl-v\">Table</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:posts</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">comments</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Arel</span>::<span class=\"pl-v\">Table</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:comments</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-s1\">good_comments_query</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">comments</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">project</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Arel</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">star</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">comments</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:rating</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">gt</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">7</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">cte</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Arel</span>::<span class=\"pl-v\">Nodes</span>::<span class=\"pl-v\">Cte</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:good_comments</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">good_comments_query</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">materialized</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-s1\">query</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">posts</span><span class=\"pl-kos\">.</span>\n      <span class=\"pl-en\">project</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Arel</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">star</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span>\n      <span class=\"pl-en\">with</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">cte</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span>\n      <span class=\"pl-en\">where</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">posts</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">in</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">cte</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_table</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">project</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:post_id</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span>\n\n    <span class=\"pl-en\">puts</span> <span class=\"pl-s1\">query</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_sql</span>\n\n    <span class=\"pl-c\"># WITH \"good_comments\" AS MATERIALIZED (SELECT * FROM \"comments\" WHERE \"comments\".\"rating\" &gt; 7) SELECT * FROM \"posts\" WHERE \"posts\".\"id\" IN (SELECT post_id FROM \"good_comments\")</span></pre></div>\n<p dir=\"auto\"><code class=\"notranslate\">As</code> and <code class=\"notranslate\">TableAlias</code> nodes continue to be supported as arguments to <code class=\"notranslate\">SelectManager#with</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">This is an alternative to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1669201616\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47951\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47951/hovercard\" href=\"https://github.com/rails/rails/pull/47951\">#47951</a>, following <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a>'s suggestion of adding a <code class=\"notranslate\">Cte</code> node that contains both an alias and a relation, instead of adding a node just to represent the addition of the <code class=\"notranslate\">MATERIALIZED</code> keyword. This keeps the syntax tree shallower and allows us easily to support <code class=\"notranslate\">NOT MATERIALIZED</code> hints without needing to resort to yet another keyword-specific node type or deeper nesting of nodes.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48261",
            "title": "Adds Arel::Nodes::Cte for use in WITH expressions",
            "date_modified": "2023-05-19T23:07:01.000Z",
            "date_published": "2023-05-19T23:05:03.000Z",
            "author": {
                "name": "97jaz",
                "url": "https://github.com/97jaz"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22918438?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Certain applications (e.g. Shopify, GitHub), retry all database queries and have been patching <code class=\"notranslate\">#execute</code> / <code class=\"notranslate\">#raw_execute</code> to change the <code class=\"notranslate\">allow_retry</code> kwarg to true. This is brittle. Enabling retries globally should be an option for apps that are willing to accept the risks.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Wondering if it's safe to retry transaction-related db methods (e.g. <code class=\"notranslate\">#commit_db_transaction</code>, <code class=\"notranslate\">#exec_restart_db_transaction</code>). As it stands, Shopify's retry patch <em>will</em> retry all of these queries, but our retry patch used to be transaction-aware. Should we stick to avoiding retries, even if the the application has configured retries globally, with these methods or are they fine to retry?</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/eileencodes/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/eileencodes\">@eileencodes</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/rafaelfranca/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/rafaelfranca\">@rafaelfranca</a></p>",
            "url": "https://github.com/rails/rails/pull/48247",
            "title": "Introduce Active Record config to enable database queries to be retried",
            "date_modified": "2023-05-18T20:44:33.000Z",
            "date_published": "2023-05-17T15:26:51.000Z",
            "author": {
                "name": "adrianna-chang-shopify",
                "url": "https://github.com/adrianna-chang-shopify"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/110363331?u=28ae16fc359f88d1814dc306b3aab73970206c96&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This is what the file said.</p>\n<p dir=\"auto\"><code class=\"notranslate\">TODO: Consider renaming this method, as it only conditionally extends keys, not always</code>,</p>\n<p dir=\"auto\">so I changed the method name.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Removed the <code class=\"notranslate\">TODO:</code> and renamed it to the <code class=\"notranslate\">append_if_exist_keys_including_timestamps</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48244",
            "title": "Fix method name for `InsertAll#keys_including_timestamps`",
            "date_modified": "2023-05-18T00:34:49.000Z",
            "date_published": "2023-05-17T10:32:51.000Z",
            "author": {
                "name": "asberel",
                "url": "https://github.com/asberel"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5512772?u=bbae6d87b3499e6b3662664cf4be0e84cc40f6d2&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This commit extends Active Record creation logic to allow for an auto-incremented column to be populated even if it's not being used as a whole or a part of the primary key.</p>\n<p dir=\"auto\">Given a <code class=\"notranslate\">Post</code> model represented by the following schema:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create_table :posts, id: false do |t|\n  t.integer :sequential_number, auto_increment: true\n  t.string :title, primary_key: true\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:posts</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">id</span>: <span class=\"pl-c1\">false</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">integer</span> <span class=\"pl-pds\">:sequential_number</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">auto_increment</span>: <span class=\"pl-c1\">true</span>\n  <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-pds\">:title</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">primary_key</span>: <span class=\"pl-c1\">true</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">where <code class=\"notranslate\">title</code> is being used as a primary key and the table has an integer <code class=\"notranslate\">sequential_number</code> column populated by a sequence, creation of <code class=\"notranslate\">Post</code> records should populate the <code class=\"notranslate\">sequential_number</code> attribute:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"new_post = Post.create(title: 'My first post')\nnew_post.sequential_number # =&gt; 1\"><pre class=\"notranslate\"><span class=\"pl-s1\">new_post</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">title</span>: <span class=\"pl-s\">'My first post'</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">new_post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">sequential_number</span> <span class=\"pl-c\"># =&gt; 1</span></pre></div>\n<h3 dir=\"auto\">Implementation details</h3>\n<p dir=\"auto\">Overall solution is trying to be generic and extensible to allow for additions while still maintains the fact that currently Rails only populates a single column and only if the column</p>\n<ul dir=\"auto\">\n<li>The most important change I'd like to bring the most attention to is the method signature change for both <code class=\"notranslate\">exec_insert</code> and <code class=\"notranslate\">insert</code> public methods. We are adding a new <code class=\"notranslate\">returning_columns</code> keyword argument with a default value with an intention for the argument to be undocumented  until Rails is ready to support populating more than one column. If keeping an undocumented optional argument is not an option then we'll have to consider defining a new method like <code class=\"notranslate\">DatabaseStatements#insert_with_returning</code> as we can't change <code class=\"notranslate\">insert</code> signature to return more than one value without a deprecation cycle.</li>\n<li><code class=\"notranslate\">ConnectionAdapters::Column</code> gets a new adapter-abstract attribute called <code class=\"notranslate\">auto_incremented_by_db?</code> which indicates whether a given column is being auto-incremented by the database regardless of the way it's being incremented. For mysql we alias it to <code class=\"notranslate\">auto_increment</code> and for postgresql we alias it to <code class=\"notranslate\">serial</code>.</li>\n<li><code class=\"notranslate\">ModelSchema._auto_populated_column_names</code> has been added to gather a list of columns that are either auto-incremented or populated by a default function. It may not be a complete list but it should cover most of the scenarios and sufficient as long as at this point we only looking on a single column in <code class=\"notranslate\">_create_record</code>. Perhaps the <code class=\"notranslate\">Column</code> class itself could have had a <code class=\"notranslate\">auto_populated_by_database?</code> method which could combine the auto-increment and default function checks but we can add this later as a refactoring</li>\n<li><code class=\"notranslate\">_create_record</code> uses <code class=\"notranslate\">_auto_populated_column_names</code> but fetches only one column as <code class=\"notranslate\">insert</code> signature is only capable of returning a single value. <code class=\"notranslate\">primary_key</code> take precedence when choosing the column to populate.</li>\n</ul>\n<p dir=\"auto\">If the change seems too risky for existing models we could consider limiting the change to the composite primary keys models only</p>\n<h3 dir=\"auto\">Long term plans</h3>\n<p dir=\"auto\">Long term we should be looking into extending the capability to be able to populate any number of auto-populated db columns after creation. For postgresql it will be done using the <code class=\"notranslate\">RETURNING</code> statement but MySQL will require an additional <code class=\"notranslate\">SELECT</code> query to be performed to fetch values for every auto-populated columns. An additional query may not be desirable for every application so the behavior should be configurable which brings more complexity and one of the reasons why we are not trying to tackle it all at once. Though for postgresql it's simpler so perhaps we could start supporting postgresql first and add mysql support later.</p>",
            "url": "https://github.com/rails/rails/pull/48241",
            "title": " Fill auto incremented column for models with CPK",
            "date_modified": "2023-05-18T19:15:15.000Z",
            "date_published": "2023-05-16T21:00:17.000Z",
            "author": {
                "name": "nvasilevski",
                "url": "https://github.com/nvasilevski"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/9117775?u=c5242a1b05e8272b9475a772e76fb3c5a7177445&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Please consider viewing the diff with whitespace disabled: <a href=\"https://github.com/rails/rails/pull/48224/files?w=1\">https://github.com/rails/rails/pull/48224/files?w=1</a></p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">A proposal for a way to improve the fix for <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1699572304\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48164\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48164/hovercard\" href=\"https://github.com/rails/rails/issues/48164\">#48164</a> which was added in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1707080058\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48200\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/48200/hovercard\" href=\"https://github.com/rails/rails/pull/48200\">#48200</a>. Please see <a href=\"https://github.com/rails/rails/issues/48164#issuecomment-1544018445\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48164/hovercard\">this discussion</a>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Introduces the concept of a transaction lock. This is used to detect cases where <code class=\"notranslate\">within_new_transaction</code> raises, potentially leaving the connection in a transaction, and the attempt to discard the connection fails.</p>\n<p dir=\"auto\">The idea is to store and acquire a new lock before attempting to begin a transaction, and to only discard the lock once the transaction state is definitely known. If <code class=\"notranslate\">within_new_transaction</code> raises, without the lock being discarded, subsequent attempts to create a transaction will detect this and discard the connection.</p>\n<p dir=\"auto\">Note that no such check is performed in other methods which may use a connection in an unknown transaction state. For instance, it will still be possible to invoke <code class=\"notranslate\">execute</code>. In case this change ends up being acceptable, such checks could be added.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48224",
            "title": "Use locks to detect connections which are in an unknown transaction state",
            "date_modified": "2023-05-17T05:09:27.000Z",
            "date_published": "2023-05-14T06:22:20.000Z",
            "author": {
                "name": "nicholasdower",
                "url": "https://github.com/nicholasdower"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1518299?u=a2dd8dd1835679cfd6b1924ef63a6e61ea62fa2a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #48185.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1703067636\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48185\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48185/hovercard\" href=\"https://github.com/rails/rails/issues/48185\">#48185</a></p>\n<p dir=\"auto\">Action Cable can be mounted standalone, but it loses the health check route provided by the railties.<br>\nThis change adds configuration for a health check rack app and a health check route to \"mount\" the rack app.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48222",
            "title": "Add health check on standalone Action Cable",
            "date_modified": "2023-05-15T23:49:20.000Z",
            "date_published": "2023-05-13T23:44:05.000Z",
            "author": {
                "name": "JoeDupuis",
                "url": "https://github.com/JoeDupuis"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Alternative to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1646855043\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47813\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47813/hovercard\" href=\"https://github.com/rails/rails/pull/47813\">#47813</a> to import the linter files directly to Rails source tree</p>\n<div class=\"highlight highlight-source-shell notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"$ zzak@mbp16 rails % ruby -v\nruby 3.2.2 (2023-03-30 revision e51014f9c0) [arm64-darwin22]\n\n\n\n$ zzak@mbp16 rails % bundle exec tools/check-changelogs .\n.............\n\n13 changelogs inspected, 0 offenses detected\n\n\n\n$ zzak@mbp16 rails % bundle exec tools/check-config-docs .\n\n\n\n$ zzak@mbp16 rails % bundle exec tools/check-links .\nhttps://edgeapi.rubyonrails.org/classes/ActiveSupport/MessageEncryptor.html#method-i-encrypt_and_sign\"><pre class=\"notranslate\">$ zzak@mbp16 rails % ruby -v\nruby 3.2.2 (2023-03-30 revision e51014f9c0) [arm64-darwin22]\n\n\n\n$ zzak@mbp16 rails % bundle <span class=\"pl-c1\">exec</span> tools/check-changelogs <span class=\"pl-c1\">.</span>\n.............\n\n13 changelogs inspected, 0 offenses detected\n\n\n\n$ zzak@mbp16 rails % bundle <span class=\"pl-c1\">exec</span> tools/check-config-docs <span class=\"pl-c1\">.</span>\n\n\n\n$ zzak@mbp16 rails % bundle <span class=\"pl-c1\">exec</span> tools/check-links <span class=\"pl-c1\">.</span>\nhttps://edgeapi.rubyonrails.org/classes/ActiveSupport/MessageEncryptor.html#method-i-encrypt_and_sign</pre></div>",
            "url": "https://github.com/rails/rails/pull/48216",
            "title": "Import rails-bin linter to rails internal tools lib",
            "date_modified": "2023-05-16T17:36:25.000Z",
            "date_published": "2023-05-13T06:53:46.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7676464?u=e3a4f142edc023655c98b3299edc577d8e79969c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Updating the reflect_on_all_associations method to<br>\nallow for more then one symbol to be accepted. It<br>\nkeeps current functionality as well. If method is<br>\npresented with no symbols it will return all associations.</p>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because [REPLACE ME]</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes [REPLACE ME]</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48208",
            "title": "Updating the reflect_on_all_associations method to allow for more then one symbol to be accepted.",
            "date_modified": "2023-05-18T19:16:07.000Z",
            "date_published": "2023-05-12T19:36:16.000Z",
            "author": {
                "name": "mgm702",
                "url": "https://github.com/mgm702"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/277819?u=f88292414deeecfd67fee18ae9d7297bcc001138&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">We want a way to be able to audit the public API of Rails, and find things that are missing <code class=\"notranslate\">:nodoc:</code>.</p>\n<p dir=\"auto\">This was implemented in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1707161137\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/sdoc/issues/222\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/sdoc/pull/222/hovercard\" href=\"https://github.com/rails/sdoc/pull/222\">rails/sdoc#222</a>, and we're pulling in the latest branch to use it here.</p>\n<p dir=\"auto\">In the future we might want a way to diff this data in some way, for example to provide PRs with feedback that introduce new classes or methods for reviewers to quickly check.</p>",
            "url": "https://github.com/rails/rails/pull/48202",
            "title": "Add namelist rake task",
            "date_modified": "2023-05-12T08:19:46.000Z",
            "date_published": "2023-05-12T08:19:42.000Z",
            "author": {
                "name": "zzak",
                "url": "https://github.com/zzak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1518299?u=a2dd8dd1835679cfd6b1924ef63a6e61ea62fa2a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #48013.\">Fix</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1678979503\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48013\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48013/hovercard\" href=\"https://github.com/rails/rails/issues/48013\">#48013</a></p>\n<p dir=\"auto\">If two routes end up with the same score when trying to recall the url from url_for, we currently pick the one with highest precedence (order of the route file).</p>\n<p dir=\"auto\">This change bumps the current route (if matched) in front of the others.</p>\n<p dir=\"auto\">The repro for the issue could help understand what this is trying to fix: <a href=\"https://gist.github.com/JoeDupuis/e0f18020c85a05d5188ee35485685387\">https://gist.github.com/JoeDupuis/e0f18020c85a05d5188ee35485685387</a></p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #48013.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1678979503\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48013\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48013/hovercard\" href=\"https://github.com/rails/rails/issues/48013\">#48013</a></p>\n<p dir=\"auto\">We are already trying to recall the current request with <code class=\"notranslate\">url_for</code>, this helps recalling the correct route when there is multiple hit.</p>\n<p dir=\"auto\">Currently, only the router knows which route is served. This adds the current route in the rack env allowing class further in the request to infer things from it.</p>\n<h3 dir=\"auto\">Detail</h3>\n<ul dir=\"auto\">\n<li>I don't know if we should merge this. I could see it as confusing if someone is calling url_for in the context of a request vs outside of a request (test or mailer). But then again, <a href=\"https://github.com/rails/rails/issues/48013\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/48013/hovercard\">it's also confusing to users if we don't</a>.</li>\n</ul>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">A bit of fun trivia. The current (7.0.4.2) guide for <code class=\"notranslate\">ActionController::UrlFor</code> mention:</p>\n<blockquote>\n<p dir=\"auto\">This module requires the host class to implement env which needs to be Rack-compatible and request which is either an instance of ActionDispatch::Request <strong>or an object that responds to the host, optional_port, protocol, and symbolized_path_parameter methods.</strong></p>\n</blockquote>\n<p dir=\"auto\">Which led me to write an initial version of this where I was checking if the request object responds to <code class=\"notranslate\">current_route</code> to make sure the code would still work if the request is not an <code class=\"notranslate\">ActionDispatch::Request</code>.</p>\n<p dir=\"auto\">Then I noticed while reading the same doc through the code that <a href=\"https://github.com/rails/rails/commit/d69501a3d60f07dc68578278041ed74682084c9a\">this was changed</a> and I was unnecessarily playing hard mode <g-emoji class=\"g-emoji\" alias=\"man_facepalming\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f926-2642.png\"></g-emoji> <g-emoji class=\"g-emoji\" alias=\"laughing\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f606.png\"></g-emoji></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48201",
            "title": "Allow url_for to prioritize the current route on ambiguous recall.",
            "date_modified": "2023-05-14T03:41:25.000Z",
            "date_published": "2023-05-12T07:27:29.000Z",
            "author": {
                "name": "JoeDupuis",
                "url": "https://github.com/JoeDupuis"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1518299?u=a2dd8dd1835679cfd6b1924ef63a6e61ea62fa2a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><a href=\"https://github.com/rails/rails/commit/e68bfaf1fe1a7890a67af6f444281185f507cf9e#diff-8b09ea0c52da5a4c3aa0eadbe23c3df5e77cbdb850f04fde04fd1e30b7e010ce\">UrlRewriter was removed in 2010</a> The <code class=\"notranslate\">url_rewriter_test.rb</code> stuck around. Now, it is really just testing <code class=\"notranslate\">url_for</code>.  Most of the tests are identical.</p>\n<p dir=\"auto\">Some tests in <code class=\"notranslate\">url_rewriter_test.rb</code> were missing in the <code class=\"notranslate\">url_for</code> spec so I moved them.</p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Hoping to save a spelunking trip for the next person who works around <code class=\"notranslate\">url_for</code> <g-emoji class=\"g-emoji\" alias=\"grin\" fallback-src=\"https://github.githubassets.com/images/icons/emoji/unicode/1f601.png\"></g-emoji></p>\n<p dir=\"auto\">I am working on a couple of PRs and was trying to make sense of some of the tests. I found these redundant and confusing. Then with a bit of digging I realized there used to be a <code class=\"notranslate\">UrlRewriter</code> class.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG -- N/A</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48199",
            "title": "Remove UrlRewriter tests",
            "date_modified": "2023-05-14T03:42:08.000Z",
            "date_published": "2023-05-12T04:29:15.000Z",
            "author": {
                "name": "JoeDupuis",
                "url": "https://github.com/JoeDupuis"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/28561?u=095779352a57f75e734987829f3f67a10e5780ed&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Active Model generates methods for each attribute to handle dirty changes. As these methods are generated and depend on the attributes in the model, they can't be found when searching for them in the API documentation.</p>\n<p dir=\"auto\">We can use the <code class=\"notranslate\">:method:</code> directive to document them in the form of <code class=\"notranslate\">[attribute]_will_change</code>, <code class=\"notranslate\">[attribute_name]_previously_was</code>, etc. This notation is <a href=\"https://github.com/rails/rails/blob/cb1073e664c41c3c4c87dee4788cc2a326247b4f/activemodel/lib/active_model/dirty.rb#L112\">already used</a> in the documentation of ActiveModel::Dirty.</p>\n<p dir=\"auto\">An alternative could be documenting the methods as: <code class=\"notranslate\">*_will_change</code>, <code class=\"notranslate\">*_previously_was</code>, etc...</p>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/28561/237787512-af5b48e5-901a-4596-8890-041b78d05611.png\"><img width=\"1339\" alt=\"image\" src=\"https://user-images.githubusercontent.com/28561/237787512-af5b48e5-901a-4596-8890-041b78d05611.png\" style=\"max-width: 100%;\"></a>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48193",
            "title": "Document generated dirty attribute methods [ci-skip]",
            "date_modified": "2023-05-12T21:41:33.000Z",
            "date_published": "2023-05-11T17:53:05.000Z",
            "author": {
                "name": "p8",
                "url": "https://github.com/p8"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/674321?u=784b6dfff67d37694fa5f914a25273855a065e79&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When building a new Service for ActiveStorage, we got two requirements:</p>\n<ol dir=\"auto\">\n<li>We need to direct upload a file with <code class=\"notranslate\">POST</code> method instead of <code class=\"notranslate\">PUT</code>, and send credential(token), key(filename) and file(binary to upload) with <code class=\"notranslate\">Content-Type:   multipart/form-data; boundary=&lt;frontier&gt;</code>, instead of sending them with headers.</li>\n<li>We are creating a SaaS that make each Tenant has their own Cloud Service configuration, hence it's not possible to write all service configurations into <code class=\"notranslate\">config/storage.yml</code>. For now, <code class=\"notranslate\">ActiveStorage::Blob</code> has an anonymous validator to check <code class=\"notranslate\">service_name</code> has to be declared in <code class=\"notranslate\">ActiveStorage::Blob.services</code>, we can't disable this validator.</li>\n</ol>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\"><strong>I think it's better to make them configurable like this:</strong></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# write my own service\nmodule ActiveStorage\n  class Service::QiniumService &lt; Service\n\n    # declare direct upload with HTTP POST method\n    def http_method_for_direct_upload\n      'POST'\n    end\n\n   # declare direct upload response type, &quot;text&quot; or &quot;json&quot;\n    def http_response_type_for_direct_upload\n      'json'\n    end\n\n    # declare direct upload file as multipart/form-data, the value of ':file' is the form data key to file\n    def form_data_for_direct_upload(key, expires_in:, content_type:, content_length:, checksum:, **)\n      put_policy = Qinium::PutPolicy.new(config, key: key, expires_in: expires_in)\n      put_policy.fsize_limit = content_length.to_i + 1000\n      put_policy.mime_limit = content_type\n      put_policy.detect_mime = 1\n      put_policy.insert_only = 1\n      {\n        key: key,\n        token: put_policy.to_token,\n        ':file': 'file'\n      }\n    end\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># write my own service</span>\n<span class=\"pl-k\">module</span> <span class=\"pl-v\">ActiveStorage</span>\n  <span class=\"pl-k\">class</span> <span class=\"pl-v\">Service</span>::<span class=\"pl-v\">QiniumService</span> &lt; <span class=\"pl-v\">Service</span>\n\n    <span class=\"pl-c\"># declare direct upload with HTTP POST method</span>\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">http_method_for_direct_upload</span>\n      <span class=\"pl-s\">'POST'</span>\n    <span class=\"pl-k\">end</span>\n\n   <span class=\"pl-c\"># declare direct upload response type, \"text\" or \"json\"</span>\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">http_response_type_for_direct_upload</span>\n      <span class=\"pl-s\">'json'</span>\n    <span class=\"pl-k\">end</span>\n\n    <span class=\"pl-c\"># declare direct upload file as multipart/form-data, the value of ':file' is the form data key to file</span>\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">form_data_for_direct_upload</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">key</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">expires_in</span>:<span class=\"pl-kos\">,</span> <span class=\"pl-s1\">content_type</span>:<span class=\"pl-kos\">,</span> <span class=\"pl-s1\">content_length</span>:<span class=\"pl-kos\">,</span> <span class=\"pl-s1\">checksum</span>:<span class=\"pl-kos\">,</span> **<span class=\"pl-kos\">)</span>\n      <span class=\"pl-s1\">put_policy</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Qinium</span>::<span class=\"pl-v\">PutPolicy</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">config</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">key</span>: <span class=\"pl-s1\">key</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">expires_in</span>: <span class=\"pl-s1\">expires_in</span><span class=\"pl-kos\">)</span>\n      <span class=\"pl-s1\">put_policy</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">fsize_limit</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">content_length</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_i</span> + <span class=\"pl-c1\">1000</span>\n      <span class=\"pl-s1\">put_policy</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">mime_limit</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">content_type</span>\n      <span class=\"pl-s1\">put_policy</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">detect_mime</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">1</span>\n      <span class=\"pl-s1\">put_policy</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">insert_only</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">1</span>\n      <span class=\"pl-kos\">{</span>\n        <span class=\"pl-pds\">key</span>: <span class=\"pl-s1\">key</span><span class=\"pl-kos\">,</span>\n        <span class=\"pl-pds\">token</span>: <span class=\"pl-s1\">put_policy</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_token</span><span class=\"pl-kos\">,</span>\n        <span class=\"pl-s\">':file'</span>: <span class=\"pl-s\">'file'</span>\n      <span class=\"pl-kos\">}</span>\n    <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">With above changes, <code class=\"notranslate\">ActiveStorage::Service</code> can support all types of HTTP methods, send token to cloud service with HTTP header or form data.</p>\n<p dir=\"auto\"><strong>change <code class=\"notranslate\">activestorage/app/models/active_storage/blob.rb</code> anonymous validator to named one:</strong></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"  validate do\n    if service_name_changed? &amp;&amp; service_name.present?\n      services.fetch(service_name) do\n        errors.add(:service_name, :invalid)\n      end\n    end\n  end\"><pre class=\"notranslate\">  <span class=\"pl-en\">validate</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-k\">if</span> <span class=\"pl-en\">service_name_changed?</span> &amp;&amp; <span class=\"pl-en\">service_name</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">present?</span>\n      <span class=\"pl-en\">services</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">fetch</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">service_name</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n        <span class=\"pl-en\">errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">add</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:service_name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:invalid</span><span class=\"pl-kos\">)</span>\n      <span class=\"pl-k\">end</span>\n    <span class=\"pl-k\">end</span>\n  <span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">changes to</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"validate :validate_service_name_in_services, if: -&gt; { service_name_changed? &amp;&amp; service_name.present? }\nprivate\n    def validate_service_name_in_services\n      services.fetch(service_name) do\n        errors.add(:service_name, :invalid)\n      end\n    end\"><pre class=\"notranslate\"><span class=\"pl-en\">validate</span> <span class=\"pl-pds\">:validate_service_name_in_services</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">if</span>: <span class=\"pl-c1\">-&gt;</span> <span class=\"pl-kos\">{</span> <span class=\"pl-en\">service_name_changed?</span> &amp;&amp; <span class=\"pl-en\">service_name</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">present?</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">private</span>\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">validate_service_name_in_services</span>\n      <span class=\"pl-en\">services</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">fetch</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">service_name</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n        <span class=\"pl-en\">errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">add</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:service_name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:invalid</span><span class=\"pl-kos\">)</span>\n      <span class=\"pl-k\">end</span>\n    <span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">Now, we can write our own Module prepend to ActiveStorage::Blob, to override <code class=\"notranslate\">validate_service_name_in_services</code>, such as:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"module ActiveStorageSaas::BlobModelMixin\n  private\n    def validate_service_name_in_services\n      # dynamically define service name per TenantStorageService#id, later we can resolve tenant storage\n      #   configuration by parsing TenantStorageService:1 to tenant_storage = TenantStorageService.find(1)\n      #   tenant_storage.service_name =&gt; Real Storage Service Name\n      #.  tenant_storage.service_options =&gt; options to make instance of Service\n      /^TenantStorageService:\\d+$/.match?(service_name) || super\n    end\nend\n\nActiveSupport.on_load(:active_storage_blob) do\n  prepend ActiveStorageSaas::BlobModelMixin\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">module</span> <span class=\"pl-v\">ActiveStorageSaas</span>::<span class=\"pl-v\">BlobModelMixin</span>\n  <span class=\"pl-k\">private</span>\n    <span class=\"pl-k\">def</span> <span class=\"pl-en\">validate_service_name_in_services</span>\n      <span class=\"pl-c\"># dynamically define service name per TenantStorageService#id, later we can resolve tenant storage</span>\n      <span class=\"pl-c\">#   configuration by parsing TenantStorageService:1 to tenant_storage = TenantStorageService.find(1)</span>\n      <span class=\"pl-c\">#   tenant_storage.service_name =&gt; Real Storage Service Name</span>\n      <span class=\"pl-c\">#.  tenant_storage.service_options =&gt; options to make instance of Service</span>\n      <span class=\"pl-pds\">/^TenantStorageService:<span class=\"pl-cce\">\\d</span>+$/</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">match?</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">service_name</span><span class=\"pl-kos\">)</span> || <span class=\"pl-smi\">super</span>\n    <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-v\">ActiveSupport</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">on_load</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:active_storage_blob</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">prepend</span> <span class=\"pl-v\">ActiveStorageSaas</span>::<span class=\"pl-v\">BlobModelMixin</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<ul dir=\"auto\">\n<li>This is another PR <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1282501642\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45442\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/45442/hovercard\" href=\"https://github.com/rails/rails/pull/45442\">#45442</a> that has the same requirement to customize HTTP Method</li>\n<li>This is my real project that is working on this PR : <a href=\"https://github.com/xiaohui-zhangxh/activestorage_qinium/blob/main/lib/active_storage/service/qinium_service.rb\">https://github.com/xiaohui-zhangxh/activestorage_qinium/blob/main/lib/active_storage/service/qinium_service.rb</a></li>\n<li>This is my real project that need to make our Tenants have their own storage configurations : <a href=\"https://github.com/xiaohui-zhangxh/activestorage_saas/blob/main/lib/active_storage/service/saas_service.rb\">https://github.com/xiaohui-zhangxh/activestorage_saas/blob/main/lib/active_storage/service/saas_service.rb</a></li>\n<li>A duplicate PR <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1341323333\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/45839\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/45839/hovercard\" href=\"https://github.com/rails/rails/pull/45839\">#45839</a> to fix tests errors</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48189",
            "title": "Support more direct upload services by customize HTTP method and respose type",
            "date_modified": "2023-05-11T09:34:16.000Z",
            "date_published": "2023-05-11T09:34:11.000Z",
            "author": {
                "name": "xiaohui-zhangxh",
                "url": "https://github.com/xiaohui-zhangxh"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/93165947?u=4aafc929ec1b2d5baf1afc9508c950960c371f71&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">I have added a new test case that raises an error if the credentials cannot be decrypted.</p>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because [This test case aims to verify that an error is raised if the credentials cannot be decrypted. By adding this new test case, the codebase's testing coverage will be improved, which can help detect and fix potential issues and bugs.]</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes [Raises an error if the credentials cannot be decrypted.]</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/48181",
            "title": "Raises an error if the credentials cannot be decrypted",
            "date_modified": "2023-05-21T21:49:24.000Z",
            "date_published": "2023-05-09T21:16:16.000Z",
            "author": {
                "name": "ajee10x",
                "url": "https://github.com/ajee10x"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/771968?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This adds <code class=\"notranslate\">Object#isolated_copy</code> (as a private API) which performs a <code class=\"notranslate\">deep_dup</code> unless the object is frozen or a non-anonymous module.  In which case, it simply returns <code class=\"notranslate\">self</code>.</p>\n<p dir=\"auto\">TODO:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> tests</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> update <code class=\"notranslate\">thread_mattr_accessor</code> docs</li>\n</ul>\n<hr>\n<p dir=\"auto\"><a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a> <code class=\"notranslate\">Module#deep_dup</code> returning <code class=\"notranslate\">self</code> may cause unexpected behavior (see <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1702310736\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48178\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/48178/hovercard\" href=\"https://github.com/rails/rails/pull/48178\">#48178</a>).  What do you think of replacing <code class=\"notranslate\">Module#deep_dup</code> with <code class=\"notranslate\">Module#isolated_copy</code>?  (In other words, restoring the original behavior of <code class=\"notranslate\">Module#deep_dup</code>, and defining <code class=\"notranslate\">Module#isolated_copy</code> with the specialized behavior instead.)</p>",
            "url": "https://github.com/rails/rails/pull/48179",
            "title": "Add `Object#isolated_copy`",
            "date_modified": "2023-05-10T18:03:32.000Z",
            "date_published": "2023-05-09T16:37:22.000Z",
            "author": {
                "name": "jonathanhefner",
                "url": "https://github.com/jonathanhefner"
            }
        }
    ]
}