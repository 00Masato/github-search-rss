{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5104186?u=c6802aa87b5de2965f8269a3798d468a08a2843b&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2368080326\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52197\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52197/hovercard\" href=\"https://github.com/rails/rails/pull/52197\">#52197</a> added an <code class=\"notranslate\">immutable: true</code> option to <code class=\"notranslate\">expires_in</code>. This PR sets <code class=\"notranslate\">immutable: true</code> for <code class=\"notranslate\">http_cache_forever</code>, which additionally affects proxied ActiveStorage files.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Set <code class=\"notranslate\">immutable: true</code> on <code class=\"notranslate\">http_cache_forever</code>'s <code class=\"notranslate\">expires_in</code> call.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52283",
            "title": "Make http_cache_forever use `immutable: true`",
            "date_modified": "2024-07-06T07:04:09.000Z",
            "date_published": "2024-07-06T07:04:05.000Z",
            "author": {
                "name": "natematykiewicz",
                "url": "https://github.com/natematykiewicz"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39144575?u=27bc8b51723fcd8f9a2de237a4082ecb370f0a59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">The following warning appeared when starting devcontainer.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"WARN[0000] /home/***/ghq/github.com/rails/rails/.devcontainer/compose.yaml: `version` is obsolete\nWARN[0000] /tmp/devcontainercli-***/docker-compose/docker-compose.devcontainer.build-1720224621191.yml: `version` is obsolete\"><pre class=\"notranslate\"><code class=\"notranslate\">WARN[0000] /home/***/ghq/github.com/rails/rails/.devcontainer/compose.yaml: `version` is obsolete\nWARN[0000] /tmp/devcontainercli-***/docker-compose/docker-compose.devcontainer.build-1720224621191.yml: `version` is obsolete\n</code></pre></div>\n<p dir=\"auto\">In fact, the top-level version element will be obsolete in the compose specification.<br>\n<a href=\"https://github.com/compose-spec/compose-spec/blob/master/spec.md#version-top-level-element-obsolete\">https://github.com/compose-spec/compose-spec/blob/master/spec.md#version-top-level-element-obsolete</a></p>",
            "url": "https://github.com/rails/rails/pull/52282",
            "title": "Delete obsolete version in compose.yaml",
            "date_modified": "2024-07-06T00:29:33.000Z",
            "date_published": "2024-07-06T00:24:15.000Z",
            "author": {
                "name": "wonda-tea-coffee",
                "url": "https://github.com/wonda-tea-coffee"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/58702?u=3b098e8231945420ffdf22e1f0af0591d71e45ce&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Images and other attachments added to a rich text area aren't being displayed in the editor when you go back to edit the record again.</p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52233.\">Fixes</span>: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2381123260\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52233\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52233/hovercard\" href=\"https://github.com/rails/rails/issues/52233\">#52233</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request makes it so that if the <code class=\"notranslate\">action-text-attachment</code> element contains an empty <code class=\"notranslate\">content</code> attribute, that attribute will be stripped out during the rendering of attachments.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">None</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52281",
            "title": "ActionText::Content - Strip `content` attribute if it is empty",
            "date_modified": "2024-07-05T19:12:37.000Z",
            "date_published": "2024-07-05T18:45:13.000Z",
            "author": {
                "name": "jagthedrummer",
                "url": "https://github.com/jagthedrummer"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/47554?u=7f919feee43d319ec01c7b135f4d1868a31bddc3&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51327.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2186612406\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51327\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51327/hovercard\" href=\"https://github.com/rails/rails/issues/51327\">#51327</a></p>\n\n<p dir=\"auto\">This Pull Request has been created to move all of the calls to <code class=\"notranslate\">ActiveSupport.run_load_hooks</code> outside of their respective constant definitions. This is to ensure that the constant is fully defined before the <code class=\"notranslate\">run_load_hooks</code> method is called.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li><del>[] Tests are added or updated if you fix a bug or add a feature.</del></li>\n<li><del>[ ] CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</del></li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52280",
            "title": "[Fix #51327] Invoke `ActiveSupport.run_load_hooks` after constant definitions `end`",
            "date_modified": "2024-07-05T20:17:10.000Z",
            "date_published": "2024-07-05T18:31:46.000Z",
            "author": {
                "name": "bensheldon",
                "url": "https://github.com/bensheldon"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/787783?u=5fda346e35dce7edb3ad596c1a96e0b09b48e090&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because of readability issues with the gotcha section of the select form options helper documentation.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the select form options helper gotcha documentation.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52278",
            "title": "[ci skip] Improve readability of select form options helper gotcha documentation",
            "date_modified": "2024-07-05T13:12:47.000Z",
            "date_published": "2024-07-05T12:00:08.000Z",
            "author": {
                "name": "markzalar",
                "url": "https://github.com/markzalar"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2780?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Noticed when reading the edge guides that we have some wonky formatting for the case when we use a method name in an h2 heading.</p>\n<p dir=\"auto\">There's already a fix for h3-level headings, so I copied the font-weight (400) and eyeballed a font-size. 2.25rem looked too much to my eyes, so went with 2rem.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes CSS for the guides. To add <code class=\"notranslate\">h2 code</code> formatting to bring the visual size into line.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<h4 dir=\"auto\">Before:</h4>\n<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/2780/346111445-3af4f85c-2884-44dd-9519-362c593e9c2e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAyNzEyMjMsIm5iZiI6MTcyMDI3MDkyMywicGF0aCI6Ii8yNzgwLzM0NjExMTQ0NS0zYWY0Zjg1Yy0yODg0LTQ0ZGQtOTUxOS0zNjJjNTkzZTljMmUucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MDcwNiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDA3MDZUMTMwMjAzWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZjQ5M2FhNWU1MjNkZWU1MTlhOWUyZDM1YjI2ZjVmNGFkYjEyYzk0ZmFkNWRmOTRkZjYyNDVhNWJmNTUzZWY4NSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.pvD0r9eqDG2f-NM-YAYZxxVqKvGjRhj9fGI_RyDRu_0\"><img src=\"https://private-user-images.githubusercontent.com/2780/346111445-3af4f85c-2884-44dd-9519-362c593e9c2e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAyNzEyMjMsIm5iZiI6MTcyMDI3MDkyMywicGF0aCI6Ii8yNzgwLzM0NjExMTQ0NS0zYWY0Zjg1Yy0yODg0LTQ0ZGQtOTUxOS0zNjJjNTkzZTljMmUucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MDcwNiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDA3MDZUMTMwMjAzWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZjQ5M2FhNWU1MjNkZWU1MTlhOWUyZDM1YjI2ZjVmNGFkYjEyYzk0ZmFkNWRmOTRkZjYyNDVhNWJmNTUzZWY4NSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.pvD0r9eqDG2f-NM-YAYZxxVqKvGjRhj9fGI_RyDRu_0\" alt=\"before\" style=\"max-width: 100%;\"></a></p>\n<h4 dir=\"auto\">After:</h4>\n<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/2780/346111526-d7c730e4-5636-4a26-8fd9-81676335acf5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAyNzEyMjMsIm5iZiI6MTcyMDI3MDkyMywicGF0aCI6Ii8yNzgwLzM0NjExMTUyNi1kN2M3MzBlNC01NjM2LTRhMjYtOGZkOS04MTY3NjMzNWFjZjUucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MDcwNiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDA3MDZUMTMwMjAzWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NWFhNWIwYzJjMTRiMDdjZDA2MDI4ZWFmZjYyYzU2NzRhZjk4ZTViZGEzNTNiNDE4NmU0MTg1Mjg4NjA0ZmZkNSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.NJec1RX4unwZdlhuW-qzInMHeO6rt2TZW8UH_QkeD10\"><img src=\"https://private-user-images.githubusercontent.com/2780/346111526-d7c730e4-5636-4a26-8fd9-81676335acf5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAyNzEyMjMsIm5iZiI6MTcyMDI3MDkyMywicGF0aCI6Ii8yNzgwLzM0NjExMTUyNi1kN2M3MzBlNC01NjM2LTRhMjYtOGZkOS04MTY3NjMzNWFjZjUucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MDcwNiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDA3MDZUMTMwMjAzWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NWFhNWIwYzJjMTRiMDdjZDA2MDI4ZWFmZjYyYzU2NzRhZjk4ZTViZGEzNTNiNDE4NmU0MTg1Mjg4NjA0ZmZkNSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.NJec1RX4unwZdlhuW-qzInMHeO6rt2TZW8UH_QkeD10\" alt=\"after\" style=\"max-width: 100%;\"></a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52276",
            "title": "Guides CSS to format code tags in h2 headings [ci skip]",
            "date_modified": "2024-07-05T12:11:18.000Z",
            "date_published": "2024-07-05T11:14:58.000Z",
            "author": {
                "name": "andycroll",
                "url": "https://github.com/andycroll"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7865030?u=a91840c5a5d8e811d0afa26717f1fd56b4d902e1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">I18n is intialized with file watchers for all translation paths when reloading is enabled.</p>\n<p dir=\"auto\">This includes translations contained within gems; which the user will not be editing in development. This adds unnecessary performance overhead.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This change ensures we're only watching the files we care about.</p>\n<p dir=\"auto\"><strong>Before Pull Request</strong><br>\n<code class=\"notranslate\">EventedFileUpdateChecker</code> watched all these files</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"[\n  &quot;/Users/schwad/.gem/ruby/3.3.3/gems/validate_url-1.0.15/lib/locale/ar.yml&quot;,\n  ...\n  &quot;/Users/schwad/path/to/my/app/config/locales/foo/en.yml&quot;\n  ...\n]\"><pre class=\"notranslate\"><span class=\"pl-kos\">[</span>\n  <span class=\"pl-s\">\"/Users/schwad/.gem/ruby/3.3.3/gems/validate_url-1.0.15/lib/locale/ar.yml\"</span><span class=\"pl-kos\">,</span>\n  ...\n  <span class=\"pl-s\">\"/Users/schwad/path/to/my/app/config/locales/foo/en.yml\"</span>\n  ...\n<span class=\"pl-kos\">]</span></pre></div>\n<p dir=\"auto\"><strong>After Pull Request</strong><br>\nNow:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"[\n  &quot;/Users/schwad/path/to/my/app/config/locales/foo/en.yml&quot;\n  ...\n]\"><pre class=\"notranslate\"><code class=\"notranslate\">[\n  \"/Users/schwad/path/to/my/app/config/locales/foo/en.yml\"\n  ...\n]\n</code></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52271",
            "title": "[i18n] - Do not watch translations from gems when reloading is enabled",
            "date_modified": "2024-07-05T20:19:02.000Z",
            "date_published": "2024-07-04T13:23:33.000Z",
            "author": {
                "name": "Schwad",
                "url": "https://github.com/Schwad"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/46262107?u=d88447065cd085859006068fcde0ef5ac9199b3b&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #52243.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2384037324\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52243\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/52243/hovercard\" href=\"https://github.com/rails/rails/issues/52243\">#52243</a></p>\n<p dir=\"auto\">Currently, the <code class=\"notranslate\">validate_each</code> method in <code class=\"notranslate\">ComparisonValidator</code> checks for presence and add an error to the record object.</p>\n<p dir=\"auto\">However, for the following case,</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"validates :attribute, presence: true, comparison: { greater_than: 0 }\"><pre class=\"notranslate\"><span class=\"pl-en\">validates</span> <span class=\"pl-pds\">:attribute</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">presence</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">comparison</span>: <span class=\"pl-kos\">{</span> <span class=\"pl-pds\">greater_than</span>: <span class=\"pl-c1\">0</span> <span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">this would cause the error to be added twice - once by the <code class=\"notranslate\">Validations::PresenceValidator</code> and then by <code class=\"notranslate\">Validations::ComparisonValidator</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<ul dir=\"auto\">\n<li>\n<p dir=\"auto\">In <code class=\"notranslate\">ComparisonValidator#validates_each</code>, added a condition to not validate <code class=\"notranslate\">presence</code> if it has already been checked.</p>\n</li>\n<li>\n<p dir=\"auto\">Made the following change as <code class=\"notranslate\">obj.blank?</code> covers <code class=\"notranslate\">obj.nil?</code> as well.</p>\n</li>\n</ul>\n<div class=\"highlight highlight-source-diff notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"- if value.nil? || value.blank?\n+ if value.blank?\"><pre class=\"notranslate\"><span class=\"pl-md\"><span class=\"pl-md\">-</span> if value.nil? || value.blank?</span>\n<span class=\"pl-mi1\"><span class=\"pl-mi1\">+</span> if value.blank?</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52269",
            "title": "Bypass presence validation in comparison validator if already checked",
            "date_modified": "2024-07-05T00:29:45.000Z",
            "date_published": "2024-07-04T12:26:59.000Z",
            "author": {
                "name": "kabirpathak",
                "url": "https://github.com/kabirpathak"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39735028?u=91330295c614cf3cec0b64bf242a14fc2ceb358f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Just a few small updates to the Dev Container setup for this repo.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes:</p>\n<ul dir=\"auto\">\n<li>use Ruby 3.3.3 as the default ruby version</li>\n<li>add default-mysql-client. I believe this was missed when switching to use the rails org ruby image</li>\n</ul>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52267",
            "title": "Update Dev Container",
            "date_modified": "2024-07-04T05:47:47.000Z",
            "date_published": "2024-07-03T20:01:49.000Z",
            "author": {
                "name": "andrewn617",
                "url": "https://github.com/andrewn617"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39735028?u=91330295c614cf3cec0b64bf242a14fc2ceb358f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because until now, the <code class=\"notranslate\">database</code> option has conflated the database adapter and the database itself. It's fine for <code class=\"notranslate\">postgres</code> and <code class=\"notranslate\">sqlite</code>, but for <code class=\"notranslate\">mysql2</code> and <code class=\"notranslate\">trilogy</code> adapters we could either use MySQL or MariaDB as the database. This becomes a problem for generating a Dev Container, since we need to add a service to docker compose with the correct database. Previously, we gave the user a MySQL database for the <code class=\"notranslate\">mysql</code> option, and a MariaDB database for the <code class=\"notranslate\">trilogy</code> option. But that is no good as it is common to use a <code class=\"notranslate\">mysql</code> database with <code class=\"notranslate\">trilogy</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">In this PR I introduce two new options, <code class=\"notranslate\">mariadb-mysql</code> and <code class=\"notranslate\">mariadb-trilogy</code>. When generating a dev container, the <code class=\"notranslate\">mysql</code> and <code class=\"notranslate\">trilogy</code> options will create a MySQL database, and the <code class=\"notranslate\">mariadb-</code> options will generate a MariaDB database. Users not generating a dev container do not need to worry about the new options and can continue using the original options, as this change only effects dev container setup.</p>\n<p dir=\"auto\">So to review here is what the options do:</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"mysql:\n  adapter: mysql2\n  database: mysql\n\ntrilogy:\n  adapter: trilogy\n  database: mysql\n\nmariadb-mysql:\n  adapter: mysql2\n  database: mariadb\n\nmariadb-trilogy:\n  adapter: trilogy\n  database: mariadb\"><pre class=\"notranslate\"><span class=\"pl-ent\">mysql</span>:\n  <span class=\"pl-ent\">adapter</span>: <span class=\"pl-s\">mysql2</span>\n  <span class=\"pl-ent\">database</span>: <span class=\"pl-s\">mysql</span>\n\n<span class=\"pl-ent\">trilogy</span>:\n  <span class=\"pl-ent\">adapter</span>: <span class=\"pl-s\">trilogy</span>\n  <span class=\"pl-ent\">database</span>: <span class=\"pl-s\">mysql</span>\n\n<span class=\"pl-ent\">mariadb-mysql</span>:\n  <span class=\"pl-ent\">adapter</span>: <span class=\"pl-s\">mysql2</span>\n  <span class=\"pl-ent\">database</span>: <span class=\"pl-s\">mariadb</span>\n\n<span class=\"pl-ent\">mariadb-trilogy</span>:\n  <span class=\"pl-ent\">adapter</span>: <span class=\"pl-s\">trilogy</span>\n  <span class=\"pl-ent\">database</span>: <span class=\"pl-s\">mariadb</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52266",
            "title": "Add mariadb options to application generator",
            "date_modified": "2024-07-03T19:59:56.000Z",
            "date_published": "2024-07-03T19:59:48.000Z",
            "author": {
                "name": "andrewn617",
                "url": "https://github.com/andrewn617"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/7331511?u=e5c461c2ed59b967e0925a515ab00b9a756715e3&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<blockquote>\n<p dir=\"auto\">This deprecation warning will be visible starting with the release of Rails 8.0,<br>\nso it seems correct to use \"in Rails 8.1\" instead of \"in Rails 8.0\".<br>\n<a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/willnet/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/willnet\">@willnet</a></p>\n</blockquote>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1632305308\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47713\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47713/hovercard\" href=\"https://github.com/rails/rails/pull/47713\">#47713</a></p>\n<p dir=\"auto\">This Pull Request has been created because need to update the deprecation warning message.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the deprecation warning message from \"in Rails 8.0\" to \"in Rails 8.1\".</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">suggested by <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/willnet/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/willnet\">@willnet</a> in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1632305308\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47713\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47713/hovercard?comment_id=1663496308&amp;comment_type=review_comment\" href=\"https://github.com/rails/rails/pull/47713#discussion_r1663496308\">#47713 (comment)</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52265",
            "title": "Update statistics.rake deprecation message",
            "date_modified": "2024-07-04T10:25:05.000Z",
            "date_published": "2024-07-03T12:58:28.000Z",
            "author": {
                "name": "JuanVqz",
                "url": "https://github.com/JuanVqz"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/30030?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The tests for streaming responses, as modified in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2347543583\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52094\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52094/hovercard\" href=\"https://github.com/rails/rails/pull/52094\">#52094</a> are insufficient to determine whether the response included multiple chunks. We should ensure that this is the case, as well as ensuring that the response body conforms to an \"Enumerable Body\" as defined by the Rack specification when <code class=\"notranslate\">stream: true</code> is requested.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52253",
            "title": "Add tests for streaming chunks.",
            "date_modified": "2024-07-02T23:33:42.000Z",
            "date_published": "2024-07-02T03:24:05.000Z",
            "author": {
                "name": "ioquatix",
                "url": "https://github.com/ioquatix"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/30030?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The HTTP status code 422 was informally referred to as \"unprocessable entity\" by the WebDAV specifications. However, it was officially standardised as \"unprocessable content\" by the HTTP standards. Rack adopted this change in v3.1 and emits deprecation warnings in v3.2 (HEAD).</p>\n<p dir=\"auto\">The current released versions of Rack work acceptably with Rails, however Rack HEAD emits warnings, causing test failures.</p>\n<p dir=\"auto\">See <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2010260417\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rack/rack/issues/2137\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rack/rack/pull/2137/hovercard\" href=\"https://github.com/rack/rack/pull/2137\">rack/rack#2137</a> for more context. See <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422\" rel=\"nofollow\">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422</a> for more details about the specifications.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Use \"422\" status code directly in <code class=\"notranslate\">exception_wrapper.rb</code> to avoid the deprecation warning. This change bypasses symbolic name lookup and thus the deprecation warning, by using the status code directly. We may prefer to change all the symbolic constants to integer values to avoid extra hash lookups. However, it's probably not a performance issue in practice.</p>\n<p dir=\"auto\">Handle both <code class=\"notranslate\">unprocessible_entity</code> and <code class=\"notranslate\">unprocessible_content</code> in <code class=\"notranslate\">ActionDispatch::Response</code> and the test assertions helper. This ensures compatibility with both symbols going forward, until Rails decides to drop support.</p>\n<h3 dir=\"auto\">Alternatives</h3>\n<p dir=\"auto\">I considered the following alternatives:</p>\n<ul dir=\"auto\">\n<li>Don’t emit the warning in Rack head, but restore it later (3.2 in about a years time?)</li>\n<li>Don’t make it an error if the warning is emitted in Rack head, in Rails test CI.</li>\n</ul>\n<p dir=\"auto\">If there is enough interest in doing it differently, I'd be willing to consider those options.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52252",
            "title": "Use direct status code to avoid deprecation warnings.",
            "date_modified": "2024-07-02T22:51:53.000Z",
            "date_published": "2024-07-02T02:06:19.000Z",
            "author": {
                "name": "ioquatix",
                "url": "https://github.com/ioquatix"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/200500?u=328252b84dc40e5d2f8cfb89de4a3e3c5ee49bb0&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because <code class=\"notranslate\">EncryptedAttributeType#type</code> incorrectly always returns <code class=\"notranslate\">:text</code> type since that's the type <code class=\"notranslate\">EncryptedAttributeType</code> inherited from. It doesn't consider the actual <code class=\"notranslate\">cast_type</code> it has.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes two things:</p>\n<ul dir=\"auto\">\n<li>it delegates <code class=\"notranslate\">type</code> method to actual <code class=\"notranslate\">cast_type</code> instead of using one from <code class=\"notranslate\">::ActiveRecord::Type::Text</code></li>\n<li>it changes type class from which <code class=\"notranslate\">EncryptedAttributeType</code> is inherited to more generic <code class=\"notranslate\">::ActiveModel::Type::Value</code>. We don't need this change to fix this issue but I thought it makes more sense to inherit from base type instead of specific <code class=\"notranslate\">::ActiveRecord::Type::Text</code>. I tried to check git history to understand why exactly this type was chosen but it was like this when this encryption feature was implemented (without an explanation) so I'm not completely sure if that's ok to change that.</li>\n</ul>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52247",
            "title": "EncryptedAttributeType#type should return cast_type's type.",
            "date_modified": "2024-07-01T19:28:54.000Z",
            "date_published": "2024-07-01T19:22:53.000Z",
            "author": {
                "name": "nashby",
                "url": "https://github.com/nashby"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/28561?u=095779352a57f75e734987829f3f67a10e5780ed&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Related to: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2373086217\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52217\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52217/hovercard\" href=\"https://github.com/rails/rails/pull/52217\">#52217</a><br>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/28561/344766376-0eb45589-76fb-4274-9a6e-e60ceeeb8733.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAyNzEyMjMsIm5iZiI6MTcyMDI3MDkyMywicGF0aCI6Ii8yODU2MS8zNDQ3NjYzNzYtMGViNDU1ODktNzZmYi00Mjc0LTlhNmUtZTYwY2VlZWI4NzMzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MDYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzA2VDEzMDIwM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkyNTVkOWQyODc1YTRjY2MyMDUyMzIwMDAzZjgwMjNlMDhjNTc4ZTcyMDQ5NTQ0YjkwNDI0MGFlMTQ4NjI1MjUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Yyj3IgfsccemTd_f6mOnsRNwg6sDVAa3D7EPg5zBZvg\"><img width=\"872\" alt=\"image\" src=\"https://private-user-images.githubusercontent.com/28561/344766376-0eb45589-76fb-4274-9a6e-e60ceeeb8733.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjAyNzEyMjMsIm5iZiI6MTcyMDI3MDkyMywicGF0aCI6Ii8yODU2MS8zNDQ3NjYzNzYtMGViNDU1ODktNzZmYi00Mjc0LTlhNmUtZTYwY2VlZWI4NzMzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA3MDYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNzA2VDEzMDIwM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkyNTVkOWQyODc1YTRjY2MyMDUyMzIwMDAzZjgwMjNlMDhjNTc4ZTcyMDQ5NTQ0YjkwNDI0MGFlMTQ4NjI1MjUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Yyj3IgfsccemTd_f6mOnsRNwg6sDVAa3D7EPg5zBZvg\" style=\"max-width: 100%;\"></a></p>",
            "url": "https://github.com/rails/rails/pull/52245",
            "title": "Add link guidelines to guides [ci-skip]",
            "date_modified": "2024-07-01T17:45:15.000Z",
            "date_published": "2024-07-01T17:35:34.000Z",
            "author": {
                "name": "p8",
                "url": "https://github.com/p8"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">When converting Action Cable docs from RDoc to Markdown, these two templates were accidentally included in the list of files converted (and the <code class=\"notranslate\">:markup:</code> directive added) because they incorrectly had an <code class=\"notranslate\">.rb</code> extension instead of <code class=\"notranslate\">.rb.tt</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit fixes the extension and removes the <code class=\"notranslate\">:markup:</code> directive.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52239",
            "title": "Fix markup directive in Action Cable templates",
            "date_modified": "2024-07-01T09:55:59.000Z",
            "date_published": "2024-06-30T23:41:56.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">While looking for templates using the <code class=\"notranslate\">.rb</code> extension instead of <code class=\"notranslate\">.rb.tt</code>, my search ended up finding this <code class=\"notranslate\">test_helper.rb</code> file. (The other two are fixed in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2382501965\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/52239\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/52239/hovercard\" href=\"https://github.com/rails/rails/pull/52239\">#52239</a>)</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"$ fd | rg &quot;/templates/.*\\.rb$&quot;\n./actioncable/lib/rails/generators/channel/templates/application_cable/channel.rb\n./actioncable/lib/rails/generators/channel/templates/application_cable/connection.rb\n./railties/lib/rails/generators/test_unit/plugin/templates/test_helper.rb\"><pre class=\"notranslate\"><code class=\"notranslate\">$ fd | rg \"/templates/.*\\.rb$\"\n./actioncable/lib/rails/generators/channel/templates/application_cable/channel.rb\n./actioncable/lib/rails/generators/channel/templates/application_cable/connection.rb\n./railties/lib/rails/generators/test_unit/plugin/templates/test_helper.rb\n</code></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Instead of correcting the extension, I opted to remove it because the <code class=\"notranslate\">test_unit:plugin</code> generator appears to be unused.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Am I right in thinking this is unused? The only tests that fail are related to generator namespace fallbacks, but that seems like a side effect of the specific class no longer existing instead of any external behavior changing. I can try updating the tests if we agree it should be removed.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52238",
            "title": "Remove test_unit plugin_generator",
            "date_modified": "2024-07-02T21:33:06.000Z",
            "date_published": "2024-06-30T23:30:59.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/170034?u=a921ef36a26d3da448fde275fd40b1e7d8a3f497&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">In line with the improvements made in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1875197825\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49095\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49095/hovercard\" href=\"https://github.com/rails/rails/pull/49095\">#49095</a>, implements the same lazily yielding backtrace frame for <code class=\"notranslate\">ActiveJob::LogSubcriber</code>. This will improve the performance of <code class=\"notranslate\">verbose_enqueue_logs</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">While researching the current 'verbose logging' features, I noticed that <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1875197825\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49095\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49095/hovercard\" href=\"https://github.com/rails/rails/pull/49095\">#49095</a> introduced a performance improvement from a new Ruby feature.</p>\n<p dir=\"auto\">A few months before, <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1650754219\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47839\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47839/hovercard\" href=\"https://github.com/rails/rails/pull/47839\">#47839</a> got merged which still uses the 'old' way of getting the matching source location. This PR gets that in line with the new, improved way.</p>\n<p dir=\"auto\"><strong>Question:</strong> does this warrant a <code class=\"notranslate\">CHANGELOG</code> entry? I left it out as I think no behavior has changed,</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52232",
            "title": "Improve performance of ActiveJob::LogSubscriber#query_source_location",
            "date_modified": "2024-07-05T07:26:54.000Z",
            "date_published": "2024-06-28T18:17:51.000Z",
            "author": {
                "name": "djfpaagman",
                "url": "https://github.com/djfpaagman"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5122678?u=204301f9f9fe8930fd26fe3bfe65b6ffaffd8b59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The existing CI templates do not work as expected if <a href=\"https://edgeguides.rubyonrails.org/security.html#custom-credentials\" rel=\"nofollow\">custom credentials</a> are utilized.</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ActiveSupport::MessageEncryptor::InvalidMessage: ActiveSupport::MessageEncryptor::InvalidMessage\"><pre class=\"notranslate\"><code class=\"notranslate\">ActiveSupport::MessageEncryptor::InvalidMessage: ActiveSupport::MessageEncryptor::InvalidMessage\n</code></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Improves existing CI templates by adding an <a href=\"https://docs.github.com/en/actions/learn-github-actions/variables\">environment variable</a> to store the <code class=\"notranslate\">RAILS_MASTER_KEY</code> which should be stored as a <a href=\"https://docs.github.com/en/actions/security-guides/using-secrets-in-github-actions\">secret</a>.</p>\n<p dir=\"auto\">This is necessary so that <a href=\"https://edgeguides.rubyonrails.org/security.html#custom-credentials\" rel=\"nofollow\">custom credentials</a> and <a href=\"https://edgeguides.rubyonrails.org/active_record_encryption.html#basic-usage\" rel=\"nofollow\">Active Record Encryption</a> will work as expected in CI.</p>\n<p dir=\"auto\">Since those features are not enabled by default, we comment this value out, which is consistent with how we treat Redis.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Unrelated changes should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/52230",
            "title": "CI: Introduce `RAILS_MASTER_KEY` placeholder",
            "date_modified": "2024-06-28T11:23:56.000Z",
            "date_published": "2024-06-27T20:07:38.000Z",
            "author": {
                "name": "stevepolitodesign",
                "url": "https://github.com/stevepolitodesign"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/522155?u=2e71ed2ab56545207a94b885fafc434ee7350cf1&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">We have some performance-critical endpoints where we want to allocate least # of objects and use <code class=\"notranslate\">insert_all</code> to write 1000s of rows into the database.</p>\n<p dir=\"auto\">However, we see <code class=\"notranslate\">insert_all</code> being ~2.5x slower compared to manually building <code class=\"notranslate\">INSERT INTO &lt;table&gt; VALUES (...), (...)</code>.</p>\n<p dir=\"auto\">I've been profiling <code class=\"notranslate\">insert_all</code> and that turned out to be largely because it 1) works with arrays of hashes and each hash needs to be traversed 2) it serializes attributes via Attributes API.</p>\n<p dir=\"auto\">That's great default behavior but if we're inserting 2000 tuples of <code class=\"notranslate\">(&lt;foreigh-key&gt;, &lt;foreigh-key&gt;, &lt;foreigh-key&gt;)</code>, we don't want to traverse hashes and run the complexity of casting integers to integers via Attributes API.</p>\n<p dir=\"auto\">I'd like to propose a \"column mode\" for <code class=\"notranslate\">insert_all</code> that takes arrays of arrays (no need to traverse hashes!) and attribute casting is the responsibility of the caller.</p>\n<p dir=\"auto\">With that approach, we're able to make <code class=\"notranslate\">insert_all</code> as fast as direct string building:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ruby 3.3.1 (2024-04-23 revision c56cd86388) [arm64-darwin23]\nWarming up --------------------------------------\n          insert_all     4.000 i/100ms\ninsert_all with columns\n                        11.000 i/100ms\n             raw sql    13.000 i/100ms\n           with Arel    12.000 i/100ms\nCalculating -------------------------------------\n          insert_all     41.522 (± 7.2%) i/s -    168.000 in   4.066766s\ninsert_all with columns\n                         86.048 (±23.2%) i/s -    341.000 in   4.161382s\n             raw sql    114.595 (±14.0%) i/s -    455.000 in   4.055053s\n           with Arel    100.232 (±23.9%) i/s -    384.000 in   4.084465s\n\nComparison:\n             raw sql:      114.6 i/s\n           with Arel:      100.2 i/s - same-ish: difference falls within error\ninsert_all with columns:       86.0 i/s - same-ish: difference falls within error\n          insert_all:       41.5 i/s - 2.76x  slower\"><pre class=\"notranslate\"><code class=\"notranslate\">ruby 3.3.1 (2024-04-23 revision c56cd86388) [arm64-darwin23]\nWarming up --------------------------------------\n          insert_all     4.000 i/100ms\ninsert_all with columns\n                        11.000 i/100ms\n             raw sql    13.000 i/100ms\n           with Arel    12.000 i/100ms\nCalculating -------------------------------------\n          insert_all     41.522 (± 7.2%) i/s -    168.000 in   4.066766s\ninsert_all with columns\n                         86.048 (±23.2%) i/s -    341.000 in   4.161382s\n             raw sql    114.595 (±14.0%) i/s -    455.000 in   4.055053s\n           with Arel    100.232 (±23.9%) i/s -    384.000 in   4.084465s\n\nComparison:\n             raw sql:      114.6 i/s\n           with Arel:      100.2 i/s - same-ish: difference falls within error\ninsert_all with columns:       86.0 i/s - same-ish: difference falls within error\n          insert_all:       41.5 i/s - 2.76x  slower\n</code></pre></div>\n<details><summary>Benchmark code</summary>\n<p dir=\"auto\">\n</p><div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# frozen_string_literal: true\n\nrequire 'debug'\nrequire &quot;active_record&quot;\nrequire &quot;benchmark/ips&quot;\n\nGC.disable\n\nROWS_COUNT = 1000\n\nActiveRecord::Base.establish_connection({ adapter: &quot;sqlite3&quot;, database: &quot;:memory:&quot; })\n\nclass Commerce &lt; ActiveRecord::Base\n  connection.create_table :commerces, force: true do |t|\n    t.string :name, :email, :title, :tags\n    t.integer :variant_id, :product_id, :inventory_id, :something_id, :another_id\n    t.boolean :fulfilled\n    t.datetime :fulfilled_at, :deleted_at\n    t.timestamps null: true\n  end\nend\n\ndef db_time(value)\n  value.to_formatted_s(:db).inspect\nend\n\nATTRS = {\n  name: &quot;sam&quot;,\n  email: &quot;kirs@shopify.com&quot;,\n  title: &quot;title&quot;,\n  tags: &quot;tag1,tag2,tag3&quot;,\n  variant_id: 1,\n  product_id: 1,\n  inventory_id: 1,\n  something_id: 1,\n  another_id: 1,\n  fulfilled: true,\n  fulfilled_at: Time.now,\n  deleted_at: Time.now\n}\n\nBenchmark.ips do |x|\n  x.warmup = 2\n  x.time   = 4\n\n  relation = Commerce.all\n\n  x.report(&quot;insert_all&quot;) do\n    conn = Commerce.connection\n\n    relation.insert_all(\n      [ATTRS] * ROWS_COUNT\n    )\n  end\n\n  x.report(&quot;insert_all with columns&quot;) do\n    conn = Commerce.connection\n    attrs = ATTRS.dup\n    attrs[:fulfilled_at] = attrs[:fulfilled_at].to_formatted_s(:db)\n    attrs[:deleted_at] = attrs[:deleted_at].to_formatted_s(:db)\n    attrs[:created_at] = Time.now.to_formatted_s(:db)\n    attrs[:updated_at] = attrs[:created_at]\n\n    values = [\n      attrs[:name], attrs[:email], attrs[:title], attrs[:tags], attrs[:variant_id], attrs[:product_id], attrs[:inventory_id], attrs[:something_id], attrs[:another_id], attrs[:fulfilled], attrs[:fulfilled_at], attrs[:deleted_at], attrs[:created_at], attrs[:updated_at]\n    ]\n\n    relation.insert_all(\n      [values] * ROWS_COUNT,\n      columns: %w[name email title tags variant_id product_id inventory_id something_id another_id fulfilled fulfilled_at deleted_at created_at updated_at],\n    )\n  end\n\n  x.report(&quot;raw sql&quot;) do\n    conn = Commerce.connection\n    values = (1..ROWS_COUNT).map do\n      attrs = ATTRS\n      &quot;(#{conn.quote(attrs[:name])}, #{conn.quote(attrs[:email])}, #{conn.quote(attrs[:title])}, #{conn.quote(attrs[:tags])}, #{attrs[:variant_id]}, #{attrs[:product_id]}, #{attrs[:inventory_id]}, #{attrs[:something_id]}, #{attrs[:another_id]}, #{attrs[:fulfilled]}, #{db_time(attrs[:fulfilled_at])}, #{db_time(attrs[:deleted_at])}, #{db_time(Time.now)}, #{db_time(Time.now)})&quot;\n    end\n\n    conn.execute(\n      &quot;INSERT INTO commerces (name, email, title, tags, variant_id, product_id, inventory_id, something_id, another_id, fulfilled, fulfilled_at, deleted_at, created_at, updated_at) &quot;\\\n      &quot;VALUES #{values.join(',')}&quot;\n    )\n  end\n\n  x.report(&quot;with Arel&quot;) do\n    conn = Commerce.connection\n    columns = %w[name email title tags variant_id product_id inventory_id something_id another_id fulfilled fulfilled_at deleted_at created_at updated_at]\n    attrs = ATTRS.dup\n    attrs[:fulfilled_at] = (attrs[:fulfilled_at]).to_formatted_s(:db)\n    attrs[:deleted_at] = (attrs[:deleted_at]).to_formatted_s(:db)\n    attrs[:created_at] = (Time.now).to_formatted_s(:db)\n    attrs[:updated_at] = (Time.now).to_formatted_s(:db)\n\n    values_list = [attrs.values] * ROWS_COUNT\n\n    sql = &quot;INSERT INTO #{Commerce.quoted_table_name} (#{columns.join(',')}) &quot;\n    sql &lt;&lt; conn.visitor.compile(Arel::Nodes::ValuesList.new(values_list))\n    conn.execute(sql)\n  end\n\n  x.compare!\nend\"><pre class=\"notranslate\"><span class=\"pl-c\"># frozen_string_literal: true</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'debug'</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"active_record\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"benchmark/ips\"</span>\n\n<span class=\"pl-c1\">GC</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">disable</span>\n\n<span class=\"pl-c1\">ROWS_COUNT</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">1000</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">establish_connection</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">{</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-s\">\"sqlite3\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">database</span>: <span class=\"pl-s\">\":memory:\"</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Commerce</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span>\n  <span class=\"pl-en\">connection</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:commerces</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-c1\">true</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-pds\">:name</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:email</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:title</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:tags</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">integer</span> <span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:another_id</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">boolean</span> <span class=\"pl-pds\">:fulfilled</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">datetime</span> <span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:deleted_at</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">timestamps</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">true</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">def</span> <span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-s1\">value</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">inspect</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-c1\">ATTRS</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-pds\">name</span>: <span class=\"pl-s\">\"sam\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">email</span>: <span class=\"pl-s\">\"kirs@shopify.com\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">title</span>: <span class=\"pl-s\">\"title\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">tags</span>: <span class=\"pl-s\">\"tag1,tag2,tag3\"</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">variant_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">product_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">inventory_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">something_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">another_id</span>: <span class=\"pl-c1\">1</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">fulfilled</span>: <span class=\"pl-c1\">true</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">fulfilled_at</span>: <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">deleted_at</span>: <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span>\n<span class=\"pl-kos\">}</span>\n\n<span class=\"pl-v\">Benchmark</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">ips</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">x</span>|\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">warmup</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">2</span>\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">time</span>   <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">4</span>\n\n  <span class=\"pl-s1\">relation</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">all</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"insert_all\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n\n    <span class=\"pl-s1\">relation</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">insert_all</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-kos\">[</span><span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"insert_all with columns\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">dup</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span>\n\n    <span class=\"pl-s1\">values</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span>\n      <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:email</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:tags</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:another_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-kos\">]</span>\n\n    <span class=\"pl-s1\">relation</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">insert_all</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-kos\">[</span><span class=\"pl-s1\">values</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span><span class=\"pl-kos\">,</span>\n      <span class=\"pl-pds\">columns</span>: <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">name</span> <span class=\"pl-s\">email</span> <span class=\"pl-s\">title</span> <span class=\"pl-s\">tags</span> <span class=\"pl-s\">variant_id</span> <span class=\"pl-s\">product_id</span> <span class=\"pl-s\">inventory_id</span> <span class=\"pl-s\">something_id</span> <span class=\"pl-s\">another_id</span> <span class=\"pl-s\">fulfilled</span> <span class=\"pl-s\">fulfilled_at</span> <span class=\"pl-s\">deleted_at</span> <span class=\"pl-s\">created_at</span> <span class=\"pl-s\">updated_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"raw sql\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">values</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-c1\">ROWS_COUNT</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">map</span> <span class=\"pl-k\">do</span>\n      <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span>\n      <span class=\"pl-s\">\"(<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:name</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:email</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:title</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quote</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:tags</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:variant_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:product_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:inventory_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:something_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:another_id</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>, <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">db_time</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>)\"</span>\n    <span class=\"pl-k\">end</span>\n\n    <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span>\n      <span class=\"pl-s\">\"INSERT INTO commerces (name, email, title, tags, variant_id, product_id, inventory_id, something_id, another_id, fulfilled, fulfilled_at, deleted_at, created_at, updated_at) \"</span>\\\n      <span class=\"pl-s\">\"VALUES <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">values</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">','</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>\"</span>\n    <span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"with Arel\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">conn</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">connection</span>\n    <span class=\"pl-s1\">columns</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">%w[</span><span class=\"pl-s\">name</span> <span class=\"pl-s\">email</span> <span class=\"pl-s\">title</span> <span class=\"pl-s\">tags</span> <span class=\"pl-s\">variant_id</span> <span class=\"pl-s\">product_id</span> <span class=\"pl-s\">inventory_id</span> <span class=\"pl-s\">something_id</span> <span class=\"pl-s\">another_id</span> <span class=\"pl-s\">fulfilled</span> <span class=\"pl-s\">fulfilled_at</span> <span class=\"pl-s\">deleted_at</span> <span class=\"pl-s\">created_at</span> <span class=\"pl-s\">updated_at</span><span class=\"pl-kos\">]</span>\n    <span class=\"pl-s1\">attrs</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">ATTRS</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">dup</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:fulfilled_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:deleted_at</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:created_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:updated_at</span><span class=\"pl-kos\">]</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">(</span><span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_formatted_s</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:db</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-s1\">values_list</span> <span class=\"pl-c1\">=</span> <span class=\"pl-kos\">[</span><span class=\"pl-s1\">attrs</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">values</span><span class=\"pl-kos\">]</span> * <span class=\"pl-c1\">ROWS_COUNT</span>\n\n    <span class=\"pl-s1\">sql</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"INSERT INTO <span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-v\">Commerce</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">quoted_table_name</span><span class=\"pl-kos\">}</span></span> (<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">columns</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">join</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">','</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span>) \"</span>\n    <span class=\"pl-s1\">sql</span> &lt;&lt; <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">visitor</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">compile</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Arel</span>::<span class=\"pl-v\">Nodes</span>::<span class=\"pl-v\">ValuesList</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">values_list</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-s1\">conn</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">execute</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">sql</span><span class=\"pl-kos\">)</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">compare!</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\"></p>\n</details> ",
            "url": "https://github.com/rails/rails/pull/52228",
            "title": "ActiveRecord::Relation#insert_all: support column mode for highest performance",
            "date_modified": "2024-07-04T14:11:39.000Z",
            "date_published": "2024-06-27T14:51:32.000Z",
            "author": {
                "name": "kirs",
                "url": "https://github.com/kirs"
            }
        }
    ]
}