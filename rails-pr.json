{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5122678?u=204301f9f9fe8930fd26fe3bfe65b6ffaffd8b59&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Re-opens <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1556770087\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47136\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47136/hovercard\" href=\"https://github.com/rails/rails/pull/47136\">#47136</a> which was accidentally closed when dealing with a merge conflict.</p>\n<hr>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Introduces <code class=\"notranslate\">other!</code> to the list of <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#module-ActiveRecord::Associations::ClassMethods-label-Singular+associations+-28one-to-one-29\" rel=\"nofollow\">generated methods</a> for singular associations.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"account.beneficiary\n#=&gt; nil\n\naccount.benificiary!\n#=&gt; #&lt;ActiveRecord::RecordNotFound&gt;\n\nBenificiary.create!(account: account)\naccount.benificiary!\n#=&gt; #&lt;Benificiary&gt;\n\nBenificiary.create!(account: account)\naccount.benificiary!\n#=&gt; #&lt;ActiveRecord::SoleRecordExceeded&gt;\"><pre class=\"notranslate\"><span class=\"pl-en\">account</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">beneficiary</span>\n<span class=\"pl-c\">#=&gt; nil</span>\n\n<span class=\"pl-en\">account</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">benificiary!</span>\n<span class=\"pl-c\">#=&gt; #&lt;ActiveRecord::RecordNotFound&gt;</span>\n\n<span class=\"pl-v\">Benificiary</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">account</span>: <span class=\"pl-en\">account</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-en\">account</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">benificiary!</span>\n<span class=\"pl-c\">#=&gt; #&lt;Benificiary&gt;</span>\n\n<span class=\"pl-v\">Benificiary</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">account</span>: <span class=\"pl-en\">account</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-en\">account</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">benificiary!</span>\n<span class=\"pl-c\">#=&gt; #&lt;ActiveRecord::SoleRecordExceeded&gt;</span></pre></div>\n<p dir=\"auto\">Rails provides the ability to <a href=\"https://api.rubyonrails.org/classes/ActiveRecord/FinderMethods.html#method-i-sole\" rel=\"nofollow\">find the sole matching record via sole</a>. I thought adding this predicate method would compliment that existing behavior.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51214",
            "title": "Add `predicate` method to `has_one` accessors",
            "date_modified": "2024-02-28T15:12:24.000Z",
            "date_published": "2024-02-28T15:03:39.000Z",
            "author": {
                "name": "stevepolitodesign",
                "url": "https://github.com/stevepolitodesign"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/50305489?u=932e2c0a90f6fc4bf029e7e95faf5dcb5b0e2b97&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because there's no example for <code class=\"notranslate\">around_ </code> callbacks, so I think it's useful for newcomers like me</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes 2 files, adding an example for an <code class=\"notranslate\">around_update</code> callback:</p>\n<ul dir=\"auto\">\n<li><code class=\"notranslate\">activerecord/lib/active_record/callbacks.rb</code></li>\n<li><code class=\"notranslate\">guides/source/active_record_callbacks.md</code></li>\n</ul>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51211",
            "title": "[ci skip] docs: add around_update callback example",
            "date_modified": "2024-02-27T23:09:17.000Z",
            "date_published": "2024-02-27T14:45:38.000Z",
            "author": {
                "name": "MiguelArgentina",
                "url": "https://github.com/MiguelArgentina"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2786819?u=722b21f1f48dc9a97c9494aba04c4f657d31e941&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created to update the Active Model Basics Documentation.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds the following two sections:</p>\n<ul dir=\"auto\">\n<li>AttributeAssignment</li>\n<li>Attributes</li>\n</ul>\n<p dir=\"auto\">It updates the rest of the sections by trying to provide more information, be more clear, and include more examples. In some parts, it references the API where more information about the methods can be provided.</p>\n<p dir=\"auto\">I also addressed these as part of the changes:</p>\n<blockquote>\n<p dir=\"auto\">There's the new ActiveModel::API module that was essentially a split from ActiveModel::Model, this difference can be better explained in the guides as it is in <a href=\"https://github.com/rails/rails/pull/42042\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/42042/hovercard\">the original PR</a>.</p>\n</blockquote>\n<blockquote>\n<p dir=\"auto\">The Lint Tests section example shows ActiveModel::Model, it should probably be ActiveModel::API.</p>\n</blockquote>\n<blockquote>\n<p dir=\"auto\">It's possible to expand validations with how to check for errors, and other common usage. As well as different types of callback examples.</p>\n</blockquote>\n<blockquote>\n<p dir=\"auto\">Some examples use send, those can be updated to use public_send instead.</p>\n</blockquote>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51210",
            "title": "[RF DOCS] Active Model Basics Documentation [ci-skip]",
            "date_modified": "2024-02-28T13:03:22.000Z",
            "date_published": "2024-02-27T14:05:15.000Z",
            "author": {
                "name": "Ridhwana",
                "url": "https://github.com/Ridhwana"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/94690524?u=34457881e242cefc75851e4d53b90fed38bd5748&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">In current implementations, formatting numerical or date values in messages generated by validations typically requires specifying the message option or implementing custom validators.<br>\nHowever, I only want to format the <code class=\"notranslate\">%{count}</code> and do not need to handle the message, apart from the message option, so I believe it should be a native feature of the framework.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This pull request introduces the value_format option for validations such as <code class=\"notranslate\">numericality</code>, <code class=\"notranslate\">length</code>, and <code class=\"notranslate\">comparison</code>. With this option, it becomes possible to format the value passed to <code class=\"notranslate\">%{count}</code> in i18n messages.</p>\n<p dir=\"auto\">e.g. messages like <em>\"must be equal to 1,000\"</em> can now be generated.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"class MyModel &lt; ApplicationRecord\n  validates :my_attribute, numericality: {\n    equal_to: 1_000,\n    value_format: -&gt; (value) { value.to_fs(:delimited) }\n  }\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">class</span> <span class=\"pl-v\">MyModel</span> &lt; <span class=\"pl-v\">ApplicationRecord</span>\n  <span class=\"pl-en\">validates</span> <span class=\"pl-pds\">:my_attribute</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">numericality</span>: <span class=\"pl-kos\">{</span>\n    <span class=\"pl-pds\">equal_to</span>: <span class=\"pl-c1\">1_000</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-pds\">value_format</span>: <span class=\"pl-c1\">-&gt;</span> <span class=\"pl-kos\">(</span><span class=\"pl-s1\">value</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> <span class=\"pl-s1\">value</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_fs</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:delimited</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">}</span>\n  <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">There have been several similar PRs submitted in the past:</p>\n<ul dir=\"auto\">\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1094118461\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/44076\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/44076/hovercard\" href=\"https://github.com/rails/rails/pull/44076\">#44076</a></li>\n<li><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"810561657\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/41482\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/41482/hovercard\" href=\"https://github.com/rails/rails/pull/41482\">#41482</a></li>\n</ul>\n<p dir=\"auto\">Comparing them,</p>\n<ul dir=\"auto\">\n<li>There is no impact on existing implementation since it can be specified with options.</li>\n<li>It also supports <code class=\"notranslate\">length</code> and <code class=\"notranslate\">comparison</code> where <code class=\"notranslate\">%{count}</code> is used, not limited to <code class=\"notranslate\">numericality</code>.</li>\n</ul>\n<br>\n<p dir=\"auto\">If there are any errors or inconsistencies in the English language in the change log or documentation, please point them out.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51208",
            "title": "Add `value_format` option to `numericality`, `length`, and `comparison` validators",
            "date_modified": "2024-02-27T11:19:04.000Z",
            "date_published": "2024-02-27T11:18:59.000Z",
            "author": {
                "name": "techkato",
                "url": "https://github.com/techkato"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1734607?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This is an alternative to <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2078388014\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50721\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50721/hovercard\" href=\"https://github.com/rails/rails/pull/50721\">#50721</a>.</p>\n<p dir=\"auto\">For <a href=\"https://github.com/rails/solid_cache\">Solid Cache</a>, we want to be able to read and write from the cache database without using the query cache.</p>\n<p dir=\"auto\">We also don't want to expire the query cache on other connection pools when we write. Writing to the Rails cache shouldn't invalidate the main query cache.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a>, <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/jeremy/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/jeremy\">@jeremy</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This adds a <code class=\"notranslate\">dirties</code> option to <code class=\"notranslate\">ActiveRecord::Base.uncached</code> and <code class=\"notranslate\">ActiveRecord::ConnectionAdapters::ConnectionPool#uncached</code>.</p>\n<p dir=\"auto\">Setting <code class=\"notranslate\">dirties</code> to <code class=\"notranslate\">false</code>, means database writes to the connection pool will not mark any query caches as dirty.</p>\n<p dir=\"auto\">The option defaults to <code class=\"notranslate\">true</code> which retains the existing behaviour and clears query caches on all connection pools used by the current thread.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51204",
            "title": "Add dirties option to Model.uncached",
            "date_modified": "2024-02-28T16:42:39.000Z",
            "date_published": "2024-02-27T08:52:17.000Z",
            "author": {
                "name": "djmb",
                "url": "https://github.com/djmb"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/49816584?u=4918bbfadc3c8dc7e0ecb7d4cc23075ca75eef38&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because we have so many syntax sugar, like for <code class=\"notranslate\">present?</code> method we have <code class=\"notranslate\">blank?</code>, and so on, so, that's would be really nice to add opposite method for a <code class=\"notranslate\">exists?</code> instead of writing always <code class=\"notranslate\">!</code>, or using unless</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes adds just an inverted <code class=\"notranslate\">exists?</code> method called <code class=\"notranslate\">missing?</code>. So, it's really simple, but powerful change</p>\n<p dir=\"auto\">Rework of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2144326539\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51138\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51138/hovercard\" href=\"https://github.com/rails/rails/pull/51138\">#51138</a> PR</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51203",
            "title": "Add a `.missing?` method as opposite for a `.exists?`",
            "date_modified": "2024-02-28T17:17:40.000Z",
            "date_published": "2024-02-27T08:35:33.000Z",
            "author": {
                "name": "loqimean",
                "url": "https://github.com/loqimean"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/19192189?u=dd60737844a9db7f1475bab21fc3e5258a405e15&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Ref: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2134298098\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51083\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51083/hovercard\" href=\"https://github.com/rails/rails/pull/51083\">#51083</a><br>\nRedo of: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2146620771\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51154\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/51154/hovercard\" href=\"https://github.com/rails/rails/pull/51154\">#51154</a></p>\n<p dir=\"auto\">The introduction of <code class=\"notranslate\">ActiveRecord::Base.with_connection</code> somewhat broke some expectations, namely that calling <code class=\"notranslate\">.connection</code> would cause the connection to be permenently leased, hence that future calls to it would return the same connection, with all it's possible environmental changes.</p>\n<p dir=\"auto\">So any call to <code class=\"notranslate\">.connection</code>, even inside <code class=\"notranslate\">.with_connection</code> should cause the lease to be sticky, and persist beyond the <code class=\"notranslate\">with_connection</code> block.</p>\n<p dir=\"auto\">After discussing with <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a>, one big worry is that people might hold onto the return value of <code class=\"notranslate\">Base.connection</code> beyond the scope of the <code class=\"notranslate\">.transaction</code> block, which could leak to segfaults or worse data leak.</p>\n<p dir=\"auto\">So in the end I think we need to do this. That makes <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2088694143\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50793\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50793/hovercard\" href=\"https://github.com/rails/rails/pull/50793\">#50793</a> a bit harder to achieve, but not the end of the world.</p>",
            "url": "https://github.com/rails/rails/pull/51192",
            "title": "Make `.connection` always return a permanently leased connection",
            "date_modified": "2024-02-28T15:13:41.000Z",
            "date_published": "2024-02-26T10:59:05.000Z",
            "author": {
                "name": "casperisfine",
                "url": "https://github.com/casperisfine"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/314453?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50850.\">Resolves</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2095807650\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50850\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50850/hovercard\" href=\"https://github.com/rails/rails/issues/50850\">#50850</a></p>\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51127.\">Resolves</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2142754949\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51127\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51127/hovercard\" href=\"https://github.com/rails/rails/issues/51127\">#51127</a> by allowing users to set all query constraints on association definitions, leaving model in a state compatible with active_storage (and active_text) associations.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR merges handling of primary keys by <code class=\"notranslate\">belongs_to</code> association and <code class=\"notranslate\">has_</code> associations into one, rendering aforementioned associations' behaviour expectedly symmetrical.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51189",
            "title": "Handle array values of belongs_to primary_key option",
            "date_modified": "2024-02-27T08:30:33.000Z",
            "date_published": "2024-02-25T19:51:32.000Z",
            "author": {
                "name": "Slotos",
                "url": "https://github.com/Slotos"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/15771072?u=702f73a95b60fa32430e8825432f7639ab72983a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">In mysql, there are two column data types: linestring and multilinestring. At the moment, we cannot create those two using</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"t.column :test_col, :linestring\nt.column :test_mcol, :multilinestring\"><pre class=\"notranslate\"><span class=\"pl-en\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">column</span> <span class=\"pl-pds\">:test_col</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:linestring</span>\n<span class=\"pl-en\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">column</span> <span class=\"pl-pds\">:test_mcol</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:multilinestring</span></pre></div>\n<p dir=\"auto\">When run <code class=\"notranslate\">db:migrate</code>, it will print to <code class=\"notranslate\">schema.rb</code></p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"# Could not dump table &quot;tests&quot; because of following StandardError\n#   Unknown type 'linestring' for column 'ls'\"><pre class=\"notranslate\"><span class=\"pl-c\"># Could not dump table \"tests\" because of following StandardError</span>\n<span class=\"pl-c\">#   Unknown type 'linestring' for column 'ls'</span></pre></div>\n<p dir=\"auto\">Test repo: <a href=\"https://github.com/zgid123/test-mysql-data-type\">https://github.com/zgid123/test-mysql-data-type</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">I followed this PR: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1967279132\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49842\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49842/hovercard\" href=\"https://github.com/rails/rails/pull/49842\">#49842</a> to add those two types. I still not know how to write unit test for this case. Please help me this one.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Here the result after the fix</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"ActiveRecord::Schema[7.2].define(version: 2024_02_25_192506) do\n  create_table &quot;tests&quot;, charset: &quot;utf8mb3&quot;, force: :cascade do |t|\n    t.string &quot;name&quot;\n    t.decimal &quot;number&quot;, precision: 10\n    t.linestring &quot;ls&quot;\n    t.multilinestring &quot;mls&quot;\n    t.datetime &quot;created_at&quot;, null: false\n    t.datetime &quot;updated_at&quot;, null: false\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Schema</span><span class=\"pl-kos\">[</span><span class=\"pl-c1\">7.2</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">define</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">version</span>: <span class=\"pl-c1\">2024_02_25_192506</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">create_table</span> <span class=\"pl-s\">\"tests\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">charset</span>: <span class=\"pl-s\">\"utf8mb3\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-pds\">:cascade</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">string</span> <span class=\"pl-s\">\"name\"</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">decimal</span> <span class=\"pl-s\">\"number\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">precision</span>: <span class=\"pl-c1\">10</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">linestring</span> <span class=\"pl-s\">\"ls\"</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">multilinestring</span> <span class=\"pl-s\">\"mls\"</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">datetime</span> <span class=\"pl-s\">\"created_at\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span>\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">datetime</span> <span class=\"pl-s\">\"updated_at\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">null</span>: <span class=\"pl-c1\">false</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n<a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://private-user-images.githubusercontent.com/15771072/307617632-8bb7d5cb-c1d9-4028-92e3-ce4438b8b1fc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkxNDM1OTksIm5iZiI6MTcwOTE0MzI5OSwicGF0aCI6Ii8xNTc3MTA3Mi8zMDc2MTc2MzItOGJiN2Q1Y2ItYzFkOS00MDI4LTkyZTMtY2U0NDM4YjhiMWZjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAyMjglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMjI4VDE4MDEzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk2N2QzZGNjYTZiNmE2ZWJjZTg0MDZlMDY1YmI1NTZhYTYxYTIzZjc2YzVmYzkzNWJjOTY3YzAzNmRiZmFmOTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.4omFPZnTm511GGWXfcQ_MKr-wsqNQpJ8EWMbGwIpLh8\"><img width=\"1159\" alt=\"image\" src=\"https://private-user-images.githubusercontent.com/15771072/307617632-8bb7d5cb-c1d9-4028-92e3-ce4438b8b1fc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDkxNDM1OTksIm5iZiI6MTcwOTE0MzI5OSwicGF0aCI6Ii8xNTc3MTA3Mi8zMDc2MTc2MzItOGJiN2Q1Y2ItYzFkOS00MDI4LTkyZTMtY2U0NDM4YjhiMWZjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAyMjglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMjI4VDE4MDEzOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk2N2QzZGNjYTZiNmE2ZWJjZTg0MDZlMDY1YmI1NTZhYTYxYTIzZjc2YzVmYzkzNWJjOTY3YzAzNmRiZmFmOTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.4omFPZnTm511GGWXfcQ_MKr-wsqNQpJ8EWMbGwIpLh8\" style=\"max-width: 100%;\"></a>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51188",
            "title": "add linestring and multilinestring for mysql",
            "date_modified": "2024-02-25T19:40:01.000Z",
            "date_published": "2024-02-25T19:19:14.000Z",
            "author": {
                "name": "zgid123",
                "url": "https://github.com/zgid123"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/12777550?u=415303ec1c626279c440cf729435fc0ee833d1c9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #51129.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2142954735\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/51129\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/51129/hovercard\" href=\"https://github.com/rails/rails/issues/51129\">#51129</a>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">When using composite primary keys in a model, the <code class=\"notranslate\">primary_key</code> will be an array. This raises an issue when calling the <code class=\"notranslate\">&lt;association&gt;_ids</code> method on a preloaded association. Internally, Rails uses the <code class=\"notranslate\">pluck</code> method from Enumerable to retrieve the preloaded results. However, the <code class=\"notranslate\">pluck</code> method does not accept an array as its argument. To accommodate that, we need to use the splat operator to split the array into multiple arguments dynamically.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51167",
            "title": "[Fix #51129] Fix issue with IDs reader on preloaded associations for composite primary keys",
            "date_modified": "2024-02-25T07:42:08.000Z",
            "date_published": "2024-02-22T15:46:48.000Z",
            "author": {
                "name": "Jay0921",
                "url": "https://github.com/Jay0921"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22918438?u=bb0e029cc4992c777cb2926b3647ab8ac20b0bf5&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">SELECT queries are idempotent and thus safe to retry automatically. This commit leverages <code class=\"notranslate\">allow_retry</code> to enable automatic retries on queries that go through <code class=\"notranslate\">ActiveRecord::ConnectionAdaptersDatabaseStatements#select</code>.</p>\n<p dir=\"auto\">This should help with connection-related exceptions stemming from network issues. Notably, at Shopify, our applications have been encountering sporadic <code class=\"notranslate\">Trilogy::EOFError</code> exceptions on finds / relation loads.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Pass <code class=\"notranslate\">allow_retry: true</code> when calling <code class=\"notranslate\">#internal_exec_query</code> from <code class=\"notranslate\">ActiveRecord::ConnectionAdaptersDatabaseStatements#select</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">There was discussion around retrying UPDATE and DELETE queries as well. This is potentially still valuable, though most Active Record updates and deletes are wrapped inside transactions that are retry-able anyways. Retrying <code class=\"notranslate\">SELECT</code> queries will make a far more significant difference, so we're proposing we start by making these queries retry-able.</p>\n<p dir=\"auto\">We'd also like to make the case to backport this to <code class=\"notranslate\">7-1-stable</code>: some of Shopify's Rails applications are having trouble moving to trilogy because connection-related exceptions have been popping up, and the DB adapter hasn't been able to retry + reconnect. It's unclear why Trilogy in particular is experiencing these issues, but Trilogy is not usable for some of our applications without these changes. Making this available in the next patch release would help.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51166",
            "title": "Retry SELECT queries on connection-related exceptions",
            "date_modified": "2024-02-28T06:45:17.000Z",
            "date_published": "2024-02-22T15:23:29.000Z",
            "author": {
                "name": "adrianna-chang-shopify",
                "url": "https://github.com/adrianna-chang-shopify"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/8269566?u=89925864a291198526e9d6bb71540244578f2cf8&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because some endless and beginless range comparisons raise <code class=\"notranslate\">RangeError</code> due to <code class=\"notranslate\">ActiveSupport::CompareWithRange</code></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the <code class=\"notranslate\">CompareWithRange#===</code> and <code class=\"notranslate\">CompareWithRange#include?</code> methods to support begin and endless ranges on the left and right hand side of the comparison.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">POR:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&gt; (1..) === (2..)\n=&gt; false\n&gt; (..1) === (..2)\n=&gt; false\"><pre class=\"notranslate\">&gt; <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span><span class=\"pl-c1\">2</span>..<span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">false</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">2</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">false</span></pre></div>\n<p dir=\"auto\">Rails 7.1.3:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&gt; (1..) === (2..)\nRangeError: cannot get the last element of endless range\nfrom …/activesupport-7.1.3/lib/active_support/core_ext/range/compare_range.rb:23:in `last'\n&gt; (..1) === (..2)\nRangeError: cannot get the first element of beginless range\nfrom …/activesupport-7.1.3/lib/active_support/core_ext/range/compare_range.rb:24:in `first'\"><pre class=\"notranslate\">&gt; <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span><span class=\"pl-c1\">2</span>..<span class=\"pl-kos\">)</span>\n<span class=\"pl-en\">RangeError</span>: <span class=\"pl-en\">cannot</span> <span class=\"pl-en\">get</span> <span class=\"pl-en\">the</span> <span class=\"pl-en\">last</span> <span class=\"pl-en\">element</span> <span class=\"pl-en\">of</span> <span class=\"pl-en\">endless</span> <span class=\"pl-en\">range</span>\n<span class=\"pl-en\">from</span> <span class=\"pl-en\">…</span>/<span class=\"pl-en\">activesupport</span>-<span class=\"pl-c1\">7.1</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">3</span>/<span class=\"pl-en\">lib</span>/<span class=\"pl-en\">active_support</span>/<span class=\"pl-en\">core_ext</span>/<span class=\"pl-en\">range</span>/<span class=\"pl-en\">compare_range</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">rb</span>:<span class=\"pl-c1\">23</span><span class=\"pl-pds\">:in</span> <span class=\"pl-s\">`last'</span>\n<span class=\"pl-s\">&gt; (..1) === (..2)</span>\n<span class=\"pl-s\">RangeError: cannot get the first element of beginless range</span>\n<span class=\"pl-s\">from …/activesupport-7.1.3/lib/active_support/core_ext/range/compare_range.rb:24:in `</span><span class=\"pl-en\">first</span><span class=\"pl-s\">'</span></pre></div>\n<p dir=\"auto\">This PR:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&gt; (1..) === (2..)\n=&gt; true\n&gt; (2..) === (1..)\n=&gt; false\n&gt; (..1) === (..2)\n=&gt; false\n&gt; (..2) === (..1)\n=&gt; true\"><pre class=\"notranslate\">&gt; <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span><span class=\"pl-c1\">2</span>..<span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">true</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-kos\">(</span><span class=\"pl-c1\">2</span>..<span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span><span class=\"pl-c1\">1</span>..<span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">false</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">2</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">false</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">2</span><span class=\"pl-kos\">)</span> === <span class=\"pl-kos\">(</span>..<span class=\"pl-c1\">1</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-c1\">true</span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51159",
            "title": "Fix beginless and endless range comparisons",
            "date_modified": "2024-02-27T23:55:11.000Z",
            "date_published": "2024-02-22T01:23:49.000Z",
            "author": {
                "name": "AlexMooney",
                "url": "https://github.com/AlexMooney"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/90490?u=759a58d59fb3604e02b9f62a8bd1e4978be7cffd&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">A non-array column can be queried via <code class=\"notranslate\">where(name: [value1, value2])</code> which is automatically converted to <code class=\"notranslate\">name IN (value1, value2)</code> in SQL. An array column would treat that array as the value to search for, so it'd be natural to expect an array of arrays would result in an <code class=\"notranslate\">IN</code> query. Unfortunately, that wasn't the case as <code class=\"notranslate\">where(name: [[value1], [value2]])</code> would return <code class=\"notranslate\">name = {{value1}, {value2}}</code> in SQL, instead of <code class=\"notranslate\">name IN ({value1}, {value2})</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">That behavior stemmed from the fact that Active Record would force equality comparison for array columns if the value was an array. In order to allow <code class=\"notranslate\">IN</code> queries this check was change to check whether it's a <strong>one-dimensional</strong> array by checking that the first item of is not an array.</p>\n<p dir=\"auto\">After these changes the following logic applies for querying array columns:</p>\n<ol dir=\"auto\">\n<li>Using a one-dimensional array results in an ordinary equality query.</li>\n<li>Using a two-dimensional array produces an <code class=\"notranslate\">IN</code> query.</li>\n</ol>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51137",
            "title": "Support IN queries on array columns",
            "date_modified": "2024-02-20T15:02:04.000Z",
            "date_published": "2024-02-20T12:01:26.000Z",
            "author": {
                "name": "gregnavis",
                "url": "https://github.com/gregnavis"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/40373?u=97283b5a00bd596840c2024f7e430ac9e41ca503&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The new AllowBrowser feature was added in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2061123087\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50505\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50505/hovercard\" href=\"https://github.com/rails/rails/pull/50505\">#50505</a> . It permits setting minimum browser versions for an application, defines and documents a <code class=\"notranslate\">:modern</code> version-set as requiring a list of certain features, and adds that option to the default config for new apps.</p>\n<p dir=\"auto\">This PR has been created to make two minor corrections to <code class=\"notranslate\">:modern</code>, one to its versions, one to its documentation.</p>\n<h3 dir=\"auto\">Detail</h3>\n<ol dir=\"auto\">\n<li>In <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/24264baeae1d57743aa87b4fcb88e55a42cc850a/hovercard\" href=\"https://github.com/rails/rails/commit/24264baeae1d57743aa87b4fcb88e55a42cc850a\"><tt>24264ba</tt></a>, adjust the <code class=\"notranslate\">:modern</code> browser versions to match the description of required features. Specifically, CSS nesting isn't supported by Chrome until 120, Opera until 106 (<a href=\"https://caniuse.com/css-nesting\" rel=\"nofollow\">1</a>, <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Nesting_selector#browser_compatibility\" rel=\"nofollow\">2</a>).</li>\n<li>In <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/ff0291291a2c93f40c92a306f4fc3025bd8bdbc0/hovercard\" href=\"https://github.com/rails/rails/commit/ff0291291a2c93f40c92a306f4fc3025bd8bdbc0\"><tt>ff02912</tt></a>, remove badging from the documentation's list of required features, because it's still a <a href=\"https://www.w3.org/TR/badging/\" rel=\"nofollow\">spec</a> that isn't fully implemented by any current browser (<a href=\"https://caniuse.com/mdn-api_notification_badge\" rel=\"nofollow\">1</a>, <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Badging_API#browser_compatibility\" rel=\"nofollow\">2</a>).</li>\n</ol>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Personally I'm not convinced this feature will be a good default for new apps, but if it's going to be offered, it should be correct for its stated purpose.</p>\n<p dir=\"auto\">For fun, I benchmarked <code class=\"notranslate\">UserAgent.parse.browser</code> on my laptop and it runs in about 40 microseconds, which is faster than I'd expected. But the runtime <code class=\"notranslate\">require \"useragent\"</code> added 30 milliseconds to the first request.</p>\n<p dir=\"auto\">The <code class=\"notranslate\">useragent</code> gem was <a href=\"https://github.com/gshutler/useragent\">last updated</a> five years ago, and its browser recognition code is all <a href=\"https://github.com/gshutler/useragent/tree/master/lib/user_agent/browsers\">7 to 9 years old</a>. It seems inappropriate to have a <code class=\"notranslate\">:modern</code> default that doesn't recognize Edge (2015). There's a <a href=\"https://github.com/art19/useragent\">fork by art19</a> that recognizes Edge, but it adds 54 other browsers too, so it has 4x the LoC, and its <code class=\"notranslate\">require</code> is 90 milliseconds. Something in-between might be nice.</p>\n<p dir=\"auto\">I made a <a href=\"https://docs.google.com/spreadsheets/d/13hz5ndUBDeTqAKwYCv5CyAMGpcCVkc5hwJ7Is7BG0qo/edit#gid=0\" rel=\"nofollow\">google spreadsheet</a> listing browser versions that support each of the <code class=\"notranslate\">:modern</code> features listed. The tl;dr is that badges and css nesting are the most-restrictive requirement for every major browser except Firefox (which was late to support css :has).</p>",
            "url": "https://github.com/rails/rails/pull/51121",
            "title": "Fix AllowBrowser versions",
            "date_modified": "2024-02-20T17:39:15.000Z",
            "date_published": "2024-02-18T18:08:50.000Z",
            "author": {
                "name": "jamiemccarthy",
                "url": "https://github.com/jamiemccarthy"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/314453?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Specifically, <code class=\"notranslate\">.where([:id] =&gt; [])</code> is now equivalent to <code class=\"notranslate\">where(:id =&gt; [])</code>.</p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This behaviour fixes <code class=\"notranslate\">#collection_singular_ids=</code> for relations with composite query constraints when used in forms, as <code class=\"notranslate\">ids_writer</code> compacts blank values before looking up matching records, efectively calling <code class=\"notranslate\">.where(primary_key =&gt; [])</code> when, for example, all checkboxes were deselected by a user on a form.</p>\n<p dir=\"auto\">The error indicative of the behaviour that this commit attempts to fix: <code class=\"notranslate\">Arel::Visitors::UnsupportedVisitError: Unsupported argument type: NilClass. Construct an Arel node instead.</code></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\"><code class=\"notranslate\">#reduce</code> returns <code class=\"notranslate\">nil</code> when operating on empty collections. This commit adds a separate branch for handling an empty query set in <code class=\"notranslate\">PredicateBuilder#grouping_queries</code>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51116",
            "title": "Handle empty array value in query builder's tuple syntax",
            "date_modified": "2024-02-27T18:19:02.000Z",
            "date_published": "2024-02-17T15:58:38.000Z",
            "author": {
                "name": "Slotos",
                "url": "https://github.com/Slotos"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5655861?u=efbdd9ae575115738b76de2c1aae359e7631db79&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h1 dir=\"auto\">Use WEBP as the default format for representations</h1>\n<p dir=\"auto\">This pull request updates the <code class=\"notranslate\">default_variant_format</code> method in the <code class=\"notranslate\">representable.rb</code> file. Previously, the default image format was PNG. With this change, the default image format is now WEBP.</p>\n<p dir=\"auto\">This change is made to improve the performance of our web pages, as <a href=\"https://caniuse.com/webp\" rel=\"nofollow\">all major browsers support WEBP images</a>, which are generally smaller in size compared to PNG images, without any significant loss in image quality. This will help in faster loading of images and improve the overall user experience.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51115",
            "title": "Change Default Variant Format from PNG to WEBP",
            "date_modified": "2024-02-17T11:42:12.000Z",
            "date_published": "2024-02-17T10:02:14.000Z",
            "author": {
                "name": "6temes",
                "url": "https://github.com/6temes"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/54629302?u=be8de5137bf940532cddd05aff823129ab8a39db&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #33155.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"333434461\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/33155\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/33155/hovercard\" href=\"https://github.com/rails/rails/issues/33155\">#33155</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Updates <code class=\"notranslate\">#load_target</code> in <code class=\"notranslate\">ActiveRecord::Associations::CollectionAssociation</code> and <code class=\"notranslate\">ActiveRecord::Associations::Association</code> (which is inherited by <code class=\"notranslate\">ActiveRecord::Associations::SingularAssociation</code>) to set the through association target using the middle record when the current record has not yet been persisted.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<p dir=\"auto\">I usually include coverage before opening a PR but I'd like some initial feedback on this before I do that given that it's a change to a core part of AR and I'm not certain that a patch will be accepted for this issue. However, I've got <a href=\"https://github.com/rails/rails/issues/33155#issuecomment-1949912960\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/33155/hovercard\">a reproduction script</a> which passes against this branch.</p>\n<p dir=\"auto\">There also seems to have been <a href=\"https://github.com/rails/rails/pull/38562\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/38562/hovercard\">another attempted patch</a> which didn't end up getting merged.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51114",
            "title": "[Fix #33155] Set through target for new records",
            "date_modified": "2024-02-17T12:05:15.000Z",
            "date_published": "2024-02-17T09:15:40.000Z",
            "author": {
                "name": "joshuay03",
                "url": "https://github.com/joshuay03"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1398?u=c811c584ad0578eb4902088362067bb4c98cff93&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">While <code class=\"notranslate\">fields_for</code> currently accepts a lambda as an argument for <code class=\"notranslate\">child_index</code>, that lambda is called without any arguments. Being that we are enumerating the association on <code class=\"notranslate\">fields_for</code> at the time the lambda is called, we have an opportunity to pass the child of the association down to the lambda.  This could simplify the case where you may want to use the <code class=\"notranslate\">id</code> of an Active Record object as the index.  So with this change you could do something like this:</p>\n<div class=\"highlight highlight-text-html-erb notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&lt;%= author_form.fields_for :books, child_index: -&gt;(book) { book.id } do |book_form| %&gt;\n  &lt;%= book_form.text_field :name %&gt;\n&lt;% end %&gt;\"><pre class=\"notranslate\"><span class=\"pl-k\">&lt;%=</span> author_form.fields_for :books, child_index: -&gt;(book) { book.id } do |book_form| <span class=\"pl-k\">%&gt;</span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">  &lt;%=</span> book_form.text_field :name <span class=\"pl-k\">%&gt;</span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">&lt;%</span> end <span class=\"pl-k\">%&gt;</span><span class=\"pl-en\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-kos\"></span><span class=\"pl-pds\"></span><span class=\"pl-c1\"></span><span class=\"pl-kos\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-kos\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-kos\"></span><span class=\"pl-k\"></span><span class=\"pl-s1\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-k\"></span></pre></div>\n<p dir=\"auto\">Prior to this, you would have had to enumerate the association yourself:</p>\n<div class=\"highlight highlight-text-html-erb notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&lt;% author.books.each do |book| %&gt;\n  &lt;%= author_form.fields_for :books, book, child_index: book.id do |book_form| %&gt;\n    &lt;%= book_form.text_field :name %&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\"><pre class=\"notranslate\"><span class=\"pl-k\">&lt;%</span> author.books.each do |book| <span class=\"pl-k\">%&gt;</span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">  &lt;%=</span> author_form.fields_for :books, book, child_index: book.id do |book_form| <span class=\"pl-k\">%&gt;</span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">    &lt;%=</span> book_form.text_field :name <span class=\"pl-k\">%&gt;</span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">  &lt;%</span> end <span class=\"pl-k\">%&gt;</span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">&lt;%</span> end <span class=\"pl-k\">%&gt;</span><span class=\"pl-en\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-k\"></span><span class=\"pl-s1\"></span><span class=\"pl-en\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-kos\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-pds\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-k\"></span><span class=\"pl-s1\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-k\"></span><span class=\"pl-k\"></span></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Accepts passing the association's child as an argument in a lambda as the <code class=\"notranslate\">child_index</code> option in <code class=\"notranslate\">fields_for</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Used <a href=\"https://github.com/rails/rails/pull/19661\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/19661/hovercard\">PR 19661</a> as a guide when passing a lambda to <code class=\"notranslate\">child_index</code> was originally introduced.</p>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/51110",
            "title": "Accept a `child_index` lambda on `fields_for` with an argument",
            "date_modified": "2024-02-16T21:47:33.000Z",
            "date_published": "2024-02-16T20:19:57.000Z",
            "author": {
                "name": "keegnotrub",
                "url": "https://github.com/keegnotrub"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">When using sharding and the <code class=\"notranslate\">test</code> primary config is named differently than <code class=\"notranslate\">development</code> primary config, like</p>\n<div class=\"highlight highlight-source-yaml notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"development:\n  primary: # can be any name, not necessary 'primary'\n    adapter: sqlite3\n    database: dev_db\n  secondary:\n    adapter: sqlite3\n    database: secondary_dev_db\n    schema_dump: false\ntest:\n  primary_test: # note the different name\n    adapter: sqlite3\n    database: test_db\n  secondary_test:\n    adapter: sqlite3\n    database: secondary_test_db\n    schema_dump: false\"><pre class=\"notranslate\"><span class=\"pl-ent\">development</span>:\n  <span class=\"pl-ent\">primary</span>: <span class=\"pl-c\"><span class=\"pl-c\">#</span> can be any name, not necessary 'primary'</span>\n    <span class=\"pl-ent\">adapter</span>: <span class=\"pl-s\">sqlite3</span>\n    <span class=\"pl-ent\">database</span>: <span class=\"pl-s\">dev_db</span>\n  <span class=\"pl-ent\">secondary</span>:\n    <span class=\"pl-ent\">adapter</span>: <span class=\"pl-s\">sqlite3</span>\n    <span class=\"pl-ent\">database</span>: <span class=\"pl-s\">secondary_dev_db</span>\n    <span class=\"pl-ent\">schema_dump</span>: <span class=\"pl-c1\">false</span>\n<span class=\"pl-ent\">test</span>:\n  <span class=\"pl-ent\">primary_test</span>: <span class=\"pl-c\"><span class=\"pl-c\">#</span> note the different name</span>\n    <span class=\"pl-ent\">adapter</span>: <span class=\"pl-s\">sqlite3</span>\n    <span class=\"pl-ent\">database</span>: <span class=\"pl-s\">test_db</span>\n  <span class=\"pl-ent\">secondary_test</span>:\n    <span class=\"pl-ent\">adapter</span>: <span class=\"pl-s\">sqlite3</span>\n    <span class=\"pl-ent\">database</span>: <span class=\"pl-s\">secondary_test_db</span>\n    <span class=\"pl-ent\">schema_dump</span>: <span class=\"pl-c1\">false</span></pre></div>\n<p dir=\"auto\">rails is unable to use the default <code class=\"notranslate\">schema.rb</code> file when running <code class=\"notranslate\">rails db:test:prepare</code>. It generates the following error:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"app/db/shard_one_test_schema.rb doesn't exist yet. Run `bin/rails db:migrate` to create it, then try again. \nIf you do not intend to use a database, you should instead alter app/config/application.rb to limit the \nframeworks that will be loaded.\"><pre class=\"notranslate\"><code class=\"notranslate\">app/db/shard_one_test_schema.rb doesn't exist yet. Run `bin/rails db:migrate` to create it, then try again. \nIf you do not intend to use a database, you should instead alter app/config/application.rb to limit the \nframeworks that will be loaded.\n</code></pre></div>\n<p dir=\"auto\">When they both are named the same, rails just \"erroneously\" uses the one from the <code class=\"notranslate\">development</code> configuration and it succeeds.</p>",
            "url": "https://github.com/rails/rails/pull/51103",
            "title": "Fix `db:test:prepare` when using sharding and test primary config is named differently than development primary config",
            "date_modified": "2024-02-17T09:54:51.000Z",
            "date_published": "2024-02-16T14:33:04.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/509837?u=697e4a265d5359363a5d57a24b07f9a79cb0b08a&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1870707368\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49072\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49072/hovercard\" href=\"https://github.com/rails/rails/pull/49072\">#49072</a> allowed you to turn <code class=\"notranslate\">support_unencrypted_data</code> on a global level, then turn it off for specific attributes. But it didn't allow the inverse: you couldn't turn the config off globally, and then turn it on for a specific attribute.</p>\n<p dir=\"auto\">This PR adds support for that, which should make the setting's behaviour less surprising.</p>",
            "url": "https://github.com/rails/rails/pull/51100",
            "title": "Encryption: allow turning on `support_unencrypted_data` at a per-attribute level",
            "date_modified": "2024-02-16T05:59:34.000Z",
            "date_published": "2024-02-16T05:58:33.000Z",
            "author": {
                "name": "ghiculescu",
                "url": "https://github.com/ghiculescu"
            }
        }
    ]
}