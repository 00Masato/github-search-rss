{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">There is the same line below.</p>",
            "url": "https://github.com/rails/rails/pull/50161",
            "title": "Remove duplicate  assignment from ActiveRecord's Rakefile",
            "date_modified": "2023-11-24T17:41:19.000Z",
            "date_published": "2023-11-24T17:41:15.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">According to the <a href=\"https://html.spec.whatwg.org/multipage/syntax.html#void-elements\" rel=\"nofollow\">HTML5 Spec</a></p>\n<blockquote>\n<p dir=\"auto\">Void elements can't have any contents (since there's no end tag, no<br>\ncontent can be put between the start tag and the end tag).</p>\n</blockquote>\n<p dir=\"auto\">Up to this point, the only special handling of void elements has been to use \"&gt;\" to close them instead of \"/&gt;\" (which is optional but valid according to the spec)</p>\n<blockquote>\n<p dir=\"auto\">Then, if the element is one of the void elements, ... , then there may<br>\nbe a single U+002F SOLIDUS character (/), ... . On void elements, it<br>\ndoes not mark the start tag as self-closing but instead is unnecessary<br>\nand has no effect of any kind.</p>\n</blockquote>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit deprecates the ability to pass content (either through the positional \"content\" parameter or a block) to a void element since it is not valid according to the Spec. This has the benefit of both encouraging more correct HTML generation, and also simplifying the method definition of void elements once the deprecation has been removed.</p>\n<p dir=\"auto\">This commit additionally tweaks the signature of \"void_tag_string\" slightly with two changes. The first change is renaming it to be \"self_closing_tag_string\". This is more accurate than \"void_tag_string\" because the definition of \"void element\" is more specific and has more requirements than \"self closing element\". For example, tags in the SVG namespace <em>can</em> be self closing but the \"/\" at the end of the start tag is <em>not</em> optional because they are not void elements. The second change to this method is swapping from a boolean \"self_closing\" parameter to a string \"tag_suffix\" parameter. This enables the void element method definition to specialize the tag_suffix (to just \"&gt;\") without either void elements or self closing elements having to pay the runtime cost of the self_closing conditional since we know at method definition time which suffix each type of tag should use.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50159",
            "title": "Deprecate content for void elements in TagBuilder",
            "date_modified": "2023-11-24T16:46:12.000Z",
            "date_published": "2023-11-24T16:46:08.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50154.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2009113153\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50154\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50154/hovercard\" href=\"https://github.com/rails/rails/issues/50154\">#50154</a>.</p>",
            "url": "https://github.com/rails/rails/pull/50158",
            "title": "Fix defining `alias_attribute` for STI classes with abstract class in the inheritance chain",
            "date_modified": "2023-11-24T12:23:02.000Z",
            "date_published": "2023-11-24T12:22:57.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14981592?u=11406fb0121b15a93b3305388377a57b4d9c96f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The link for erubis docs seems to be dead for a few years now <a href=\"http://www.kuwata-lab.com/erubis/users-guide.06.html#topics-trimspaces\" rel=\"nofollow\">http://www.kuwata-lab.com/erubis/users-guide.06.html#topics-trimspaces</a>, see <a href=\"http://web.archive.org/web/20230401000000*/http://www.kuwata-lab.com/erubis/users-guide.06.html\" rel=\"nofollow\">Wayback Machine</a>. Even when reading it through a <a href=\"http://web.archive.org/web/20200218190015/http://www.kuwata-lab.com/erubis/users-guide.06.html\" rel=\"nofollow\">working link</a> I'm not sure how it relates to Rails and this config value.</p>\n<p dir=\"auto\">I updated docs to how I understand it currently works.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Some context at <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"248936605\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/30149\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/30149/hovercard\" href=\"https://github.com/rails/rails/pull/30149\">#30149</a>. To me it looks like this config value should be deprecated and replaced with a boolean since that is how it is excusivly used by rails. </p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/a6099ed2b7a544d8fe67688e8a0f9237847404ee/actionview/lib/action_view/template/handlers/erb.rb#L81\">rails/actionview/lib/action_view/template/handlers/erb.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n         Line 81\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/a6099ed2b7a544d8fe67688e8a0f9237847404ee\">a6099ed</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L81\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"81\"></td>\n          <td id=\"LC81\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-pds\">trim</span>: <span class=\"pl-kos\">(</span><span class=\"pl-smi\">self</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">class</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">erb_trim_mode</span> == <span class=\"pl-s\">\"-\"</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50157",
            "title": "Update docs for `erb_trim_mode`",
            "date_modified": "2023-11-24T11:54:55.000Z",
            "date_published": "2023-11-24T11:30:51.000Z",
            "author": {
                "name": "Earlopain",
                "url": "https://github.com/Earlopain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/563294?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">In our codebase, we heavily lean on PostgreSQL stored procedures. These procedures can raise errors through the <code class=\"notranslate\">RAISE</code> statement. We've added custom error codes to these errors so we can throw custom exceptions in our Ruby code. Up until now this has always been a monkey patch to the <code class=\"notranslate\">translate_exception</code> method in the PostgreSQL adapter. The upgrade to Rails 7.1 broke our monkey patch (again), this motivated us to work on a better solution in ActiveRecord.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR introduces the <code class=\"notranslate\">ActiveRecord:Errors</code> registry to manage translations of database specific exceptions to ActiveRecord exceptions. Initially I wanted to only introduce this for custom errors, but after seeing the result I figured we can also use this for all specific translations in the adapters. This cleans up a lot of code and makes it easier to understand the translation.</p>\n<p dir=\"auto\">A translation for an error can be registered in the registry:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"ActiveRecord::Errors.register(&quot;MY0001&quot;, MyCustomException, adapter: ActiveRecord::ConnectionAdapters::PostgreSQL)\nActiveRecord::Errors.register(/connection lost/, CustomConnectionLostException, adapter: ActiveRecord::ConnectionAdapters::PostgreSQL)\nActiveRecord::Errors.register((e)-&gt; { e.kind_of?(Exception) }, MyCustomException, adapter: ActiveRecord::ConnectionAdapters::PostgreSQL)\"><pre class=\"notranslate\"><span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">register</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"MY0001\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">MyCustomException</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">ConnectionAdapters</span>::<span class=\"pl-v\">PostgreSQL</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">register</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/connection lost/</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">CustomConnectionLostException</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">ConnectionAdapters</span>::<span class=\"pl-v\">PostgreSQL</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">register</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">e</span><span class=\"pl-kos\">)</span>-&gt; <span class=\"pl-kos\">{</span> <span class=\"pl-en\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">kind_of?</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Exception</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">MyCustomException</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">ConnectionAdapters</span>::<span class=\"pl-v\">PostgreSQL</span><span class=\"pl-kos\">)</span></pre></div>\n<p dir=\"auto\">The <code class=\"notranslate\">AbstractAdapter</code> does a lookup in the registry to find the appropriate ActiveRecord exception. By supporting strings, Regexp and Procs, almost all translation cases in the specific adapters can be replaced.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Changing error handling for all database adapters should not be taken lightly. I've checked the test coverage for all errors and found that all errors are covered with tests spread over different test cases.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50156",
            "title": "Introduce ActiveRecord:Errors registry for error translations",
            "date_modified": "2023-11-24T12:22:15.000Z",
            "date_published": "2023-11-24T11:13:12.000Z",
            "author": {
                "name": "edwinv",
                "url": "https://github.com/edwinv"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22231095?u=fc75f9764434943effe06d6c1dc48d40a5003b0c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request updates the the <code class=\"notranslate\">excerpt</code> text helper documentation. Separated the options and examples in different section as same as <code class=\"notranslate\">simple_format</code>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50153",
            "title": "Improve documentation for excerpt text helper [skip ci]",
            "date_modified": "2023-11-24T04:26:50.000Z",
            "date_published": "2023-11-24T04:16:05.000Z",
            "author": {
                "name": "akhilgkrishnan",
                "url": "https://github.com/akhilgkrishnan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/84159?u=611f8cb6bdccc221b89e645b60cb8471d9269ada&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">Problem</h2>\n<p dir=\"auto\">Some behaviours for <code class=\"notranslate\">ActiveSupport::InheritableOptions</code> are unintuitive because it implements hash lookup like so:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"def initialize\n  super() { |h, k| parent[k] }\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">def</span> <span class=\"pl-en\">initialize</span>\n  <span class=\"pl-smi\">super</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> |<span class=\"pl-s1\">h</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">k</span>| <span class=\"pl-en\">parent</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">k</span><span class=\"pl-kos\">]</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">Because of this, lookups work because they fall through to the block which is stored in the closure. But if you try to do any hash-like behaviour it only operates on the keys added after inheritance, and ignores the parent hash. So when attempting to <code class=\"notranslate\">to_h</code> and compare the results are silently wrong and confusing.</p>\n<p dir=\"auto\">Specifically:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&gt; object = ActiveSupport::InheritableOptions.new(key: :value)\n=&gt; {}\n&gt; object.to_h\n=&gt; {}\n&gt; object[:key]\n=&gt; :value\"><pre class=\"notranslate\">&gt; <span class=\"pl-s1\">object</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">InheritableOptions</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">key</span>: <span class=\"pl-pds\">:value</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-s1\">object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_h</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-s1\">object</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:key</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-pds\">:value</span></pre></div>\n<h2 dir=\"auto\">Solution</h2>\n<p dir=\"auto\">Override <code class=\"notranslate\">to_h</code>, <code class=\"notranslate\">inspect</code>, and <code class=\"notranslate\">==</code> in order to merge the parent hash and self hash, and then behave like a hash.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a></p>",
            "url": "https://github.com/rails/rails/pull/50151",
            "title": "Improve `ActiveSupport::InheritableOptions` hash-like behaviour",
            "date_modified": "2023-11-24T17:59:52.000Z",
            "date_published": "2023-11-23T17:55:54.000Z",
            "author": {
                "name": "kmcphillips",
                "url": "https://github.com/kmcphillips"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/84159?u=611f8cb6bdccc221b89e645b60cb8471d9269ada&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">Problem</h2>\n<p dir=\"auto\">In <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1994508902\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50064\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50064/hovercard\" href=\"https://github.com/rails/rails/pull/50064\">#50064</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2002097869\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50112\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50112/hovercard\" href=\"https://github.com/rails/rails/pull/50112\">#50112</a> we have changed the way Active Record database adapters are expected to register themselves with the framework in order to be loaded.</p>\n<p dir=\"auto\">Previously it was by convention, as Jean so eloquently defined it as \"byzantine\":</p>\n<ul dir=\"auto\">\n<li>They must be defined in <code class=\"notranslate\">active_record/connection_adapters/&lt;name&gt;_adapter</code></li>\n<li>They must define <code class=\"notranslate\">ConnectionHandling.&lt;name&gt;_adapter_class</code></li>\n<li>They must define <code class=\"notranslate\">ConnectionHandling.&lt;name&gt;_connection</code></li>\n</ul>\n<p dir=\"auto\">Now they must explicitly call <code class=\"notranslate\">ActiveRecord::ConnectionAdapters.register</code> and do not need to fit this convention.</p>\n<p dir=\"auto\">Rails has updated its internal adapters, and we will attempt to notify known maintainers of adapters. But there are plenty of use cases for private adapters we do not know about or cannot know about.</p>\n<p dir=\"auto\">The issue with that is the error message is pretty generic \"this adapter does not exist, be sure to add it to the gemfile\" which is correct for most <em>users</em> but not correct for <em>maintainers</em>. We want to make <strong>updating as clear and easy as possible</strong>. The code change is pretty small, but knowing where and how to make that change is the hard part.</p>\n<h2 dir=\"auto\">Solution</h2>\n<p dir=\"auto\">Add a transitionary block of extra error handling and messaging to explain how to update the adapters.</p>\n<p dir=\"auto\">When calling <code class=\"notranslate\">resolve(\"some_adapter\")</code> and it is not found, before raising the generic error first try to require that adapter in the legacy location. If it is found raise a better error explaining exactly how to update the adapter.</p>\n<p dir=\"auto\">The tricky part is that just because a file with that name exists, does not necessarily mean that file is an adapter. So to be extra sure we check for the existence of an adapter method. If it's not there raise a slightly different error message.</p>\n<p dir=\"auto\">Hopefully this makes the transition path easier.</p>\n<h2 dir=\"auto\">Questions</h2>\n<p dir=\"auto\">This code can all be deleted, especially the fake test classes, when we move beyond <code class=\"notranslate\">7.2.x</code>. What is the desired way to flag this to be deleted when the next major or minor version is updated on <code class=\"notranslate\">main</code>?</p>\n<p dir=\"auto\">Paired with <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/adrianna-chang-shopify/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/adrianna-chang-shopify\">@adrianna-chang-shopify</a><br>\ncc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a></p>",
            "url": "https://github.com/rails/rails/pull/50150",
            "title": "Add more specific exceptions to warn when an adapter is using legacy adapter format",
            "date_modified": "2023-11-24T12:06:08.000Z",
            "date_published": "2023-11-23T16:12:16.000Z",
            "author": {
                "name": "kmcphillips",
                "url": "https://github.com/kmcphillips"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50125.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2003526083\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50125\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50125/hovercard\" href=\"https://github.com/rails/rails/issues/50125\">#50125</a>.</p>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"645515028\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/39723\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/39723/hovercard\" href=\"https://github.com/rails/rails/pull/39723\">#39723</a> changed bad connection related errors so that we now have some (useful for debugging) details from the original database exceptions lost.</p>\n<p dir=\"auto\"><del>This PR adds original database errors to these new exceptions classes, so we can get the exception details. It also prints these added exceptions messages by default as part of the new exceptions messages.</del></p>",
            "url": "https://github.com/rails/rails/pull/50145",
            "title": "Include exception causes into log messages",
            "date_modified": "2023-11-23T15:25:14.000Z",
            "date_published": "2023-11-23T00:02:56.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/84159?u=611f8cb6bdccc221b89e645b60cb8471d9269ada&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This takes a completely different approach to what I attempted in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2002097869\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50112\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50112/hovercard\" href=\"https://github.com/rails/rails/pull/50112\">#50112</a>, cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a>.</p>\n<h2 dir=\"auto\">Problem</h2>\n<p dir=\"auto\">When using a <code class=\"notranslate\">DATABASE_URL</code> to define a database connection, the deployment env config needs to define the adapter used as part of the URL. The adapter is actually an application level concern, and what the env should care about is the DBMS/protocol (ie. \"this rails app connects to MySQL\" and not \"this rails app connects to MySQL and does it using a specific adapter class\")</p>\n<p dir=\"auto\">The most obvious usecase here is toggling or transitioning between <code class=\"notranslate\">mysql2</code> and <code class=\"notranslate\">trilogy</code> as they are both first party DB adapters including in Rails to connect to MySQL, but the same concern holds true for custom adapters and likely any future adapters.</p>\n<p dir=\"auto\">What the env should be able to do is say <code class=\"notranslate\">DATABASE_URL=mysql://host/db?options=whatever</code> and then have the application decide that <code class=\"notranslate\">mysql -&gt; mysql2</code> or <code class=\"notranslate\">mysql -&gt; trilogy</code> without having to modify the environment.</p>\n<h2 dir=\"auto\">Solution</h2>\n<p dir=\"auto\">Add an Active Record config that provides a mapping from protocol to adapter in database URLs. Use that in the <code class=\"notranslate\">ActiveRecord::DatabaseConfigurations::UrlConfig</code> (the <code class=\"notranslate\">ActiveRecord::DatabaseConfigurations::ConnectionUrlResolver</code> class internally) to map from protocol to adapter.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"config.active_record.protocol_adapters.mysql = &quot;trilogy&quot;\"><pre class=\"notranslate\"><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">active_record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">protocol_adapters</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">mysql</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"trilogy\"</span></pre></div>\n<p dir=\"auto\">Build in some reasonable defaults, including removing a specific <code class=\"notranslate\">postgres</code> -&gt; <code class=\"notranslate\">postgresql</code> hack that was already hardcoded in. In this case:</p>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Protocol</th>\n<th>Adapter</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"notranslate\">mysql</code></td>\n<td><code class=\"notranslate\">mysql2</code></td>\n</tr>\n<tr>\n<td><code class=\"notranslate\">sqlite</code></td>\n<td><code class=\"notranslate\">sqlite3</code></td>\n</tr>\n<tr>\n<td><code class=\"notranslate\">postgres</code></td>\n<td><code class=\"notranslate\">postgresql</code></td>\n</tr>\n</tbody>\n</table>\n<h2 dir=\"auto\">What should reviewers focus on?</h2>\n<ul dir=\"auto\">\n<li>Oh gosh writing good documentation is hard.</li>\n<li>I use <code class=\"notranslate\">ActiveSupport::InheritableOptions</code> but it's not strictly necessary. It provides some indifferent access and reader conveniences, but a hash would work and just be less forgiving.</li>\n<li>I added <code class=\"notranslate\">sqlite</code> to <code class=\"notranslate\">sqlite3</code> but I honestly have no idea if this is correct or reasonable.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50140",
            "title": "Add a `ActiveRecord.protocol_adapters` configuration to map `DATABASE_URL` protocols to adapters at an application level",
            "date_modified": "2023-11-23T19:23:16.000Z",
            "date_published": "2023-11-22T18:26:53.000Z",
            "author": {
                "name": "kmcphillips",
                "url": "https://github.com/kmcphillips"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/583144?u=631960ce25887ba68d4b23810b2478ab8aa55323&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Inspired by <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/casperisfine/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/casperisfine\">@casperisfine</a> change in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1977042369\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49909\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49909/hovercard\" href=\"https://github.com/rails/rails/pull/49909\">#49909</a>.</p>\n<p dir=\"auto\">For codebases using <code class=\"notranslate\">ActiveSupport::Duration</code> extensively, checking if the duration is negative currently requires going through the <code class=\"notranslate\">method_missing</code> mechanism and a `public_send`` call which can be quite slow.</p>\n<p dir=\"auto\">Instead, we can implement the method natively and get the check executed almost 4x faster.</p>\n<p dir=\"auto\">Here's some benchmark:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"ruby 3.1.1p18 (2022-02-18 revision 53f5fc4236) [arm64-darwin21]\nWarming up --------------------------------------\n           negative?   588.000  i/100ms\n    negative_native?     2.544k i/100ms\nCalculating -------------------------------------\n           negative?      6.738k (± 1.9%) i/s -     34.104k in   5.063211s\n    negative_native?     25.804k (± 1.3%) i/s -    129.744k in   5.028821s\n\nComparison:\n           negative?:     6738.1 i/s\n    negative_native?:    25804.4 i/s - 3.83x  (± 0.00) faster\"><pre class=\"notranslate\"><code class=\"notranslate\">ruby 3.1.1p18 (2022-02-18 revision 53f5fc4236) [arm64-darwin21]\nWarming up --------------------------------------\n           negative?   588.000  i/100ms\n    negative_native?     2.544k i/100ms\nCalculating -------------------------------------\n           negative?      6.738k (± 1.9%) i/s -     34.104k in   5.063211s\n    negative_native?     25.804k (± 1.3%) i/s -    129.744k in   5.028821s\n\nComparison:\n           negative?:     6738.1 i/s\n    negative_native?:    25804.4 i/s - 3.83x  (± 0.00) faster\n</code></pre></div>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"require 'bundler/inline'\n\ngemfile do\n  source 'https://rubygems.org'\n  gem 'benchmark-ips'\n  gem 'activesupport'\nend\n\nrequire 'active_support/all'\n\nclass ActiveSupport::Duration\n  def negative_native?\n    @value &lt; 0\n  end\nend\n\nvalues = 1000.times.map do |i|\n  rand(-100..100).hours\nend\n\nputs RUBY_DESCRIPTION\nBenchmark.ips do |x|\n  x.report(&quot;negative?&quot;) do\n    values.each do |v|\n      v.negative?\n    end\n  end\n\n  x.report(&quot;negative_native?&quot;) do\n    values.each do |v|\n      v.negative_native?\n    end\n  end\n\n  x.compare!(order: :baseline)\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">require</span> <span class=\"pl-s\">'bundler/inline'</span>\n\n<span class=\"pl-en\">gemfile</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">source</span> <span class=\"pl-s\">'https://rubygems.org'</span>\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'benchmark-ips'</span>\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">'activesupport'</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">'active_support/all'</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">Duration</span>\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">negative_native?</span>\n    <span class=\"pl-c1\">@value</span> &lt; <span class=\"pl-c1\">0</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-s1\">values</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">1000</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">times</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">map</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">i</span>|\n  <span class=\"pl-en\">rand</span><span class=\"pl-kos\">(</span>-<span class=\"pl-c1\">100</span>..<span class=\"pl-c1\">100</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">hours</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-en\">puts</span> <span class=\"pl-c1\">RUBY_DESCRIPTION</span>\n<span class=\"pl-v\">Benchmark</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">ips</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">x</span>|\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"negative?\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">values</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">each</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">v</span>|\n      <span class=\"pl-s1\">v</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">negative?</span>\n    <span class=\"pl-k\">end</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">report</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"negative_native?\"</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n    <span class=\"pl-s1\">values</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">each</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">v</span>|\n      <span class=\"pl-s1\">v</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">negative_native?</span>\n    <span class=\"pl-k\">end</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-s1\">x</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">compare!</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">order</span>: <span class=\"pl-pds\">:baseline</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">end</span></pre></div>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This pull request implements <code class=\"notranslate\">ActiveSupport::Duration#negative?</code> without relying on <code class=\"notranslate\">method_missing</code> and <code class=\"notranslate\">public_send</code>.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50136",
            "title": "Implement `Duration#negative?` without calling `public_send`",
            "date_modified": "2023-11-23T07:49:30.000Z",
            "date_published": "2023-11-22T16:55:13.000Z",
            "author": {
                "name": "Morriar",
                "url": "https://github.com/Morriar"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Ref <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2003526083\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50125\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50125/hovercard\" href=\"https://github.com/rails/rails/issues/50125\">#50125</a></p>\n<p dir=\"auto\">A <a href=\"https://github.com/rails/rails/commit/b28711ffa015217e2c24c87152a2f37d8aca1c83\">previous change</a> added a more specific interface for some database connection errors, with the goal to provide Actionable Errors for some of these issues in development. However, the errors concerning not being able to connect to a specified hostname ended up displaying less information than before. Now, they only display the hostname instead of also including the port, even though that information is also very necessary when debugging connection issues.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit adds the port to the messages concerning hostname so that a more \"complete\" hostname is displayed to the user on connection issues.</p>\n<h3 dir=\"auto\">Additional Information</h3>\n<p dir=\"auto\">Since the referenced commit first appeared in 7.0, I would love for this to be backported to 7-1-stable and 7-0-stable.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50135",
            "title": "Fix port not displayed on host connection errors",
            "date_modified": "2023-11-22T23:51:12.000Z",
            "date_published": "2023-11-22T14:56:51.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/894561?u=4c52a73ff17f698d354319cb61b302d38ca4a923&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">In short, this change makes it so that using ActiveRecord::Associations::Preloader doesn't overwrite / lose state.</p>\n<p dir=\"auto\">Right now, here is how things are:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"post = Post.last\npost.comments.build\nActiveRecord::Associations::Preloader.new(records: [post], associations: :comment)\npost.comments.to_a\"><pre class=\"notranslate\"><span class=\"pl-s1\">post</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">last</span>\n<span class=\"pl-s1\">post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">comments</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">build</span>\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Associations</span>::<span class=\"pl-v\">Preloader</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">records</span>: <span class=\"pl-kos\">[</span><span class=\"pl-s1\">post</span><span class=\"pl-kos\">]</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">associations</span>: <span class=\"pl-pds\">:comment</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-s1\">post</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">comments</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_a</span></pre></div>\n<p dir=\"auto\">The last line would not return the comment that was built. This is unintuitive and was changed in Rails 6.0. In Rails 5.2, this code behave as one would expect and still contains the persisted comment.</p>\n<p dir=\"auto\">Considering that the commit that introduced this behaviors was to fix a problem that, it turns out, was also fixed differently, this change is just a partial revert of said commit with no ill effects.</p>\n<p dir=\"auto\">It would be nice to backport this to at least 7.1 since it's so new. The code hasn't changed since Rails 7.0 so that would be easy too. I'm willing to do it if there is openness to such a backport.</p>\n<h3 dir=\"auto\">Investigation</h3>\n<p dir=\"auto\">In effect, this PR undoes changes made in <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/5f9e05048d409b9c3fb35a3620fe361fb03dd4e1/hovercard\" href=\"https://github.com/rails/rails/commit/5f9e05048d409b9c3fb35a3620fe361fb03dd4e1\"><tt>5f9e050</tt></a> which introduced this bug.</p>\n<p dir=\"auto\">Here is the story:</p>\n<p dir=\"auto\">Starting after Rails 5.2</p>\n<p dir=\"auto\">(Bug1) If you have 2 distinct but equal records given to preload, only one of them will receive the preloaded records.</p>\n<p dir=\"auto\">(BugfixA) <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/9897f50ae77d5880bac292ac35873490669fc107/hovercard\" href=\"https://github.com/rails/rails/commit/9897f50ae77d5880bac292ac35873490669fc107\"><tt>9897f50</tt></a><br>\nThis fixes Bug1. The #uniq was removing the extra distinct but equal records, so only one of them would receive sub-records in its associations.<br>\nBut there is a new bug!</p>\n<p dir=\"auto\">(Bug2) If you have a single instance twice in the records to preload on, it receives the sub-records multiple time.</p>\n<p dir=\"auto\">(BugfixB): <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/5f9e05048d409b9c3fb35a3620fe361fb03dd4e1/hovercard\" href=\"https://github.com/rails/rails/commit/5f9e05048d409b9c3fb35a3620fe361fb03dd4e1\"><tt>5f9e050</tt></a><br>\nThis fixes Bug2. And is what I am reverting.<br>\nInstead of adding the preloaded data to what was already in the association, the received data overwrites the data that was already there.<br>\nBut there is a new bug!</p>\n<p dir=\"auto\">(Bug3) If you had unpersisted data in the association being preloaded (using #build for example), it will be gone!<br>\nThis is the bug this PR wants to fix.</p>\n<p dir=\"auto\">(BugfixC) <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/rails/rails/commit/a4b20e4ffcdc9726f210c4e828927768497d7392/hovercard\" href=\"https://github.com/rails/rails/commit/a4b20e4ffcdc9726f210c4e828927768497d7392\"><tt>a4b20e4</tt></a><br>\n<strong>This fix doesn't resolve Bug3.</strong><br>\nBut it also fixes Bug2, and does it more correctly. It does a better <code class=\"notranslate\">#uniq</code> than the one that was removed by BugfixA due to Bug1.<br>\nUnlike BugfixB, BuugfixC doesn't introduce Bug3.</p>\n<p dir=\"auto\">So at this point, it's safe to undo BugfixB, at least the part that causes Bug3:</p>\n<ul dir=\"auto\">\n<li>Bug2 doesn't get brought back because BugfixC also fixes it.</li>\n</ul>\n<p dir=\"auto\">This is what this PR is doing, while also adding tests.</p>\n<p dir=\"auto\">I'd like to thank <code class=\"notranslate\">git bisect</code> for making this investigation so much simpler than it would have been otherwise xD</p>",
            "url": "https://github.com/rails/rails/pull/50129",
            "title": "Preloader should no longer overwrites built records",
            "date_modified": "2023-11-22T14:53:48.000Z",
            "date_published": "2023-11-22T02:54:25.000Z",
            "author": {
                "name": "MaxLap",
                "url": "https://github.com/MaxLap"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6090?u=90ecdaa75b7e5aa0be2d4352c07c843c22450ac7&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request has been created because I was looking at the ActionPack test suite and found a few fixture files that are not used anymore.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul dir=\"auto\">\n<li>[ X ] This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li>[ N/A ] Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li>[ N/A ] Tests are added or updated if you fix a bug or add a feature.</li>\n<li>[ N/A ] CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50128",
            "title": "Removing not used fixtures from ActionPack test suite",
            "date_modified": "2023-11-22T02:02:16.000Z",
            "date_published": "2023-11-22T02:02:12.000Z",
            "author": {
                "name": "thiagopradi",
                "url": "https://github.com/thiagopradi"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/2575027?u=e7a9fe052c03fa59da09e064fdfacf2b1f627c2f&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">Generate the text-only label contents for a field:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"  # Helper method\n  field_label :article, :title    # =&gt; &quot;Title&quot;\n\n  # FormBuilder method\n  fields model: @article do |form|\n    form.label :title             # =&gt; &quot;&lt;label for=\\&quot;article_title\\&quot;&gt;Title&lt;/label&gt;&quot;\n    form.field_label :title       # =&gt; &quot;Title&quot;\n  end\"><pre class=\"notranslate\">  <span class=\"pl-c\"># Helper method</span>\n  <span class=\"pl-en\">field_label</span> <span class=\"pl-pds\">:article</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">:title</span>    <span class=\"pl-c\"># =&gt; \"Title\"</span>\n\n  <span class=\"pl-c\"># FormBuilder method</span>\n  <span class=\"pl-en\">fields</span> <span class=\"pl-pds\">model</span>: <span class=\"pl-c1\">@article</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">form</span>|\n    <span class=\"pl-s1\">form</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">label</span> <span class=\"pl-pds\">:title</span>             <span class=\"pl-c\"># =&gt; \"&lt;label for=\\\"article_title\\\"&gt;Title&lt;/label&gt;\"</span>\n    <span class=\"pl-s1\">form</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">field_label</span> <span class=\"pl-pds\">:title</span>       <span class=\"pl-c\"># =&gt; \"Title\"</span>\n  <span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">This can be useful when utilizing <code class=\"notranslate\">[aria-label]</code> in rare circumstances where rendering a <code class=\"notranslate\">&lt;label&gt;</code> element for a form control isn't feasible.</p>\n<p dir=\"auto\">Prior to this commit, invoking <code class=\"notranslate\">label_tag</code> or <code class=\"notranslate\">form.label</code> was the only way to automatically determine a form control's (internationalized!) label text without providing call-site specific content (via a String argument or a block). Even with that automatic determination, the text content is nested within a <code class=\"notranslate\">&lt;label&gt;</code> element.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">With this change, views can separate the content text from the element for circumstances where they need to craft their own <code class=\"notranslate\">[aria-label]</code> text based on the out-of-the-box translated label text:</p>\n<div class=\"highlight highlight-text-html-erb notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&lt;%= form_with model: @post do |form| %&gt;\n  &lt;%# a typical &lt;label&gt; + &lt;input&gt; combination %&gt;\n  &lt;%= form.label :title %&gt;\n  &lt;%= form.text_field :title %&gt;\n\n  &lt;%# an &lt;input&gt; with [aria-label] text %&gt;\n  &lt;%= form.text_field :title, aria: { label: form.field_label(:title) } %&gt;\n\n  &lt;%# a typical &lt;label&gt; + &lt;input&gt; combination with additional [aria-label] text %&gt;\n  &lt;%= form.label :title %&gt;\n  &lt;%= form.text_field :title, aria: {\n        label: &quot;#{form.field_label(:title)}, and then some additional text to be announced&quot;\n      } %&gt;\n&lt;% end %&gt;\"><pre class=\"notranslate\"><span class=\"pl-k\">&lt;%=</span> form_with model: @post do |form| <span class=\"pl-k\">%&gt;</span><span class=\"pl-c\"><span class=\"pl-k\"></span></span>\n<span class=\"pl-c\"><span class=\"pl-k\">  &lt;%#</span> a typical &lt;label&gt; + &lt;input&gt; combination <span class=\"pl-k\">%&gt;</span></span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">  &lt;%=</span> form.label :title <span class=\"pl-k\">%&gt;</span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">  &lt;%=</span> form.text_field :title <span class=\"pl-k\">%&gt;</span><span class=\"pl-c\"><span class=\"pl-k\"></span></span>\n<span class=\"pl-c\"><span class=\"pl-k\"></span></span>\n<span class=\"pl-c\"><span class=\"pl-k\">  &lt;%#</span> an &lt;input&gt; with [aria-label] text <span class=\"pl-k\">%&gt;</span></span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">  &lt;%=</span> form.text_field :title, aria: { label: form.field_label(:title) } <span class=\"pl-k\">%&gt;</span><span class=\"pl-c\"><span class=\"pl-k\"></span></span>\n<span class=\"pl-c\"><span class=\"pl-k\"></span></span>\n<span class=\"pl-c\"><span class=\"pl-k\">  &lt;%#</span> a typical &lt;label&gt; + &lt;input&gt; combination with additional [aria-label] text <span class=\"pl-k\">%&gt;</span></span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">  &lt;%=</span> form.label :title <span class=\"pl-k\">%&gt;</span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">  &lt;%=</span> form.text_field :title, aria: {\n        label: \"#{form.field_label(:title)}, and then some additional text to be announced\"\n      } <span class=\"pl-k\">%&gt;</span><span class=\"pl-k\"></span>\n<span class=\"pl-k\">&lt;%</span> end <span class=\"pl-k\">%&gt;</span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-c1\"></span><span class=\"pl-k\"></span><span class=\"pl-s1\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-kos\"></span><span class=\"pl-pds\"></span><span class=\"pl-kos\"></span><span class=\"pl-pds\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-kos\"></span><span class=\"pl-pds\"></span><span class=\"pl-kos\"></span><span class=\"pl-kos\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-pds\"></span><span class=\"pl-kos\"></span><span class=\"pl-pds\"></span><span class=\"pl-kos\"></span><span class=\"pl-pds\"></span><span class=\"pl-s\"><span class=\"pl-s1\"><span class=\"pl-kos\"></span><span class=\"pl-s1\"></span><span class=\"pl-kos\"></span><span class=\"pl-en\"></span><span class=\"pl-kos\"></span><span class=\"pl-pds\"></span><span class=\"pl-kos\"></span><span class=\"pl-kos\"></span></span></span><span class=\"pl-kos\"></span><span class=\"pl-k\"></span></pre></div>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50124",
            "title": "Introduce `field_label` form helper",
            "date_modified": "2023-11-21T04:10:03.000Z",
            "date_published": "2023-11-21T03:58:55.000Z",
            "author": {
                "name": "seanpdoyle",
                "url": "https://github.com/seanpdoyle"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/42748004?u=a2f943e4a20b708d6e082b99f8ee277189dce7cf&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">From <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1692891902\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/48111\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/48111/hovercard?comment_id=1531952728&amp;comment_type=issue_comment\" href=\"https://github.com/rails/rails/pull/48111#issuecomment-1531952728\">#48111 (comment)</a>, it was found that there is currently no test coverage for the types of errors when connecting to the db.</p>\n\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This was done by modifying the database configs with invalid host/user/database. As a result, this PR also fixes the error code of <code class=\"notranslate\">ER_DBACCESS_DENIED_ERROR</code> to return a no database error instead of a username error.</p>\n<p dir=\"auto\">**Looking into the CI error 👀</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50123",
            "title": "Add error connection tests for various db adapters",
            "date_modified": "2023-11-21T13:11:37.000Z",
            "date_published": "2023-11-21T01:16:33.000Z",
            "author": {
                "name": "jenshenny",
                "url": "https://github.com/jenshenny"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/38864576?u=6bbb80e5c3a3a5bd70f1be00a243893056738e3e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">Using the current <code class=\"notranslate\">Interceptor</code> and <code class=\"notranslate\">Observer</code> registering examples trigger deprecation warnings. The ones I proposed instead are similar to what is recommended in the <code class=\"notranslate\">ActionMailer</code> <a href=\"https://guides.rubyonrails.org/configuring.html#config-action-mailer-observers\" rel=\"nofollow\">configuration guide</a>.</p>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50115",
            "title": "Update interceptors and observers registering examples",
            "date_modified": "2023-11-22T01:02:28.000Z",
            "date_published": "2023-11-20T16:03:13.000Z",
            "author": {
                "name": "bear-in-mind",
                "url": "https://github.com/bear-in-mind"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/10277857?u=62b279cd191760111ca30d53d3be2c688014c1f7&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\"><a href=\"https://www.ietf.org/rfc/rfc7396.txt\" rel=\"nofollow\">RFC 7396 JSON Merge Patch</a> defines the JSON merge patch format and processing rules and registers <code class=\"notranslate\">application/merge-patch+json</code> as additional MIME media type. It expects the same encoding of <code class=\"notranslate\">application/json</code>.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR proposes adding <code class=\"notranslate\">application/merge-patch+json</code> as an additional recognized MIME subtype for <code class=\"notranslate\">application/json</code>.</p>\n<h3 dir=\"auto\">Additional information</h3>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50114",
            "title": "Add `application/merge-patch+json` as subtype for `application/json`",
            "date_modified": "2023-11-20T15:07:57.000Z",
            "date_published": "2023-11-20T15:07:53.000Z",
            "author": {
                "name": "kemuridama",
                "url": "https://github.com/kemuridama"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/84159?u=611f8cb6bdccc221b89e645b60cb8471d9269ada&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Continuation of <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1994508902\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50064\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50064/hovercard\" href=\"https://github.com/rails/rails/pull/50064\">#50064</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2000421714\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50093\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50093/hovercard\" href=\"https://github.com/rails/rails/pull/50093\">#50093</a> with <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a></p>\n<p dir=\"auto\">This adds the <code class=\"notranslate\">mysql://</code> or <code class=\"notranslate\">adapter: mysql</code> alias to be put in DB config or deploy ENV, and then allows the application to be configured to either use <code class=\"notranslate\">mysql2</code> or <code class=\"notranslate\">trilogy</code> as the concrete adapter. This separates environment config (ie. \"this app uses MySQL and here are the credentials\") from adapter choice and implementation (ie. \"connect to the database from the app using trilogy or mysql2\"). It also provides an easy test/upgrade path without changing the env.</p>\n<p dir=\"auto\">It makes <code class=\"notranslate\">mysql</code> the default adapter generated for new rails apps that use MySQL, but it keeps <code class=\"notranslate\">mysql2</code> as the default adapter used. It's a different approach than <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2001754105\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50110\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50110/hovercard\" href=\"https://github.com/rails/rails/pull/50110\">#50110</a> but here it's easily swappable as to which generates by default.</p>\n<h3 dir=\"auto\">Is <code class=\"notranslate\">alias</code> really necessary?</h3>\n<p dir=\"auto\">I proposed adding this once before and discussed it with Matthew and we decided to remove it. <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2000421714\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50093\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50093/hovercard?comment_id=1817531767&amp;comment_type=issue_comment\" href=\"https://github.com/rails/rails/pull/50093#issuecomment-1817531767\">#50093 (comment)</a></p>\n<p dir=\"auto\">I've added it back here for a couple reasons.</p>\n<p dir=\"auto\">The <code class=\"notranslate\">ActiveRecord::ConnectionAdapters</code> does not expose what the class name and path are for registered adapters. Since you cannot query that you cannot retrieve those two values to add an alias, so you'd need to be repeating those configuration strings in wherever you add the alias through <code class=\"notranslate\">register()</code>.</p>\n<p dir=\"auto\">It would also mean we would need to somewhere (like in an initializer) define a switch statement like:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"case ActiveRecord.mysql_adapter\nwhen :trilogy, &quot;trilogy&quot;\n  ActiveRecord::ConnectionAdapters.register(&quot;mysql&quot;, &quot;ActiveRecord::ConnectionAdapters::TrilogyAdapter&quot;, &quot;active_record/connection_adapters/trilogy_adapter&quot;)\nwhen :mysql2, &quot;mysql2&quot;\n  ActiveRecord::ConnectionAdapters.register(&quot;mysql2&quot;, &quot;ActiveRecord::ConnectionAdapters::Mysql2Adapter&quot;, &quot;active_record/connection_adapters/mysql2_adapter&quot;)\nwhen nil\n  # noop\nelse\n  raise &quot;uknown adapter etc.&quot;\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">case</span> <span class=\"pl-v\">ActiveRecord</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">mysql_adapter</span>\n<span class=\"pl-k\">when</span> <span class=\"pl-pds\">:trilogy</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"trilogy\"</span>\n  <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">ConnectionAdapters</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">register</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"mysql\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"ActiveRecord::ConnectionAdapters::TrilogyAdapter\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"active_record/connection_adapters/trilogy_adapter\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">when</span> <span class=\"pl-pds\">:mysql2</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"mysql2\"</span>\n  <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">ConnectionAdapters</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">register</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"mysql2\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"ActiveRecord::ConnectionAdapters::Mysql2Adapter\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-s\">\"active_record/connection_adapters/mysql2_adapter\"</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-k\">when</span> <span class=\"pl-c1\">nil</span>\n  <span class=\"pl-c\"># noop</span>\n<span class=\"pl-k\">else</span>\n  <span class=\"pl-en\">raise</span> <span class=\"pl-s\">\"uknown adapter etc.\"</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">This reimplements some of the connection lookup validation and the location/class names of the adapters. It is very much not <strong>DRY</strong>.  It is also not <strong>open/closed</strong> as this is extremely not open for extension as we cannot easily add to the list. I could not write code that I was happy with without this.</p>\n<h3 dir=\"auto\">Why is the default <code class=\"notranslate\">mysql_adapter</code> config <code class=\"notranslate\">nil</code>?</h3>\n<p dir=\"auto\">I'm a little unsure on what the best behaviour is here. If we set <code class=\"notranslate\">ActiveRecord.mysql_adapter = :trilogy</code> or whatever as default, the initializer attempts to alias to it no matter what. So if the app is using Postgres or SQLite it will reference the MySQL adapter(s) that are not loaded and raise.</p>\n<p dir=\"auto\">But because the aliasing must be done before the adapters are loaded, <em>we do not know if we are using MySQL in the app or not</em>. So, the default is <code class=\"notranslate\">nil</code> and it does nothing, but the <em>default generated app adds the config</em>. That makes it easy to update later.</p>\n<h3 dir=\"auto\">Should the default be <code class=\"notranslate\">:trilogy</code>?</h3>\n<p dir=\"auto\">I don't know! That's a Rails vision/direction question. Easy to change that here (or soon after).</p>",
            "url": "https://github.com/rails/rails/pull/50112",
            "title": "Allow the MySQL adapter implementation to be configured in an Active Record config",
            "date_modified": "2023-11-22T18:28:14.000Z",
            "date_published": "2023-11-20T12:29:19.000Z",
            "author": {
                "name": "kmcphillips",
                "url": "https://github.com/kmcphillips"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/530941?u=8a110e767c1f487f7c7979170a6ffb85fbef3be5&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">This Pull Request addresses a regression introduced in PR <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1630083113\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/47708\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/47708/hovercard\" href=\"https://github.com/rails/rails/pull/47708\">#47708</a>, where the error message for an excessively long password was changed to a less informative \"is too long\". Previously, the error message included a dynamic count of the maximum allowed characters (e.g., \"is too long (maximum is %{count} characters)\"). This regression affects the user experience by providing less guidance on how to correct the input. Restoring the informative error message helps developers and users understand the validation constraints.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request makes the following changes:</p>\n<ul dir=\"auto\">\n<li>It restores the <code class=\"notranslate\">count</code> parameter in the error message for a password exceeding the maximum length, ensuring users receive a detailed response (\"is too long (maximum is %{count} characters)\").</li>\n<li>It reverts the validation error symbol from <code class=\"notranslate\">:password_too_long</code> back to <code class=\"notranslate\">:too_long</code> within <code class=\"notranslate\">activemodel/lib/active_model/secure_password.rb</code>.</li>\n<li>It removes the <code class=\"notranslate\">:password_too_long</code> key from <code class=\"notranslate\">activemodel/lib/active_model/locale/en.yml</code> to align with the use of the <code class=\"notranslate\">:too_long</code> symbol.</li>\n</ul>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">The change is straightforward and restores functionality to its previous state as of v7.1.0.beta1, ensuring that the error message for password length validation is both informative and accurate.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>\n<hr>\n<p dir=\"auto\">This PR was co-authored by ChatGPT.</p>",
            "url": "https://github.com/rails/rails/pull/50109",
            "title": "Restore detailed error message for excessive password length",
            "date_modified": "2023-11-21T08:24:05.000Z",
            "date_published": "2023-11-20T00:33:04.000Z",
            "author": {
                "name": "cabgfx",
                "url": "https://github.com/cabgfx"
            }
        }
    ]
}