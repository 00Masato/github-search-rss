{
    "version": "https://jsonfeed.org/version/1",
    "title": "rails/rails pr",
    "home_page_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "feed_url": "https://00masato.github.io/github-search-rss/rails-pr.json",
    "description": "rails/rails pr on GitHub",
    "items": [
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/131752?u=32ddf1119b1d189c9bd241a721b36ea01c29f61e&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">When we reap connections, we check if they are inactive (connected and responding to ping in most adapters) and if so we remove the connection instead of checking it back in.</p>\n<p dir=\"auto\">However, in acquire_connection, we weren't checking after reaping whether we were allowed to build a new connection, only whether an existing one was in the available pool.</p>\n<p dir=\"auto\">This still leaves a race condition where if the background reaper thread runs while a thread is polling and finds a free inactive connection, it could have the same issue and not wake the waiting thread. However we don't really expect the reaper to solve this (it only runs every 60 seconds by default, far too slow to solve for a blocked thread). I think this should be fixed, just separately (and would probably involve some more significant refactoring).</p>\n<p dir=\"auto\"><a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/joeldrapper/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/joeldrapper\">@joeldrapper</a> showed me an example usage at RubyConf San Diego, which may have been caused (or at least worsened) by this bug. So ðŸ¤ž this helps.</p>\n<p dir=\"auto\">Thanks to advice from <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/composerinteralia/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/composerinteralia\">@composerinteralia</a> and <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a></p>\n<p dir=\"auto\">I think we should backport this to 7-1-stable.</p>",
            "url": "https://github.com/rails/rails/pull/50190",
            "title": "Retry new connection on checkout after reap",
            "date_modified": "2023-11-27T23:14:47.000Z",
            "date_published": "2023-11-27T23:14:43.000Z",
            "author": {
                "name": "jhawthorn",
                "url": "https://github.com/jhawthorn"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">The CI env var was recently <a href=\"https://github.com/rails/rails/commit/1f0262aa2b768b14de5e6ef29d0e547628f570ee\">changed</a> to be specific for the application being tested instead of the framework tests. Because of this, these lines which should have been true before are now false.</p>\n<p dir=\"auto\">Note: I expect this to fail CI because <code class=\"notranslate\">skip</code>s will raise now, I'll update with the fixes</p>",
            "url": "https://github.com/rails/rails/pull/50188",
            "title": "Fix test infra depending on CI=true",
            "date_modified": "2023-11-27T23:25:28.000Z",
            "date_published": "2023-11-27T22:43:32.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22231095?u=fc75f9764434943effe06d6c1dc48d40a5003b0c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request adds the markup code highlight for bash script in readme.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50181",
            "title": "Add markdown code highlight for bash script [skip ci]",
            "date_modified": "2023-11-27T14:59:56.000Z",
            "date_published": "2023-11-27T14:58:37.000Z",
            "author": {
                "name": "akhilgkrishnan",
                "url": "https://github.com/akhilgkrishnan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22231095?u=fc75f9764434943effe06d6c1dc48d40a5003b0c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Followup: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2011716333\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50178\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50178/hovercard\" href=\"https://github.com/rails/rails/pull/50178\">#50178</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request updates the the <code class=\"notranslate\">highlight</code>  text helper documentation. Separated the options and examples in different section.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50179",
            "title": "Improve documentation for highlight text helper [skip ci]",
            "date_modified": "2023-11-27T08:35:56.000Z",
            "date_published": "2023-11-27T08:35:20.000Z",
            "author": {
                "name": "akhilgkrishnan",
                "url": "https://github.com/akhilgkrishnan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22231095?u=fc75f9764434943effe06d6c1dc48d40a5003b0c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">Followup: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2009069154\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50153\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50153/hovercard\" href=\"https://github.com/rails/rails/pull/50153\">#50153</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request updates the the <code class=\"notranslate\">truncate</code> text helper documentation. Separated the options and examples in different section.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50178",
            "title": "Improve documentation for truncate text helper [skip ci]",
            "date_modified": "2023-11-27T08:02:22.000Z",
            "date_published": "2023-11-27T08:02:18.000Z",
            "author": {
                "name": "akhilgkrishnan",
                "url": "https://github.com/akhilgkrishnan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1371733?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #39921.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"665167157\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/39921\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/39921/hovercard\" href=\"https://github.com/rails/rails/issues/39921\">#39921</a> cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/zzak/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zzak\">@zzak</a></p>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This PR has been created to fix an old issue with VIPS not supporting JFIF. This makes creating variants for JFIF files impossible ( more details in the issue)</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">At the ImageProcessing transformer level, we reformat the \"format\" variable that's passed to the <code class=\"notranslate\">convert</code> call from jfif to jpg, only when the image processor is vips.</p>\n<p dir=\"auto\">At first, I tried renaming the tempfile from jfif to jpg. But It had no effect.</p>\n<p dir=\"auto\">Then I realized that the <code class=\"notranslate\">{ format:  'jfif' }</code> was passed here:<br>\n</p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/9f18c0469777907206954bf2a8cc31141fd60734/activestorage/app/models/active_storage/blob/representable.rb#L36\">rails/activestorage/app/models/active_storage/blob/representable.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n         Line 36\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/9f18c0469777907206954bf2a8cc31141fd60734\">9f18c04</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L36\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"36\"></td>\n          <td id=\"LC36\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-en\">variant_class</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-smi\">self</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">ActiveStorage</span>::<span class=\"pl-v\">Variation</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">wrap</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">transformations</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">default_to</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">default_variant_transformations</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<p dir=\"auto\">I thought about maybe refactoring here but since this is a vips issue related to the ImageProcessingTransformer, I migrated the \"mapping\" logic directly there to have minimal impact on apps.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"Marcel::Magic.new('image/jpeg').extensions \n# =&gt; [&quot;jpg&quot;, &quot;jpeg&quot;, &quot;jpe&quot;, &quot;jif&quot;, &quot;jfif&quot;, &quot;jfi&quot;]\"><pre class=\"notranslate\"><span class=\"pl-v\">Marcel</span>::<span class=\"pl-v\">Magic</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'image/jpeg'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">extensions</span> \n<span class=\"pl-c\"># =&gt; [\"jpg\", \"jpeg\", \"jpe\", \"jif\", \"jfif\", \"jfi\"]</span></pre></div>\n<p dir=\"auto\">I think we can try to make this more dynamic to handle all of <code class=\"notranslate\">image/jpeg</code> extensions what do you think? <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/zzak/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/zzak\">@zzak</a></p>\n<p dir=\"auto\">If you think this is a good idea, i can refactor the tests and the implementation.</p>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50175",
            "title": "[ActiveStorage] Fix JFIF issue with VIPS processor",
            "date_modified": "2023-11-27T14:20:49.000Z",
            "date_published": "2023-11-26T17:10:04.000Z",
            "author": {
                "name": "chaadow",
                "url": "https://github.com/chaadow"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/11690?u=f9c14ce403f3e8f35e163d36d8d2c046cea364f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/>\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">If you have an object that has strict_loading set and then need to call <code class=\"notranslate\">reload</code> multiple times, it would only work the first time, and after that, the application would start throwing a strict loading violation errors.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">To fix this, and keep <code class=\"notranslate\">reload</code> working consistently between calls, we set <code class=\"notranslate\">strict_loading</code>, if the original object has <code class=\"notranslate\">strict_loading</code>, to the reloaded records to avoid the strict loading error.</p>\n<p dir=\"auto\">This wasn't a problem for the first call, because it is using the original associations cache, but it isn't the case for the other calls of <code class=\"notranslate\">reload</code> as they would be using new copies of it, and when the new cache is used to build the list of <code class=\"notranslate\"> strict_loaded_associations</code>, the <code class=\"notranslate\">assoc.owner.strict_loading?</code> check will return <code class=\"notranslate\">false</code>, as this owner is the previous <code class=\"notranslate\">fresh_object</code> reference that doesn't have <code class=\"notranslate\">strict_loading</code> set.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50174",
            "title": "Fix `#reload` consistency issue",
            "date_modified": "2023-11-26T14:26:37.000Z",
            "date_published": "2023-11-26T10:04:44.000Z",
            "author": {
                "name": "sarcilav",
                "url": "https://github.com/sarcilav"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/57004457?u=2190df7e9f78739609f69d2c4b786662b1a29121&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">I've been running into some issues in some projects when calling <code class=\"notranslate\">in_time_zone</code> which behind the scenes calls <code class=\"notranslate\">find_zone!</code>. The cause was always the zone being an empty string, which I would've expected the method to behave in the same way as when passing nil as a parameter.</p>\n<p dir=\"auto\">This Pull Request has been created because in my opinion instead of calling <code class=\"notranslate\">.presence</code> each time we call <code class=\"notranslate\">in_time_zone</code> the <code class=\"notranslate\">find_zone!</code> method should check for the presence of the argument, making sure that what we just passed is not \"equivalent\" to nil.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request changes the <code class=\"notranslate\">find_zone!</code> method to check the <code class=\"notranslate\">zone</code> argument presence before actually trying to find the corresponding time zone.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included. -&gt; Not sure if this counts as a minor bug fix, open to add the CHANGELOG file changes too</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50172",
            "title": "Check zone presence in find_zone!",
            "date_modified": "2023-11-27T02:50:46.000Z",
            "date_published": "2023-11-26T05:37:46.000Z",
            "author": {
                "name": "matiassalles99",
                "url": "https://github.com/matiassalles99"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/22231095?u=fc75f9764434943effe06d6c1dc48d40a5003b0c&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">As per the discussion in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1977635925\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/49925\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/49925/hovercard?comment_id=1819025503&amp;comment_type=issue_comment\" href=\"https://github.com/rails/rails/pull/49925#issuecomment-1819025503\">#49925 (comment)</a>, noticed that its more appropriate to link the api documentation for the each of the action view helper methods to get more information about the methods.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request added the link to the api documentation for action view helpers.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50171",
            "title": "Add link to API documentation for ActionView helper method [skip ci]",
            "date_modified": "2023-11-26T05:26:32.000Z",
            "date_published": "2023-11-26T05:22:44.000Z",
            "author": {
                "name": "akhilgkrishnan",
                "url": "https://github.com/akhilgkrishnan"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/1371733?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #35811.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"427447230\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/35811\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/35811/hovercard\" href=\"https://github.com/rails/rails/issues/35811\">#35811</a><br>\nFollow up to the closed PR <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"428050576\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/35828\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/35828/hovercard\" href=\"https://github.com/rails/rails/pull/35828\">#35828</a></p>\n\n<h3 dir=\"auto\">Motivation / Background</h3>\n\n<p dir=\"auto\">This Pull Request has been created because ActiveStorage db model table names are hardcoded. Making it impossible to be compatible with ActiveRecord prefix/suffix configuration.</p>\n<p dir=\"auto\">What's also problematic is that AS generated migrations ( with <code class=\"notranslate\">activestorage:install</code> task ) respects the prefix/suffix configuration, which makes it then impossible to use AS models in a Rails application.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">To fix this issue we remove the hard coded lines. But then we need to also override an internal method for specifying the prefix. the full explanation is here: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2010725925\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50167\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50167/hovercard?comment_id=1405175059&amp;comment_type=review_comment\" href=\"https://github.com/rails/rails/pull/50167#discussion_r1405175059\">#50167 (comment)</a></p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Some tests were refactored to remove hard coded table name references, making ActiveStorage test suite compatible with ActiveRecord config.</p>\n<p dir=\"auto\"></p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/354d68e8a63b21e47a529105a508411bfe8be869/activerecord/lib/active_record/model_schema.rb#L597-L611\">rails/activerecord/lib/active_record/model_schema.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n        Lines 597 to 611\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/354d68e8a63b21e47a529105a508411bfe8be869\">354d68e</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L597\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"597\"></td>\n          <td id=\"LC597\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">def</span> <span class=\"pl-en\">compute_table_name</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L598\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"598\"></td>\n          <td id=\"LC598\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">if</span> <span class=\"pl-en\">base_class?</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L599\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"599\"></td>\n          <td id=\"LC599\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-c\"># Nested classes are prefixed with singular parent table name.</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L600\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"600\"></td>\n          <td id=\"LC600\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">if</span> <span class=\"pl-en\">module_parent</span> &lt; <span class=\"pl-v\">Base</span> &amp;&amp; !<span class=\"pl-en\">module_parent</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">abstract_class?</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L601\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"601\"></td>\n          <td id=\"LC601\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">       <span class=\"pl-s1\">contained</span> <span class=\"pl-c1\">=</span> <span class=\"pl-en\">module_parent</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">table_name</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L602\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"602\"></td>\n          <td id=\"LC602\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">       <span class=\"pl-s1\">contained</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s1\">contained</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">singularize</span> <span class=\"pl-k\">if</span> <span class=\"pl-en\">module_parent</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">pluralize_table_names</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L603\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"603\"></td>\n          <td id=\"LC603\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">       <span class=\"pl-s1\">contained</span> += <span class=\"pl-s\">\"_\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L604\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"604\"></td>\n          <td id=\"LC604\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L605\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"605\"></td>\n          <td id=\"LC605\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">  </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L606\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"606\"></td>\n          <td id=\"LC606\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-s\">\"<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">full_table_name_prefix</span><span class=\"pl-kos\">}</span></span><span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">contained</span><span class=\"pl-kos\">}</span></span><span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">undecorated_table_name</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">model_name</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">}</span></span><span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-en\">full_table_name_suffix</span><span class=\"pl-kos\">}</span></span>\"</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L607\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"607\"></td>\n          <td id=\"LC607\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">else</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L608\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"608\"></td>\n          <td id=\"LC608\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-c\"># STI subclasses always use their superclass's table.</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L609\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"609\"></td>\n          <td id=\"LC609\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">     <span class=\"pl-en\">base_class</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">table_name</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L610\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"610\"></td>\n          <td id=\"LC610\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\">   <span class=\"pl-k\">end</span> </td>\n        </tr>\n\n        <tr class=\"border-0\">\n          <td id=\"L611\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"611\"></td>\n          <td id=\"LC611\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-k\">end</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<ul dir=\"auto\">\n<li><strong>I believe the root cause lies inside ActiveRecord model schema file</strong> but I can't find the solution... for now ( <strong>EDIT: solution found here: <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2010725925\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50167\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50167/hovercard?comment_id=1405175059&amp;comment_type=review_comment\" href=\"https://github.com/rails/rails/pull/50167#discussion_r1405175059\">#50167 (comment)</a> )</strong></li>\n<li>This issue is also present in action_text, but I want to focus for now on activestorage and make sure it works properly before porting it</li>\n</ul>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50167",
            "title": "[ActiveStorage] Take `ActiveRecord` affixes into account for `ActiveStorage` database models",
            "date_modified": "2023-11-27T14:18:33.000Z",
            "date_published": "2023-11-25T16:45:49.000Z",
            "author": {
                "name": "chaadow",
                "url": "https://github.com/chaadow"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/39539196?u=2c29b6277ad175c1346384ff3fc0c9416dd25010&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><blockquote>\n<p dir=\"auto\">Sometimes, operations on Times returns just float numbers of seconds, so, we<br>\nneed to handle that.<br>\nExample: Time.current - (Time.current + 1.hour) # =&gt; -3600.000001776 (Float)</p>\n</blockquote>\n<p dir=\"auto\">When this happens, it's possible to endup with a pretty large number of seconds, making the ISO 8601 formatted duration to trigger an <code class=\"notranslate\">interval field value out range error</code>.</p>\n<p dir=\"auto\">PostgreSQL 15 has already improved overflow detection when casting values to interval</p>\n<p dir=\"auto\">However, to further reduce the likelihood of such issues and ensure better-formatted duration types, it now implements the construction of <code class=\"notranslate\">ActiveSupport::Duration</code> during the serialization step.</p>\n<p dir=\"auto\">How to reproduce (at least in versions prior to PG 15+):</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"\nrequire &quot;bundler/inline&quot;\n\ngemfile(true) do\n  source &quot;https://rubygems.org&quot;\n\n  git_source(:github) { |repo| &quot;https://github.com/#{repo}.git&quot; }\n\n  gem &quot;rails&quot;, github: &quot;rails/rails&quot;, branch: &quot;main&quot;\n  gem &quot;pg&quot;\nend\n\nrequire &quot;active_record&quot;\nrequire &quot;minitest/autorun&quot;\nrequire &quot;logger&quot;\n\nActiveRecord::Base.establish_connection(\n  adapter: 'postgresql',\n  database: 'postgres',\n  username: 'postgres',\n  host: 'localhost'\n)\n\nActiveRecord::Base.logger = Logger.new(STDOUT)\n\nActiveRecord::Schema.define do\n  create_table :projects, force: true do |t|\n    t.interval :duration\n  end\nend\n\nclass Project &lt; ActiveRecord::Base; end\n\nclass IntervalBugTest &lt; Minitest::Test\n  def test_duration\n    project = Project.create(duration: 70.years)\n    assert_equal 70.years, project.duration\n  end\n\n  def test_duration_error\n    duration = 70.years.ago - Time.now()\n\n    assert_raises ActiveRecord::StatementInvalid do\n      Project.create(duration: duration)\n    end\n  end\nend\"><pre class=\"notranslate\"><span class=\"pl-en\">require</span> <span class=\"pl-s\">\"bundler/inline\"</span>\n\n<span class=\"pl-en\">gemfile</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">true</span><span class=\"pl-kos\">)</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">source</span> <span class=\"pl-s\">\"https://rubygems.org\"</span>\n\n  <span class=\"pl-en\">git_source</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">:github</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> |<span class=\"pl-s1\">repo</span>| <span class=\"pl-s\">\"https://github.com/<span class=\"pl-s1\"><span class=\"pl-kos\">#{</span><span class=\"pl-s1\">repo</span><span class=\"pl-kos\">}</span></span>.git\"</span> <span class=\"pl-kos\">}</span>\n\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">\"rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">github</span>: <span class=\"pl-s\">\"rails/rails\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">branch</span>: <span class=\"pl-s\">\"main\"</span>\n  <span class=\"pl-en\">gem</span> <span class=\"pl-s\">\"pg\"</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"active_record\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"minitest/autorun\"</span>\n<span class=\"pl-en\">require</span> <span class=\"pl-s\">\"logger\"</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">establish_connection</span><span class=\"pl-kos\">(</span>\n  <span class=\"pl-pds\">adapter</span>: <span class=\"pl-s\">'postgresql'</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">database</span>: <span class=\"pl-s\">'postgres'</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">username</span>: <span class=\"pl-s\">'postgres'</span><span class=\"pl-kos\">,</span>\n  <span class=\"pl-pds\">host</span>: <span class=\"pl-s\">'localhost'</span>\n<span class=\"pl-kos\">)</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">logger</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Logger</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-c1\">STDOUT</span><span class=\"pl-kos\">)</span>\n\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Schema</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">define</span> <span class=\"pl-k\">do</span>\n  <span class=\"pl-en\">create_table</span> <span class=\"pl-pds\">:projects</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">force</span>: <span class=\"pl-c1\">true</span> <span class=\"pl-k\">do</span> |<span class=\"pl-s1\">t</span>|\n    <span class=\"pl-s1\">t</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">interval</span> <span class=\"pl-pds\">:duration</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">Project</span> &lt; <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Base</span><span class=\"pl-kos\">;</span> <span class=\"pl-k\">end</span>\n\n<span class=\"pl-k\">class</span> <span class=\"pl-v\">IntervalBugTest</span> &lt; <span class=\"pl-v\">Minitest</span>::<span class=\"pl-v\">Test</span>\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">test_duration</span>\n    <span class=\"pl-s1\">project</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">Project</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">duration</span>: <span class=\"pl-c1\">70</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">years</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-en\">assert_equal</span> <span class=\"pl-c1\">70</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">years</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">project</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">duration</span>\n  <span class=\"pl-k\">end</span>\n\n  <span class=\"pl-k\">def</span> <span class=\"pl-en\">test_duration_error</span>\n    <span class=\"pl-s1\">duration</span> <span class=\"pl-c1\">=</span> <span class=\"pl-c1\">70</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">years</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">ago</span> - <span class=\"pl-v\">Time</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">now</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span>\n\n    <span class=\"pl-en\">assert_raises</span> <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">StatementInvalid</span> <span class=\"pl-k\">do</span>\n      <span class=\"pl-v\">Project</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">create</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">duration</span>: <span class=\"pl-s1\">duration</span><span class=\"pl-kos\">)</span>\n    <span class=\"pl-k\">end</span>\n  <span class=\"pl-k\">end</span>\n<span class=\"pl-k\">end</span></pre></div>\n\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50163",
            "title": "Improve interval overflow protection",
            "date_modified": "2023-11-27T15:21:20.000Z",
            "date_published": "2023-11-24T19:06:06.000Z",
            "author": {
                "name": "EduardoGHdez",
                "url": "https://github.com/EduardoGHdez"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/192252?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50160.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2010004982\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50160\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50160/hovercard\" href=\"https://github.com/rails/rails/issues/50160\">#50160</a></p>\n<h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The <code class=\"notranslate\">object_id</code> name may be used by polymorphic relations where <code class=\"notranslate\">object</code> is the best name, like <code class=\"notranslate\">notification.object</code>. In that case two columns are created: <code class=\"notranslate\">object_id</code> and <code class=\"notranslate\">object_type</code>.</p>\n<p dir=\"auto\">This Pull Request has been created because we have a rails application that uses the <code class=\"notranslate\">object</code> as the polymorphic relationship name, and it seems to be the best name. It was allowed until rails 7.1 and was not breaking anything.</p>\n<p dir=\"auto\">Using the <code class=\"notranslate\">object_id</code> as a column name <a href=\"https://github.com/rails/rails/pull/38990\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/38990/hovercard\">was explicitly allowed here</a></p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This Pull Request removes the <code class=\"notranslate\">object_id</code> from the list of not allowed column names.<br>\nFor the sake of consitency, the comments and tests are updated where relevant to use the <code class=\"notranslate\">__id__</code> method instead.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">The method <code class=\"notranslate\">object_id</code> <a href=\"https://github.com/rails/rails/pull/45883\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/45883/hovercard\">was added to the dangerous method list here</a></p>\n<p dir=\"auto\">Using the <code class=\"notranslate\">object_id</code> as a column name <a href=\"https://github.com/rails/rails/pull/38990\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/38990/hovercard\">was previously explicitly allowed here</a></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50162",
            "title": "Allow `object_id` as a column name for ActiveRecord",
            "date_modified": "2023-11-24T19:55:16.000Z",
            "date_published": "2023-11-24T18:24:05.000Z",
            "author": {
                "name": "misdoro",
                "url": "https://github.com/misdoro"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/6014046?u=3972bfb97451f7f90e051df2e49fb7b8ee83e28d&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">According to the <a href=\"https://html.spec.whatwg.org/multipage/syntax.html#void-elements\" rel=\"nofollow\">HTML5 Spec</a></p>\n<blockquote>\n<p dir=\"auto\">Void elements can't have any contents (since there's no end tag, no<br>\ncontent can be put between the start tag and the end tag).</p>\n</blockquote>\n<p dir=\"auto\">Up to this point, the only special handling of void elements has been to use \"&gt;\" to close them instead of \"/&gt;\" (which is optional but valid according to the spec)</p>\n<blockquote>\n<p dir=\"auto\">Then, if the element is one of the void elements, ... , then there may<br>\nbe a single U+002F SOLIDUS character (/), ... . On void elements, it<br>\ndoes not mark the start tag as self-closing but instead is unnecessary<br>\nand has no effect of any kind.</p>\n</blockquote>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This commit deprecates the ability to pass content (either through the positional \"content\" parameter or a block) to a void element since it is not valid according to the Spec. This has the benefit of both encouraging more correct HTML generation, and also simplifying the method definition of void elements once the deprecation has been removed.</p>\n<p dir=\"auto\">This commit additionally tweaks the signature of \"void_tag_string\" slightly with two changes. The first change is renaming it to be \"self_closing_tag_string\". This is more accurate than \"void_tag_string\" because the definition of \"void element\" is more specific and has more requirements than \"self closing element\". For example, tags in the SVG namespace <em>can</em> be self closing but the \"/\" at the end of the start tag is <em>not</em> optional because they are not void elements. The second change to this method is swapping from a boolean \"self_closing\" parameter to a string \"tag_suffix\" parameter. This enables the void element method definition to specialize the tag_suffix (to just \"&gt;\") without either void elements or self closing elements having to pay the runtime cost of the self_closing conditional since we know at method definition time which suffix each type of tag should use.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50159",
            "title": "Deprecate content for void elements in TagBuilder",
            "date_modified": "2023-11-24T16:46:12.000Z",
            "date_published": "2023-11-24T16:46:08.000Z",
            "author": {
                "name": "skipkayhil",
                "url": "https://github.com/skipkayhil"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50154.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2009113153\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50154\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50154/hovercard\" href=\"https://github.com/rails/rails/issues/50154\">#50154</a>.</p>",
            "url": "https://github.com/rails/rails/pull/50158",
            "title": "Fix defining `alias_attribute` for STI classes with abstract class in the inheritance chain",
            "date_modified": "2023-11-25T00:24:25.000Z",
            "date_published": "2023-11-24T12:22:57.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/14981592?u=11406fb0121b15a93b3305388377a57b4d9c96f9&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">The link for erubis docs seems to be dead for a few years now <a href=\"http://www.kuwata-lab.com/erubis/users-guide.06.html#topics-trimspaces\" rel=\"nofollow\">http://www.kuwata-lab.com/erubis/users-guide.06.html#topics-trimspaces</a>, see <a href=\"http://web.archive.org/web/20230401000000*/http://www.kuwata-lab.com/erubis/users-guide.06.html\" rel=\"nofollow\">Wayback Machine</a>. Even when reading it through a <a href=\"http://web.archive.org/web/20200218190015/http://www.kuwata-lab.com/erubis/users-guide.06.html\" rel=\"nofollow\">working link</a> I'm not sure how it relates to Rails and this config value.</p>\n<p dir=\"auto\">I updated docs to how I understand it currently works.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">Some context at <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"248936605\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/30149\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/30149/hovercard\" href=\"https://github.com/rails/rails/pull/30149\">#30149</a>. To me it looks like this config value should be deprecated and replaced with a boolean since that is how it is excusivly used by rails. </p><div class=\"Box Box--condensed my-2\">\n  <div class=\"Box-header f6\">\n    <p class=\"mb-0 text-bold\">\n      <a href=\"https://github.com/rails/rails/blob/a6099ed2b7a544d8fe67688e8a0f9237847404ee/actionview/lib/action_view/template/handlers/erb.rb#L81\">rails/actionview/lib/action_view/template/handlers/erb.rb</a>\n    </p>\n    <p class=\"mb-0 color-fg-muted\">\n         Line 81\n      in\n      <a data-pjax=\"true\" class=\"commit-tease-sha Link--inTextBlock\" href=\"/rails/rails/commit/a6099ed2b7a544d8fe67688e8a0f9237847404ee\">a6099ed</a>\n    </p>\n  </div>\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper blob-wrapper-embedded data\">\n    <table class=\"highlight tab-size mb-0 js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip=\"\">\n\n        <tbody><tr class=\"border-0\">\n          <td id=\"L81\" class=\"blob-num border-0 px-3 py-0 color-bg-default\" data-line-number=\"81\"></td>\n          <td id=\"LC81\" class=\"blob-code border-0 px-3 py-0 color-bg-default blob-code-inner js-file-line\"> <span class=\"pl-pds\">trim</span>: <span class=\"pl-kos\">(</span><span class=\"pl-smi\">self</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">class</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">erb_trim_mode</span> == <span class=\"pl-s\">\"-\"</span><span class=\"pl-kos\">)</span> </td>\n        </tr>\n    </tbody></table>\n  </div>\n</div>\n<p></p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50157",
            "title": "Update docs for `erb_trim_mode`",
            "date_modified": "2023-11-24T11:54:55.000Z",
            "date_published": "2023-11-24T11:30:51.000Z",
            "author": {
                "name": "Earlopain",
                "url": "https://github.com/Earlopain"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/563294?v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h3 dir=\"auto\">Motivation / Background</h3>\n<p dir=\"auto\">In our codebase, we heavily lean on PostgreSQL stored procedures. These procedures can raise errors through the <code class=\"notranslate\">RAISE</code> statement. We've added custom error codes to these errors so we can throw custom exceptions in our Ruby code. Up until now this has always been a monkey patch to the <code class=\"notranslate\">translate_exception</code> method in the PostgreSQL adapter. The upgrade to Rails 7.1 broke our monkey patch (again), this motivated us to work on a better solution in ActiveRecord.</p>\n<h3 dir=\"auto\">Detail</h3>\n<p dir=\"auto\">This PR introduces the <code class=\"notranslate\">ActiveRecord:Errors</code> registry to manage translations of database specific exceptions to ActiveRecord exceptions. Initially I wanted to only introduce this for custom errors, but after seeing the result I figured we can also use this for all specific translations in the adapters. This cleans up a lot of code and makes it easier to understand the translation.</p>\n<p dir=\"auto\">A translation for an error can be registered in the registry:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"ActiveRecord::Errors.register(&quot;MY0001&quot;, MyCustomException, adapter: ActiveRecord::ConnectionAdapters::PostgreSQL)\nActiveRecord::Errors.register(/connection lost/, CustomConnectionLostException, adapter: ActiveRecord::ConnectionAdapters::PostgreSQL)\nActiveRecord::Errors.register((e)-&gt; { e.kind_of?(Exception) }, MyCustomException, adapter: ActiveRecord::ConnectionAdapters::PostgreSQL)\"><pre class=\"notranslate\"><span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">register</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">\"MY0001\"</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">MyCustomException</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">ConnectionAdapters</span>::<span class=\"pl-v\">PostgreSQL</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">register</span><span class=\"pl-kos\">(</span><span class=\"pl-sr\">/connection lost/</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">CustomConnectionLostException</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">ConnectionAdapters</span>::<span class=\"pl-v\">PostgreSQL</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">Errors</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">register</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">(</span><span class=\"pl-en\">e</span><span class=\"pl-kos\">)</span>-&gt; <span class=\"pl-kos\">{</span> <span class=\"pl-en\">e</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">kind_of?</span><span class=\"pl-kos\">(</span><span class=\"pl-v\">Exception</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">}</span><span class=\"pl-kos\">,</span> <span class=\"pl-v\">MyCustomException</span><span class=\"pl-kos\">,</span> <span class=\"pl-pds\">adapter</span>: <span class=\"pl-v\">ActiveRecord</span>::<span class=\"pl-v\">ConnectionAdapters</span>::<span class=\"pl-v\">PostgreSQL</span><span class=\"pl-kos\">)</span></pre></div>\n<p dir=\"auto\">The <code class=\"notranslate\">AbstractAdapter</code> does a lookup in the registry to find the appropriate ActiveRecord exception. By supporting strings, Regexp and Procs, almost all translation cases in the specific adapters can be replaced.</p>\n<h3 dir=\"auto\">Additional information</h3>\n<p dir=\"auto\">Changing error handling for all database adapters should not be taken lightly. I've checked the test coverage for all errors and found that all errors are covered with tests spread over different test cases.</p>\n<h3 dir=\"auto\">Checklist</h3>\n<p dir=\"auto\">Before submitting the PR make sure the following are checked:</p>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> This Pull Request is related to one change. Changes that are unrelated should be opened in separate PRs.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Commit message has a detailed description of what changed and why. If this PR fixes a related issue include it in the commit message. Ex: <code class=\"notranslate\">[Fix #issue-number]</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> Tests are added or updated if you fix a bug or add a feature.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"\" disabled=\"\" class=\"task-list-item-checkbox\" checked=\"\"> CHANGELOG files are updated for the changed libraries if there is a behavior change or additional feature. Minor bug fixes and documentation changes should not be included.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50156",
            "title": "Introduce ActiveRecord:Errors registry for error translations",
            "date_modified": "2023-11-24T12:22:15.000Z",
            "date_published": "2023-11-24T11:13:12.000Z",
            "author": {
                "name": "edwinv",
                "url": "https://github.com/edwinv"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/84159?u=611f8cb6bdccc221b89e645b60cb8471d9269ada&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">Problem</h2>\n<p dir=\"auto\">Some behaviours for <code class=\"notranslate\">ActiveSupport::InheritableOptions</code> are unintuitive because it implements hash lookup like so:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"def initialize\n  super() { |h, k| parent[k] }\nend\"><pre class=\"notranslate\"><span class=\"pl-k\">def</span> <span class=\"pl-en\">initialize</span>\n  <span class=\"pl-smi\">super</span><span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-kos\">{</span> |<span class=\"pl-s1\">h</span><span class=\"pl-kos\">,</span> <span class=\"pl-s1\">k</span>| <span class=\"pl-en\">parent</span><span class=\"pl-kos\">[</span><span class=\"pl-s1\">k</span><span class=\"pl-kos\">]</span> <span class=\"pl-kos\">}</span>\n<span class=\"pl-k\">end</span></pre></div>\n<p dir=\"auto\">Because of this, lookups work because they fall through to the block which is stored in the closure. But if you try to do any hash-like behaviour it only operates on the keys added after inheritance, and ignores the parent hash. So when attempting to <code class=\"notranslate\">to_h</code> and compare the results are silently wrong and confusing.</p>\n<p dir=\"auto\">Specifically:</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&gt; object = ActiveSupport::InheritableOptions.new(key: :value)\n=&gt; {}\n&gt; object.to_h\n=&gt; {}\n&gt; object[:key]\n=&gt; :value\"><pre class=\"notranslate\">&gt; <span class=\"pl-s1\">object</span> <span class=\"pl-c1\">=</span> <span class=\"pl-v\">ActiveSupport</span>::<span class=\"pl-v\">InheritableOptions</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">new</span><span class=\"pl-kos\">(</span><span class=\"pl-pds\">key</span>: <span class=\"pl-pds\">:value</span><span class=\"pl-kos\">)</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-s1\">object</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">to_h</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span><span class=\"pl-kos\">}</span><span class=\"pl-en\"></span>\n&gt; <span class=\"pl-s1\">object</span><span class=\"pl-kos\">[</span><span class=\"pl-pds\">:key</span><span class=\"pl-kos\">]</span>\n<span class=\"pl-c1\">=&gt;</span> <span class=\"pl-pds\">:value</span></pre></div>\n<h2 dir=\"auto\">Solution</h2>\n<p dir=\"auto\">Override <code class=\"notranslate\">to_h</code>, <code class=\"notranslate\">inspect</code>, and <code class=\"notranslate\">==</code> in order to merge the parent hash and self hash, and then behave like a hash.</p>\n<p dir=\"auto\">cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a></p>",
            "url": "https://github.com/rails/rails/pull/50151",
            "title": "Improve `ActiveSupport::InheritableOptions` hash-like behaviour",
            "date_modified": "2023-11-27T16:27:25.000Z",
            "date_published": "2023-11-23T17:55:54.000Z",
            "author": {
                "name": "kmcphillips",
                "url": "https://github.com/kmcphillips"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/84159?u=611f8cb6bdccc221b89e645b60cb8471d9269ada&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><h2 dir=\"auto\">Problem</h2>\n<p dir=\"auto\">In <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"1994508902\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50064\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50064/hovercard\" href=\"https://github.com/rails/rails/pull/50064\">#50064</a> and <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2002097869\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50112\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50112/hovercard\" href=\"https://github.com/rails/rails/pull/50112\">#50112</a> we have changed the way Active Record database adapters are expected to register themselves with the framework in order to be loaded.</p>\n<p dir=\"auto\">Previously it was by convention, as Jean so eloquently defined it as \"byzantine\":</p>\n<ul dir=\"auto\">\n<li>They must be defined in <code class=\"notranslate\">active_record/connection_adapters/&lt;name&gt;_adapter</code></li>\n<li>They must define <code class=\"notranslate\">ConnectionHandling.&lt;name&gt;_adapter_class</code></li>\n<li>They must define <code class=\"notranslate\">ConnectionHandling.&lt;name&gt;_connection</code></li>\n</ul>\n<p dir=\"auto\">Now they must explicitly call <code class=\"notranslate\">ActiveRecord::ConnectionAdapters.register</code> and do not need to fit this convention.</p>\n<p dir=\"auto\">Rails has updated its internal adapters, and we will attempt to notify known maintainers of adapters. But there are plenty of use cases for private adapters we do not know about or cannot know about.</p>\n<p dir=\"auto\">The issue with that is the error message is pretty generic \"this adapter does not exist, be sure to add it to the gemfile\" which is correct for most <em>users</em> but not correct for <em>maintainers</em>. We want to make <strong>updating as clear and easy as possible</strong>. The code change is pretty small, but knowing where and how to make that change is the hard part.</p>\n<h2 dir=\"auto\">Solution</h2>\n<p dir=\"auto\">Add a transitionary block of extra error handling and messaging to explain how to update the adapters.</p>\n<p dir=\"auto\">When calling <code class=\"notranslate\">resolve(\"some_adapter\")</code> and it is not found, before raising the generic error first try to require that adapter in the legacy location. If it is found raise a better error explaining exactly how to update the adapter.</p>\n<p dir=\"auto\">The tricky part is that just because a file with that name exists, does not necessarily mean that file is an adapter. So to be extra sure we check for the existence of an adapter method. If it's not there raise a slightly different error message.</p>\n<p dir=\"auto\">Hopefully this makes the transition path easier.</p>\n<h2 dir=\"auto\">Questions</h2>\n<p dir=\"auto\">This code can all be deleted, especially the fake test classes, when we move beyond <code class=\"notranslate\">7.2.x</code>. What is the desired way to flag this to be deleted when the next major or minor version is updated on <code class=\"notranslate\">main</code>?</p>\n<p dir=\"auto\">Paired with <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/adrianna-chang-shopify/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/adrianna-chang-shopify\">@adrianna-chang-shopify</a><br>\ncc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a></p>",
            "url": "https://github.com/rails/rails/pull/50150",
            "title": "Add more specific exceptions to warn when an adapter is using legacy adapter format",
            "date_modified": "2023-11-25T11:05:06.000Z",
            "date_published": "2023-11-23T16:12:16.000Z",
            "author": {
                "name": "kmcphillips",
                "url": "https://github.com/kmcphillips"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/5657035?u=48dc5950e98b199e1ed1e8c5c3f1e4bfd2b39691&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\"><span class=\"issue-keyword tooltipped tooltipped-se\" aria-label=\"This pull request closes issue #50125.\">Fixes</span> <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2003526083\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50125\" data-hovercard-type=\"issue\" data-hovercard-url=\"/rails/rails/issues/50125/hovercard\" href=\"https://github.com/rails/rails/issues/50125\">#50125</a>.</p>\n<p dir=\"auto\"><a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"645515028\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/39723\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/39723/hovercard\" href=\"https://github.com/rails/rails/pull/39723\">#39723</a> changed bad connection related errors so that we now have some (useful for debugging) details from the original database exceptions lost.</p>\n<p dir=\"auto\"><del>This PR adds original database errors to these new exceptions classes, so we can get the exception details. It also prints these added exceptions messages by default as part of the new exceptions messages.</del></p>",
            "url": "https://github.com/rails/rails/pull/50145",
            "title": "Include exception causes into log messages",
            "date_modified": "2023-11-23T15:25:14.000Z",
            "date_published": "2023-11-23T00:02:56.000Z",
            "author": {
                "name": "fatkodima",
                "url": "https://github.com/fatkodima"
            }
        },
        {
            "content_html": "<img src=\"https://avatars.githubusercontent.com/u/84159?u=611f8cb6bdccc221b89e645b60cb8471d9269ada&v=4\" width=\"64\" height=\"64\" alt=\"\"/><br/><p dir=\"auto\">This takes a completely different approach to what I attempted in <a class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"2002097869\" data-permission-text=\"Title is private\" data-url=\"https://github.com/rails/rails/issues/50112\" data-hovercard-type=\"pull_request\" data-hovercard-url=\"/rails/rails/pull/50112/hovercard\" href=\"https://github.com/rails/rails/pull/50112\">#50112</a>, cc <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/byroot/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/byroot\">@byroot</a> <a class=\"user-mention notranslate\" data-hovercard-type=\"user\" data-hovercard-url=\"/users/matthewd/hovercard\" data-octo-click=\"hovercard-link-click\" data-octo-dimensions=\"link_type:self\" href=\"https://github.com/matthewd\">@matthewd</a>.</p>\n<h2 dir=\"auto\">Problem</h2>\n<p dir=\"auto\">When using a <code class=\"notranslate\">DATABASE_URL</code> to define a database connection, the deployment env config needs to define the adapter used as part of the URL. The adapter is actually an application level concern, and what the env should care about is the DBMS/protocol (ie. \"this rails app connects to MySQL\" and not \"this rails app connects to MySQL and does it using a specific adapter class\")</p>\n<p dir=\"auto\">The most obvious usecase here is toggling or transitioning between <code class=\"notranslate\">mysql2</code> and <code class=\"notranslate\">trilogy</code> as they are both first party DB adapters including in Rails to connect to MySQL, but the same concern holds true for custom adapters and likely any future adapters.</p>\n<p dir=\"auto\">What the env should be able to do is say <code class=\"notranslate\">DATABASE_URL=mysql://host/db?options=whatever</code> and then have the application decide that <code class=\"notranslate\">mysql -&gt; mysql2</code> or <code class=\"notranslate\">mysql -&gt; trilogy</code> without having to modify the environment.</p>\n<h2 dir=\"auto\">Solution</h2>\n<p dir=\"auto\">Add an Active Record config that provides a mapping from protocol to adapter in database URLs. Use that in the <code class=\"notranslate\">ActiveRecord::DatabaseConfigurations::UrlConfig</code> (the <code class=\"notranslate\">ActiveRecord::DatabaseConfigurations::ConnectionUrlResolver</code> class internally) to map from protocol to adapter.</p>\n<div class=\"highlight highlight-source-ruby notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"config.active_record.protocol_adapters.mysql = &quot;trilogy&quot;\"><pre class=\"notranslate\"><span class=\"pl-en\">config</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">active_record</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">protocol_adapters</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">mysql</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">\"trilogy\"</span></pre></div>\n<p dir=\"auto\">Build in some reasonable defaults, including removing a specific <code class=\"notranslate\">postgres</code> -&gt; <code class=\"notranslate\">postgresql</code> hack that was already hardcoded in. In this case:</p>\n<table role=\"table\">\n<thead>\n<tr>\n<th>Protocol</th>\n<th>Adapter</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"notranslate\">mysql</code></td>\n<td><code class=\"notranslate\">mysql2</code></td>\n</tr>\n<tr>\n<td><code class=\"notranslate\">sqlite</code></td>\n<td><code class=\"notranslate\">sqlite3</code></td>\n</tr>\n<tr>\n<td><code class=\"notranslate\">postgres</code></td>\n<td><code class=\"notranslate\">postgresql</code></td>\n</tr>\n</tbody>\n</table>\n<h2 dir=\"auto\">What should reviewers focus on?</h2>\n<ul dir=\"auto\">\n<li>Oh gosh writing good documentation is hard.</li>\n<li>I use <code class=\"notranslate\">ActiveSupport::InheritableOptions</code> but it's not strictly necessary. It provides some indifferent access and reader conveniences, but a hash would work and just be less forgiving.</li>\n<li>I added <code class=\"notranslate\">sqlite</code> to <code class=\"notranslate\">sqlite3</code> but I honestly have no idea if this is correct or reasonable.</li>\n</ul>",
            "url": "https://github.com/rails/rails/pull/50140",
            "title": "Add a `ActiveRecord.protocol_adapters` configuration to map `DATABASE_URL` protocols to adapters at an application level",
            "date_modified": "2023-11-23T19:23:16.000Z",
            "date_published": "2023-11-22T18:26:53.000Z",
            "author": {
                "name": "kmcphillips",
                "url": "https://github.com/kmcphillips"
            }
        }
    ]
}